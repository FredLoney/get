/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var n=void 0,o=!0,r=null,s=!1;function aa(){return function(){}}function ea(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var u,fa=this;function ga(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==n}function x(a){return a!=r}function z(a){return"array"==ha(a)}function ja(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ka(a){return"string"==typeof a}function D(a){return"number"==typeof a}function la(a){return"function"==ha(a)}function ma(a){a=ha(a);return"object"==a||"array"==a||"function"==a}function na(a){return a[oa]||(a[oa]=++pa)}
var oa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),pa=0;function qa(a,b,c){return a.call.apply(a.bind,arguments)}function sa(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ta(a,b,c){ta=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?qa:sa;return ta.apply(r,arguments)}function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=fa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function H(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c;a.prototype.constructor=a};function xa(a,b,c){this.Da=this.Ca=this.Ba=0;3==arguments.length?(this.Ba=Number(a),this.Ca=Number(b),this.Da=Number(c)):a instanceof xa?(this.Ba=Number(a.x()),this.Ca=Number(a.y()),this.Da=Number(a.b())):(this.Ba=Number(a[0]),this.Ca=Number(a[1]),this.Da=Number(a[2]))}
xa.prototype={f:function(){return new xa(this.Ba,this.Ca,this.Da)},Xe:function(){return new xa(-this.Ba,-this.Ca,-this.Da)},xc:function(a){return new xa(this.Ba+a.x(),this.Ca+a.y(),this.Da+a.b())},hd:function(a){return new xa(this.Ba-a.x(),this.Ca-a.y(),this.Da-a.b())},Eb:function(a){return new xa(this.Ba*a,this.Ca*a,this.Da*a)},fh:function(a){return new xa(this.Ba/a,this.Ca/a,this.Da/a)},uc:function(a){return this.Ba*a.x()+this.Ca*a.y()+this.Da*a.b()},dg:function(a,b){return this.xc(a.hd(this).Eb(b))},
length:function(){return Math.sqrt(this.uc(this))},od:function(){return this.fh(this.length())},Ge:function(a){return new xa(this.Ca*a.b()-this.Da*a.y(),this.Da*a.x()-this.Ba*a.b(),this.Ba*a.y()-this.Ca*a.x())},x:t("Ba"),y:t("Ca"),b:t("Da")};var I=I||{};I.Ui=o;I.sa=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.na=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Pg=0;this.Qi=function(){return this.Pg++}};function ya(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.kd;++c)window.kd=window[b[c]+"RequestAnimationFrame"],window.Be=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.kd||(window.kd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Be||(window.Be=function(a){clearTimeout(a)})})();E("Function.prototype.bind",Function.prototype.bind);E("window.requestAnimationFrame",window.kd);
E("window.cancelAnimationFrame",window.Be);function za(a){if(!Ca.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Da,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ea,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Fa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ga,"&quot;"));return a}var Da=/&/g,Ea=/</g,Fa=/>/g,Ga=/\"/g,Ca=/[&<>\"]/;var Ha,Ja,Ka,La,Ma,Na,Oa;function Pa(){return fa.navigator?fa.navigator.userAgent:r}function Qa(){return fa.navigator}Ma=La=Ka=Ja=Ha=s;var Ra;if(Ra=Pa()){var Ta=Qa();Ha=0==Ra.indexOf("Opera");Ja=!Ha&&-1!=Ra.indexOf("MSIE");La=(Ka=!Ha&&-1!=Ra.indexOf("WebKit"))&&-1!=Ra.indexOf("Mobile");Ma=!Ha&&!Ka&&"Gecko"==Ta.product}var Ua=Ha,J=Ja,Va=Ma,Wa=Ka,Xa=La,Ya,Za=Qa();Ya=Za&&Za.platform||"";Na=-1!=Ya.indexOf("Mac");Oa=-1!=Ya.indexOf("Win");var ab=!!Qa()&&-1!=(Qa().appVersion||"").indexOf("X11"),bb;
a:{var cb="",db;if(Ua&&fa.opera)var eb=fa.opera.version,cb="function"==typeof eb?eb():eb;else if(Va?db=/rv\:([^\);]+)(\)|;)/:J?db=/MSIE\s+([^\);]+)(\)|;)/:Wa&&(db=/WebKit\/(\S+)/),db)var fb=db.exec(Pa()),cb=fb?fb[1]:"";if(J){var jb,kb=fa.document;jb=kb?kb.documentMode:n;if(jb>parseFloat(cb)){bb=""+jb;break a}}bb=cb}var lb={};
function mb(a){var b;if(!(b=lb[a])){b=0;for(var c=(""+bb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var j=k.exec(g)||["","",""],l=m.exec(h)||["","",""];if(0==j[0].length&&0==l[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==j[2].length)<(0==l[2].length)?-1:(0==j[2].length)>(0==l[2].length)?1:0)||(j[2]<l[2]?-1:j[2]>l[2]?1:0)}while(0==b)}b=lb[a]=0<=b}return b}var nb={};function ob(a){return nb[a]||(nb[a]=J&&document.documentMode&&document.documentMode>=a)};function qb(a,b){for(var c in a)b.call(n,a[c],c,a)}function rb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function sb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var tb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function ub(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tb.length;f++)c=tb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var vb=Array.prototype,wb=vb.indexOf?function(a,b,c){return vb.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(ka(a))return!ka(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=vb.forEach?function(a,b,c){vb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=vb.map?function(a,b,c){return vb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ka(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},zb=vb.some?function(a,b,c){return vb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return o;return s},Ab=vb.every?function(a,b,c){return vb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return o};function Bb(a,b){var c=wb(a,b);0<=c&&vb.splice.call(a,c,1)}
function Cb(a){return vb.concat.apply(vb,arguments)}function Db(a){if(z(a))return Cb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Eb(a,b,c){return 2>=arguments.length?vb.slice.call(a,b):vb.slice.call(a,b,c)};function Fb(a){if("function"==typeof a.pa)a=a.pa();else if(ja(a)||ka(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Jb(a){if("function"==typeof a.bc)return a.bc();if(ka(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return rb(a)}
function Kb(a,b){if("function"==typeof a.every)return a.every(b,n);if(ja(a)||ka(a))return Ab(a,b,n);var c;if("function"==typeof a.dd)c=a.dd();else if("function"!=typeof a.bc)if(ja(a)||ka(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=sb(a);else c=n;for(var d=Jb(a),e=d.length,f=0;f<e;f++)if(!b.call(n,d[f],c&&c[f],a))return s;return o};var Lb="StopIteration"in fa?fa.StopIteration:Error("StopIteration");function Mb(){}Mb.prototype.next=function(){i(Lb)};Mb.prototype.Dc=function(){return this};function Nb(a){if(a instanceof Mb)return a;if("function"==typeof a.Dc)return a.Dc(s);if(ja(a)){var b=0,c=new Mb;c.next=function(){for(;;){b>=a.length&&i(Lb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Ob(a,b){if(ja(a))try{xb(a,b,n)}catch(c){c!==Lb&&i(c)}else{a=Nb(a);try{for(;;)b.call(n,a.next(),n,a)}catch(d){d!==Lb&&i(d)}}};function Pb(a,b){this.D={};this.w=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.ye(a)}u=Pb.prototype;u.L=0;u.pd=0;u.pa=t("L");u.bc=function(){Qb(this);for(var a=[],b=0;b<this.w.length;b++)a.push(this.D[this.w[b]]);return a};u.dd=function(){Qb(this);return this.w.concat()};u.Ee=function(a){for(var b=0;b<this.w.length;b++){var c=this.w[b];if(Rb(this.D,c)&&this.D[c]==a)return o}return s};
u.$c=function(a,b){if(this===a)return o;if(this.L!=a.pa())return s;var c=b||Sb;Qb(this);for(var d,e=0;d=this.w[e];e++)if(!c(this.get(d),a.get(d)))return s;return o};function Sb(a,b){return a===b}u.clear=function(){this.D={};this.pd=this.L=this.w.length=0};u.remove=function(a){return Rb(this.D,a)?(delete this.D[a],this.L--,this.pd++,this.w.length>2*this.L&&Qb(this),o):s};
function Qb(a){if(a.L!=a.w.length){for(var b=0,c=0;b<a.w.length;){var d=a.w[b];Rb(a.D,d)&&(a.w[c++]=d);b++}a.w.length=c}if(a.L!=a.w.length){for(var e={},c=b=0;b<a.w.length;)d=a.w[b],Rb(e,d)||(a.w[c++]=d,e[d]=1),b++;a.w.length=c}}u.get=function(a,b){return Rb(this.D,a)?this.D[a]:b};u.set=function(a,b){Rb(this.D,a)||(this.L++,this.w.push(a),this.pd++);this.D[a]=b};u.ye=function(a){var b;a instanceof Pb?(b=a.dd(),a=a.bc()):(b=sb(a),a=rb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};u.f=function(){return new Pb(this)};
u.Dc=function(a){Qb(this);var b=0,c=this.w,d=this.D,e=this.pd,f=this,g=new Mb;g.next=function(){for(;;){e!=f.pd&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Lb);var g=c[b++];return a?g:d[g]}};return g};function Rb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Tb(a){this.D=new Pb;a&&this.ye(a)}function Ub(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+na(a):b.substr(0,1)+a}u=Tb.prototype;u.pa=function(){return this.D.pa()};u.add=function(a){this.D.set(Ub(a),a)};u.ye=function(a){for(var a=Jb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};u.Yd=function(a){for(var a=Jb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};u.remove=function(a){return this.D.remove(Ub(a))};u.clear=function(){this.D.clear()};
u.contains=function(a){a=Ub(a);return Rb(this.D.D,a)};u.bg=function(a){for(var b=new Tb,a=Jb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};u.bc=function(){return this.D.bc()};u.f=function(){return new Tb(this)};u.$c=function(a){return this.pa()==Fb(a)&&Vb(this,a)};
function Vb(a,b){var c=Fb(b);if(a.pa()>c)return s;!(b instanceof Tb)&&5<c&&(b=new Tb(b));return Kb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Ee)a=b.Ee(a);else if(ja(b)||ka(b))a=0<=wb(b,a);else a:{for(var c in b)if(b[c]==a){a=o;break a}a=s}return a})}u.Dc=function(){return this.D.Dc(s)};function Wb(){}Wb.prototype.Of=s;Wb.prototype.Ma=function(){this.Of||(this.Of=o,this.M())};Wb.prototype.M=function(){this.bh&&Xb.apply(r,this.bh)};function Yb(a){a&&"function"==typeof a.Ma&&a.Ma()}function Xb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ja(d)?Xb.apply(r,d):Yb(d)}};function Zb(a,b){this.fg=b;this.cd=[];a>this.fg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.cd.push(this.Kd())}H(Zb,Wb);u=Zb.prototype;u.Lf=r;u.Nf=r;function $b(a,b){a.cd.length<a.fg?a.cd.push(b):a.Ie(b)}u.Kd=function(){return this.Lf?this.Lf():{}};u.Ie=function(a){if(this.Nf)this.Nf(a);else if(ma(a))if(la(a.Ma))a.Ma();else for(var b in a)delete a[b]};u.M=function(){Zb.i.M.call(this);for(var a=this.cd;a.length;)this.Ie(a.pop());delete this.cd};function ac(){this.ad=[];this.cf=new Pb;this.Bg=this.Cg=this.Dg=this.yg=0;this.nd=new Pb;this.If=this.Ag=0;this.Ye=1;this.Je=new Zb(0,4E3);this.Je.Kd=function(){return new bc};this.zg=new Zb(0,50);this.zg.Kd=function(){return new cc};var a=this;this.Ne=new Zb(0,2E3);this.Ne.Kd=function(){return""+a.Ye++};this.Ne.Ie=aa()}function cc(){this.pf=this.time=this.count=0}
cc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.pf&&a.push(" [VarAlloc = ",this.pf,"]");return a.join("")};function bc(){}function dc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(ec(a.Pf-c));e.push(" ",fc(a.Pf-b));0==a.Ke?e.push(" Start        "):1==a.Ke?(e.push(" Done "),e.push(ec(a.Jj-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Mi&&e.push("[VarAlloc ",a.Mi,"] ");return e.join("")}
bc.prototype.toString=function(){return this.type==r?this.Zg:"["+this.type+"] "+this.Zg};ac.prototype.reset=function(){for(var a=0;a<this.ad.length;a++){var b=this.Je.id;b&&$b(this.Ne,b);$b(this.Je,this.ad[a])}this.ad.length=0;this.cf.clear();this.yg=wa();this.If=this.Ag=this.Bg=this.Cg=this.Dg=0;b=this.nd.dd();for(a=0;a<b.length;a++){var c=this.nd.get(b[a]);c.count=0;c.time=0;c.pf=0;$b(this.zg,c)}this.nd.clear()};
ac.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.ad.length;d++){var e=this.ad[d];1==e.Ke&&c.pop();a.push(" ",dc(e,this.yg,b,c.join("")));b=e.Pf;a.push("\n");0==e.Ke&&c.push("|  ")}if(0!=this.cf.pa()){var f=wa();a.push(" Unstopped timers:\n");Ob(this.cf,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",fc(b.startTime),")\n")})}b=this.nd.dd();for(d=0;d<b.length;d++)c=this.nd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Ag,"\n","Total comments created ",
this.If,"\n","Overhead start: ",this.Dg," ms\n","Overhead end: ",this.Cg," ms\n","Overhead comment: ",this.Bg," ms\n");return a.join("")};function ec(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function fc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new ac;function gc(){}var hc=0;u=gc.prototype;u.key=0;u.zc=s;u.Ae=s;u.ma=function(a,b,c,d,e,f){la(a)?this.cg=o:a&&a.handleEvent&&la(a.handleEvent)?this.cg=s:i(Error("Invalid listener argument"));this.fd=a;this.ug=b;this.src=c;this.type=d;this.capture=!!e;this.Le=f;this.Ae=s;this.key=++hc;this.zc=s};u.handleEvent=function(a){return this.cg?this.fd.call(this.Le||this.src,a):this.fd.handleEvent.call(this.fd,a)};!J||ob(9);var ic=!J||ob(9),jc=J&&!mb("8");!Wa||mb("528");Va&&mb("1.9b")||J&&mb("8")||Ua&&mb("9.5")||Wa&&mb("528");!Va||mb("8");function kc(a,b){this.type=a;this.currentTarget=this.target=b}H(kc,Wb);u=kc.prototype;u.M=function(){delete this.type;delete this.target;delete this.currentTarget};u.fc=s;u.ld=o;u.stopPropagation=function(){this.fc=o};u.preventDefault=function(){this.ld=s};function lc(a){lc[" "](a);return a}lc[" "]=ga;function mc(a,b){a&&this.ma(a,b)}H(mc,kc);u=mc.prototype;u.target=r;u.relatedTarget=r;u.offsetX=0;u.offsetY=0;u.clientX=0;u.clientY=0;u.screenX=0;u.screenY=0;u.button=0;u.keyCode=0;u.charCode=0;u.ctrlKey=s;u.altKey=s;u.shiftKey=s;u.metaKey=s;u.Wa=r;
u.ma=function(a,b){var c=this.type=a.type;kc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Va){var e;a:{try{lc(d.nodeName);e=o;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Wa||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=Wa||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Wa=a;delete this.ld;delete this.fc};u.stopPropagation=function(){mc.i.stopPropagation.call(this);this.Wa.stopPropagation?this.Wa.stopPropagation():this.Wa.cancelBubble=o};
u.preventDefault=function(){mc.i.preventDefault.call(this);var a=this.Wa;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,jc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};u.oh=t("Wa");u.M=function(){mc.i.M.call(this);this.relatedTarget=this.currentTarget=this.target=this.Wa=r};var nc={},oc={},pc={},qc={};
function L(a,b,c,d,e){if(b){if(z(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return r}var d=!!d,g=oc;b in g||(g[b]={L:0,Ha:0});g=g[b];d in g||(g[d]={L:0,Ha:0},g.L++);var g=g[d],h=na(a),k;g.Ha++;if(g[h]){k=g[h];for(f=0;f<k.length;f++)if(g=k[f],g.fd==c&&g.Le==e){if(g.zc)break;return k[f].key}}else k=g[h]=[],g.L++;f=rc();f.src=a;g=new gc;g.ma(c,f,a,b,d,e);c=g.key;f.key=c;k.push(g);nc[c]=g;pc[h]||(pc[h]=[]);pc[h].push(g);a.addEventListener?(a==fa||!a.Mf)&&a.addEventListener(b,f,d):a.attachEvent(b in
qc?qc[b]:qc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function rc(){var a=sc,b=ic?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function tc(a,b,c,d,e){if(z(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else a=L(a,b,c,d,e),nc[a].Ae=o}
function uc(a,b,c,d,e){if(z(b))for(var f=0;f<b.length;f++)uc(a,b[f],c,d,e);else{d=!!d;a:{f=oc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=na(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].fd==c&&a[f].capture==d&&a[f].Le==e){vc(a[f].key);break}}}
function vc(a){if(!nc[a])return s;var b=nc[a];if(b.zc)return s;var c=b.src,d=b.type,e=b.ug,f=b.capture;c.removeEventListener?(c==fa||!c.Mf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in qc?qc[d]:qc[d]="on"+d,e);c=na(c);e=oc[d][f][c];if(pc[c]){var g=pc[c];Bb(g,b);0==g.length&&delete pc[c]}b.zc=o;e.jg=o;wc(d,f,c,e);delete nc[a];return o}
function wc(a,b,c,d){if(!d.Ud&&d.jg){for(var e=0,f=0;e<d.length;e++)d[e].zc?d[e].ug.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.jg=s;0==f&&(delete oc[a][b][c],oc[a][b].L--,0==oc[a][b].L&&(delete oc[a][b],oc[a].L--),0==oc[a].L&&delete oc[a])}}function xc(a){var b,c=0,d=b==r;b=!!b;if(a==r)qb(pc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}});else if(a=na(a),pc[a])for(var a=pc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}}
function yc(a){var b=zc,a=na(a),c=pc[a];if(c){var d=ia(b),e=ia(n);return d&&e?(c=oc[b],!!c&&!!c[n]&&a in c[n]):!d&&!e?o:zb(c,function(a){return d&&a.type==b||e&&a.capture==n})}return s}function Ac(a,b,c,d,e){var f=1,b=na(b);if(a[b]){a.Ha--;a=a[b];a.Ud?a.Ud++:a.Ud=1;try{for(var g=a.length,h=0;h<g;h++){var k=a[h];k&&!k.zc&&(f&=Bc(k,e)!==s)}}finally{a.Ud--,wc(c,d,b,a)}}return Boolean(f)}function Bc(a,b){var c=a.handleEvent(b);a.Ae&&vc(a.key);return c}
function sc(a,b){if(!nc[a])return o;var c=nc[a],d=c.type,e=oc;if(!(d in e))return o;var e=e[d],f,g;if(!ic){var h;if(!(h=b))a:{h=["window","event"];for(var k=fa;f=h.shift();)if(x(k[f]))k=k[f];else{h=r;break a}h=k}f=h;h=o in e;k=s in e;if(h){if(0>f.keyCode||f.returnValue!=n)return o;a:{var m=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(j){m=o}if(m||f.returnValue==n)f.returnValue=o}}m=new mc;m.ma(f,this);f=o;try{if(h){for(var l=[],q=m.currentTarget;q;q=q.parentNode)l.push(q);g=e[o];g.Ha=g.L;for(var p=
l.length-1;!m.fc&&0<=p&&g.Ha;p--)m.currentTarget=l[p],f&=Ac(g,l[p],d,o,m);if(k){g=e[s];g.Ha=g.L;for(p=0;!m.fc&&p<l.length&&g.Ha;p++)m.currentTarget=l[p],f&=Ac(g,l[p],d,s,m)}}else f=Bc(c,m)}finally{l&&(l.length=0),m.Ma()}return f}d=new mc(b,this);try{f=Bc(c,d)}finally{d.Ma()}return f}var Cc=0;function Fc(a){return a+"_"+Cc++};function Gc(){}H(Gc,Wb);u=Gc.prototype;u.Mf=o;u.Wd=r;u.ff=ea("Wd");u.addEventListener=function(a,b,c,d){L(this,a,b,c,d)};u.removeEventListener=function(a,b,c,d){uc(this,a,b,c,d)};
u.dispatchEvent=function(a){var b=a.type||a,c=oc;if(b in c){if(ka(a))a=new kc(a,this);else if(a instanceof kc)a.target=a.target||this;else{var d=a,a=new kc(b,this);ub(a,d)}var d=1,e,c=c[b],b=o in c,f;if(b){e=[];for(f=this;f;f=f.Wd)e.push(f);f=c[o];f.Ha=f.L;for(var g=e.length-1;!a.fc&&0<=g&&f.Ha;g--)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,o,a)&&a.ld!=s}if(s in c)if(f=c[s],f.Ha=f.L,b)for(g=0;!a.fc&&g<e.length&&f.Ha;g++)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,s,a)&&a.ld!=s;else for(e=this;!a.fc&&e&&
f.Ha;e=e.Wd)a.currentTarget=e,d&=Ac(f,e,a.type,s,a)&&a.ld!=s;a=Boolean(d)}else a=o;return a};u.M=function(){Gc.i.M.call(this);xc(this);this.Wd=r};function M(){this.c="base";this.ta=window["X.counter"].Qi();this.e=s}H(M,Gc);M.prototype.__defineGetter__("classname",t("c"));M.prototype.__defineGetter__("id",t("ta"));E("X.base",M);function Hc(a,b){this.Aa=new xa(a);this.ga=new xa(b)}Hc.prototype={f:function(){return new Hc(this.Aa.f(),this.ga.f())},ac:function(){this.ga=this.ga.Xe()},Ch:function(a,b){return new Hc(this.Aa.dg(a.Aa,b),this.ga.dg(a.ga,b))}};function Ic(a,b){this.ga=a;this.qd=b}Ic.prototype={f:function(){return new Ic(this.ga.f(),this.qd)},ac:function(){this.ga=this.ga.Xe();this.qd=-this.qd}};function Jc(a,b){this.hb=a;this.be=b;var c=a[0].Aa,d=a[2].Aa,d=a[1].Aa.hd(c).Ge(d.hd(c)).od();this.za=new Ic(d,d.uc(c))}
Jc.prototype={f:function(){var a=this.hb.map(function(a){return a.f()});return new Jc(a,this.be)},ac:function(){this.hb.reverse().map(function(a){a.ac()});this.za.ac()},xg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.hb.length;h++){var k=a.ga.uc(this.hb[h].Aa)-a.qd,k=-1.0E-5>k?2:1.0E-5<k?1:0,f=f|k;g.push(k)}switch(f){case 0:(0<a.ga.uc(this.za.ga)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.hb.length;h++){var m=(h+1)%this.hb.length,k=
g[h],j=g[m],f=this.hb[h],m=this.hb[m];2!=k&&b.push(f);1!=k&&c.push(2!=k?f.f():f);3==(k|j)&&(k=(a.qd-a.ga.uc(f.Aa))/a.ga.uc(m.Aa.hd(f.Aa)),k=f.Ch(m,k),b.push(k),c.push(k.f()))}3<=b.length&&d.push(new Jc(b,this.be));3<=c.length&&e.push(new Jc(c,this.be))}}};function Kc(a){this.ha=this.ia=this.za=r;this.A=[];a&&this.rc(a)}
Kc.prototype={f:function(){var a=new Kc;a.xi(this.za&&this.za.f());a.wi(this.ia&&this.ia.f());a.vi(this.ha&&this.ha.f());a.$d(this.A.map(function(a){return a.f()}));return a},ca:function(){for(var a=0;a<this.A.length;a++)this.A[a].ac();this.za.ac();this.ia&&this.ia.ca();this.ha&&this.ha.ca();a=this.ia;this.ia=this.ha;this.ha=a},De:function(a){if(!this.za)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].xg(this.za,b,c,b,c);this.ia&&(b=this.ia.De(b));c=this.ha?this.ha.De(c):[];return b.concat(c)},
La:function(a){this.A=a.De(this.A);this.ia&&this.ia.La(a);this.ha&&this.ha.La(a)},Bb:function(){var a=this.A.slice();this.ia&&(a=a.concat(this.ia.Bb()));this.ha&&(a=a.concat(this.ha.Bb()));return a},rc:function(a){if(a.length){this.za||(this.za=a[0].za.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].xg(this.za,this.A,this.A,b,c);b.length&&(this.ia||(this.ia=new Kc),this.ia.rc(b));c.length&&(this.ha||(this.ha=new Kc),this.ha.rc(c))}},xi:ea("za"),wi:ea("ia"),vi:ea("ha"),$d:ea("A")};function Lc(){this.A=[]}function Mc(a){var b=new Lc;b.$d(a);return b}
Lc.prototype={f:function(){var a=new Lc;a.$d(this.A.map(function(a){return a.f()}));return a},nf:function(a){var b=new Kc(this.f().A),a=new Kc(a.f().A);b.La(a);a.La(b);a.ca();a.La(b);a.ca();b.rc(a.Bb());return Mc(b.Bb())},gb:function(a){var b=new Kc(this.f().A),a=new Kc(a.f().A);b.ca();b.La(a);a.La(b);a.ca();a.La(b);a.ca();b.rc(a.Bb());b.ca();return Mc(b.Bb())},Pe:function(a){var b=new Kc(this.f().A),a=new Kc(a.f().A);b.ca();a.La(b);a.ca();b.La(a);a.La(b);b.rc(a.Bb());b.ca();return Mc(b.Bb())},inverse:function(){var a=
this.f();a.A.map(function(a){a.ac()});return a},$d:ea("A")};function Nc(){M.call(this);this.c="indexer";this.we=[];this.da={}}H(Nc,M);Nc.prototype.add=function(a){x(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.da||(this.da[b]=this.we.length,this.we.push(a));return this.da[b]};Nc.prototype.unique=t("we");function Oc(a){M.call(this);this.c="file";this.Qc=a;this.e=o}H(Oc,M);function Pc(){this.vd=this.nc=this.Sa=this.t=r}Pc.prototype.__defineSetter__("file",function(a){this.t=!x(a)||z(a)&&0==a.length?r:z(a)?1==a.length?new Oc(a[0]):yb(a,function(a){var c=new N;c.t=new Oc(a);return c}):new Oc(a)});Pc.prototype.__defineGetter__("file",function(){return!this.t?"":this.t.Qc});Pc.prototype.__defineGetter__("filedata",t("Sa"));
Pc.prototype.__defineSetter__("filedata",function(a){if(!x(a)||z(a)&&0==a.length)this.Sa=r;if(z(a))if(1==a.length)this.Sa=a[0];else{var b=this.t.length,c;for(c=0;c<b;c++)this.t[c].Sa=a[c]}else this.Sa=a});Pc.prototype.__defineSetter__("hdrfile",function(a){this.nc=x(a)?new Oc(a):r});Pc.prototype.__defineGetter__("hdrfile",function(){return!this.nc?"":this.nc.Qc});Pc.prototype.__defineGetter__("hdrfiledata",t("vd"));Pc.prototype.__defineSetter__("hdrfiledata",ea("vd"));function Qc(){M.call(this);this.c="colortable";this.da=new Pb;ya(this,new Pc)}H(Qc,M);Qc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&i(Error("Invalid color table entry."));this.da.set(a,[b,c,d,e,f]);this.e=o};function Rc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.b=ia(c)?c:0}Rc.prototype.f=function(){return new Rc(this.x,this.y,this.b)};Rc.prototype.mf=function(){return[this.x,this.y,this.b]};function P(a,b,c){this.x=a;this.y=b;this.b=c}H(P,Rc);u=P.prototype;u.f=function(){return new P(this.x,this.y,this.b)};u.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};u.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};u.ca=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};u.normalize=function(){return this.scale(1/this.dc())};u.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
u.gb=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};u.$c=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Sc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Tc(a,b){return new P(a.x+b.x,a.y+b.y,a.b+b.b)}function Uc(a,b){return new P(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Vc(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}Vc.prototype.f=function(){return new Vc(this.x,this.y)};function Wc(a,b){return new Vc(a.x-b.x,a.y-b.y)};function Xc(a,b){this.x=a;this.y=b}H(Xc,Vc);u=Xc.prototype;u.f=function(){return new Xc(this.x,this.y)};u.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};u.scale=function(a){this.x*=a;this.y*=a;return this};u.ca=function(){this.x=-this.x;this.y=-this.y;return this};u.normalize=function(){return this.scale(1/this.dc())};u.add=function(a){this.x+=a.x;this.y+=a.y;return this};u.gb=function(a){this.x-=a.x;this.y-=a.y;return this};
u.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};u.$c=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Yc(a,b){this.width=a;this.height=b}function Zc(a,b){return a==b?o:!a||!b?s:a.width==b.width&&a.height==b.height}Yc.prototype.f=function(){return new Yc(this.width,this.height)};Yc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Yc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Yc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function $c(a,b){if(a instanceof $c)this.U=a.mf();else{var c;if(c=ja(a))a:{for(var d=c=0;d<a.length;d++){if(!ja(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.U=Db(a):a instanceof Yc?this.U=ad(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.U=ad(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.F=new Yc(this.U[0].length,this.U.length)}
function bd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new $c(b)}function cd(a,b,c){for(var d=0;d<a.ya().height;d++)for(var e=0;e<a.ya().width;e++)b.call(c,a.U[d][e],d,e,a)}function dd(a,b){var c=new $c(a.ya());cd(a,function(d,e,f){c.U[e][f]=b.call(n,d,e,f,a)});return c}function ad(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}u=$c.prototype;
u.add=function(a){Zc(this.F,a.ya())||i(Error("Matrix summation is only supported on arrays of equal size"));return dd(this,function(b,c,d){return b+a.U[c][d]})};u.$c=function(a,b){if(this.F.width!=a.F.width||this.F.height!=a.F.height)return s;for(var c=b||0,d=0;d<this.F.height;d++)for(var e=0;e<this.F.width;e++)if(!(Math.abs(this.U[d][e]-a.U[d][e])<=(c||1.0E-6)))return s;return o};u.ya=t("F");u.V=function(a,b){return!(0<=a&&a<this.F.height&&0<=b&&b<this.F.width)?r:this.U[a][b]};
u.k=function(a,b,c){0<=a&&a<this.F.height&&0<=b&&b<this.F.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.F.height+","+this.F.width+")"));this.U[a][b]=c};u.multiply=function(a){if(a instanceof $c)return this.F.width!=a.ya().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),ed(this,a);if(D(a))return fd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
u.gb=function(a){Zc(this.F,a.ya())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return dd(this,function(b,c,d){return b-a.U[c][d]})};u.mf=t("U");function ed(a,b){var c=new $c(a.F.height,b.ya().width);cd(c,function(a,e,f){for(var g=a=0;g<this.F.width;g++)a+=this.V(e,g)*b.V(g,f);c.k(e,f,a)},a);return c}function fd(a,b){return dd(a,function(a){return a*b})};function gd(a,b){$c.call(this,a,b);this.c="matrix"}H(gd,$c);function hd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new gd(b)}u=gd.prototype;u.Ga=function(){var a=[],b=this.ya();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.V(c,d));return a};
u.translate=function(a){this.F.width!=this.F.height&&i(Error("Can not translate non-square matrix."));var b=this.ya(),c=bd(b.height);a instanceof Xc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof P&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new gd(this.multiply(c))};
u.rotate=function(a,b){(4!=this.ya().height||this.F.width!=this.F.height)&&i(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof P))&&i(Error("Invalid axis vector."));D(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=bd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new gd(this.multiply(f))};u.Oa=function(a){var b=this.ya(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof P&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new $c(c));return new P(parseFloat(a.V(0,0)),parseFloat(a.V(1,0)),parseFloat(a.V(2,0)))};u.Ki=function(a,b){var c=this.U[a];this.U[a]=this.U[b];this.U[b]=c};
u.Ji=function(a,b){for(var c=this.ya(),d=0,d=0;d<c.height;d++){var e=this.V(d,a);e||(e=0);var f=this.V(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};E("X.matrix",gd);E("X.matrix.createIdentityMatrix",hd);E("X.matrix.prototype.flatten",gd.prototype.Ga);E("X.matrix.prototype.translate",gd.prototype.translate);E("X.matrix.prototype.rotate",gd.prototype.rotate);E("X.matrix.prototype.toArray",gd.prototype.mf);E("X.matrix.prototype.getValueAt",gd.prototype.V);E("X.matrix.prototype.setValueAt",gd.prototype.k);
E("X.matrix.prototype.multiplyByVector",gd.prototype.Oa);E("X.matrix.prototype.swapRows",gd.prototype.Ki);E("X.matrix.prototype.swapCols",gd.prototype.Ji);function nd(){M.call(this);this.c="transform";this.B=hd(4);this.uf=new Float32Array(this.B.Ga())}H(nd,M);nd.prototype.__defineGetter__("matrix",t("B"));nd.prototype.__defineSetter__("matrix",function(a){(!x(a)||!(a instanceof gd))&&i(Error("Invalid matrix."));this.B=a;this.o()});u=nd.prototype;u.pi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.B=this.B.rotate(a*Math.PI/180,new P(0,1,0));this.o()};
u.qi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.B=this.B.rotate(a*Math.PI/180,new P(1,0,0));this.o()};u.ri=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.B=this.B.rotate(a*Math.PI/180,new P(0,0,1));this.o()};u.Ni=function(a){D(a)||i(Error("Invalid distance."));this.B=this.B.translate(new P(a,0,0));this.o()};u.Oi=function(a){D(a)||i(Error("Invalid distance."));this.B=this.B.translate(new P(0,a,0));this.o()};
u.Pi=function(a){D(a)||i(Error("Invalid distance."));this.B=this.B.translate(new P(0,0,a));this.o()};function od(a,b,c){var d=a.B.V(b,c);d||(d=0);a.B.k(b,c,-1*d);a.o()}u.kh=function(){od(this,0,0)};u.lh=function(){od(this,1,1)};u.mh=function(){od(this,2,2)};u.o=function(){this.uf=new Float32Array(this.B.Ga());this.e=o};E("X.transform",nd);E("X.transform.prototype.rotateX",nd.prototype.pi);E("X.transform.prototype.rotateY",nd.prototype.qi);E("X.transform.prototype.rotateZ",nd.prototype.ri);
E("X.transform.prototype.translateX",nd.prototype.Ni);E("X.transform.prototype.translateY",nd.prototype.Oi);E("X.transform.prototype.translateZ",nd.prototype.Pi);E("X.transform.prototype.flipX",nd.prototype.kh);E("X.transform.prototype.flipY",nd.prototype.lh);E("X.transform.prototype.flipZ",nd.prototype.mh);E("X.transform.prototype.modified",nd.prototype.o);function pd(){M.call(this);this.c="texture";this.xa=this.lb=this.t=r;this.xb=this.yb=0;ya(this,new Pc)}H(pd,M);E("X.texture",pd);function Q(a,b){M.call(this);this.c="fasttriplets";this.Pb=Infinity;this.Mb=-Infinity;this.Qb=Infinity;this.Nb=-Infinity;this.Rb=Infinity;this.Ob=-Infinity;this.rd=[0,0,0];this.s=0;this.I=new Float32Array(a);x(b)&&(this.I=b.I.subarray(0,b.I.length),this.s=this.I.length,this.Pb=b.Pb,this.Mb=b.Mb,this.Qb=b.Qb,this.Nb=b.Nb,this.Rb=b.Rb,this.Ob=b.Ob,this.rd=b.rd.slice())}H(Q,M);u=Q.prototype;
u.add=function(a,b,c){this.Pb=Math.min(this.Pb,a);this.Mb=Math.max(this.Mb,a);this.Qb=Math.min(this.Qb,b);this.Nb=Math.max(this.Nb,b);this.Rb=Math.min(this.Rb,c);this.Ob=Math.max(this.Ob,c);this.rd=[(this.Pb+this.Mb)/2,(this.Qb+this.Nb)/2,(this.Rb+this.Ob)/2];this.e=o;this.I[this.s++]=a;this.I[this.s++]=b;this.I[this.s++]=c;return this.s/3};u.Bc=function(){if(this.s!=this.I.length){var a=new Float32Array(this.s);a.set(this.I.subarray(0,this.s));this.I=a}};
u.get=function(a){a*=3;return[this.I[a],this.I[a+1],this.I[a+2]]};u.remove=function(){i(Error("Not implemented."))};u.clear=function(){this.I=new Float32Array(this.I.length);this.e=o};Q.prototype.__defineGetter__("count",function(){this.Bc();return this.I.length/3});Q.prototype.__defineGetter__("length",function(){this.Bc();return this.I.length});E("X.triplets",Q);E("X.triplets.prototype.add",Q.prototype.add);E("X.triplets.prototype.resize",Q.prototype.Bc);E("X.triplets.prototype.get",Q.prototype.get);
E("X.triplets.prototype.remove",Q.prototype.remove);E("X.triplets.prototype.clear",Q.prototype.clear);function S(){this.la=qd;this.Xb=new nd;this.Gb=[1,1,1];this.Wb=this.z=this.W=this.h=this.g=r;this.Rc=[];this.Ja=o;this.pc=this.Sc=1;this.jc=r;this.Jc=s;this.aa=1;this.Z=0}var qd="TRIANGLES";S.prototype.__defineSetter__("type",function(a){return this.la=a});S.prototype.__defineGetter__("type",t("la"));S.prototype.__defineGetter__("texture",function(){this.z||(this.z=new pd);return this.z});S.prototype.__defineGetter__("transform",t("Xb"));S.prototype.__defineGetter__("points",t("g"));
S.prototype.__defineSetter__("points",ea("g"));S.prototype.__defineGetter__("normals",t("h"));S.prototype.__defineSetter__("normals",ea("h"));S.prototype.__defineGetter__("colors",t("W"));S.prototype.__defineSetter__("colors",ea("W"));S.prototype.__defineGetter__("color",t("Gb"));S.prototype.__defineSetter__("color",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Gb=a;this.e=o});
S.prototype.__defineGetter__("opacity",t("aa"));S.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.aa=a;this.e=o});S.prototype.__defineGetter__("caption",t("jc"));S.prototype.__defineSetter__("caption",function(a){this.jc=a;this.e=o});S.prototype.__defineGetter__("visible",t("Ja"));
S.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Ja=a;this.e=o});S.prototype.__defineGetter__("pointsize",t("Sc"));S.prototype.__defineSetter__("pointsize",function(a){D(a)||i(Error("Invalid point size."));this.Sc=a;this.e=o});S.prototype.__defineGetter__("magicmode",t("Jc"));S.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Jc=a;this.e=o});
S.prototype.__defineGetter__("linewidth",t("pc"));S.prototype.__defineSetter__("linewidth",function(a){D(a)||i(Error("Invalid line width."));this.pc=a;this.e=o});function rd(){this.Ea=Infinity;this.$=this.ua=-Infinity;this.ba=Infinity;this.tb=[0,0,0];this.rb=[1,1,1]}rd.prototype.__defineGetter__("lowerThreshold",t("$"));rd.prototype.__defineSetter__("lowerThreshold",ea("$"));rd.prototype.__defineGetter__("upperThreshold",t("ba"));rd.prototype.__defineSetter__("upperThreshold",ea("ba"));rd.prototype.__defineGetter__("min",t("Ea"));rd.prototype.__defineGetter__("max",t("ua"));rd.prototype.__defineGetter__("minColor",t("tb"));
rd.prototype.__defineSetter__("minColor",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid min. color."));this.tb=a});rd.prototype.__defineGetter__("maxColor",t("rb"));rd.prototype.__defineSetter__("maxColor",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid max. color."));this.rb=a});function sd(){M.call(this);this.c="scalars";this.Ec=this.v=r;this.Ef=o;ya(this,new Pc);ya(this,new rd);this.tb=[0,1,0];this.rb=[1,0,0]}H(sd,M);sd.prototype.__defineGetter__("array",t("v"));sd.prototype.__defineSetter__("array",function(a){this.Ec=this.v=a;this.e=o});E("X.scalars",sd);function T(a){M.call(this);this.c="object";this.d=[];this.u=this.O=r;ya(this,new S);x(a)&&this.Yb(a)}H(T,M);
T.prototype.Yb=function(a){this.la=a.la;this.Xb=new nd;this.Xb.B=new gd(a.Xb.B.U);this.Gb=a.Gb.slice();a.g&&(this.g=new Q(a.g.length,a.g));a.h&&(this.h=new Q(a.h.length,a.h));a.W&&(this.W=new Q(a.W.length,a.W));this.z=a.z;this.Wb=a.Wb;a.t&&(this.t=new Oc((new String(a.t.Qc)).toString()));a.nc&&(this.nc=new Oc((new String(a.nc.Qc)).toString()));this.aa=a.aa;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new I[b[d].c](b[d]));this.Ja=a.Ja;this.Sc=a.Sc;this.pc=a.pc;a.jc&&
(this.jc=(new String(a.jc)).toString());this.Jc=a.Jc;this.Rc=a.Rc.slice();this.e=o};T.prototype.__defineGetter__("colortable",function(){this.O||(this.O=new Qc);return this.O});T.prototype.__defineGetter__("scalars",function(){this.u||(this.u=new sd);return this.u});T.prototype.__defineGetter__("children",t("d"));T.prototype.o=function(){var a=new td;a.R=this;this.dispatchEvent(a)};
function ud(a,b){(!x(a)||!x(b)||!(a instanceof T)||!(b instanceof T))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.aa?-1:1==b.aa?1:x(a.Z)&&x(b.Z)&&a.Z>b.Z?-1:1}E("X.object",T);E("X.object.prototype.modified",T.prototype.o);function vd(){}function wd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),k=a.h.get(d+1),m=a.h.get(d+2),j=a.Gb;a.W&&0<a.W.length&&(j=a.W.get(d));var l=[];l.push(new Hc(e,h));l.push(new Hc(f,k));l.push(new Hc(g,m));c.push(new Jc(l,j))}return Mc(c)}
function xd(a,b){(!x(b)||!(b instanceof Lc))&&i(Error("Invalid CSG object."));var c=new Nc,d=[];yb(b.A,function(a){for(var b=[],g=a.be,b=yb(a.hb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Og=yb(c.unique(),function(a){return[a.Aa.x(),a.Aa.y(),a.Aa.b()]});a.Ng=yb(c.unique(),function(a){return[a.ga.x(),a.ga.y(),a.ga.b()]});a.Mg=yb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});a.g=new Q(9*d.length);a.h=new Q(9*d.length);
a.W=new Q(9*d.length);yb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Og,k=this.Ng,m=this.Mg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(k[b][0],k[b][1],k[b][2]);this.h.add(k[c][0],k[c][1],k[c][2]);this.h.add(k[a][0],k[a][1],k[a][2]);m[b]&&this.W.add(m[b][0],m[b][1],m[b][2]);m[c]&&this.W.add(m[c][0],m[c][1],m[c][2]);m[a]&&this.W.add(m[a][0],m[a][1],m[a][2])}.bind(a));0==a.W.s&&(a.W=r);a.la=qd}
vd.prototype.nf=function(a){(!x(a)||!(a instanceof Lc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;ya(a,new vd);xd(a,wd(this).nf(b));return a};vd.prototype.gb=function(a){(!x(a)||!(a instanceof Lc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;ya(a,new vd);xd(a,wd(this).gb(b));return a};
vd.prototype.Pe=function(a){(!x(a)||!(a instanceof Lc)&&!(a instanceof T))&&i(Error("Invalid object."));var b=a;a instanceof T&&(b=wd(b));a=new T;ya(a,new vd);xd(a,wd(this).Pe(b));return a};vd.prototype.inverse=function(){var a=new T;ya(a,new vd);xd(a,wd(this).inverse());return a};E("X.constructable",vd);E("X.constructable.prototype.intersect",vd.prototype.Pe);E("X.constructable.prototype.inverse",vd.prototype.inverse);E("X.constructable.prototype.subtract",vd.prototype.gb);
E("X.constructable.prototype.union",vd.prototype.nf);function yd(a){kc.call(this,a);this.c="event"}H(yd,kc);var zd=Fc("pan"),Ad=Fc("rotate"),Bd=Fc("zoom"),Cd=Fc("scroll");Fc("render");var Dd=Fc("resetview"),Ed=Fc("windowlevel"),zc=Fc("modified"),Fd=Fc("progress"),Gd=Fc("hover"),Hd=Fc("hover_end");function Id(){yd.call(this,Ed);this.me=this.xe=0}H(Id,yd);function Jd(){yd.call(this,zd);this.Z=new Xc(0,0)}H(Jd,yd);function Kd(){yd.call(this,Ad);this.Z=new Xc(0,0)}H(Kd,yd);function Ld(){yd.call(this,Bd);this.jb=this.Kb=s}H(Ld,yd);
function Md(){yd.call(this,Cd);this.J=s}H(Md,yd);function Nd(){yd.call(this,Gd);this.Gd=this.Fd=0}H(Nd,yd);function Od(){yd.call(this,Hd)}H(Od,yd);function Pd(){yd.call(this,Dd)}H(Pd,yd);function td(){yd.call(this,zc);this.p=this.R=r}H(td,yd);function Qd(){yd.call(this,Fd);this.Ff=0}H(Qd,yd);function W(){M.call(this);this.c="parser";this.P=r;this.s=0;this.Rg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.qc=o}H(W,M);W.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Rd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Y(a,b,c){x(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.P.slice(a.s,a.s+=c*d));if(a.Rg!=a.qc){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Sd(a,b,c){I.sa(a.c+".reslice");for(var d=b.Y,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],k=b.n!=r,m=h*d,j=Array(g),l=Array(g),q=0,p=0,w=0,v=0,A=0,B=4*m,p=0;p<g;p++){j[p]=Array(h);l[p]=Array(h);for(var y=f.subarray(p*m,(p+1)*m),C=new Uint8Array(B),w=A=0;w<h;w++){j[p][w]=new c.data.constructor(d);l[p][w]=new c.data.constructor(d);for(v=0;v<d;v++){var q=y[A],F=0,G=0,R=0,K=0;b.O?((K=b.O.da.get(Math.floor(q)))||(K=b.O.da.get(b.O.da.pa()-1)),F=255*K[1],G=255*K[2],R=255*K[3],K=255*K[4]):(F=G=R=255*(q/
e),K=255);var O=4*A;C[O]=F;C[++O]=G;C[++O]=R;C[++O]=K;j[p][w][v]=255*(q/e);l[p][w][v]=q;A++}}q=new pd;q.xa=C;q.yb=d;q.xb=h;y=b.bb.d[p];y.z=q;k&&(y.n=b.n.bb.d[p].z)}d!=h?k?b.O?(Td(g,d,h,l,b.O,b.T,b.n.T,o),Td(g,h,d,l,b.O,b.S,b.n.S,s)):(Ud(g,d,h,j,b.T,b.n.T,o),Ud(g,h,d,j,b.S,b.n.S,s)):b.O?(Td(g,d,h,l,b.O,b.T,r,o),Td(g,h,d,l,b.O,b.S,r,s)):(Ud(g,d,h,j,b.T,r,o),Ud(g,h,d,j,b.S,r,s)):k?b.O?Vd(g,d,h,j,b.O,b.S,b.n.S,b.T,b.n.T):Wd(g,d,h,j,b.S,b.n.S,b.T,b.n.T):b.O?Vd(g,d,h,l,b.O,b.S,r,b.T,r):Wd(g,d,h,j,b.S,r,
b.T,r);I.na(a.c+".reslice");return l}function Ud(a,b,c,d,e,f,g){for(var h=4*a*b,k=0,k=0;k<c;k++){for(var m=new Uint8Array(h),j=0,l=0,j=0;j<a;j++)for(var q=0,p=d[j],q=0;q<b;q++){var w,v=w=g?p[k][q]:p[q][k],A=w,B=4*l;m[B]=w;m[++B]=v;m[++B]=A;m[++B]=255;l++}j=new pd;j.xa=m;j.yb=b;j.xb=a;m=e.d[k];m.z=j;f&&(m.n=f.d[k].z)}}
function Td(a,b,c,d,e,f,g,h){for(var k=4*a*b,m=0,m=0;m<c;m++){for(var j=new Uint8Array(k),l=0,q=0,l=0;l<a;l++)for(var p=d[l],w=0,w=0;w<b;w++){var v=e.da.get(Math.floor(h?p[m][w]:p[w][m]));v||(v=e.da.get(e.da.pa()-1));var A=255*v[2],B=255*v[3],y=255*v[4],C=4*q;j[C]=255*v[1];j[++C]=A;j[++C]=B;j[++C]=y;q++}l=new pd;l.xa=j;l.yb=b;l.xb=a;j=f.d[m];j.z=l;g&&(j.n=g.d[m].z)}}
function Wd(a,b,c,d,e,f,g,h){for(var k=4*a*b,m=0,m=0;m<c;m++){for(var j=new Uint8Array(k),l=new Uint8Array(k),q=0,p=0,p=0;p<a;p++)for(var w=d[p],v=0,v=0;v<b;v++){var A=w[v][m],B=A,y=A,C=4*q;j[C]=A;j[++C]=B;j[++C]=y;j[++C]=255;y=B=A=C=w[m][v];C=4*q;l[C]=A;l[++C]=B;l[++C]=y;l[++C]=255;q++}q=new pd;q.xa=j;q.yb=b;q.xb=a;j=e.d[m];j.z=q;f&&(j.n=f.d[m].z);j=new pd;j.xa=l;j.yb=b;j.xb=a;l=g.d[m];l.z=j;h&&(l.n=h.d[m].z)}}
function Vd(a,b,c,d,e,f,g,h,k){for(var m=4*a*b,j=0,j=0;j<c;j++){for(var l=new Uint8Array(m),q=new Uint8Array(m),p=0,w=0,w=0;w<a;w++)for(var v=d[w],A=0,A=0;A<b;A++){var B=e.da.get(Math.floor(v[A][j]));B||(B=e.da.get(e.da.pa()-1));var y=255*B[2],C=255*B[3],F=255*B[4],G=4*p;l[G]=255*B[1];l[++G]=y;l[++G]=C;l[++G]=F;(G=e.da.get(Math.floor(v[j][A])))||(G=e.da.get(e.da.pa()-1));B=255*G[1];y=255*G[2];C=255*G[3];F=255*G[4];G=4*p;q[G]=B;q[++G]=y;q[++G]=C;q[++G]=F;p++}p=new pd;p.xa=l;p.yb=b;p.xb=a;l=f.d[j];
l.z=p;g&&(l.n=g.d[j].z);l=new pd;l.xa=q;l.yb=b;l.xb=a;q=h.d[j];q.z=l;k&&(q.n=k.d[j].z)}};function Xd(){W.call(this);this.c="parserLBL"}H(Xd,W);
Xd.prototype.parse=function(a,b,c){I.sa(this.c+".parse");var d=b.Rc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.P=c;for(var f=[],g=Y(this,"uchar",c.byteLength),h=g.length,k=s,m=0,c=1;c<h;c++)10==g[c-1]?(m=c,k=o):k&&32==g[c]&&(k=parseInt(String.fromCharCode.apply(r,g.subarray(m,c)),10),f.push(k),k=s);g=b.u.v?b.u.v:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)m=d[c],m>e&&i(Error("Could not find scalar for vertex.")),
m=g[m],f[h++]=m,f[h++]=m,f[h++]=m;b.u.v=g;b.u.Ec=f;b.u.e=o;I.na(this.c+".parse");d=new td;d.R=b;d.p=a;this.dispatchEvent(d)};E("X.parserLBL",Xd);E("X.parserLBL.prototype.parse",Xd.prototype.parse);function $d(a){this.q=a;this.eg=L(this.q,Va?"DOMMouseScroll":"mousewheel",this)}H($d,Gc);
$d.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Wa;if("mousewheel"==a.type){c=1;if(J||Wa&&(Oa||mb("532.0")))c=40;d=Wa&&Na&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ia(a.wheelDeltaX)?(b=Wa&&Na&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Wa&&Na&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.gg)&&Math.min(Math.max(b,-this.gg),this.gg);D(this.hg)&&(c=Math.min(Math.max(c,
-this.hg),this.hg));b=new ae(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Ma()}};$d.prototype.M=function(){$d.i.M.call(this);vc(this.eg);delete this.eg};function ae(a,b,c,d){b&&this.ma(b,n);this.type="mousewheel";this.detail=a;this.tc=d}H(ae,mc);J||Wa&&mb("525");var be;function ce(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Eb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=wb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var de=!J||ob(9);!Va&&!J||J&&ob(9)||Va&&mb("1.9.1");J&&mb("9");function ee(a){return a?new fe(ge(a)):be||(be=new fe)}function he(a){return ka(a)?document.getElementById(a):a}function ie(a,b){qb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in je?a.setAttribute(je[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var je={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function ke(a,b,c){return le(document,arguments)}
function le(a,b){var c=b[0],d=b[1];if(!de&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',za(d.name),'"');if(d.type){c.push(' type="',za(d.type),'"');var e={};ub(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ka(d)?c.className=d:z(d)?ce.apply(r,[c].concat(d)):ie(c,d));2<b.length&&me(a,c,b);return c}
function me(a,b,c){function d(c){c&&b.appendChild(ka(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ja(f)&&!(ma(f)&&0<f.nodeType)?xb(ne(f)?Db(f):f,d):d(f)}}function oe(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function pe(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function qe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ge(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ne(a){if(a&&"number"==typeof a.length){if(ma(a))return"function"==typeof a.item||"string"==typeof a.item;if(la(a))return"function"==typeof a.item}return s}function fe(a){this.N=a||fa.document||document}u=fe.prototype;
u.Nd=ee;u.j=function(a){return ka(a)?this.N.getElementById(a):a};u.sc=function(a,b,c){return le(this.N,arguments)};u.createElement=function(a){return this.N.createElement(a)};u.createTextNode=function(a){return this.N.createTextNode(a)};function re(a){return"CSS1Compat"==a.N.compatMode}function se(a){var b=a.N,a=!Wa&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Vc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}u.appendChild=function(a,b){a.appendChild(b)};
u.contains=qe;function Z(a){(!x(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));M.call(this);this.c="interactor";this.kc=a;this.oe=this.yf=this.xf=this.zf=this.wf=this.Af=r;this.ne=o;this.zb=this.sb=this.$a=s;this.xd=[0,0];this.ie=new Xc(0,0);this.X={MOUSEWHEEL_ENABLED:o,MOUSECLICKS_ENABLED:o,KEYBOARD_ENABLED:o,HOVERING_ENABLED:o,CONTEXTMENU_ENABLED:s}}H(Z,M);Z.prototype.__defineGetter__("config",t("X"));Z.prototype.__defineGetter__("leftButtonDown",t("$a"));
Z.prototype.__defineGetter__("middleButtonDown",t("sb"));Z.prototype.__defineGetter__("rightButtonDown",t("zb"));
Z.prototype.ma=function(){this.X.MOUSEWHEEL_ENABLED?(this.oe=new $d(this.kc),this.Af=L(this.oe,"mousewheel",this.jd.bind(this))):(vc(this.Af),this.oe=r);this.X.MOUSECLICKS_ENABLED?(this.wf=L(this.kc,"mousedown",this.Oh.bind(this)),this.zf=L(this.kc,"mouseup",this.Th.bind(this))):(vc(this.wf),vc(this.zf));this.kc.oncontextmenu=this.X.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.X.KEYBOARD_ENABLED?this.mg.bind(this):r;vc(this.xf);vc(this.yf);this.xf=L(this.kc,"mousemove",this.Qh.bind(this));
this.yf=L(this.kc,"mouseout",this.Rh.bind(this))};Z.prototype.Oh=function(a){0==a.button?this.$a=o:1==a.button?this.sb=o:2==a.button&&(this.zb=o);eval("this.onMouseDown("+this.$a+","+this.sb+","+this.zb+")");te(this);a.preventDefault()};Z.prototype.Nh=aa();Z.prototype.Th=function(a){0==a.button?this.$a=s:1==a.button?this.sb=s:2==a.button&&(this.zb=s);eval("this.onMouseUp("+this.$a+","+this.sb+","+this.zb+")");te(this);a.preventDefault()};Z.prototype.__defineGetter__("mousePosition",t("xd"));u=Z.prototype;
u.Sh=aa();u.Rh=function(a){this.ne=s;this.X.KEYBOARD_ENABLED&&(window.onkeydown=r);this.zb=this.sb=this.$a=s;te(this);this.ie=new Xc(0,0);a.preventDefault()};u.Ph=aa();
u.Qh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.ne=o;this.X.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.mg.bind(this));a.preventDefault();var b=a.shiftKey;this.xd=[a.offsetX,a.offsetY];var c=new Xc(this.xd[0],this.xd[1]),a=this.ie.gb(c);this.ie=c.f();this.X.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.sb||this.$a||this.zb)&&te(this),this.Me=setTimeout(function(){te(this);var a=new Nd;a.Fd=c.x;a.Gd=c.y;this.dispatchEvent(a);
this.Me=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.dc()&&(this.$a&&!b?(b=new Kd,b.Z=a,this.dispatchEvent(b)):this.sb||this.$a&&b?(b=new Jd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.Z=a,this.dispatchEvent(b)):this.zb&&(b=new Ld,b.Kb=0<a.y,b.jb=s,this.dispatchEvent(b)))};function te(a){a.Me&&clearTimeout(a.Me);a.dispatchEvent(new Od)}u.Uh=aa();u.jd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");te(this);a.preventDefault()};
u.Lh=aa();
u.mg=function(a){if(this.ne){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");te(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Pd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Jd:b?a=new Ld:(a=new Kd,this instanceof ue&&(a=new Md)),a&&(c=new Xc(0,0),37==f?(c.x=5,a.J=s,b&&(a.J=o,a.Kb=o,a.jb=s)):39==f?(c.x=-5,a.J=o,b&&(a.Kb=s,a.jb=s)):38==f?(c.y=5,a.J=o,b&&(a.Kb=o,a.jb=o)):40==f&&(c.y=-5,a.J=s,b&&(a.Kb=s,
a.jb=o)),a.Z=c,this.dispatchEvent(a)))}};E("X.interactor",Z);E("X.interactor.prototype.init",Z.prototype.ma);E("X.interactor.prototype.onMouseDown",Z.prototype.Nh);E("X.interactor.prototype.onMouseUp",Z.prototype.Sh);E("X.interactor.prototype.onMouseMove",Z.prototype.Ph);E("X.interactor.prototype.onMouseWheel",Z.prototype.Uh);E("X.interactor.prototype.onKey",Z.prototype.Lh);function ue(a){Z.call(this,a);this.c="interactor2D"}H(ue,Z);ue.prototype.jd=function(a){ue.i.jd.call(this,a);var b=new Md;x(a.tc)||(a.tc=0);b.J=0>a.tc;this.dispatchEvent(b)};function ve(a){T.call(this);this.c="slice";this.l=[0,0,0];this.mc=[0,0,1];this.J=[0,1,0];this.G=this.K=10;this.Wb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.eb=r;this.Ra=o;this.ic=[1,1,1];x(a)&&this.Yb(a)}H(ve,T);ve.prototype.Yb=function(a){this.l=a.l.slice();this.mc=a.mc.slice();this.J=a.J.slice();this.K=a.K;this.G=a.G;this.eb=a.eb;this.n=a.n;this.Ra=a.Ra;this.ic=a.ic;this.Qg=a.Qg;ve.i.Yb.call(this,a)};
ve.prototype.Zb=function(){var a=new P(this.mc[0],this.mc[1],this.mc[2]),b=new P(this.J[0],this.J[1],this.J[2]),c=Uc(b,a),d=new P(this.l[0],this.l[1],this.l[2]),e=new P(1,1,1);1==a.x?(e=new P(this.l[0],this.G/2,this.K/2),this.Wb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new P(this.K/2,this.l[1],this.G/2),this.Wb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new P(this.K/2,this.G/2,this.l[2]));var f=Tc(c.f().ca(),b.f().ca()),f=new P(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Tc(c.f().ca(),b),g=new P(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Tc(c,b.f().ca()),h=new P(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var k=h,b=Tc(c,b),b=new P(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new Q(18);this.h=new Q(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(k.x,k.y,k.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Ra&&(a=new T,a.g=new Q(24),
a.h=new Q(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Gb=[this.ic[0],this.ic[1],this.ic[2]],a.la="LINES",a.pc=2,this.d.push(a))};E("X.slice",ve);function N(a){T.call(this);this.c="volume";this.l=[0,0,0];this.Y=[10,10,10];this.C=[1,1,1];this.lb=[];this.Hc=this.ob=this.Gc=this.nb=this.Fc=this.mb=0;this.S=new T;this.T=new T;this.bb=new T;this.Ed=this.Ka=s;this.Ab=0;this.n=r;this.Ra=o;this.fa=Infinity;this.ea=-Infinity;ya(this,new Pc);ya(this,new rd);x(a)&&this.Yb(a)}H(N,T);
N.prototype.Yb=function(a){window.console.log(a);this.l=a.l.slice();this.Y=a.Y.slice();this.C=a.C.slice();this.mb=a.mb;this.Fc=a.Fc;this.nb=a.nb;this.Gc=a.Gc;this.ob=a.ob;this.Hc=a.Hc;this.S=new T(a.S);this.T=new T(a.T);this.bb=new T(a.bb);this.Ka=a.Ka;this.Ed=a.Ed;this.Ab=a.Ab;this.n=a.n;this.Ra=a.Ra;N.i.Yb.call(this,a)};
N.prototype.Zb=function(){this.d.length=0;this.S.d.length=0;this.T.d.length=0;this.bb.d.length=0;this.d.push(this.S);this.d.push(this.T);this.d.push(this.bb);for(var a=0,a=0;3>a;a++){for(var b=(this.Y[a]-1)/2,c=b,d=0,d=0;d<this.Y[a];d++){var e=-b*this.C[a]+d*this.C[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,k=[1,1,1],m=this.Ra;0==a?(g=this.Y[2]*this.C[2]-this.C[2],h=this.Y[1]*this.C[1]-this.C[1],k=[1,1,0]):1==
a?(g=this.Y[0]*this.C[0]-this.C[0],h=this.Y[2]*this.C[2]-this.C[2],k=[1,0,0]):2==a&&(g=this.Y[0]*this.C[0]-this.C[0],h=this.Y[1]*this.C[1]-this.C[1],k=[0,1,0]);x(this.eb)&&(m=s);var j=new ve,l=j,f=f[a],q=[[1,0,0],[0,1,0],[0,0,1]][a],p=[[0,1,0],[0,0,-1],[0,1,0]][a];(!x(f)||!z(f)||3!=f.length)&&i(Error("Invalid center."));(!x(q)||!z(q)||3!=q.length)&&i(Error("Invalid front direction."));(!x(p)||!z(p)||3!=p.length)&&i(Error("Invalid up direction."));D(g)||i(Error("Invalid width."));D(h)||i(Error("Invalid height."));
var w=s;x(m)&&(w=m);m=[1,1,1];x(k)&&(m=k);l.l=f;l.mc=q;l.J=p;l.K=g;l.G=h;l.Ra=w;l.ic=m;l.Zb();j.eb=this;j.visible=d==Math.floor(c);e.push(j)}0==a?this.Fc=this.mb=c:1==a?this.Gc=this.nb=c:2==a&&(this.Hc=this.ob=c)}this.e=o};
N.prototype.o=function(a){a="undefined"!==typeof a?a:o;if(0<this.d.length)if(this.Ka!=this.Ed&&(this.Ka?(this.d[0].d[parseInt(this.mb,10)].visible=s,this.d[1].d[parseInt(this.nb,10)].visible=s,this.d[2].d[parseInt(this.ob,10)].visible=s):this.d[this.Ab].visible=s,this.e=o,this.Ed=this.Ka),this.Ka)we(this,this.Ab);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.mb,e=this.Fc,this.Fc=this.mb):1==b?(d=this.nb,e=this.Gc,this.Gc=this.nb):2==b&&(d=this.ob,e=this.Hc,this.Hc=this.ob);c.d[parseInt(e,
10)].visible=s;c=c.d[parseInt(d,10)];c.visible=o;c.aa=1}a&&N.i.o.call(this)};N.prototype.__defineGetter__("dimensions",t("Y"));N.prototype.__defineGetter__("volumeRendering",t("Ka"));N.prototype.__defineSetter__("volumeRendering",function(a){this.Ka=a;this.o(s)});N.prototype.__defineSetter__("visible",ea("Ja"));N.prototype.__defineGetter__("center",t("l"));N.prototype.__defineSetter__("center",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
N.prototype.__defineGetter__("image",t("lb"));N.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new xe(this));return this.n});N.prototype.__defineGetter__("indexX",t("mb"));N.prototype.__defineSetter__("indexX",function(a){D(a)&&0<=a&&a<this.S.d.length&&(this.mb=a,this.o(s))});N.prototype.__defineGetter__("indexY",t("nb"));N.prototype.__defineSetter__("indexY",function(a){D(a)&&0<=a&&a<this.T.d.length&&(this.nb=a,this.o(s))});N.prototype.__defineGetter__("indexZ",t("ob"));
N.prototype.__defineSetter__("indexZ",function(a){D(a)&&0<=a&&a<this.bb.d.length&&(this.ob=a,this.o(s))});N.prototype.__defineGetter__("windowLow",t("fa"));N.prototype.__defineSetter__("windowLow",ea("fa"));N.prototype.__defineGetter__("windowHigh",t("ea"));N.prototype.__defineSetter__("windowHigh",ea("ea"));N.prototype.__defineGetter__("borders",t("Ra"));N.prototype.__defineSetter__("borders",ea("Ra"));
function we(a,b){if(a.Ka&&(a.e||b!=a.Ab)){var c=a.d[a.Ab];c.visible=s;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].Ja=o;a.Ab=b;a.e=s}}E("X.volume",N);E("X.volume.prototype.modified",N.prototype.o);function ye(){W.call(this);this.c="parserSTL"}H(ye,W);
ye.prototype.parse=function(a,b,c){I.sa(this.c+".parse");this.P=c;var d=b.g,e=b.h;if("solid"==String.fromCharCode.apply(r,Y(this,"uchar",5))){b.g=d=new Q(c.byteLength);b.h=e=new Q(c.byteLength);var f=d,d=e,e=Y(this,"uchar",c.byteLength-5),c=e.length,g=s,h=s,k=0,m;for(m=0;m<c;m++)if(10==e[m]){if(g||h){var j=String.fromCharCode.apply(r,e.subarray(k,m)).split(" "),h=parseFloat(j[0]),l=parseFloat(j[1]),j=parseFloat(j[2]);g?(d.add(h,l,j),d.add(h,l,j),d.add(h,l,j)):f.add(h,l,j);h=g=s}}else 32==e[m-1]&&
(102==e[m]?(k=m+=13,g=o):118==e[m]&&(k=m+=7,h=o))}else{this.s=80;f=Y(this,"uint");b.g=d=new Q(9*f);b.h=e=new Q(9*f);for(c=c=0;c<f;c++)g=Y(this,"float",12),k=g[0],m=g[1],h=g[2],e.add(k,m,h),e.add(k,m,h),e.add(k,m,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.s+=2}I.na(this.c+".parse");f=new td;f.R=b;f.p=a;this.dispatchEvent(f)};E("X.parserSTL",ye);E("X.parserSTL.prototype.parse",ye.prototype.parse);function ze(a){function b(){Dc+=8;return gb<ua.length?ua[gb++]:-1}function c(){var a;Dc++;a=Ia&1;Ia>>=1;0==Ia&&(Ia=b(),a=Ia&1,Ia=Ia>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=R[b]>>8-a);return b}function e(a){y[C++]=a;if(G==w-1){var b=new Uint8Array(2*w);b.set(p);p=b;w*=2}p[G++]=a;32768==C&&(C=0)}function f(){this.Id=this.Hd=0;this.Qe=r}function g(){for(;;){if(hb[Aa]>=id)return-1;if(jd[hb[Aa]]==Aa)return hb[Aa]++;hb[Aa]++}}function h(){var a=Ec[Gb],b;if(17==Aa)return-1;Gb++;
Aa++;b=g();if(0<=b)a.Hd=b;else if(a.Hd=32768,h())return-1;b=g();if(0<=b)a.Id=b,a.Qe=r;else if(a.Id=32768,a.Qe=Ec[Gb],a.Fj=Gb,h())return-1;Aa--;return 0}function k(a,b,c){Ec=a;Gb=0;jd=c;id=b;for(a=0;17>a;a++)hb[a]=0;Aa=0;return h()?-1:0}function m(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Id&32768))return f.Id;f=f.Qe;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Hd&32768))return f.Hd;e++;f=a[e]}}function j(){var a,g,h,j,l;do if(a=c(),h=d(2),0==h){Ia=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=R[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;l=d(O[h])+K[h];h=R[d(5)]>>3;8<ba[h]?(p=d(8),p|=d(ba[h]-8)<<8):p=d(ba[h]);p+=da[h];for(h=0;h<l;h++)g=y[C-p&32767],e(g)}else if(2==h){var q=Array(320);g=257+d(5);p=1+d(5);j=4+d(4);for(h=0;19>h;h++)q[h]=0;for(h=0;h<j;h++)q[ca[h]]=d(3);l=ib.length;for(j=0;j<l;j++)ib[j]=new f;if(k(ib,19,q)){C=0;return}l=g+p;j=0;for(var v=-1;j<l;)if(v++,
h=m(ib),16>h)q[j++]=h;else if(16==h){var w;h=3+d(2);if(j+h>l){C=0;return}for(w=j?q[j-1]:0;h--;)q[j++]=w}else{h=17==h?3+d(3):11+d(7);if(j+h>l){C=0;return}for(;h--;)q[j++]=0}l=Ib.length;for(j=0;j<l;j++)Ib[j]=new f;if(k(Ib,g,q)){C=0;return}l=Ib.length;for(j=0;j<l;j++)ib[j]=new f;h=[];for(j=g;j<q.length;j++)h[j-g]=q[j];if(k(ib,p,h)){C=0;return}for(;;)if(h=m(Ib),256<=h){h-=256;if(0==h)break;h--;l=d(O[h])+K[h];h=m(ib);8<ba[h]?(p=d(8),p|=d(ba[h]-8)<<8):p=d(ba[h]);for(p+=da[h];l--;)g=y[C-p&32767],e(g)}else e(h)}while(!a);
C=0;Ia=1}function l(){var a=[],c;v&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&q(ua.byteLength);a[0]=b();if(8==a[0]){v=b();b();b();b();b();b();b();if(v&4){a[0]=b();a[2]=b();Aa=a[0]+256*a[1];for(a=0;a<Aa;a++)b()}if(v&8){a=0;for(pb=[];c=b();){if("7"==c||":"==c)a=0;a<ld-1&&(pb[a++]=c)}}if(v&16)for(;b(););v&2&&(b(),b());j();b();b();b();b();b();b();b();b();F&&q(ua.byteLength)}}function q(a){w=a;p=new Uint8Array(a);
a=[];F=s;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(j(),B[A]=Array(2),B[A][0]=p,B[A][1]="geonext.gxt",A++);31==a[0]&&139==a[1]&&(l(),B[A]=Array(2),B[A][0]=p,B[A][1]="file",A++);if(80==a[0]&&75==a[1]&&(F=o,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();v=b();v|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(pb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<ld-1&&(pb[e++]=String.fromCharCode(f))}md||(md=pb);for(e=0;e<
d;)b(),e++;G=0;8==a&&(j(),B[A]=Array(2),B[A][0]=p,B[A][1]=pb.join(""),A++);l()}}var p=r,w=0,v,A=0,B=[],y=Array(32768),C=0,F=s,G=0,R=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],da=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ba=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ua=a,gb=0,Ia=1,Dc=0,ld=256,pb=[],md,Ib=Array(288),ib=Array(32),
Gb=0,Ec=r,Aa=0,hb=Array(17);hb[0]=0;var jd,id;ze.prototype.ce=function(){q(ua.byteLength);return p}};function Ae(){W.call(this);this.c="parserDCM"}H(Ae,W);Ae.prototype.parse=function(a,b,c){c=this.ec(c,b);if(c.Td==c.Xa){var d=c.jf.length,e,f=0;for(e=0;e<d;e++){var g=c.jf[e];g!==n&&(g*=c.ib,g=c.Zc.subarray(g,g+c.ib),c.data.set(g,f*c.ib),f++)}b.Y=[c.H[0],c.H[1],c.H[2]];b.C=[c.ra[0],c.ra[1],c.ra[2]];e=Rd(c.data);d=e[0];e=e[1];c.min=b.Ea=b.fa=d;c.max=b.ua=b.ea=e;-Infinity==b.$&&(b.$=d);Infinity==b.ba&&(b.ba=e);b.Zb();b.lb=Sd(this,b,c)}c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};
Ae.prototype.ec=function(a,b){this.P=a;if(x(b.hc)){d=b.hc;f=d.ag;h=d.$f;this.s=2*f;var c=Y(this,"uchar",h),c=parseInt(String.fromCharCode.apply(r,c),10);d.H[2]++}else{var d={rows:0,cols:0,ra:r,ze:0,Wg:0,Xa:1,Jh:1,ag:0,$f:0,Td:0,ib:0,Zc:r,df:0,jf:[],data:r,min:Infinity,max:-Infinity};d.Xa=b.t.length;x(d.Xa)||(d.Xa=1);for(var e=Y(this,"ushort",this.P.byteLength),f=66,g=h=r,h=r,c="",k=7;0<k;)if(h=e[f++],40==h)switch(g=e[f++],f++,h=e[f++],g){case 16:d.rows=e[f++];k--;break;case 17:d.cols=e[f++];k--;break;
case 256:d.ze=e[f++];k--;break;case 257:d.Wg=e[f++];k--;break;case 2:d.Jh=e[f++];k--;break;case 48:for(var g="",m=0,m=0;m<h/2;m++)var j=e[f++],l=j&255,j=(j&65280)>>8,g=g+String.fromCharCode(l),g=g+String.fromCharCode(j);g=g.split("\\");d.ra=[parseInt(g[0],10),parseInt(g[1],10),1];k--}else if(32==h&&(g=e[f++],19==g)){f++;h=e[f++];d.ag=f;d.$f=h;for(m=0;m<h/2;m++)j=e[f++],l=j&255,j=(j&65280)>>8,c+=String.fromCharCode(l),c+=String.fromCharCode(j),c=parseInt(c,10);k--}b.hc=d;d.H=[d.cols,d.rows,1];d.ib=
d.rows*d.cols;switch(d.ze){case 8:d.Zc=new Uint8Array(d.cols*d.rows*d.Xa);d.data=new Uint8Array(d.cols*d.rows*d.Xa);break;case 16:d.Zc=new Uint16Array(d.cols*d.rows*d.Xa);d.data=new Uint16Array(d.cols*d.rows*d.Xa);break;case 32:d.Zc=new Uint32Array(d.cols*d.rows*d.Xa),d.data=new Uint32Array(d.cols*d.rows*d.Xa)}}this.s=this.P.byteLength-2*d.ib;e=r;switch(d.ze){case 8:e=Y(this,"uchar",d.ib);break;case 16:e=Y(this,"ushort",d.ib);break;case 32:e=Y(this,"uint",d.ib)}d.jf[c]=d.df;d.Zc.set(e,d.df*d.ib);
d.df++;++d.Td;return d};E("X.parserDCM",Ae);E("X.parserDCM.prototype.parse",Ae.prototype.parse);function Ce(){W.call(this);this.c="parserVTK"}H(Ce,W);
Ce.prototype.parse=function(a,b,c){I.sa(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new Q(c.byteLength);b.h=e=new Q(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=String.fromCharCode.apply(r,f.subarray(c,Math.min(c+32768,h)));f=g.split("\n");g=f.length;this.Vc=this.Wc=r;this.Ib=[];this.va=qd;this.qe=this.vb=this.kb=this.wb=s;c=0;for(h=g%8;h--;)De(this,f[c]),c++;for(h=0.125*g^0;h--;)De(this,f[c]),c++,De(this,f[c]),c++,De(this,f[c]),c++,De(this,f[c]),c++,De(this,f[c]),c++,
De(this,f[c]),c++,De(this,f[c]),c++,De(this,f[c]),c++;var c=this.Wc,f=this.Vc,g=f.length,k=h=this.Ib.length;do{var m=this.Ib[h-k],j=m.length,l;for(l=0;l<j&&!("LINES"==this.va&&l+1>=j);l++){var q=parseInt(m[l],10),p=c.get(q);d.add(p[0],p[1],p[2]);var w=q,v=p;"LINES"==this.va?(w=parseInt(m[l+1],10),v=c.get(w),d.add(v[0],v[1],v[2])):"TRIANGLE_STRIPS"==this.va&&(0==l||l==j-1)&&d.add(p[0],p[1],p[2]);q<g?(v=f.get(q),e.add(v[0],v[1],v[2]),"LINES"==this.va?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==
this.va&&(0==l||l==j-1)&&e.add(v[0],v[1],v[2])):(w=new P(p[0],p[1],p[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.va?(w=new P(v[0],v[1],v[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.va&&(0==l||l==j-1)&&e.add(w.x,w.y,w.b))}k--}while(0<k);b.la=this.va;I.na(this.c+".parse");d=new td;d.R=b;d.p=a;this.dispatchEvent(d)};
function De(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.wb=o;a.kb=s;a.vb=s;c=parseInt(c[1],10);a.Wc=new Q(3*c);a.Vc=new Q(3*c);return;case "VERTICES":a.kb=o;a.wb=s;a.vb=s;c=parseInt(c[1],10);3<=c?a.va=qd:1==c?a.va="POINTS":i(Error("This VTK file is not supported!"));a.Ib=[];return;case "TRIANGLE_STRIPS":a.kb=o;a.wb=s;a.vb=s;a.va="TRIANGLE_STRIPS";a.Ib=[];return;case "LINES":a.kb=o;a.wb=s;a.vb=s;a.va="LINES";a.Ib=[];return;case "POLYGONS":a.kb=o;
a.wb=s;a.vb=s;a.va="POLYGONS";a.Ib=[];return;case "POINT_DATA":a.vb=o;a.wb=s;a.kb=s;return}if(a.wb)if(1==d||isNaN(parseFloat(e)))a.wb=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Wc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Wc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Wc.add(d,e,c))}else a.kb?1==d||isNaN(parseFloat(e))?a.kb=s:a.Ib.push(c.slice(1)):a.vb&&("NORMALS"==e?a.qe=o:1==d||isNaN(parseFloat(e))?
(a.vb=s,a.qe=s):a.qe&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Vc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Vc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Vc.add(d,e,c))))}E("X.parserVTK",Ce);E("X.parserVTK.prototype.parse",Ce.prototype.parse);function Ee(){W.call(this);this.c="parserFSM";this.qc=s}H(Ee,W);
Ee.prototype.parse=function(a,b,c){I.sa(this.c+".parse");this.P=c;var d=b.g,e=b.h,f=b.Rc,c=0,g;do g=Y(this,"uchar"),c++;while(200>c&&10!=g);Y(this,"uchar");var e=Y(this,"uint"),c=Y(this,"uint"),h=Y(this,"float",3*e);g=Y(this,"uint",3*c);var k=new Uint32Array(e),m=new Float32Array(9*c);b.g=d=new Q(9*c);b.h=e=new Q(9*c);var j;for(j=0;j<c;j++){var l=3*j,q=g[l],p=g[l+1],w=g[l+2];f.push(q);f.push(p);f.push(w);k[q]+=1;k[p]+=1;k[w]+=1;var l=3*q,v=3*p,A=3*w,B=h[l],y=h[l+1],C=h[l+2],p=h[v],w=h[v+1],q=h[v+
2],F=h[A],G=h[A+1],R=h[A+2];d.add(B,y,C);d.add(p,w,q);d.add(F,G,R);B=new P(B,y,C);F=new P(F,G,R);p=(new P(p,w,q)).f().gb(B);w=F.f().gb(B);p=Uc(p,w).normalize();m[l]+=p.x;m[l+1]+=p.y;m[l+2]+=p.b;m[v]+=p.x;m[v+1]+=p.y;m[v+2]+=p.b;m[A]+=p.x;m[A+1]+=p.y;m[A+2]+=p.b}for(j=0;j<c;j++)l=3*j,q=g[l],p=g[l+1],w=g[l+2],l=3*q,v=3*p,A=3*w,f=new P(m[v],m[v+1],m[v+2]),h=new P(m[A],m[A+1],m[A+2]),l=(new P(m[l],m[l+1],m[l+2])).scale(1/k[q]).normalize(),f=f.scale(1/k[p]).normalize(),h=h.scale(1/k[w]).normalize(),e.add(l.x,
l.y,l.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.la=qd;I.na(this.c+".parse");c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};E("X.parserFSM",Ee);E("X.parserFSM.prototype.parse",Ee.prototype.parse);function Fe(){W.call(this);this.c="parserMGZ";this.qc=s}H(Fe,W);Fe.prototype.parse=function(a,b,c,d){I.sa(this.c+".parse");var e=c;d&&(e=(new ze(new Uint8Array(c))).ce(),e=e.buffer);c=this.ec(e);b.Y=[c.Ue,c.Ve,c.We];b.C=c.Eg;d=c.min;e=c.max;b.Ea=b.fa=d;b.ua=b.ea=e;-Infinity==b.$&&(b.$=d);Infinity==b.ba&&(b.ba=e);b.Zb();I.na(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};
Fe.prototype.ec=function(a){this.P=a;a={version:0,Lg:0,Jg:0,nh:0,Kg:0,Ue:0,Ve:0,We:0,Ih:0,type:0,gh:0,vg:0,Wi:r,Ig:r,Eg:r,data:r,min:Infinity,max:-Infinity};a.version=Y(this,"uint");a.Ue=Y(this,"uint");a.Ve=Y(this,"uint");a.We=Y(this,"uint");a.Ih=Y(this,"uint");a.type=Y(this,"uint");a.gh=Y(this,"uint");a.vg=Y(this,"ushort");if(0<a.vg){a.Eg=Y(this,"float",3);var b=[];b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));a.Ig=b}this.s=284;b=a.Ue*a.Ve*
a.We;switch(a.type){case 0:a.data=Y(this,"uchar",b);break;case 1:a.data=Y(this,"uint",b);break;case 3:a.data=Y(this,"float",b);break;case 4:a.data=Y(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Rd(a.data);a.min=b[0];a.max=b[1];this.s+16<this.P.byteLength&&(a.Lg=Y(this,"float"),a.nh=Y(this,"float"),a.Jg=Y(this,"float"),a.Kg=Y(this,"float"));return a};E("X.parserMGZ",Fe);E("X.parserMGZ.prototype.parse",Fe.prototype.parse);function Ge(){W.call(this);this.c="parserNRRD"}H(Ge,W);
Ge.prototype.parse=function(a,b,c){I.sa(this.c+".parse");this.P=c;var c=Y(this,"uchar",c.byteLength),d=c.length,e=r,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(r,c.subarray(0,g-2));f=g+1;break}var h,k,m,j,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Eh=o;else if(!h.match(/^#/)&&(j=h.match(/(.*):(.*)/)))k=j[1].trim(),h=j[2].trim(),(m=this.jh[k])?m.call(this,h):this[k]=h;this.Eh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ia&&(this.Ia=[new P(1,0,0),new P(0,1,0),new P(0,0,1)],this.kf)){d=[];for(j=0;2>=j;j++)d.push(!isNaN(this.kf[j])?this.Ia[j].scale(this.kf[j]):n)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new ze(f)).ce();f=f.buffer;c={data:r,min:Infinity,max:-Infinity};c.data=new this.Fb(f);j=Rd(c.data);f=c.min=j[0];j=c.max=j[1];b.Y=[this.gf[0],this.gf[1],this.gf[2]];b.C=[(new P(this.Ia[0][0],this.Ia[0][1],
this.Ia[0][2])).dc(),(new P(this.Ia[1][0],this.Ia[1][1],this.Ia[1][2])).dc(),(new P(this.Ia[2][0],this.Ia[2][1],this.Ia[2][2])).dc()];b.Ea=b.fa=f;b.ua=b.ea=j;-Infinity==b.$&&(b.$=f);Infinity==b.ba&&(b.ba=j);b.Zb();I.na(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};
Ge.prototype.jh={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Fb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Fb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Fb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Fb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Fb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Fb=Uint32Array;break;case "float":this.Fb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.H=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.gf=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Ia=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.kf=e}};E("X.parserNRRD",Ge);E("X.parserNRRD.prototype.parse",Ge.prototype.parse);function He(){W.call(this);this.c="parserCRV";this.qc=s}H(He,W);
He.prototype.parse=function(a,b,c){I.sa(this.c+".parse");var d=b.Rc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.P=c;this.s=3;var e=Y(this,"uint");Y(this,"uint");Y(this,"uint");var f=0,g=0,h=0,k=0,m=0,j=0,l=0,q=0,p=0,w=0,v=0,c=Array(2),A=Array(2),B=Y(this,"float",e),y;for(y=0;y<e;y++){var C=B[y];0==y&&(c[0]=A[0]=C);0<=C?(f++,k+=C):(g++,h+=C);p+=C;v++;A[0]=Math.max(C,A[0]);c[0]=Math.min(C,c[0]);B[y]=C}0!=f&&(m=k/f);0!=g&&(j=h/g);0!=v&&(w=p/v);for(v=p=h=k=0;v<e;v++)C=B[v],
y=0,0<=C?(y=Math.pow(C-m,2),k+=y):(y=Math.pow(C-j,2),h+=y),y=Math.pow(C-w,2),p+=y;1<f&&(l=Math.sqrt(k/(f-1)));1<g&&(q=Math.sqrt(h/(g-1)));c[1]=j-2.5*q;A[1]=m+2.5*l;e=d.length;f=new Float32Array(3*e);for(v=0;v<e;v++)g=B[d[v]],h=3*v,f[h]=g,f[h+1]=g,f[h+2]=g;b.u.Ea=c[1];b.u.ua=A[1];-Infinity==b.u.$&&(b.u.$=c[1]);Infinity==b.u.ba&&(b.u.ba=A[1]);b.u.v=B;b.u.Ec=f;b.u.e=o;I.na(this.c+".parse");d=new td;d.R=b;d.p=a;this.dispatchEvent(d)};E("X.parserCRV",He);E("X.parserCRV.prototype.parse",He.prototype.parse);function Ie(){W.call(this);this.c="parserTRK"}H(Ie,W);
Ie.prototype.parse=function(a,b,c){I.sa(this.c+".parse");var d=b.g,e=b.h,f=b.W;this.P=c;Y(this,"uchar",6);Y(this,"ushort",3);var g=Y(this,"float",3);Y(this,"float",3);Y(this,"ushort");Y(this,"uchar",200);Y(this,"ushort");Y(this,"uchar",200);Y(this,"float",16);Y(this,"uchar",444);Y(this,"uchar",4);Y(this,"uchar",4);Y(this,"float",6);Y(this,"uchar",2);Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");var h=Y(this,"uint");Y(this,"uint");var k=Y(this,"uint"),
m=[],j=[],c=Infinity,l=-Infinity,q=r,p=r,w=r,v=r,e=d=r,A=Y(this,"uint",(this.P.byteLength-1E3)/4);this.s=k;for(var B=Y(this,"float",(this.P.byteLength-1E3)/4),y=0,k=f=0;k<h;k++){for(var C=A[y],F=new Q(3*C),G=0,R=0;R<C;R++){var K=B[y+3*R+1],O=B[y+3*R+2],da=B[y+3*R+3],K=K/g[0],O=O/g[1],da=da/g[2];F.add(K,O,da);if(0<R)var ba=F.get(R-1),G=G+Math.sqrt(Math.pow(K-ba[0],2)+Math.pow(O-ba[1],2)+Math.pow(da-ba[2],2));R<C-1&&(f+=6)}y+=3*C+1;R=F.Pb;C=F.Mb;K=F.Qb;O=F.Nb;da=F.Rb;ba=F.Ob;if(!q||R<q)q=R;if(!p||C>
p)p=C;if(!w||K<w)w=K;if(!v||O>v)v=O;if(!d||da<d)d=da;if(!e||ba>e)e=ba;m.push(F);j.push(G)}g=(q+p)/2;w=(w+v)/2;q=(d+e)/2;v=new Float32Array(f);b.g=d=new Q(f);b.h=e=new Q(f);b.W=f=new Q(f);for(k=p=0;k<h;k++){A=m[k];B=A.count;G=j[k];c=Math.min(c,G);l=Math.max(l,G);for(R=0;R<B-1;R++){F=A.get(R);y=A.get(R+1);d.add(F[0],F[1],F[2]);d.add(y[0],y[1],y[2]);var C=F[0]-g,K=F[1]-w,O=F[2]-q,da=Math.sqrt(C*C+K*K+O*O),ba=y[0]-g,ca=y[1]-w,ua=y[2]-q,gb=Math.sqrt(ba*ba+ca*ca+ua*ua);e.add(C/da,K/da,O/da);e.add(ba/gb,
ca/gb,ua/gb);y=[Math.abs(y[0]-F[0]),Math.abs(y[1]-F[1]),Math.abs(y[2]-F[2])];F=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]);y[0]/=F;y[1]/=F;y[2]/=F;f.add(y[0],y[1],y[2]);f.add(y[0],y[1],y[2]);v[p++]=G;v[p++]=G;v[p++]=G;v[p++]=G;v[p++]=G;v[p++]=G}}b.la="LINES";h=new sd;h.Ea=c;h.ua=l;h.$=c;h.ba=l;h.Ec=v;h.Ef=s;h.e=o;b.u=h;I.na(this.c+".parse");c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};E("X.parserTRK",Ie);E("X.parserTRK.prototype.parse",Ie.prototype.parse);function Je(){W.call(this);this.c="parserIMAGE"}H(Je,W);Je.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;tc(f,"load",this.ci.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Je.prototype.ci=function(a,b,c){b.lb=a;b.xa=r;a=new td;a.R=c;a.p=b;this.dispatchEvent(a)};E("X.parserIMAGE",Je);E("X.parserIMAGE.prototype.parse",Je.prototype.parse);function Ke(){W.call(this);this.c="parserLUT"}H(Ke,W);
Ke.prototype.parse=function(a,b,c){I.sa(this.c+".parse");this.P=c;var c=Y(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(r,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.na(this.c+".parse");c=new td;
c.R=b;c.p=a;this.dispatchEvent(c)};E("X.parserLUT",Ke);E("X.parserLUT.prototype.parse",Ke.prototype.parse);function Le(){W.call(this);this.c="parserIMG"}H(Le,W);Le.prototype.parse=function(a,b,c,d,e){I.sa(this.c+".parse");var f=d;e&&(f=(new ze(new Uint8Array(d))).ce(),f=f.buffer);348!=(new Uint32Array(c,0,1))[0]&&(this.qc=s);c=this.ec(c,f);b.Y=[c.H[1],c.H[2],c.H[3]];b.C=[c.ra[1],c.ra[2],c.ra[3]];d=c.min;e=c.max;b.Ea=b.fa=d;b.ua=b.ea=e;-Infinity==b.$&&(b.$=d);Infinity==b.ba&&(b.ba=e);b.Zb();I.na(this.c+".parse");Sd(this,b,c);c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};
Le.prototype.ec=function(a,b){var c={H:[],Cb:0,ra:[],data:[]};this.P=a;this.s=40;c.H=Y(this,"ushort",8);this.s=70;c.Cb=Y(this,"ushort");this.s=76;c.ra=Y(this,"float",8);var d=c.H[1]*c.H[2]*c.H[3];this.P=b;this.s=0;switch(c.Cb){case 2:c.data=Y(this,"uchar",d);break;case 4:c.data=Y(this,"sshort",d);break;case 8:c.data=Y(this,"sint",d);break;case 16:c.data=Y(this,"float",d);break;default:window.console.log("Unsupported IMG data type: "+c.Cb),i(Error("Unsupported IMG data type: "+c.Cb))}d=Rd(c.data);
c.min=d[0];c.max=d[1];return c};E("X.parserIMG",Le);E("X.parserIMG.prototype.parse",Le.prototype.parse);function Me(){W.call(this);this.c="parserNII"}H(Me,W);Me.prototype.parse=function(a,b,c,d){I.sa(this.c+".parse");var e=c;d&&(e=(new ze(new Uint8Array(c))).ce(),e=e.buffer);348!=(new Uint32Array(e,0,1))[0]&&(this.qc=s);c=this.ec(e);b.Y=[c.H[1],c.H[2],c.H[3]];b.C=[c.ra[1],c.ra[2],c.ra[3]];d=c.min;e=c.max;b.Ea=b.fa=d;b.ua=b.ea=e;-Infinity==b.$&&(b.$=d);Infinity==b.ba&&(b.ba=e);b.Zb();I.na(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.R=b;c.p=a;this.dispatchEvent(c)};
Me.prototype.ec=function(a){this.P=a;a={Ai:0,$g:r,ah:r,ih:0,ui:0,li:0,eh:r,H:r,zh:0,Ah:0,Bh:0,xh:0,Cb:0,Vg:0,Ei:0,ra:r,Fg:0,ti:0,si:0,Di:0,Bi:r,Si:r,Xg:0,Yg:0,Ci:0,Li:0,ph:0,qh:0,dh:r,Ug:r,ei:0,yi:0,ii:0,ji:0,ki:0,fi:0,gi:0,hi:0,Fi:r,Gi:r,Hi:r,yh:r,Fh:r,data:r,min:Infinity,max:-Infinity};a.Ai=Y(this,"uint");a.$g=Y(this,"uchar",10);a.ah=Y(this,"uchar",18);a.ih=Y(this,"uint");a.ui=Y(this,"ushort");a.li=Y(this,"uchar");a.eh=Y(this,"uchar");a.H=Y(this,"ushort",8);a.zh=Y(this,"float");a.Ah=Y(this,"float");
a.Bh=Y(this,"float");a.xh=Y(this,"ushort");a.Cb=Y(this,"ushort");a.Vg=Y(this,"ushort");a.Ei=Y(this,"ushort");a.ra=Y(this,"float",8);a.Fg=Y(this,"float");a.ti=Y(this,"float");a.si=Y(this,"float");a.Di=Y(this,"ushort");a.Bi=Y(this,"uchar");a.Si=Y(this,"uchar");a.Xg=Y(this,"float");a.Yg=Y(this,"float");a.Ci=Y(this,"float");a.Li=Y(this,"float");a.ph=Y(this,"uint",1);a.qh=Y(this,"uint",1);a.dh=Y(this,"uchar",80);a.Ug=Y(this,"uchar",24);a.ei=Y(this,"ushort");a.yi=Y(this,"ushort");a.ii=Y(this,"float");a.ji=
Y(this,"float");a.ki=Y(this,"float");a.fi=Y(this,"float");a.gi=Y(this,"float");a.hi=Y(this,"float");a.Fi=Y(this,"float",4);a.Gi=Y(this,"float",4);a.Hi=Y(this,"float",4);a.yh=Y(this,"uchar",16);a.Fh=Y(this,"uchar",4);this.s=parseInt(a.Fg,10);var b=a.H[1]*a.H[2]*a.H[3];switch(a.Cb){case 2:a.data=Y(this,"uchar",b);break;case 4:a.data=Y(this,"sshort",b);break;case 8:a.data=Y(this,"sint",b);break;case 16:a.data=Y(this,"float",b);break;case 256:a.data=Y(this,"schar",b);break;case 512:a.data=Y(this,"ushort",
b);break;case 768:a.data=Y(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Cb))}b=Rd(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",Me);E("X.parserNII.prototype.parse",Me.prototype.parse);function Ne(){M.call(this);this.c="loader";this.oc=new Pb;this.Tc=0}H(Ne,M);function Oe(a,b){a.Tc+=b/a.oc.pa()/3;a.Tc=Math.min(1,a.Tc);var c=new Qd;c.Ff=a.Tc;a.dispatchEvent(c)}function Pe(a){var a=a.t.Qc,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Qe||i(Error("The "+b+" file format is not supported."));return[a,b,Qe[b][0],Qe[b][1],Qe[b][2]]}
Ne.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Rb(this.oc.D,a.ta)||this.oc.get(a.ta)){this.oc.set(a.ta,s);var c=Pe(a)[0];if(a.Sa!=r)this.parse(r,a,b);else{var d=new XMLHttpRequest;L(d,"abort",this.Rf.bind(this,d,a,b));L(d,"error",this.Rf.bind(this,d,a,b));L(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,o);d.responseType="arraybuffer";d.send(r)}}};
Ne.prototype.parse=function(a,b,c){Oe(this,1);setTimeout(function(){var d=Pe(b),e=d[3],d=new d[2];tc(d,zc,this.complete.bind(this));b.Sa==r&&(b.Sa=a.response);b.vd!=r?d.parse(b,c,b.vd,b.Sa,e):d.parse(b,c,b.Sa,e)}.bind(this),100)};Ne.prototype.complete=function(a){Oe(this,1);setTimeout(function(){var b=a.p,c=a.R;b.t.e=s;b.e=o;c.o();this.oc.set(b.ta,o)}.bind(this),100)};Ne.prototype.Rf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Qe={STL:[ye,r,r],VTK:[Ce,r,r],DX:[Re,r,r],TRK:[Ie,r,r],FSM:[Ee,r],INFLATED:[Ee,r],SMOOTHWM:[Ee,r],SPHERE:[Ee,r],PIAL:[Ee,r],ORIG:[Ee,r],NRRD:[Ge,r],NII:[Me,s],GZ:[Me,o],DCM:[Ae,r],DICOM:[Ae,r],IMG:[Le,r],HDR:[Le,r],"":[Ae,r],CRV:[He,r],LABEL:[Xd,r],MGH:[Fe,s],MGZ:[Fe,o],TXT:[Ke,r],LUT:[Ke,r],PNG:[Je,"png"],JPG:[Je,"jpeg"],JPEG:[Je,"jpeg"],GIF:[Je,"gif"]};function Se(a,b){(!D(a)||!D(b))&&i(Error("A camera needs valid width and height values."));M.call(this);this.c="camera";this.wa=new P(0,0,100);this.lc=new P(0,0,0);this.J=new P(0,1,0);this.m=this.Vd(this.wa,this.lc);this.Jb=new Float32Array(this.m.Ga())}H(Se,M);Se.prototype.Yh=function(a){a instanceof Kd||i(Error("Received no valid rotate event."));this.rotate(a.Z)};Se.prototype.bi=function(a){a instanceof Ld||i(Error("Received no valid zoom event."));a.Kb?this.Gg(a.jb):this.Hg(a.jb)};
Se.prototype.Vh=function(a){a instanceof Jd||i(Error("Received no valid pan event."));this.rg(a.Z)};Se.prototype.__defineGetter__("view",t("m"));Se.prototype.__defineSetter__("view",function(a){(!x(a)||!(a instanceof gd))&&i(Error("Invalid view matrix."));this.m=a;this.Jb=new Float32Array(this.m.Ga())});Se.prototype.__defineGetter__("position",function(){return[this.wa.x,this.wa.y,this.wa.b]});
Se.prototype.__defineSetter__("position",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid position."));this.wa=new P(a[0],a[1],a[2]);this.reset()});Se.prototype.__defineGetter__("focus",function(){return[this.lc.x,this.lc.y,this.lc.b]});Se.prototype.__defineSetter__("focus",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid focus"));this.lc=new P(a[0],a[1],a[2]);this.reset()});Se.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});
Se.prototype.__defineSetter__("up",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid up vector."));this.J=new P(a[0],a[1],a[2]);this.reset()});u=Se.prototype;u.reset=function(){this.m=this.Vd(this.wa,this.lc);this.Jb=new Float32Array(this.m.Ga())};u.rotate=function(a){z(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for rotate operation."));return a};
u.rg=function(a){z(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for pan operation."));a=new P(-a.x,a.y,0);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ga())};u.Gg=function(a){var b=20;x(a)&&!a&&(b=1);a=new P(0,0,b);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ga())};
u.Hg=function(a){var b=30;x(a)&&!a&&(b=1);a=new P(0,0,-b);a=hd(4).translate(a);this.m=new gd(a.multiply(this.m));this.Jb=new Float32Array(this.m.Ga())};u.Vd=function(a,b){(!(a instanceof P)||!(b instanceof P))&&i(Error("3D vectors required for calculating the view."));return hd(4)};E("X.camera",Se);E("X.camera.prototype.pan",Se.prototype.rg);E("X.camera.prototype.rotate",Se.prototype.rotate);E("X.camera.prototype.zoomIn",Se.prototype.Gg);E("X.camera.prototype.zoomOut",Se.prototype.Hg);function Te(a){function b(a,b,d){b=2*b*Math.PI;b=k.Eb(Math.cos(b)).xc(m.Eb(Math.sin(b)));a=c.xc(e.Eb(a)).xc(b.Eb(f));d=b.Eb(1-Math.abs(d)).xc(g.Eb(d));return new Hc(a,d)}this.A=[];for(var a=a||{},c=new xa(a.start||[0,-1,0]),d=new xa(a.end||[0,1,0]),e=d.hd(c),f=a.Ya||1,a=a.hf||16,g=e.od(),h=0.5<Math.abs(g.y()),k=(new xa(h,!h,0)).Ge(g).od(),m=k.Ge(g).od(),h=new Hc(c,g.Xe()),d=new Hc(d,g.od()),j=[],l=0;l<a;l++){var q=l/a,p=(l+1)/a;j.push(new Jc([h,b(0,q,-1),b(0,p,-1)]));j.push(new Jc([b(0,p,0),b(0,q,
0),b(1,q,0),b(1,p,0)]));j.push(new Jc([d,b(1,p,1),b(1,q,1)]))}return Mc(j)}H(Te,Lc);function Ue(){T.call(this);this.c="cylinder";this.ve=[-10,-10,-10];this.fe=[10,10,10];this.Sb=10;this.Vb=32;ya(this,new vd)}H(Ue,T);Ue.prototype.__defineGetter__("start",t("ve"));Ue.prototype.__defineSetter__("start",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid start"));this.ve=a});Ue.prototype.__defineGetter__("end",t("fe"));Ue.prototype.__defineSetter__("end",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid end"));this.fe=a});Ue.prototype.__defineGetter__("radius",t("Sb"));
Ue.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});Ue.prototype.o=function(){xd(this,new Te({start:this.ve,end:this.fe,Ya:this.Sb,hf:this.Vb}));Ue.i.o.call(this)};E("X.cylinder",Ue);E("X.cylinder.prototype.modified",Ue.prototype.o);function Ve(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new xa(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Hc(c.xc(e.Eb(d)),e))}this.A=[];for(var a=a||{},c=new xa(a.Ce||[0,0,0]),d=a.Ya||1,e=a.hf||16,a=a.Ii||8,f=[],g=[],h=0;h<e;h++)for(var k=0;k<a;k++)g=[],b(h/e,k/a),0<k&&b((h+1)/e,k/a),k<a-1&&b((h+1)/e,(k+1)/a),b(h/e,(k+1)/a),f.push(new Jc(g));return Mc(f)}H(Ve,Lc);function We(){T.call(this);this.c="sphere";this.l=[0,0,0];this.Sb=5;this.Vb=32;this.Sg=16;ya(this,new vd)}H(We,T);We.prototype.__defineGetter__("center",t("l"));We.prototype.__defineSetter__("center",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});We.prototype.__defineGetter__("radius",t("Sb"));We.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});
We.prototype.o=function(){xd(this,new Ve({Ce:this.l,Ya:this.Sb,hf:this.Vb,Ii:this.Sg}));We.i.o.call(this)};E("X.sphere",We);E("X.sphere.prototype.modified",We.prototype.o);function xe(a){N.call(this);this.c="labelmap";this.eb=a}H(xe,N);xe.prototype.o=function(){var a=new td;a.R=this;this.dispatchEvent(a);this.eb.o()};E("X.labelmap",xe);function Xe(a){this.A=[];var a=a||{},b=new xa(a.Ce||[0,0,0]),c=!a.Ya?[1,1,1]:a.Ya.length?a.Ya:[a.Ya,a.Ya,a.Ya];return Mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Jc(a[0].map(function(e){e=new xa(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Hc(e,new xa(a[1]))}))}))}H(Xe,Lc);function Ye(){T.call(this);this.c="cube";this.l=[0,0,0];this.le=this.ke=this.je=20;this.Wb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];ya(this,new vd)}H(Ye,T);Ye.prototype.__defineGetter__("center",t("l"));Ye.prototype.__defineSetter__("center",function(a){(!x(a)||!z(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Ye.prototype.__defineGetter__("lengthX",t("je"));
Ye.prototype.__defineSetter__("lengthX",function(a){D(a)||i(Error("Invalid lengthX."));this.je=a});Ye.prototype.__defineGetter__("lengthY",t("ke"));Ye.prototype.__defineSetter__("lengthY",function(a){D(a)||i(Error("Invalid lengthY."));this.ke=a});Ye.prototype.__defineGetter__("lengthZ",t("le"));Ye.prototype.__defineSetter__("lengthZ",function(a){D(a)||i(Error("Invalid lengthZ."));this.le=a});Ye.prototype.o=function(){xd(this,new Xe({Ce:this.l,Ya:[this.je/2,this.ke/2,this.le/2]}));Ye.i.o.call(this)};
E("X.cube",Ye);E("X.cube.prototype.modified",Ye.prototype.o);function Ze(a){Z.call(this,a);this.c="interactor3D"}H(Ze,Z);Ze.prototype.jd=function(a){Ze.i.jd.call(this,a);var b=new Ld;x(a.tc)||(a.tc=0);b.Kb=0>a.tc;b.jb=o;this.dispatchEvent(b)};function $e(a){M.call(this);this.c="array";this.v=[];this.rf=a}H($e,M);$e.prototype.add=function(a){this.v.push(a);return o};$e.prototype.clear=function(){this.v.length=0};function af(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);af(a,b,d);for(af(a,d,c);b<d;++b)if(0<a.rf(a.v[b],a.v[d])){var e=a.v[b];a.v[b]=a.v[d];for(var f=a,g=d,h=c;g+1<h&&0>f.rf(f.v[g+1],e);){var k=f,m=g+1,j=k.v[g];k.v[g]=k.v[m];k.v[m]=j;++g}f.v[g]=e}}}$e.prototype.sort=function(){af(this,0,this.v.length)};function bf(a,b){Se.call(this,a,b);this.c="camera2D"}H(bf,Se);bf.prototype.rotate=function(a){var a=bf.i.rotate.call(this,a),b=new Id;0<a.x?b.xe--:0>a.x&&b.xe++;0<a.y?b.me++:0>a.y&&b.me--;this.dispatchEvent(b)};function cf(a,b){Se.call(this,a,b);this.c="camera3D";this.sf=45;this.Bf=new Float32Array(df(this.sf,a/b).Ga())}H(cf,Se);function df(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new gd([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
cf.prototype.rotate=function(a){var a=cf.i.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=hd(4),d=new P(parseFloat(this.m.V(0,0)),parseFloat(this.m.V(0,1)),parseFloat(this.m.V(0,2))),b=c.rotate(b,new P(parseFloat(this.m.V(1,0)),parseFloat(this.m.V(1,1)),parseFloat(this.m.V(1,2)))),a=c.rotate(a,d);this.m=new gd(this.m.multiply(a.multiply(b)));this.Jb=new Float32Array(this.m.Ga())};
cf.prototype.Vd=function(a,b){cf.i.Vd.call(this,a,b);var c=hd(4),d=new P(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.$c(d)&&(e.b+=1.0E-6);var f=Uc(e,d),e=Uc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.ca())};E("X.camera3D",cf);function ef(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}ef.prototype.f=function(){return new ef(this.top,this.right,this.bottom,this.left)};ef.prototype.contains=function(a){return!this||!a?s:a instanceof ef?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function ff(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}ff.prototype.f=function(){return new ff(this.left,this.top,this.width,this.height)};ff.prototype.bg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,o}return s};
ff.prototype.contains=function(a){return a instanceof ff?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};ff.prototype.ya=function(){return new Yc(this.width,this.height)};function gf(a,b){var c=ge(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b):""}function hf(a,b){return a.currentStyle?a.currentStyle[b]:r}function jf(a,b){return gf(a,b)||hf(a,b)||a.style&&a.style[b]}function kf(a){a=a?9==a.nodeType?a:ge(a):document;return J&&!ob(9)&&!re(ee(a))?a.body:a.documentElement}
function lf(a){var b=a.getBoundingClientRect();J&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function mf(a){if(J&&!ob(8))return a.offsetParent;for(var b=ge(a),c=jf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=jf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function nf(a){for(var b=new ef(0,Infinity,Infinity,0),c=ee(a),d=c.N.body,e=c.N.documentElement,f=!Wa&&"CSS1Compat"==c.N.compatMode?c.N.documentElement:c.N.body;a=mf(a);)if((!J||0!=a.clientWidth)&&(!Wa||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=jf(a,"overflow")){var g=of(a),h;h=a;if(Va&&!mb("1.9")){var k=parseFloat(gf(h,"borderLeftWidth"));if(pf(h))var m=h.offsetWidth-h.clientWidth-k-parseFloat(gf(h,"borderRightWidth")),k=k+m;h=new Vc(k,parseFloat(gf(h,"borderTopWidth")))}else h=new Vc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.N.parentWindow||c.N.defaultView||window;e=c.document;Wa&&!mb("500")&&!Xa?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Yc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Yc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:r}
function of(a){var b,c=ge(a),d=jf(a,"position"),e=Va&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vc(0,0),g=kf(c);if(a==g)return f;if(a.getBoundingClientRect)b=lf(a),a=se(ee(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Wa&&"fixed"==jf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ua||Wa&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=mf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Ua||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function qf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function rf(a){if("none"!=jf(a,"display"))return sf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=sf(a);b.display=c;b.position=e;b.visibility=d;return a}function sf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Wa&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=lf(a),new Yc(a.right-a.left,a.bottom-a.top)):new Yc(b,c)}function tf(a,b){a.style.display=b?"":"none"}function pf(a){return"rtl"==jf(a,"direction")}
function uf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var vf={thin:2,medium:4,thick:6};function wf(a,b){if("none"==hf(a,b+"Style"))return 0;var c=hf(a,b+"Width");return c in vf?vf[c]:uf(a,c)};function xf(a){this.Na=a;this.w=[]}H(xf,Wb);var yf=[];function zf(a,b,c,d,e){z(c)||(yf[0]=c,c=yf);for(var f=0;f<c.length;f++)a.w.push(L(b,c[f],d||a,e||s,a.Na||a))}xf.prototype.Yd=function(){xb(this.w,vc);this.w.length=0};xf.prototype.M=function(){xf.i.M.call(this);this.Yd()};xf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function Af(){}(function(a){a.Sf=function(){return a.wh||(a.wh=new a)}})(Af);Af.prototype.Ye=0;Af.Sf();function Bf(a){this.Va=a||ee()}H(Bf,Gc);u=Bf.prototype;u.uh=Af.Sf();u.Zf=r;u.cc=s;u.q=r;u.wc=r;u.Jd=r;u.Yc=r;u.Ri=s;u.j=t("q");u.ff=function(a){this.wc&&this.wc!=a&&i(Error("Method not supported"));Bf.i.ff.call(this,a)};u.Nd=t("Va");u.sc=function(){this.q=this.Va.createElement("div")};u.gc=function(a){this.Db(a)};u.Db=function(a,b){this.cc&&i(Error("Component already rendered"));this.q||this.sc();a?a.insertBefore(this.q,b||r):this.Va.N.body.appendChild(this.q);(!this.wc||this.wc.cc)&&this.Md()};
u.Md=function(){this.cc=o;Cf(this,function(a){!a.cc&&a.j()&&a.Md()})};u.bd=function(){Cf(this,function(a){a.cc&&a.bd()});this.Rd&&this.Rd.Yd();this.cc=s};u.M=function(){Bf.i.M.call(this);this.cc&&this.bd();this.Rd&&(this.Rd.Ma(),delete this.Rd);Cf(this,function(a){a.Ma()});!this.Ri&&this.q&&oe(this.q);this.wc=this.q=this.Yc=this.Jd=r};function Cf(a,b){a.Jd&&xb(a.Jd,b,n)}
u.removeChild=function(a,b){if(a){var c=ka(a)?a:a.Zf||(a.Zf=":"+(a.uh.Ye++).toString(36)),a=this.Yc&&c?(c in this.Yc?this.Yc[c]:n)||r:r;if(c&&a){var d=this.Yc;c in d&&delete d[c];Bb(this.Jd,a);b&&(a.bd(),a.q&&oe(a.q));c=a;c==r&&i(Error("Unable to set parent component"));c.wc=r;Bf.i.ff.call(c,r)}}a||i(Error("Child is not in parent component"));return a};function Df(){}H(Df,Gc);u=Df.prototype;u.of=0;u.gd=0;u.Te=100;u.Qf=0;u.lf=1;u.Dh=s;u.Hh=s;u.ae=function(a){a=Ef(this,a);this.of!=a&&(this.of=a+this.Qf>this.Te?this.Te-this.Qf:a<this.gd?this.gd:a,!this.Dh&&!this.Hh&&this.dispatchEvent("change"))};u.Qd=function(){return Ef(this,this.of)};u.Pd=function(){return Ef(this,this.gd)};u.Od=function(){return Ef(this,this.Te)};function Ef(a,b){return a.lf==r?b:a.gd+Math.round((b-a.gd)/a.lf)*a.lf};function Ff(a){this.Va=a||ee();this.yc=new Df;L(this.yc,"change",this.rh,s,this)}H(Ff,Bf);var Gf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};u=Ff.prototype;u.sc=function(){this.Qa=this.Nd().sc("div","progress-bar-thumb");var a=Gf[this.qg];this.q=this.Nd().sc("div",a,this.Qa);Hf(this);this.j().setAttribute("aria-valuemin",this.Pd());this.j().setAttribute("aria-valuemax",this.Od())};
u.Md=function(){Ff.i.Md.call(this);J&&7>bb&&L(this.j(),"resize",this.de,s,this);this.de();var a=this.j();a.setAttribute("role","progressbar");a.Ij="progressbar";this.j().setAttribute("aria-live","polite")};u.bd=function(){Ff.i.bd.call(this);If(this)};function If(a){J&&7>bb&&uc(a.j(),"resize",a.de,s,a)}u.Qd=function(){return this.yc.Qd()};u.ae=function(a){this.yc.ae(a);this.j()&&Hf(this)};function Hf(a){var b=a.Qd();a.j().setAttribute("aria-valuenow",b)}u.Pd=function(){return this.yc.Pd()};u.Od=function(){return this.yc.Od()};
u.qg="horizontal";u.rh=function(){this.de();this.dispatchEvent("change")};u.de=function(){if(this.Qa){var a=this.Pd(),b=this.Od(),a=(this.Qd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.qg?J&&7>bb?(this.Qa.style.top=0,this.Qa.style.height="100%",b=this.Qa.offsetHeight,a=Math.round(a*b),this.Qa.style.top=b-a+"px",this.Qa.style.height=a+"px"):(this.Qa.style.top=100-b+"%",this.Qa.style.height=b+"%"):this.Qa.style.width=b+"%"}};u.M=function(){If(this);Ff.i.M.call(this);this.Qa=r;this.yc.Ma()};function Jf(a,b){x(a)||i(Error("No valid parent element."));x(b)||i(Error("Invalid initial value."));Ff.call(this);this.c="progressbar";this.Fa=a;this.td=this.cb=r;this.Hb=[];this.Hb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.ae(b);this.Oe()}H(Jf,Ff);
Jf.prototype.Oe=function(){if("static"==this.Fa.style.position||""==this.Fa.style.position)this.Fa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Hb[0]),d=document.createTextNode(this.Hb[1]),e=document.createTextNode(this.Hb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.cb=b;this.gc(this.Fa);a=this.j();a.style.position="absolute";a.style.top=(this.Fa.clientHeight-
5)/2;a.style.left=(this.Fa.clientWidth-100)/2;a.classList.add("xtk-progress-bar")};function Kf(a){var b=a.j().style.top,c=a.j().style.left;oe(a.j());var d=new Jf(a.Fa,100),e=d.j();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=n?e.firstElementChild:pe(e.firstChild)).classList.add("progress-bar-thumb-done");a.td=d}Jf.prototype.Re=function(){this.cb&&oe(this.cb);this.j()&&oe(this.j());this.td&&oe(this.td.j());this.td=this.cb=r};var Lf=fa.window;function Mf(a,b,c){la(a)?c&&(a=ta(a,c)):a&&"function"==typeof a.handleEvent?a=ta(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Lf.setTimeout(a,b||0)};function Nf(){M.call(this);this.c="renderer";this.p=window.document.body;this.K=this.p.clientWidth;this.G=this.p.clientHeight;this.Lb=this.r=this.ja=r;this.ab=new $e(ud);this.Ua=[];this.Q=r;this.yd=this.Ic=this.wd=s;this.a=this.Ta=r;this.X={PROGRESSBAR_ENABLED:o};window.console.log("XTK Release pre8 -- 08/17/12 -- http://www.goXTK.com -- @goXTK")}H(Nf,M);u=Nf.prototype;u.Wh=function(a){this.Ta&&this.Ta.ae(100*a.Ff)};u.Mh=function(a){x(a)&&a instanceof td&&a.R&&this.Za(a.R)};
u.af=function(a){(!x(a)||!(a instanceof Nd))&&i(Error("Invalid hover event."))};u.Xh=function(){var a=he(this.p);this.K=a.clientWidth;this.G=a.clientHeight;a=he(this.ja);a.width=this.K;a.height=this.G;this instanceof Of&&(this.a.viewport(0,0,this.K,this.G),this.r.Bf=new Float32Array(df(this.r.sf,this.ja.width/this.ja.height).Ga()));this.Ac()};u.bf=function(a){(!x(a)||!(a instanceof Md))&&i(Error("Invalid scroll event."))};Nf.prototype.__defineGetter__("config",t("X"));
Nf.prototype.__defineGetter__("interactor",t("Lb"));Nf.prototype.__defineGetter__("camera",t("r"));Nf.prototype.__defineGetter__("loadingCompleted",t("Ic"));Nf.prototype.__defineGetter__("container",t("p"));Nf.prototype.__defineSetter__("container",function(a){x(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ka(b)&&(b=he(a));ma(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.p=b});u=Nf.prototype;u.Ac=function(){this.r.reset()};
function Pf(a){a.X.PROGRESSBAR_ENABLED&&a.Ta&&!a.qf&&(Kf(a.Ta),a.qf=Mf(function(){this.qf=r;this.Ta&&(this.Ta.Re(),this.Ta=r);this.gc()}.bind(a),700))}
u.ma=function(a){var b=ke("canvas");this.p.appendChild(b);this.K=this.p.clientWidth;this.G=this.p.clientHeight;b.width=this.K;b.height=this.G;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.p.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.Q=new Ne;L(this.Q,Fd,this.Wh.bind(this));this.ja=b;this.a=c;b=new Ze(this.ja);"2d"==a&&(b=new ue(this.ja));b.ma();L(b,Dd,this.Ac.bind(this));L(b,Gd,this.af.bind(this));L(b,Cd,this.bf.bind(this));this.Lb=b;b=new cf(this.K,this.G);"2d"==a&&(b=new bf(this.K,this.G));a=b;c=this.Lb;(!x(c)||!(c instanceof Z))&&i(Error("Could not observe the interactor."));L(c,Ad,a.Yh.bind(a));L(c,zd,a.Vh.bind(a));L(c,Bd,a.bi.bind(a));this.r=b;L(window,"resize",this.Xh,s,this)};
u.add=function(a){(a instanceof Ye||a instanceof We||a instanceof Ue)&&a.o();this.Ua.push(a);this.Za(a)};u.Za=function(a){(!this.ja||!this.a)&&i(Error("The renderer was not initialized properly."));x(a)||(window.console.log(a),i(Error("Illegal object.")));yc(a)||L(a,zc,this.Mh.bind(this))};u.get=function(a){x(a)||i(Error("Invalid object id."));for(var b=this.ab.v,c=b.length,d=0,d=0;d<c;d++)if(b[d].ta==a)return b[d];return r};
u.gc=function(){(!this.ja||!this.a)&&i(Error("The renderer was not initialized properly."));x(this.Df)||(this.Q.oc.Ee(s)?(this.X.PROGRESSBAR_ENABLED&&!this.Ta&&(this.Ta=new Jf(this.p,3)),this.yd=this.Ic=s,this.Df=Mf(function(){this.Df=r;this.gc()}.bind(this),100)):(!this.Ic&&!this.yd&&(this.yd=o,eval("this.onShowtime()"),this.Ic=o),this.Ta?Pf(this):(window.kd(this.gc.bind(this),this.ja),eval("this.onRender()"),this.Db(s,o))))};u.ni=function(){this.Ic=this.yd=s};u.pg=aa();u.ng=aa();u.Db=aa();
u.Ld=function(){this.ab.clear();delete this.ab;this.Ua.length=0;delete this.Ua;delete this.Q;this.Q=r;delete this.r;this.r=r;delete this.Lb;this.Lb=r;delete this.a;this.a=r;oe(this.ja);delete this.ja;this.ja=r};function Qf(){M.call(this);this.c="shaders";this.Dd="";this.Dd="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.ud="";this.ud="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
H(Qf,M);
var Rf={sj:"vertexPosition",rj:"vertexNormal",qj:"vertexColor",uj:"vertexTexturePos",tj:"vertexScalar"},Sf={vj:"view",aj:"perspective",Ti:"center",$i:"objectTransform",mj:"useObjectColor",Yi:"objectColor",oj:"useScalars",ij:"scalarsReplaceMode",fj:"scalarsMin",cj:"scalarsMax",gj:"scalarsMinColor",dj:"scalarsMaxColor",hj:"scalarsMinThreshold",ej:"scalarsMaxThreshold",bj:"pointSize",Zi:"objectOpacity",Xi:"normal",nj:"usePicking",pj:"useTexture",lj:"useLabelMapTexture",Vi:"labelmapOpacity",jj:"textureSampler",kj:"textureSampler2",
wj:"volumeLowerThreshold",Cj:"volumeUpperThreshold",zj:"volumeScalarMin",xj:"volumeScalarMax",Aj:"volumeScalarMinColor",yj:"volumeScalarMaxColor",Ej:"volumeWindowLow",Dj:"volumeWindowHigh",Bj:"volumeTexture"};
function Tf(a){var b=Object.keys(Sf);Object.keys(Rf).every(function(a){a=Rf[a];return-1!=this.Dd.search(a)||-1!=this.ud.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Sf[a];return-1!=this.Dd.search(a)||-1!=this.ud.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Uf(a,b,c){x(a)||i(Error("Invalid GL Buffer."));x(b)||i(Error("Invalid number of items."));x(c)||i(Error("Invalid item size."));M.call(this);this.c="buffer";this.ka=a;this.pb=b;this.qb=c}H(Uf,M);function Vf(a,b,c,d,e,f,g,h){var k,m=c.offsetParent;if(m){var j="HTML"==m.tagName||"BODY"==m.tagName;if(!j||"static"!=jf(m,"position"))k=of(m),j||(k=Wc(k,new Vc(m.scrollLeft,m.scrollTop)))}m=of(a);j=rf(a);m=new ff(m.x,m.y,j.width,j.height);(j=nf(a))&&m.bg(new ff(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=ee(a),l=ee(c);if(j.N!=l.N){var q=j.N.body,l=l.N.parentWindow||l.N.defaultView,p=new Vc(0,0),w=ge(q)?ge(q).parentWindow||ge(q).defaultView:window,v=q;do{var A;if(w==l)A=of(v);else{var B=v;
A=new Vc;if(1==B.nodeType)if(B.getBoundingClientRect)B=lf(B),A.x=B.left,A.y=B.top;else{var y=se(ee(B)),B=of(B);A.x=B.x-y.x;A.y=B.y-y.y}else{var y=la(B.oh),C=B;B.targetTouches?C=B.targetTouches[0]:y&&B.Wa.targetTouches&&(C=B.Wa.targetTouches[0]);A.x=C.clientX;A.y=C.clientY}}p.x+=A.x;p.y+=A.y}while(w&&w!=l&&(v=w.frameElement)&&(w=w.parent));q=Wc(p,of(q));J&&!re(j)&&(q=Wc(q,se(j)));m.left+=q.x;m.top+=q.y}a=(b&4&&pf(a)?b^2:b)&-5;b=new Vc(a&2?m.left+m.width:m.left,a&1?m.top+m.height:m.top);k&&(b=Wc(b,
k));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=nf(c))&&k)F.top-=k.y,F.right-=k.x,F.bottom-=k.y,F.left-=k.x;return Wf(b,c,d,f,F,g,h)}
function Wf(a,b,c,d,e,f,g){var a=a.f(),h=0,k=(c&4&&pf(b)?c^2:c)&-5,c=rf(b),g=g?g.f():c.f();if(d||0!=k)k&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),k&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Va&&(Na||ab)&&mb("1.9");f instanceof Vc?(a=f.x,f=f.y):(a=f,f=n);b.style.left=qf(a,e);b.style.top=qf(f,e);Zc(c,g)||(a=re(ee(ge(b))),
J&&(!a||!mb("8"))?(c=b.style,a?(J?(a=uf(b,hf(b,"paddingLeft")),e=uf(b,hf(b,"paddingRight")),f=uf(b,hf(b,"paddingTop")),d=uf(b,hf(b,"paddingBottom")),a=new ef(f,e,d,a)):(a=gf(b,"paddingLeft"),e=gf(b,"paddingRight"),f=gf(b,"paddingTop"),d=gf(b,"paddingBottom"),a=new ef(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),J?(e=wf(b,"borderLeft"),f=wf(b,"borderRight"),d=wf(b,"borderTop"),b=wf(b,"borderBottom"),b=new ef(d,f,b,e)):(e=gf(b,"borderLeftWidth"),f=gf(b,"borderRightWidth"),d=gf(b,"borderTopWidth"),
b=gf(b,"borderBottomWidth"),b=new ef(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Va?b.MozBoxSizing="border-box":Wa?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Xf(){}Xf.prototype.Pa=aa();function Yf(a,b){this.element=a;this.Kf=b}H(Yf,Xf);Yf.prototype.Pa=function(a,b,c){Vf(this.element,this.Kf,a,b,n,c)};function Zf(a,b){this.Na=new xf(this);this.ef(a||r);b&&(this.Cc=b)}H(Zf,Gc);u=Zf.prototype;u.q=r;u.Tg=o;u.Gf=r;u.qa=s;u.zi=s;u.Se=-1;u.th=s;u.hh=o;u.Cc="toggle_display";u.j=t("q");u.ef=function(a){this.qa&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function $f(a,b){a.md&&a.md.stop();a.ed&&a.ed.stop();if(b){if(!a.qa&&a.Ze()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Pa();var c=ge(a.q);a.th&&zf(a.Na,c,"keydown",a.Kh,o);if(a.Tg)if(zf(a.Na,c,"mousedown",a.lg,o),J){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}zf(a.Na,c,"mousedown",a.lg,o);zf(a.Na,c,"deactivate",a.kg)}else zf(a.Na,c,"blur",a.kg);"toggle_display"==
a.Cc?(a.q.style.visibility="visible",tf(a.q,o)):"move_offscreen"==a.Cc&&a.Pa();a.qa=o;a.md?(tc(a.md,"end",a.og,s,a),a.md.play()):a.og()}}else ag(a)}u.Pa=ga;function ag(a,b){if(!a.qa||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.Na&&a.Na.Yd();a.ed?(tc(a.ed,"end",va(a.Jf,b),s,a),a.ed.play()):a.Jf(b);return o}u.Jf=function(a){"toggle_display"==this.Cc?this.zi?Mf(this.Yf,0,this):this.Yf():"move_offscreen"==this.Cc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.qa=s;this.$e(a)};
u.Yf=function(){this.q.style.visibility="hidden";tf(this.q,s)};u.Ze=function(){return this.dispatchEvent("beforeshow")};u.og=function(){this.Se=wa();this.dispatchEvent("show")};u.$e=function(a){wa();this.dispatchEvent({type:"hide",target:a})};u.lg=function(a){a=a.target;!qe(this.q,a)&&(!this.Gf||qe(this.Gf,a))&&!(150>wa()-this.Se)&&ag(this,a)};u.Kh=function(a){27==a.keyCode&&ag(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
u.kg=function(a){if(this.hh){var b=ge(this.q);if(J||Ua){if(a=b.activeElement,!a||qe(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.Se||ag(this)}};u.M=function(){Zf.i.M.call(this);this.Na.Ma();Yb(this.md);Yb(this.ed);delete this.q;delete this.Na};function bg(a,b){this.Fe=a instanceof Vc?a:new Vc(a,b)}H(bg,Xf);bg.prototype.Pa=function(a,b,c,d){Vf(kf(a),0,a,b,this.Fe,c,r,d)};function cg(a,b){this.di=4;this.Xd=b||n;Zf.call(this,a)}H(cg,Zf);cg.prototype.Pa=function(){if(this.Xd){var a=!this.qa&&"move_offscreen"!=this.Cc,b=this.j();a&&(b.style.visibility="hidden",tf(b,o));this.Xd.Pa(b,this.di,this.Gj);a&&tf(b,s)}};function dg(a,b,c){this.Va=c||(a?ee(he(a)):ee());cg.call(this,this.Va.sc("div",{style:"position:absolute;display:none;"}));this.He=new Vc(1,1);this.$b=new Tb;a&&eg(this,a);if(b!=r)if(a=this.j(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ge(a).createTextNode(b))}}H(dg,cg);var fg=[];u=dg.prototype;u.oa=r;u.className="goog-tooltip";
u.wg=500;u.sh=0;u.Nd=t("Va");function eg(a,b){b=he(b);a.$b.add(b);L(b,"mouseover",a.Vf,s,a);L(b,"mouseout",a.Sd,s,a);L(b,"mousemove",a.Uf,s,a);L(b,"focus",a.Tf,s,a);L(b,"blur",a.Sd,s,a)}u.detach=function(a){if(a)a=he(a),gg(this,a),this.$b.remove(a);else{for(var b=this.$b.bc(),c=0;a=b[c];c++)gg(this,a);this.$b.clear()}};function gg(a,b){uc(b,"mouseover",a.Vf,s,a);uc(b,"mouseout",a.Sd,s,a);uc(b,"mousemove",a.Uf,s,a);uc(b,"focus",a.Tf,s,a);uc(b,"blur",a.Sd,s,a)}
u.ef=function(a){var b=this.j();b&&oe(b);dg.i.ef.call(this,a);a&&(b=this.Va.N.body,b.insertBefore(a,b.lastChild))};u.Ze=function(){if(!Zf.prototype.Ze.call(this))return s;if(this.anchor)for(var a,b=0;a=fg[b];b++)qe(a.j(),this.anchor)||$f(a,s);0<=wb(fg,this)||fg.push(this);a=this.j();a.className=this.className;hg(this);L(a,"mouseover",this.Xf,s,this);L(a,"mouseout",this.Wf,s,this);ig(this);return o};
u.$e=function(){Bb(fg,this);for(var a=this.j(),b,c=0;b=fg[c];c++)b.anchor&&qe(a,b.anchor)&&$f(b,s);this.sg&&jg(this.sg);uc(a,"mouseover",this.Xf,s,this);uc(a,"mouseout",this.Wf,s,this);this.anchor=n;if(0==(this.fb?this.qa?4:1:this.vc?3:this.qa?2:0))this.Zd=s;Zf.prototype.$e.call(this)};u.ig=function(a,b){this.anchor==a&&this.$b.contains(this.anchor)&&(this.Zd||!this.Hj?($f(this,s),this.qa||(this.anchor=a,this.Xd=b||kg(this,0)||n,this.qa&&this.Pa(),$f(this,o))):this.anchor=n);this.fb=n};
u.Gh=function(a){this.vc=n;a==this.anchor&&(this.oa==r||this.oa!=this.j()&&!this.$b.contains(this.oa))&&(!this.Hf||!this.Hf.oa)&&$f(this,s)};function lg(a,b){var c=se(a.Va);a.He.x=b.clientX+c.x;a.He.y=b.clientY+c.y}u.Vf=function(a){var b=mg(this,a.target);this.oa=b;hg(this);b!=this.anchor&&(this.anchor=b,this.fb||(this.fb=Mf(ta(this.ig,this,b,n),this.wg)),ng(this),lg(this,a))};function mg(a,b){try{for(;b&&!a.$b.contains(b);)b=b.parentNode;return b}catch(c){return r}}
u.Uf=function(a){lg(this,a);this.Zd=o};u.Tf=function(a){this.oa=a=mg(this,a.target);this.Zd=o;if(this.anchor!=a){this.anchor=a;var b=kg(this,1);hg(this);this.fb||(this.fb=Mf(ta(this.ig,this,a,b),this.wg));ng(this)}};function kg(a,b){if(0==b){var c=a.He.f();return new og(c)}return new pg(a.oa)}function ng(a){if(a.anchor)for(var b,c=0;b=fg[c];c++)qe(b.j(),a.anchor)&&(b.Hf=a,a.sg=b)}
u.Sd=function(a){var b=mg(this,a.target),c=mg(this,a.relatedTarget);b!=c&&(b==this.oa&&(this.oa=r),ig(this),this.Zd=s,this.qa&&(!a.relatedTarget||!qe(this.j(),a.relatedTarget))?jg(this):this.anchor=n)};u.Xf=function(){var a=this.j();this.oa!=a&&(hg(this),this.oa=a)};u.Wf=function(a){var b=this.j();if(this.oa==b&&(!a.relatedTarget||!qe(b,a.relatedTarget)))this.oa=r,jg(this)};function ig(a){a.fb&&(Lf.clearTimeout(a.fb),a.fb=n)}
function jg(a){if(2==(a.fb?a.qa?4:1:a.vc?3:a.qa?2:0))a.vc=Mf(ta(a.Gh,a,a.anchor),a.sh)}function hg(a){a.vc&&(Lf.clearTimeout(a.vc),a.vc=n)}u.M=function(){$f(this,s);ig(this);this.detach();this.j()&&oe(this.j());this.oa=r;delete this.Va;dg.i.M.call(this)};function og(a,b){bg.call(this,a,b)}H(og,bg);og.prototype.Pa=function(a,b,c){b=kf(a);b=nf(b);c=c?new ef(c.top+10,c.right,c.bottom,c.left+10):new ef(10,0,0,10);Wf(this.Fe,a,4,c,b,9)&496&&Wf(this.Fe,a,4,c,b,5)};function pg(a){Yf.call(this,a,3)}
H(pg,Yf);pg.prototype.Pa=function(a,b,c){var d=new Vc(10,0);Vf(this.element,this.Kf,a,b,d,c,9)&496&&Vf(this.element,2,a,1,d,c,5)};function qg(a,b,c,d){x(a)||i(Error("No valid parent element."));(!D(b)||!D(c))&&i(Error("Invalid coordinates."));(!x(d)||!(d instanceof Z))&&i(Error("Invalid interactor."));dg.call(this);this.c="caption";this.Fa=a;this.Fd=b;this.Gd=c;this.Lb=d;this.cb=r;this.Hb=[];this.Hb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];tc(d,Hd,this.Re.bind(this));this.Oe()}H(qg,dg);
qg.prototype.Oe=function(){if("static"==this.Fa.style.position||""==this.Fa.style.position)this.Fa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ke("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Hb[0]);a.appendChild(b);b.appendChild(c);this.cb=b;this.Xd=new bg(this.Fd,this.Gd)||n;this.qa&&this.Pa();$f(this,o);eg(this,this.Fa);this.j().classList.add("x-tooltip")};
qg.prototype.Re=function(){$f(this,s);this.cb&&oe(this.cb);this.j()&&oe(this.j());this.cb=r};function Of(){Nf.call(this);this.c="renderer3D";this.Mc=this.Pc=this.Lc=this.Oc=this.Kc=this.Nc=this.re=this.se=r;this.l=[0,0,0];this.Cf=r;this.ee=new Pb;this.Uc=new Pb;this.Xc=new Pb;this.pe=new Pb;this.sd=new Pb;this.Ad=new Pb;this.Bd=new Pb;this.Cd=new Pb;this.X={PROGRESSBAR_ENABLED:o,PICKING_ENABLED:o,ORDERING_ENABLED:o,STATISTICS_ENABLED:s}}H(Of,Nf);Of.prototype.__defineGetter__("config",t("X"));u=Of.prototype;u.mi=function(){this.Mc=this.Pc=this.Lc=this.Oc=this.Kc=this.Nc=r;this.l=[0,0,0]};
u.af=function(a){Of.i.af.call(this,a);var b=a.Fd,a=a.Gd,c=this.get(this.tg(b,a));if(c&&(c=c.jc))(new qg(this.p,this.p.offsetLeft+b+10,this.p.offsetTop+a+10,this.Lb)).j().innerHTML=c};
u.ma=function(){Of.i.ma.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.K,this.G),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.X.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.K,this.G,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.K,this.G);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.Cf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}rg(this)};
function rg(a){var b=new Qf;(!x(a.ja)||!x(a.a)||!x(a.r))&&i(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof Qf))&&i(Error("Could not add shaders."));Tf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.ud);a.a.shaderSource(d,b.Dd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.re=e;Object.keys(Rf).forEach(function(a){a=Rf[a];this.ee.set(a,this.a.getAttribLocation(this.re,a));this.a.enableVertexAttribArray(this.ee.get(a))}.bind(a));
Object.keys(Sf).forEach(function(a){a=Sf[a];this.Uc.set(a,this.a.getUniformLocation(this.re,a))}.bind(a));a.se=b}
u.Za=function(a){Of.i.Za.call(this,a);var b=s;this.get(a.ta)&&(b=o);var c=a.ta,d=a.g,e=a.h,f=a.W,g=a.z,h=a.t,k=a.Xb,m=a.O,j=a.n,l=a.u;if(x(j)&&x(j.t)&&j.t.e)this.Za(j);else if(x(j)&&j.e&&this.Za(j),x(m)&&x(m.t)&&m.t.e)this.Q.load(m,a);else if(x(g)&&x(g.t)&&g.t.e)this.Q.load(g,a);else{if(x(h)&&z(h))if(x(a.hc)){if(a.hc.Td!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.Q.load(h[b],a);return}else{if(x(h)&&h.e){this.Q.load(a,a);return}if(x(l)&&x(l.t)&&l.t.e){this.Q.load(l,a);return}}if(0<
a.d.length){h=a.d;m=h.length;for(j=j=0;j<m;j++)this.Za(h[j])}if(d){for(h=0;this.wd;)h++,window.console.log("Possible thread lock avoided: "+h);this.wd=o;m=a instanceof ve&&a.eb instanceof xe;b&&x(g)&&g.e&&(h=this.Bd.get(c),x(h)&&this.a.isBuffer(h.ka)&&this.a.deleteBuffer(h.ka));h=r;x(g)&&(!b||g.e?(h=a.Wb,x(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=s,g.xa&&(j=o),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,j),j=this.a.createTexture(),
j.vh=g.lb,this.Cd.set(g.ta,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.xa?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.yb,g.xb,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.xa):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.vh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),m?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,r),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Uf(j,h.length,2),g.e=s):h=this.Bd.get(c));Oe(this.Q,0.1);if(m)this.wd=
s,I.na(this.c+".update"),Oe(this.Q,0.9);else{if(!b||d.e||k.e){m=k.B;g=m.Oa(new P(d.Pb,d.Qb,d.Rb));m=m.Oa(new P(d.Mb,d.Nb,d.Ob));if(this.Nc===r||g.x<this.Nc)this.Nc=g.x;if(this.Kc===r||m.x>this.Kc)this.Kc=m.x;if(this.Oc===r||g.y<this.Oc)this.Oc=g.y;if(this.Lc===r||m.y>this.Lc)this.Lc=m.y;if(this.Pc===r||g.b<this.Pc)this.Pc=g.b;if(this.Mc===r||m.b>this.Mc)this.Mc=m.b;this.l=[(this.Nc+this.Kc)/2,(this.Oc+this.Lc)/2,(this.Pc+this.Mc)/2];k.e=s}b&&d.e&&(k=this.Xc.get(c),x(k)&&this.a.isBuffer(k.ka)&&this.a.deleteBuffer(k.ka));
k=r;!b||d.e?(k=this.a.createBuffer(),d.Bc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,d.I,this.a.STATIC_DRAW),k=new Uf(k,d.count,3),d.e=s):k=this.Xc.get(c);Oe(this.Q,0.3);b&&e.e&&(g=this.Xc.get(c),x(g)&&this.a.isBuffer(g.ka)&&this.a.deleteBuffer(g.ka));g=r;!b||e.e?(g=this.a.createBuffer(),e.Bc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.I,this.a.STATIC_DRAW),g=new Uf(g,e.count,3),e.e=s):g=this.pe.get(c);Oe(this.Q,0.3);b&&
f&&f.e&&(e=this.sd.get(c),x(e)&&this.a.isBuffer(e.ka)&&this.a.deleteBuffer(e.ka));e=r;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Bc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.I,this.a.STATIC_DRAW),e=new Uf(e,f.count,3),f.e=s):e=this.sd.get(c));Oe(this.Q,0.2);b&&l&&l.e&&(f=this.Ad.get(c),x(f)&&this.a.isBuffer(f.ka)&&this.a.deleteBuffer(f.ka));f=r;l&&(f=l.Ec,!b||l.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Uf(d,f.length,3),l.e=s):f=this.Ad.get(c));Oe(this.Q,0.1);b||this.ab.add(a);this.Xc.set(c,k);this.pe.set(c,g);this.sd.set(c,e);this.Bd.set(c,h);this.Ad.set(c,f);this.wd=a.e=s}}else a.e=s}};function sg(a,b){var c=b.g.rd,c=a.r.m.Oa(b.Xb.B.Oa(new P(c[0],c[1],c[2]))),c=Sc(a.r.wa,c);return Math.round(1E3*c)/1E3}
u.tg=function(a,b){if(this.X.PICKING_ENABLED){this.Db(o,s);var c=new Uint8Array(4);this.a.readPixels(a,this.G-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
u.Db=function(a,b){Of.i.Db.call(this,a,b);var c=this.ab.v,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Cf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.viewport(0,0,this.K,this.G);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.r.Bf,f=this.r.Jb;this.a.uniformMatrix4fv(this.Uc.get("perspective"),s,e);this.a.uniformMatrix4fv(this.Uc.get("view"),s,f);e=this.l;this.a.uniform3f(this.Uc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Ua.length;for(e=0;e<f;++e){var g=this.Ua[e];if(g instanceof N){var h=new P(1,0,0),h=this.r.m.Oa(h),k=Sc(this.r.wa,h),h=new P(-1,0,0),h=this.r.m.Oa(h),m=Sc(this.r.wa,h),h=new P(0,1,0),h=this.r.m.Oa(h),j=Sc(this.r.wa,h),h=new P(0,-1,0),h=this.r.m.Oa(h),l=Sc(this.r.wa,h),h=new P(0,0,1),h=this.r.m.Oa(h),q=Sc(this.r.wa,h),h=new P(0,0,-1),h=this.r.m.Oa(h),h=Sc(this.r.wa,h),p=Math.max(k,j,q,m,l,h);p==k||p==m?we(g,0):p==j||p==l?we(g,1):(p==q||p==h)&&we(g,2)}}if(this.X.ORDERING_ENABLED){k=s;f=this.Ua;
g=f.length-1;do if(e=f[g],e instanceof N&&e.Ka){m=e.Ab;k=e.S.d;1==m?k=e.T.d:2==m&&(k=e.bb.d);m=k.length;j=k[0];j.Z=sg(this,j);j.aa=e.aa;l=k[m-1];l.Z=sg(this,l);l.aa=e.aa;l=Math.round(1E3*((l.Z-j.Z)/m))/1E3;for(q=q=1;q<m-1;q++)h=Math.round(1E3*(j.Z+q*l))/1E3,k[q].Z=h,k[q].aa=e.aa;k=o}while(g--);f=this.ab.v;g=f.length-1;do if(e=f[g],e.Ja&&!(1==e.aa||e instanceof ve))e.Z=sg(this,e),k=o;while(g--);k&&this.ab.sort()}if(f=!a&&x(b)&&b&&this.X.STATISTICS_ENABLED)var w=0,v=0,A=0,B=0;var e=this.ee,g=e.get("vertexPosition"),
k=e.get("vertexNormal"),m=e.get("vertexColor"),j=e.get("vertexTexturePos"),l=e.get("vertexScalar"),e=this.Uc,q=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),y=e.get("useScalars"),C=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),G=e.get("scalarsMax"),R=e.get("scalarsMinColor"),K=e.get("scalarsMaxColor"),O=e.get("scalarsMinThreshold"),da=e.get("scalarsMaxThreshold"),ba=e.get("objectOpacity"),ca=e.get("labelmapOpacity"),ua=e.get("useTexture"),gb=e.get("useLabelMapTexture"),
Ia=e.get("textureSampler"),Dc=e.get("textureSampler2"),ld=e.get("volumeLowerThreshold"),pb=e.get("volumeUpperThreshold"),md=e.get("volumeScalarMin"),Ib=e.get("volumeScalarMax"),ib=e.get("volumeWindowLow"),Gb=e.get("volumeWindowHigh"),Ec=e.get("volumeScalarMinColor"),Aa=e.get("volumeScalarMaxColor"),hb=e.get("volumeTexture"),jd=e.get("objectTransform"),id=e.get("pointSize"),e=d;do{var U=c[d-e];if(U){var V=r;U instanceof ve&&U.eb&&(V=U.eb);if(U.Ja&&(!V||V.Ja)){var ra=U.ta,Sa=U.Jc,Ba=this.Xc.get(ra),
$a=this.pe.get(ra),Yd=this.sd.get(ra),Hb=this.Ad.get(ra),Zd=this.Bd.get(ra);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ba.ka);this.a.vertexAttribPointer(g,Ba.qb,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,$a.ka);this.a.vertexAttribPointer(k,$a.qb,this.a.FLOAT,s,0,0);a?this.a.uniform1i(q,o):this.a.uniform1i(q,s);Yd&&!a&&!Sa?(this.a.uniform1i(h,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,Yd.ka),this.a.vertexAttribPointer(m,Yd.qb,this.a.FLOAT,s,0,0)):($a=1,Sa&&!a&&($a=0),this.a.uniform1i(h,$a),
$a=U.Gb,a&&($a=[Math.floor(ra%65025%255)/255,Math.floor(ra%65025/255)/255,Math.floor(ra/65025)/255]),this.a.uniform3f(p,parseFloat($a[0]),parseFloat($a[1]),parseFloat($a[2])),this.a.vertexAttribPointer(m,Ba.qb,this.a.FLOAT,s,0,0));Hb&&!a&&!Sa?(this.a.uniform1i(y,o),this.a.uniform1i(C,U.u.Ef),ra=U.u.tb,Sa=U.u.rb,this.a.uniform3f(R,parseFloat(ra[0]),parseFloat(ra[1]),parseFloat(ra[2])),this.a.uniform3f(K,parseFloat(Sa[0]),parseFloat(Sa[1]),parseFloat(Sa[2])),this.a.uniform1f(O,parseFloat(U.u.$)),this.a.uniform1f(da,
parseFloat(U.u.ba)),this.a.uniform1f(F,parseFloat(U.u.Ea)),this.a.uniform1f(G,parseFloat(U.u.ua)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Hb.ka),this.a.vertexAttribPointer(l,Hb.qb,this.a.FLOAT,s,0,0)):(this.a.uniform1i(y,s),this.a.vertexAttribPointer(l,Ba.qb,this.a.FLOAT,s,0,0));this.a.uniform1f(ba,parseFloat(U.aa));U.z&&Zd&&!a?(this.a.uniform1i(ua,o),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.Cd.get(U.z.ta)),this.a.uniform1i(Ia,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,
Zd.ka),this.a.vertexAttribPointer(j,Zd.qb,this.a.FLOAT,s,0,0),this.a.uniform1i(hb,s)):(this.a.uniform1i(ua,s),this.a.vertexAttribPointer(j,Ba.qb,this.a.FLOAT,s,0,0));V&&(this.a.uniform1i(hb,o),this.a.uniform1f(ld,V.$),this.a.uniform1f(pb,V.ba),this.a.uniform1f(md,V.Ea),this.a.uniform1f(Ib,V.ua),ra=V.tb,Sa=V.rb,this.a.uniform3f(Ec,parseFloat(ra[0]),parseFloat(ra[1]),parseFloat(ra[2])),this.a.uniform3f(Aa,parseFloat(Sa[0]),parseFloat(Sa[1]),parseFloat(Sa[2])),this.a.uniform1f(ib,V.fa),this.a.uniform1f(Gb,
V.ea),Hb=V.n,this.a.uniform1i(gb,s),V.Ka?this.a.uniform1f(ba,parseFloat(V.aa)):Hb&&Hb.Ja&&(V=U.n.ta,this.a.uniform1i(gb,o),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Cd.get(V)),this.a.uniform1i(Dc,1),this.a.uniform1f(ca,Hb.aa)));this.a.uniformMatrix4fv(jd,s,U.Xb.uf);V=1;"POINTS"==U.la&&(V=U.Sc);this.a.uniform1f(id,V);V=-1;U.la==qd?(V=this.a.TRIANGLES,f&&(v+=Ba.pb/3)):"LINES"==U.la?(this.a.lineWidth(U.pc),V=this.a.LINES,f&&(A+=Ba.pb/2)):"POINTS"==U.la?(V=this.a.POINTS,
f&&(B+=Ba.pb)):"TRIANGLE_STRIPS"==U.la?(V=this.a.TRIANGLE_STRIP,f&&(v+=Ba.pb/3)):"POLYGONS"==U.la&&(V=0==Ba.pb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(v+=Ba.pb/3));f&&(w+=Ba.pb);this.a.drawArrays(V,0,Ba.pb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(v)+" | "),c=c+("Lines: "+A+" | ")+("Points: "+B+" | ")+("Textures: "+this.Cd.pa()),window.console.log(c))}};
u.Ld=function(){this.se=r;delete this.se;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Of.i.Ld.call(this)};E("X.renderer3D",Of);E("X.renderer3D.prototype.init",Of.prototype.ma);E("X.renderer3D.prototype.add",Of.prototype.add);E("X.renderer3D.prototype.onShowtime",Of.prototype.pg);E("X.renderer3D.prototype.resetRender",Of.prototype.ni);E("X.renderer3D.prototype.onRender",Of.prototype.ng);E("X.renderer3D.prototype.get",Of.prototype.get);E("X.renderer3D.prototype.render",Of.prototype.gc);
E("X.renderer3D.prototype.destroy",Of.prototype.Ld);E("X.renderer3D.prototype.resetBoundingBox",Of.prototype.mi);E("X.renderer3D.prototype.resetViewAndRender",Of.prototype.Ac);E("X.renderer3D.prototype.pick",Of.prototype.tg);function Re(){W.call(this);this.c="parserDX"}H(Re,W);
Re.prototype.parse=function(a,b,c){I.sa(this.c+".parse");this.P=c;for(var d=Y(this,"uchar",c.byteLength),e=new Q(c.byteLength),f=new Q(c.byteLength),g=0,h=0;h<d.length;){if(10==d[h]){var k=String.fromCharCode.apply(r,d.subarray(g,h));if(!k){h++;g=h;continue}k=k.replace(/^\s+|\s+$/g,"");if("object"==k.split(" ")[0])a:{for(var k=e,m=f,j=d,l=g,q=h,l=String.fromCharCode.apply(r,j.subarray(l,q)).replace(/^\s+|\s+$/g,""),l=l.split(" "),p=0,w=r,g=0;g<l.length;g++){var v=l[g];if("type"==v)g++,w=l[g];else if("items"==
v)g++,p=parseInt(l[g]);else if("shape"==v&&(g++,"3"!=l[g]))break a}if(!(0==p||w==r)){v=new Q(3*p);q++;for(var l=q,A=0;q<j.length;){if(10==j[q]){l=String.fromCharCode.apply(r,j.subarray(l,q));if(!l){q++;l=g;continue}l=l.replace(/^\s+|\s+$/g,"");l=l.split(" ");if("float"==w){var B=parseFloat(l[0]),y=parseFloat(l[1]),l=parseFloat(l[2]);v.add(B,y,l)}else"int"==w&&(B=parseInt(l[0]),y=parseInt(l[1]),l=parseInt(l[2]),v.add(B,y,l));A++;l=q+1}q++;if(A>=p)break}for(;q<j.length;){if(10==j[q]){l=String.fromCharCode.apply(r,
j.subarray(l,q));if(!l)break;l=l.replace(/^\s+|\s+$/g,"");if(-1!=l.indexOf('"dep"')&&-1!=l.indexOf('"positions"')){for(g=0;g<v.count;g++)j=v.get(g),k.add(j[0],j[1],j[2]);break}else if(-1!=l.indexOf('"dep"')&&-1!=l.indexOf('"connections"')){for(g=0;g<v.count;g++)j=v.get(g),m.add(j[0],j[1],j[2]);break}l=q+1}q++}}}g=h+1}h++}d=b.g=new Q(c.byteLength);c=b.h=new Q(c.byteLength);for(h=0;h<f.count;h++)k=f.get(h),q=e.get(k[0]),j=e.get(k[1]),w=e.get(k[2]),d.add(q[0],q[1],q[2]),d.add(j[0],j[1],j[2]),d.add(w[0],
w[1],w[2]),k=j[0]-q[0],m=j[1]-q[1],p=j[2]-q[2],j=w[0]-q[0],g=w[1]-q[1],w=w[2]-q[2],q=m*w-p*g,p=p*j-k*w,k=k*g-m*j,m=Math.sqrt(Math.pow(q,2)+Math.pow(p,2)+Math.pow(k,2)),j=q/m,g=p/m,k/=m,c.add(j,g,k),c.add(j,g,k),c.add(j,g,k);I.na(this.c+".parse");e=new td;e.R=b;e.p=a;this.dispatchEvent(e)};E("X.parserDX",Re);E("X.parserDX.prototype.parse",Re.prototype.parse);function $(){Nf.call(this);this.c="renderer2D";this.vf=this.he=this.tf=this.ge=this.ub=r;this.zd=this.Tb=this.Ub=this.te=this.ue=0}H($,Nf);$.prototype.Zh=aa();$.prototype.$h=aa();$.prototype.bf=function(a){$.i.bf.call(this,a);var b=this.Ua[0];if(b){var c=this.ub;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
$.prototype.ai=function(a){var b=this.Ua[0];if(b){var c=b.ea-b.fa,d=c/2,e=parseInt(c+c/15*-a.xe,10),a=parseInt(d+d/15*a.me,10);c==e&&e++;d==a&&a++;b.fa-=parseInt(d-a,10);b.fa-=parseInt(c-e,10);b.fa=Math.max(b.fa,b.Ea);b.ea-=parseInt(d-a,10);b.ea+=parseInt(c-e,10);b.ea=Math.min(b.ea,b.ua);eval("this.onWindowLevel();")}};$.prototype.__defineGetter__("orientation",t("ub"));
$.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.ub=a});u=$.prototype;u.ma=function(){this.ub||i(Error("No 2D orientation set."));$.i.ma.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ja.width,this.ja.height);this.ge=ke("canvas");this.he=ke("canvas");L(this.r,Ed,this.ai.bind(this))};u.rotate=function(){this.zd++};u.oi=function(){this.zd--};
u.Ac=function(){$.i.Ac.call(this);tg(this);var a=this.Ua[0];a&&(a.ea=a.ua,a.fa=a.Ea)};
u.Za=function(a){$.i.Za.call(this,a);var b=s;this.get(a.ta)&&(b=o);var c=a.t,d=a.n,e=a.O;if(x(d)&&x(d.t)&&d.t.e)this.Za(d);else if(x(e)&&x(e.t)&&e.t.e)this.Q.load(e,a);else{if(x(c)&&z(c))if(x(a.hc)){if(a.hc.Td!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.Q.load(c[b],a);return}else if(x(c)&&c.e){this.Q.load(a,a);return}var d=c=0,e=a.Y,f=a.C;"X"==this.ub?(this.Vb=a.S.d,c=e[1],d=e[2],this.Ub=f[1],this.Tb=f[2]):"Y"==this.ub?(this.Vb=a.T.d,c=e[0],d=e[2],this.Ub=f[0],this.Tb=f[2]):
"Z"==this.ub&&(this.Vb=a.bb.d,c=e[0],d=e[1],this.Ub=f[0],this.Tb=f[1]);this.ue=c;this.te=d;e=this.ge;e.width=c;e.height=d;f=this.he;f.width=c;f.height=d;this.tf=e.getContext("2d");this.vf=f.getContext("2d");b||(this.ab.add(a),tg(this))}};function tg(a){var b=Math.min(a.K/a.ue*a.Ub,a.G/a.te*a.Tb);a.r.m.k(2,3,10*b-10)}
u.Db=function(a,b){$.i.Db.call(this,a,b);if(0!=this.ab.v.length){var c=this.K,d=this.G,e=this.r.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.V(0,3),g=-1*e.V(1,3),h=Math.max(1+e.V(2,3)/10,0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Ua[0],k=this.Vb[parseInt(e["index"+this.ub],10)],m=k.z.xa,k=k.n,j=r;k&&(j=k.xa);var l=this.ue,q=this.te,p=this.tf,w=this.vf,v=p.getImageData(0,0,l,q),A=w.getImageData(0,0,l,q),B=v.data,y=A.data,C=B.length,F=e.ua,G=e.$,R=e.ba,K=0;do{var O=
[0,0,0,0],da=[0,0,0,0],ba=m[K]/255*F,ca=m[K],ua=e.fa/F,ca=(ca/255-ua)/(e.ea/F-ua),ca=255*ca;ba>=G&&ba<=R&&(O=new P(e.tb[0],e.tb[1],e.tb[2]),O=(new P(e.rb[0],e.rb[1],e.rb[2])).scale(ca).add(O.scale(255-ca)),O=[Math.floor(O.x),Math.floor(O.y),Math.floor(O.b),255],k&&(da=[j[K],j[K+1],j[K+2],j[K+3]]));ca=C-1-K;B[ca-3]=O[0];B[ca-2]=O[1];B[ca-1]=O[2];B[ca]=O[3];y[ca-3]=da[0];y[ca-2]=da[1];y[ca-1]=da[2];y[ca]=da[3];K+=4}while(K<C);p.putImageData(v,0,0);w.putImageData(A,0,0);this.a.globalAlpha=1;this.a.translate(c/
2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.zd);switch(this.zd%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-l*this.Ub/2+f;g=-q*this.Tb/2+g;this.a.drawImage(this.ge,f,g,l*this.Ub,q*this.Tb);k&&e.n.Ja&&(this.a.globalAlpha=e.n.aa,this.a.drawImage(this.he,f,g,l*this.Ub,q*this.Tb))}};E("X.renderer2D",$);E("X.renderer2D.prototype.init",$.prototype.ma);E("X.renderer2D.prototype.add",$.prototype.add);E("X.renderer2D.prototype.onShowtime",$.prototype.pg);
E("X.renderer2D.prototype.onRender",$.prototype.ng);E("X.renderer2D.prototype.onScroll",$.prototype.Zh);E("X.renderer2D.prototype.onWindowLevel",$.prototype.$h);E("X.renderer2D.prototype.get",$.prototype.get);E("X.renderer2D.prototype.rotate",$.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",$.prototype.oi);E("X.renderer2D.prototype.resetViewAndRender",$.prototype.Ac);E("X.renderer2D.prototype.render",$.prototype.gc);E("X.renderer2D.prototype.destroy",$.prototype.Ld);function ug(){T.call(this);this.c="fibers";ya(this,new Pc)}H(ug,T);E("X.fibers",ug);function vg(){T.call(this);this.c="mesh";ya(this,new Pc)}H(vg,T);E("X.mesh",vg);
