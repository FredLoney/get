/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function n(a){throw a;}var p=void 0,q=!0,t=null,u=!1;function da(){return function(){}}function ea(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}var w,fa=this;function ga(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==p}function ka(a){return"array"==ha(a)}function la(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ma(a){return"string"==typeof a}function x(a){return"number"==typeof a}function na(a){return"function"==ha(a)}function oa(a){var b=typeof a;return"object"==b&&a!=t||"function"==b}function pa(a){return a[qa]||(a[qa]=++ra)}var qa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;
function sa(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||n(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sa:ta;return ua.apply(t,arguments)}
function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};function B(a,b){var c=a.split("."),d=fa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}
function C(a,b){function c(){}c.prototype=b.prototype;a.u=b.prototype;a.prototype=new c;a.prototype.constructor=a};function xa(a,b,c){this.Na=this.Ma=this.La=0;3==arguments.length?(this.La=Number(a),this.Ma=Number(b),this.Na=Number(c)):a instanceof xa?(this.La=Number(a.x()),this.Ma=Number(a.y()),this.Na=Number(a.c())):(this.La=Number(a[0]),this.Ma=Number(a[1]),this.Na=Number(a[2]))}
xa.prototype={i:function(){return new xa(this.La,this.Ma,this.Na)},Yb:function(a){return this.La*a.x()+this.Ma*a.y()+this.Na*a.c()},de:function(a,b){return za(this,Aa(Ba(a,this),b))},length:function(){return Math.sqrt(this.Yb(this))},gc:function(a){return new xa(this.Ma*a.c()-this.Na*a.y(),this.Na*a.x()-this.La*a.c(),this.La*a.y()-this.Ma*a.x())},x:v("La"),y:v("Ma"),c:v("Na")};function Ca(a){var b=a.length();return new xa(a.La/b,a.Ma/b,a.Na/b)}
function Aa(a,b){return new xa(a.La*b,a.Ma*b,a.Na*b)}function Ba(a,b){return new xa(a.La-b.x(),a.Ma-b.y(),a.Na-b.c())}function za(a,b){return new xa(a.La+b.x(),a.Ma+b.y(),a.Na+b.c())}function Da(a){return new xa(-a.La,-a.Ma,-a.Na)};var H=H||{};H.Tj=q;H.Ta=function(a){eval("X.DEV === undefined")||window.console.time(a)};H.Oa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Mh=0;this.Pj=function(){return this.Mh++}};function Ea(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}}var Fa=window.Bh;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&n(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ga=0,Ha=["ms","moz","webkit","o"],Ia=0;Ia<Ha.length&&!window.requestAnimationFrame;++Ia)window.requestAnimationFrame=window[Ha[Ia]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ha[Ia]+"CancelAnimationFrame"]||window[Ha[Ia]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ga)),d=window.setTimeout(function(){a(b+c)},c);Ga=b+c;return d});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&n(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});B("$",Fa);B("Function.prototype.bind",Function.prototype.bind);
B("window.requestAnimationFrame",window.requestAnimationFrame);B("window.cancelAnimationFrame",window.cancelAnimationFrame);var Ja=0;function Ka(){}w=Ka.prototype;w.key=0;w.kc=u;w.Rd=u;w.ra=function(a,b,c,d,e,f){na(a)?this.Qg=q:a&&a.handleEvent&&na(a.handleEvent)?this.Qg=u:n(Error("Invalid listener argument"));this.Zb=a;this.ih=b;this.src=c;this.type=d;this.capture=!!e;this.ef=f;this.Rd=u;this.key=++Ja;this.kc=u};w.handleEvent=function(a){return this.Qg?this.Zb.call(this.ef||this.src,a):this.Zb.handleEvent.call(this.Zb,a)};function La(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}var Na="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Oa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Na.length;f++)c=Na[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Pa(a){if(!Qa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ra,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Sa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ta,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ua,"&quot;"));return a}var Ra=/&/g,Sa=/</g,Ta=/>/g,Ua=/\"/g,Qa=/[&<>\"]/;var Va,Wa,Xa,Ya,Za,$a,ab;function cb(){return fa.navigator?fa.navigator.userAgent:t}function db(){return fa.navigator}Ya=Xa=Wa=Va=u;var eb;if(eb=cb()){var fb=db();Va=0==eb.indexOf("Opera");Wa=!Va&&-1!=eb.indexOf("MSIE");Xa=!Va&&-1!=eb.indexOf("WebKit");Ya=!Va&&!Xa&&"Gecko"==fb.product}var gb=Va,L=Wa,ib=Ya,jb=Xa,kb,mb=db();kb=mb&&mb.platform||"";Za=-1!=kb.indexOf("Mac");$a=-1!=kb.indexOf("Win");ab=-1!=kb.indexOf("Linux");var nb=!!db()&&-1!=(db().appVersion||"").indexOf("X11");
function ob(){var a=fa.document;return a?a.documentMode:p}var pb;a:{var qb="",rb;if(gb&&fa.opera)var sb=fa.opera.version,qb="function"==typeof sb?sb():sb;else if(ib?rb=/rv\:([^\);]+)(\)|;)/:L?rb=/MSIE\s+([^\);]+)(\)|;)/:jb&&(rb=/WebKit\/(\S+)/),rb)var tb=rb.exec(cb()),qb=tb?tb[1]:"";if(L){var ub=ob();if(ub>parseFloat(qb)){pb=String(ub);break a}}pb=qb}var vb={};
function wb(a){var b;if(!(b=vb[a])){b=0;for(var c=String(pb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var j=l.exec(g)||["","",""],m=k.exec(h)||["","",""];if(0==j[0].length&&0==m[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==j[2].length)<(0==m[2].length)?-1:(0==j[2].length)>(0==m[2].length)?1:0)||(j[2]<m[2]?-1:j[2]>m[2]?1:0)}while(0==b)}b=vb[a]=0<=b}return b}var xb=fa.document,yb=!xb||!L?p:ob()||("CSS1Compat"==xb.compatMode?parseInt(pb,10):5);var zb=!L||L&&9<=yb,Ab=L&&!wb("9");!jb||wb("528");ib&&wb("1.9b")||L&&wb("8")||gb&&wb("9.5")||jb&&wb("528");ib&&!wb("8")||L&&wb("9");var Bb=Array.prototype,Db=Bb.indexOf?function(a,b,c){return Bb.indexOf.call(a,b,c)}:function(a,b,c){c=c==t?0:0>c?Math.max(0,a.length+c):c;if(ma(a))return!ma(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Eb=Bb.forEach?function(a,b,c){Bb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Fb=Bb.map?function(a,b,c){return Bb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ma(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Gb=Bb.some?function(a,b,c){return Bb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ma(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return q;return u};function Hb(a,b){var c=Db(a,b);0<=c&&Bb.splice.call(a,c,1)}function Ib(a,b,c){return 2>=arguments.length?Bb.slice.call(a,b):Bb.slice.call(a,b,c)};function Jb(){0!=Kb&&(this.Sk=Error().stack,pa(this))}var Kb=0;function Lb(a,b){this.type=a;this.currentTarget=this.target=b}w=Lb.prototype;w.jc=u;w.defaultPrevented=u;w.ie=q;w.stopPropagation=function(){this.jc=q};w.preventDefault=function(){this.defaultPrevented=q;this.ie=u};function Mb(a){Mb[" "](a);return a}Mb[" "]=ga;function Nb(a,b){a&&this.ra(a,b)}C(Nb,Lb);w=Nb.prototype;w.target=t;w.relatedTarget=t;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=u;w.altKey=u;w.shiftKey=u;w.metaKey=u;w.xj=u;w.gb=t;
w.ra=function(a,b){var c=this.type=a.type;Lb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(ib){var e;a:{try{Mb(d.nodeName);e=q;break a}catch(f){}e=u}e||(d=t)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=jb||a.offsetX!==p?a.offsetX:a.layerX;this.offsetY=jb||a.offsetY!==p?a.offsetY:a.layerY;this.clientX=a.clientX!==p?a.clientX:a.pageX;this.clientY=a.clientY!==p?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.xj=Za?a.metaKey:a.ctrlKey;this.state=a.state;this.gb=a;a.defaultPrevented&&this.preventDefault();delete this.jc};w.stopPropagation=function(){Nb.u.stopPropagation.call(this);this.gb.stopPropagation?this.gb.stopPropagation():this.gb.cancelBubble=q};
w.preventDefault=function(){Nb.u.preventDefault.call(this);var a=this.gb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=u,Ab)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.ti=v("gb");var Ob={},Pb={},Qb={},Rb={};function P(a,b,c,d,e){if(ka(b)){for(var f=0;f<b.length;f++)P(a,b[f],c,d,e);return t}a=Sb(a,b,c,u,d,e);b=a.key;Ob[b]=a;return b}
function Sb(a,b,c,d,e,f){b||n(Error("Invalid event type"));e=!!e;var g=Pb;b in g||(g[b]={ca:0,Da:0});g=g[b];e in g||(g[e]={ca:0,Da:0},g.ca++);var g=g[e],h=pa(a),l;g.Da++;if(g[h]){l=g[h];for(var k=0;k<l.length;k++)if(g=l[k],g.Zb==c&&g.ef==f){if(g.kc)break;d||(l[k].Rd=u);return l[k]}}else l=g[h]=[],g.ca++;var j=Tb,m=zb?function(a){return j.call(m.src,m.Zb,a)}:function(a){a=j.call(m.src,m.Zb,a);if(!a)return a},k=m,g=new Ka;g.ra(c,k,a,b,e,f);g.Rd=d;k.src=a;k.Zb=g;l.push(g);Qb[h]||(Qb[h]=[]);Qb[h].push(g);
a.addEventListener?(a==fa||!a.customEvent_)&&a.addEventListener(b,k,e):a.attachEvent(b in Rb?Rb[b]:Rb[b]="on"+b,k);return g}function Ub(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)Ub(a,b[f],c,d,e);else a=Sb(a,b,c,q,d,e),Ob[a.key]=a}function Vb(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)Vb(a,b[f],c,d,e);else{d=!!d;a:{f=Pb;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=t}if(a)for(f=0;f<a.length;f++)if(a[f].Zb==c&&a[f].capture==d&&a[f].ef==e){Wb(a[f].key);break}}}
function Wb(a){var b=Ob[a];if(!b||b.kc)return u;var c=b.src,d=b.type,e=b.ih,f=b.capture;c.removeEventListener?(c==fa||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Rb?Rb[d]:Rb[d]="on"+d,e);c=pa(c);Qb[c]&&(e=Qb[c],Hb(e,b),0==e.length&&delete Qb[c]);b.kc=q;if(b=Pb[d][f][c])b.Yg=q,Xb(d,f,c,b);delete Ob[a];return q}
function Xb(a,b,c,d){if(!d.fe&&d.Yg){for(var e=0,f=0;e<d.length;e++)d[e].kc?d[e].ih.src=t:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Yg=u;0==f&&(delete Pb[a][b][c],Pb[a][b].ca--,0==Pb[a][b].ca&&(delete Pb[a][b],Pb[a].ca--),0==Pb[a].ca&&delete Pb[a])}}function Yb(a,b,c,d,e){var f=1;b=pa(b);if(a[b]){var g=--a.Da,h=a[b];h.fe?h.fe++:h.fe=1;try{for(var l=h.length,k=0;k<l;k++){var j=h[k];j&&!j.kc&&(f&=Zb(j,e)!==u)}}finally{a.Da=Math.max(g,a.Da),h.fe--,Xb(c,d,b,h)}}return Boolean(f)}
function Zb(a,b){a.Rd&&Wb(a.key);return a.handleEvent(b)}
function Tb(a,b){if(a.kc)return q;var c=a.type,d=Pb;if(!(c in d))return q;var d=d[c],e,f;if(!zb){var g;if(!(g=b))a:{g=["window","event"];for(var h=fa;e=g.shift();)if(h[e]!=t)h=h[e];else{g=t;break a}g=h}e=g;g=q in d;h=u in d;if(g){if(0>e.keyCode||e.returnValue!=p)return q;a:{var l=u;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(k){l=q}if(l||e.returnValue==p)e.returnValue=q}}l=new Nb;l.ra(e,this);e=q;try{if(g){for(var j=[],m=l.currentTarget;m;m=m.parentNode)j.push(m);f=d[q];f.Da=f.ca;for(var r=j.length-
1;!l.jc&&0<=r&&f.Da;r--)l.currentTarget=j[r],e&=Yb(f,j[r],c,q,l);if(h){f=d[u];f.Da=f.ca;for(r=0;!l.jc&&r<j.length&&f.Da;r++)l.currentTarget=j[r],e&=Yb(f,j[r],c,u,l)}}else e=Zb(a,l)}finally{j&&(j.length=0)}return e}c=new Nb(b,this);return e=Zb(a,c)}var $b=0;function ac(a){return a+"_"+$b++};function bc(){Jb.call(this);this.Vk={};this.Qk=this}C(bc,Jb);bc.prototype.customEvent_=q;w=bc.prototype;w.uf=t;w.Af=ea("uf");w.addEventListener=function(a,b,c,d){P(this,a,b,c,d)};w.removeEventListener=function(a,b,c,d){Vb(this,a,b,c,d)};
w.dispatchEvent=function(a){var b=a.type||a,c=Pb;if(b in c){if(ma(a))a=new Lb(a,this);else if(a instanceof Lb)a.target=a.target||this;else{var d=a;a=new Lb(b,this);Oa(a,d)}var d=1,e,c=c[b],b=q in c,f;if(b){e=[];for(f=this;f;f=f.uf)e.push(f);f=c[q];f.Da=f.ca;for(var g=e.length-1;!a.jc&&0<=g&&f.Da;g--)a.currentTarget=e[g],d&=Yb(f,e[g],a.type,q,a)&&a.ie!=u}if(u in c)if(f=c[u],f.Da=f.ca,b)for(g=0;!a.jc&&g<e.length&&f.Da;g++)a.currentTarget=e[g],d&=Yb(f,e[g],a.type,u,a)&&a.ie!=u;else for(e=this;!a.jc&&
e&&f.Da;e=e.uf)a.currentTarget=e,d&=Yb(f,e,a.type,u,a)&&a.ie!=u;a=Boolean(d)}else a=q;return a};function Q(){bc.call(this);this.f="base";this.na=window["X.counter"].Pj();this.h=u}C(Q,bc);Q.prototype.__defineGetter__("classname",v("f"));Q.prototype.__defineGetter__("id",v("na"));B("X.base",Q);function cc(a,b){this.Ja=new xa(a);this.la=new xa(b)}cc.prototype={i:function(){return new cc(this.Ja.i(),this.la.i())},ic:function(){this.la=Da(this.la)}};function dc(a,b){this.la=a;this.vd=b}dc.prototype={i:function(){return new dc(this.la.i(),this.vd)},ic:function(){this.la=Da(this.la);this.vd=-this.vd}};function ec(a,b){this.Eb=a;this.pe=b;var c=a[0].Ja,d=a[2].Ja,d=Ca(Ba(a[1].Ja,c).gc(Ba(d,c)));this.Ia=new dc(d,d.Yb(c))}ec.prototype={i:function(){var a=this.Eb.map(function(a){return a.i()});return new ec(a,this.pe)},ic:function(){this.Eb.reverse().map(function(a){a.ic()});this.Ia.ic()}};
function fc(a,b,c,d,e,f){for(var g=0,h=[],l=0;l<a.Eb.length;l++){var k=b.la.Yb(a.Eb[l].Ja)-b.vd,k=-1E-5>k?2:1E-5<k?1:0,g=g|k;h.push(k)}switch(g){case 0:(0<b.la.Yb(a.Ia.la)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:c=[];d=[];for(l=0;l<a.Eb.length;l++){var j=(l+1)%a.Eb.length,k=h[l],m=h[j],g=a.Eb[l],j=a.Eb[j];2!=k&&c.push(g);1!=k&&d.push(2!=k?g.i():g);3==(k|m)&&(k=(b.vd-b.la.Yb(g.Ja))/b.la.Yb(Ba(j.Ja,g.Ja)),k=new cc(g.Ja.de(j.Ja,k),g.la.de(j.la,k)),c.push(k),d.push(k.i()))}3<=
c.length&&e.push(new ec(c,a.pe));3<=d.length&&f.push(new ec(d,a.pe))}};function gc(a){this.pa=this.qa=this.Ia=t;this.L=[];a&&hc(this,a)}gc.prototype={i:function(){var a=new gc,b=this.Ia&&this.Ia.i();a.Ia=b;b=this.qa&&this.qa.i();a.qa=b;b=this.pa&&this.pa.i();a.pa=b;a.ne(this.L.map(function(a){return a.i()}));return a},K:function(){for(var a=0;a<this.L.length;a++)this.L[a].ic();this.Ia.ic();this.qa&&this.qa.K();this.pa&&this.pa.K();a=this.qa;this.qa=this.pa;this.pa=a},ne:ea("L")};
function hc(a,b){if(b.length){a.Ia||(a.Ia=b[0].Ia.i());for(var c=[],d=[],e=0;e<b.length;e++)fc(b[e],a.Ia,a.L,a.L,c,d);c.length&&(a.qa||(a.qa=new gc),hc(a.qa,c));d.length&&(a.pa||(a.pa=new gc),hc(a.pa,d))}}function ic(a){var b=a.L.slice();a.qa&&(b=b.concat(ic(a.qa)));a.pa&&(b=b.concat(ic(a.pa)));return b}function jc(a,b){a.L=kc(b,a.L);a.qa&&jc(a.qa,b);a.pa&&jc(a.pa,b)}
function kc(a,b){if(!a.Ia)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)fc(b[e],a.Ia,c,d,c,d);a.qa&&(c=kc(a.qa,c));d=a.pa?kc(a.pa,d):[];return c.concat(d)};function lc(){this.L=[]}function mc(a){var b=new lc;b.ne(a);return b}
lc.prototype={i:function(){var a=new lc;a.ne(this.L.map(function(a){return a.i()}));return a},Kf:function(a){var b=new gc(this.i().L);a=new gc(a.i().L);jc(b,a);jc(a,b);a.K();jc(a,b);a.K();hc(b,ic(a));return mc(ic(b))},ya:function(a){var b=new gc(this.i().L);a=new gc(a.i().L);b.K();jc(b,a);jc(a,b);a.K();jc(a,b);a.K();hc(b,ic(a));b.K();return mc(ic(b))},gf:function(a){var b=new gc(this.i().L);a=new gc(a.i().L);b.K();jc(a,b);a.K();jc(b,a);jc(a,b);hc(b,ic(a));b.K();return mc(ic(b))},inverse:function(){var a=
this.i();a.L.map(function(a){a.ic()});return a},ne:ea("L")};function nc(){Q.call(this);this.f="indexer";this.Qe=[];this.Lk=[];this.lb={}}C(nc,Q);nc.prototype.add=function(a){a==t&&n(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.lb||(this.lb[b]=this.Qe.length,this.Qe.push(a));return this.lb[b]};nc.prototype.unique=v("Qe");function oc(a){Q.call(this);this.f="file";this.Kd=a;this.h=q}C(oc,Q);function pc(){this.ib=this.o=t}pc.prototype.__defineSetter__("file",function(a){if(a==t||ka(a)&&0==a.length)this.o=t;else{if(ka(a)){if(1==a.length){this.o=new oc(a[0]);return}this.o=Fb(a,function(a){var c=new S;c.o=new oc(a);return c})}else this.o=new oc(a);this.ib=t}});pc.prototype.__defineGetter__("file",function(){return!this.o?"":ka(this.o)?this.o.map(function(a){return a.o.Kd}):this.o.Kd});
pc.prototype.__defineGetter__("filedata",function(){return ka(this.o)?this.o.map(function(a){return a.ib}):this.ib});pc.prototype.__defineSetter__("filedata",function(a){if(a==t||ka(a)&&0==a.length)this.ib=t;if(ka(a))if(1==a.length)this.ib=a[0];else{var b=this.o.length,c;for(c=0;c<b;c++)this.o[c].ib=a[c]}else this.ib=a});function qc(a){if("function"==typeof a.md)return a.md();if(ma(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return La(a)};function rc(a,b){this.R={};this.G=[];var c=arguments.length;if(1<c){c%2&&n(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Se(a)}w=rc.prototype;w.ca=0;w.Mf=0;w.Xd=v("ca");w.md=function(){sc(this);for(var a=[],b=0;b<this.G.length;b++)a.push(this.R[this.G[b]]);return a};function tc(a){for(var b=0;b<a.G.length;b++){var c=a.G[b];if(uc(a.R,c)&&a.R[c]==u)return q}return u}w.clear=function(){this.R={};this.Mf=this.ca=this.G.length=0};
w.remove=function(a){return uc(this.R,a)?(delete this.R[a],this.ca--,this.Mf++,this.G.length>2*this.ca&&sc(this),q):u};function sc(a){if(a.ca!=a.G.length){for(var b=0,c=0;b<a.G.length;){var d=a.G[b];uc(a.R,d)&&(a.G[c++]=d);b++}a.G.length=c}if(a.ca!=a.G.length){for(var e={},c=b=0;b<a.G.length;)d=a.G[b],uc(e,d)||(a.G[c++]=d,e[d]=1),b++;a.G.length=c}}w.get=function(a,b){return uc(this.R,a)?this.R[a]:b};w.set=function(a,b){uc(this.R,a)||(this.ca++,this.G.push(a),this.Mf++);this.R[a]=b};
w.Se=function(a){var b;if(a instanceof rc)sc(a),b=a.G.concat(),a=a.md();else{b=[];var c=0,d;for(d in a)b[c++]=d;a=La(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.i=function(){return new rc(this)};w.Jf=function(){for(var a=new rc,b=0;b<this.G.length;b++){var c=this.G[b];a.set(this.R[c],c)}return a};function uc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function vc(){Q.call(this);this.f="colortable";this.lb=new rc;Ea(this,new pc)}C(vc,Q);vc.prototype.add=function(a,b,c,d,e,f){(!x(a)||!x(c)||!x(d)||!x(e)||!x(f))&&n(Error("Invalid color table entry."));this.lb.set(a,[b,c,d,e,f]);this.h=q};vc.prototype.get=function(a){return this.lb.get(a)};B("X.colortable.prototype.get",vc.prototype.get);function wc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.c=ia(c)?c:0}wc.prototype.i=function(){return new wc(this.x,this.y,this.c)};function T(a,b,c){this.x=a;this.y=b;this.c=c}C(T,wc);w=T.prototype;w.i=function(){return new T(this.x,this.y,this.c)};w.Bb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.c*this.c)};w.scale=function(a){this.x*=a;this.y*=a;this.c*=a;return this};w.K=function(){this.x=-this.x;this.y=-this.y;this.c=-this.c;return this};w.normalize=function(){return this.scale(1/this.Bb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.c+=a.c;return this};
w.ya=function(a){this.x-=a.x;this.y-=a.y;this.c-=a.c;return this};function xc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.c-b.c;return Math.sqrt(c*c+d*d+e*e)}function yc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.c-b.c;return c*c+d*d+e*e}function zc(a,b){return new T(a.x+b.x,a.y+b.y,a.c+b.c)}function Ac(a,b){return new T(a.y*b.c-a.c*b.y,a.c*b.x-a.x*b.c,a.x*b.y-a.y*b.x)};H.j=T;w=H.j.prototype;w.i=T.prototype.i;w.Bb=T.prototype.Bb;w.scale=T.prototype.scale;w.K=T.prototype.K;w.add=T.prototype.add;w.ya=T.prototype.ya;w.normalize=function(){var a=this.Bb();return 0==a?this.scale(0):this.scale(1/a)};H.j.Yb=function(a,b){return a.x*b.x+a.y*b.y+a.c*b.c};H.j.gc=Ac;H.j.df=xc;H.j.de=function(a,b,c){return new T(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.c+c*(b.c-a.c))};H.j.prototype.__defineGetter__("xx",v("x"));H.j.prototype.__defineGetter__("yy",v("y"));
H.j.prototype.__defineGetter__("zz",v("c"));B("X.vector",H.j);B("X.vector.prototype.clone",H.j.prototype.i);B("X.vector.prototype.magnitude",H.j.prototype.Bb);B("X.vector.prototype.scale",H.j.prototype.scale);B("X.vector.prototype.invert",H.j.prototype.K);B("X.vector.prototype.normalize",H.j.prototype.normalize);B("X.vector.prototype.add",H.j.prototype.add);B("X.vector.prototype.subtract",H.j.prototype.ya);B("X.vector.dot",H.j.Yb);B("X.vector.cross",H.j.gc);B("X.vector.distance",H.j.df);
B("X.vector.lerp",H.j.de);function Bc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Bc.prototype.BYTES_PER_ELEMENT=8;Bc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Bc.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Bc.BYTES_PER_ELEMENT=8}catch(Cc){}Bc.prototype.BYTES_PER_ELEMENT=Bc.prototype.BYTES_PER_ELEMENT;Bc.prototype.set=Bc.prototype.set;Bc.prototype.toString=Bc.prototype.toString;B("Float64Array",Bc)};function Dc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Dc.prototype.BYTES_PER_ELEMENT=4;Dc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Dc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Dc.BYTES_PER_ELEMENT=4,Dc.prototype.BYTES_PER_ELEMENT=Dc.prototype.BYTES_PER_ELEMENT,Dc.prototype.set=Dc.prototype.set,Dc.prototype.toString=Dc.prototype.toString,B("Float32Array",Dc));function Ec(a,b,c){var d=new Float32Array(3);d[0]=a;d[1]=b;d[2]=c;return d}function Ic(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c};function Jc(){return new Float32Array(4)}function Kc(a,b,c,d){var e=Jc();e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e};function Lc(){return new Float32Array(16)}function Mc(){var a=Lc();a[0]=a[5]=a[10]=a[15]=1;return a}function Nc(a,b,c,d,e,f,g,h,l,k,j,m,r,s,y,z,D){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=l;a[8]=k;a[9]=j;a[10]=m;a[11]=r;a[12]=s;a[13]=y;a[14]=z;a[15]=D;return a}function Oc(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function Pc(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function Qc(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f}
function Rc(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function Sc(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}
function Tc(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],l=a[5],k=a[6],j=a[7],m=a[8],r=a[9],s=a[10],y=a[11],z=a[12],D=a[13],E=a[14];a=a[15];var G=b[0],A=b[1],F=b[2],I=b[3],J=b[4],R=b[5],M=b[6],V=b[7],aa=b[8],Z=b[9],ba=b[10],K=b[11],N=b[12],O=b[13],hb=b[14];b=b[15];c[0]=d*G+h*A+m*F+z*I;c[1]=e*G+l*A+r*F+D*I;c[2]=f*G+k*A+s*F+E*I;c[3]=g*G+j*A+y*F+a*I;c[4]=d*J+h*R+m*M+z*V;c[5]=e*J+l*R+r*M+D*V;c[6]=f*J+k*R+s*M+E*V;c[7]=g*J+j*R+y*M+a*V;c[8]=d*aa+h*Z+m*ba+z*K;c[9]=e*aa+l*Z+r*ba+D*K;c[10]=f*aa+k*Z+s*ba+E*
K;c[11]=g*aa+j*Z+y*ba+a*K;c[12]=d*N+h*O+m*hb+z*b;c[13]=e*N+l*O+r*hb+D*b;c[14]=f*N+k*O+s*hb+E*b;c[15]=g*N+j*O+y*hb+a*b;return c}
function Uc(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],k=a[7],j=a[8],m=a[9],r=a[10],s=a[11],y=a[12],z=a[13],D=a[14],E=a[15],G=c*h-d*g,A=c*l-e*g,F=c*k-f*g,I=d*l-e*h,J=d*k-f*h,R=e*k-f*l,M=j*z-m*y,V=j*D-r*y,aa=j*E-s*y,Z=m*D-r*z,ba=m*E-s*z,K=r*E-s*D,N=G*K-A*ba+F*Z+I*aa-J*V+R*M;if(0==N)return u;N=1/N;b[0]=(h*K-l*ba+k*Z)*N;b[1]=(-d*K+e*ba-f*Z)*N;b[2]=(z*R-D*J+E*I)*N;b[3]=(-m*R+r*J-s*I)*N;b[4]=(-g*K+l*aa-k*V)*N;b[5]=(c*K-e*aa+f*V)*N;b[6]=(-y*R+D*F-E*A)*N;b[7]=(j*R-r*F+s*A)*N;b[8]=(g*ba-h*
aa+k*M)*N;b[9]=(-c*ba+d*aa-f*M)*N;b[10]=(y*J-z*F+E*G)*N;b[11]=(-j*J+m*F-s*G)*N;b[12]=(-g*Z+h*V-l*M)*N;b[13]=(c*Z-d*V+e*M)*N;b[14]=(-y*I+z*A-D*G)*N;b[15]=(j*I-m*A+r*G)*N;return q}function Vc(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8]+a[12];c[1]=d*a[1]+e*a[5]+b*a[9]+a[13];c[2]=d*a[2]+e*a[6]+b*a[10]+a[14]}
function Wc(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12];c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13];c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14];c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15];return c}function Xc(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];a[12]=a[0]*b+a[4]*c+a[8]*d+a[12];a[13]=e;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);H.d={};H.d.Tg=function(a,b,c,d){c=c.ya(b);c.normalize();d=H.j.gc(c,d);d.normalize();var e=H.j.gc(d,c);e.normalize();c.K();Qc(a,0,d.x,d.y,d.c,0);Qc(a,1,e.x,e.y,e.c,0);Qc(a,2,c.x,c.y,c.c,0);Xc(a,-b.x,-b.y,-b.c);return a};H.d.W=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new H.j((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};
H.d.Nj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Sc(a,b,d);Sc(a,c,e);Rc(a,b,e);Rc(a,c,d);return a};H.d.Mj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);Pc(a,b,d);Pc(a,c,e);Oc(a,b,e);Oc(a,c,d);return a};H.d.nd=Mc;H.d.i=function(a){var b=Lc();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
H.d.Jf=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
H.d.ii=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],l=a[7],k=a[8],j=a[9],m=a[10],r=a[11],s=a[12],y=a[13],z=a[14];a=a[15];return(b*g-c*f)*(m*a-r*z)-(b*h-d*f)*(j*a-r*y)+(b*l-e*f)*(j*z-m*y)+(c*h-d*g)*(k*a-r*s)-(c*l-e*g)*(k*z-m*s)+(d*l-e*h)*(k*y-j*s)};H.d.K=Uc;H.d.jf=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Nc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};
H.d.Oi=function(a,b,c,d,e,f,g){return Nc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};H.d.Pi=function(a,b,c,d,e,f,g){return Nc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};H.d.multiply=Tc;H.d.Xg=Wc;H.d.translate=Xc;H.d.scale=function(a,b,c,d){return Nc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
H.d.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],l=a[3],k=a[4],j=a[5],m=a[6],r=a[7],s=a[8],y=a[9],z=a[10],D=a[11],E=Math.cos(b),G=Math.sin(b),A=1-E;b=c*c*A+E;var F=c*d*A+e*G,I=c*e*A-d*G,J=c*d*A-e*G,R=d*d*A+E,M=d*e*A+c*G,V=c*e*A+d*G;c=d*e*A-c*G;e=e*e*A+E;return Nc(a,f*b+k*F+s*I,g*b+j*F+y*I,h*b+m*F+z*I,l*b+r*F+D*I,f*J+k*R+s*M,g*J+j*R+y*M,h*J+m*R+z*M,l*J+r*R+D*M,f*V+k*c+s*e,g*V+j*c+y*e,h*V+m*c+z*e,l*V+r*c+D*e,a[12],a[13],a[14],a[15])};
H.d.je=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],l=a[10],k=a[11],j=Math.cos(b),m=Math.sin(b);a[4]=c*j+g*m;a[5]=d*j+h*m;a[6]=e*j+l*m;a[7]=f*j+k*m;a[8]=c*-m+g*j;a[9]=d*-m+h*j;a[10]=e*-m+l*j;a[11]=f*-m+k*j;return a};H.d.ke=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],l=a[10],k=a[11],j=Math.cos(b),m=Math.sin(b);a[0]=c*j+g*-m;a[1]=d*j+h*-m;a[2]=e*j+l*-m;a[3]=f*j+k*-m;a[8]=c*m+g*j;a[9]=d*m+h*j;a[10]=e*m+l*j;a[11]=f*m+k*j;return a};
H.d.le=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],k=a[7],j=Math.cos(b),m=Math.sin(b);a[0]=c*j+g*m;a[1]=d*j+h*m;a[2]=e*j+l*m;a[3]=f*j+k*m;a[4]=c*-m+g*j;a[5]=d*-m+h*j;a[6]=e*-m+l*j;a[7]=f*-m+k*j;return a};B("X.matrix.identity",H.d.nd);B("X.matrix.clone",H.d.i);B("X.matrix.transpose",H.d.Jf);B("X.matrix.determinant",H.d.ii);B("X.matrix.invert",H.d.K);B("X.matrix.multiply",H.d.multiply);B("X.matrix.multiplyByVector",H.d.W);B("X.matrix.multiplyByVec4",H.d.Xg);
B("X.matrix.makePerspective",H.d.jf);B("X.matrix.makeFrustum",H.d.Oi);B("X.matrix.makeOrtho",H.d.Pi);B("X.matrix.makeLookAt",H.d.Tg);B("X.matrix.translate",H.d.translate);B("X.matrix.scale",H.d.scale);B("X.matrix.rotate",H.d.rotate);B("X.matrix.rotateX",H.d.je);B("X.matrix.rotateY",H.d.ke);B("X.matrix.rotateZ",H.d.le);B("X.matrix.swapRows",H.d.Nj);B("X.matrix.swapCols",H.d.Mj);function Yc(){Q.call(this);this.f="transform";this.oa=H.d.nd()}C(Yc,Q);Yc.prototype.__defineGetter__("matrix",v("oa"));Yc.prototype.__defineSetter__("matrix",function(a){(a==t||!(a instanceof Float32Array))&&n(Error("Invalid matrix."));this.oa=a;this.q()});w=Yc.prototype;w.je=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));H.d.je(this.oa,a*Math.PI/180);this.q()};w.ke=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));H.d.ke(this.oa,a*Math.PI/180);this.q()};
w.le=function(a){(!x(a)||-360>a||360<a)&&n(Error("Invalid angle."));H.d.le(this.oa,a*Math.PI/180);this.q()};w.vh=function(a){x(a)||n(Error("Invalid distance."));H.d.translate(this.oa,a,0,0);this.q()};w.wh=function(a){x(a)||n(Error("Invalid distance."));H.d.translate(this.oa,0,a,0);this.q()};w.xh=function(a){x(a)||n(Error("Invalid distance."));H.d.translate(this.oa,0,0,a);this.q()};function Zc(a,b,c){a.oa[b+4*c]*=-1;a.q()}w.pi=function(){Zc(this,0,0)};w.qi=function(){Zc(this,1,1)};
w.ri=function(){Zc(this,2,2)};w.q=function(){this.h=q};B("X.transform",Yc);B("X.transform.prototype.rotateX",Yc.prototype.je);B("X.transform.prototype.rotateY",Yc.prototype.ke);B("X.transform.prototype.rotateZ",Yc.prototype.le);B("X.transform.prototype.translateX",Yc.prototype.vh);B("X.transform.prototype.translateY",Yc.prototype.wh);B("X.transform.prototype.translateZ",Yc.prototype.xh);B("X.transform.prototype.flipX",Yc.prototype.pi);B("X.transform.prototype.flipY",Yc.prototype.qi);
B("X.transform.prototype.flipZ",Yc.prototype.ri);B("X.transform.prototype.modified",Yc.prototype.q);function $c(){Q.call(this);this.f="texture";this.Tb=this.Kb=this.o=t;this.Ie=this.Je=0;this.Wf=u;Ea(this,new pc)}C($c,Q);$c.prototype.__defineSetter__("rawData",function(a){this.Tb=a;this.h=q});$c.prototype.__defineSetter__("rawDataHeight",function(a){this.Ie=a;this.h=q});$c.prototype.__defineSetter__("rawDataWidth",function(a){this.Je=a;this.h=q});$c.prototype.__defineSetter__("grayscale",function(a){this.Wf=a;this.h=q});B("X.texture",$c);function U(a,b){Q.call(this);this.f="triplets";this.$a=Infinity;this.Wa=-Infinity;this.ab=Infinity;this.Xa=-Infinity;this.bb=Infinity;this.Ya=-Infinity;this.zd=[0,0,0];this.Vf=q;this.H=0;this.P=new Float32Array(a);b!=t&&(this.P=b.P.subarray(0,b.P.length),this.H=this.P.length,this.$a=b.$a,this.Wa=b.Wa,this.ab=b.ab,this.Xa=b.Xa,this.bb=b.bb,this.Ya=b.Ya,this.zd=b.zd.slice(),this.Vf=u)}C(U,Q);w=U.prototype;
w.add=function(a,b,c){this.$a=Math.min(this.$a,a);this.Wa=Math.max(this.Wa,a);this.ab=Math.min(this.ab,b);this.Xa=Math.max(this.Xa,b);this.bb=Math.min(this.bb,c);this.Ya=Math.max(this.Ya,c);this.zd=[(this.$a+this.Wa)/2,(this.ab+this.Xa)/2,(this.bb+this.Ya)/2];this.Vf=u;this.h=q;this.P[this.H++]=a;this.P[this.H++]=b;this.P[this.H++]=c;return this.H/3};w.Cb=function(){if(this.H!=this.P.length){var a=new Float32Array(this.H);a.set(this.P.subarray(0,this.H));this.P=a}};
w.get=function(a){a*=3;return[this.P[a],this.P[a+1],this.P[a+2]]};w.remove=function(){n(Error("Not implemented."))};w.clear=function(){this.P=new Float32Array(this.P.length);this.h=q};U.prototype.__defineGetter__("count",function(){this.Cb();return this.P.length/3});U.prototype.__defineGetter__("length",function(){this.Cb();return this.P.length});B("X.triplets",U);B("X.triplets.prototype.add",U.prototype.add);B("X.triplets.prototype.resize",U.prototype.Cb);B("X.triplets.prototype.get",U.prototype.get);
B("X.triplets.prototype.remove",U.prototype.remove);B("X.triplets.prototype.clear",U.prototype.clear);function ad(){this.xa=bd;this.U=new Yc;this.ha=[1,1,1];this.zc=this.Z=this.da=this.l=this.g=t;this.vc=[];this.ka=q;this.uc=this.Xc=1;this.oc=t;this.Pc=u;this.ga=1;this.T=0;this.Wc=q}var bd="TRIANGLES";ad.prototype.__defineSetter__("type",function(a){return this.xa=a});ad.prototype.__defineGetter__("type",v("xa"));ad.prototype.__defineGetter__("texture",function(){this.Z||(this.Z=new $c);return this.Z});ad.prototype.__defineGetter__("transform",v("U"));ad.prototype.__defineGetter__("points",v("g"));
ad.prototype.__defineSetter__("points",ea("g"));ad.prototype.__defineGetter__("normals",v("l"));ad.prototype.__defineSetter__("normals",ea("l"));ad.prototype.__defineGetter__("colors",v("da"));ad.prototype.__defineSetter__("colors",ea("da"));ad.prototype.__defineGetter__("color",v("ha"));ad.prototype.__defineSetter__("color",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid color."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.ha=a;this.h=q});
ad.prototype.__defineGetter__("opacity",v("ga"));ad.prototype.__defineSetter__("opacity",function(a){(!x(a)||1<a||0>a)&&n(Error("Invalid opacity."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].opacity=a);this.ga=a;this.h=q});ad.prototype.__defineGetter__("caption",v("oc"));ad.prototype.__defineSetter__("caption",function(a){this.oc=a;this.h=q});ad.prototype.__defineGetter__("visible",v("ka"));
ad.prototype.__defineSetter__("visible",function(a){for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d]!=t&&(b[d].visible=a);this.ka=a;this.h=q});ad.prototype.__defineGetter__("pointsize",v("Xc"));ad.prototype.__defineSetter__("pointsize",function(a){x(a)||n(Error("Invalid point size."));this.Xc=a;this.h=q});ad.prototype.__defineGetter__("magicmode",v("Pc"));ad.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&n(Error("Invalid magic mode setting."));this.Pc=a;this.h=q});
ad.prototype.__defineGetter__("linewidth",v("uc"));ad.prototype.__defineSetter__("linewidth",function(a){x(a)||n(Error("Invalid line width."));this.uc=a;this.h=q});ad.prototype.__defineGetter__("pickable",v("Wc"));ad.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&n(Error("Invalid pickable setting."));this.Wc=a;this.h=q});ad.prototype.__defineGetter__("textureCoordinateMap",v("zc"));ad.prototype.__defineSetter__("textureCoordinateMap",ea("Ok"));function cd(){this.Za=Infinity;this.Y=this.ea=-Infinity;this.$=Infinity;this.Pb=[0,0,0];this.Nb=[1,1,1]}cd.prototype.__defineGetter__("lowerThreshold",v("Y"));cd.prototype.__defineSetter__("lowerThreshold",ea("Y"));cd.prototype.__defineGetter__("upperThreshold",v("$"));cd.prototype.__defineSetter__("upperThreshold",ea("$"));cd.prototype.__defineGetter__("min",v("Za"));cd.prototype.__defineGetter__("max",v("ea"));cd.prototype.__defineGetter__("minColor",v("Pb"));
cd.prototype.__defineSetter__("minColor",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid min. color."));this.Pb=a});cd.prototype.__defineGetter__("maxColor",v("Nb"));cd.prototype.__defineSetter__("maxColor",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid max. color."));this.Nb=a});function dd(){Q.call(this);this.f="scalars";this.Kc=this.z=t;this.og=q;this.we=0;Ea(this,new pc);Ea(this,new cd);this.Pb=[0,1,0];this.Nb=[1,0,0]}C(dd,Q);dd.prototype.__defineGetter__("array",v("z"));dd.prototype.__defineSetter__("array",function(a){this.Kc=this.z=a;this.h=q});dd.prototype.__defineGetter__("interpolation",v("we"));dd.prototype.__defineSetter__("interpolation",ea("we"));B("X.scalars",dd);function W(a){Q.call(this);this.f="object";this.e=[];this.A=this.Ua=t;Ea(this,new ad);a!=t&&this.ec(a)}C(W,Q);
W.prototype.ec=function(a){this.xa=a.xa;this.U=new Yc;this.U.oa=new Float32Array(a.U.oa);this.ha=a.ha.slice();a.g&&(this.g=new U(a.g.length,a.g));a.l&&(this.l=new U(a.l.length,a.l));a.da&&(this.da=new U(a.da.length,a.da));this.Z=a.Z;this.zc=a.zc;a.o&&(this.o=new oc((new String(a.o.Kd)).toString()));this.ga=a.ga;this.e.length=0;var b=a.e;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.e.push(new H[b[d].f](b[d]));this.ka=a.ka;this.Xc=a.Xc;this.uc=a.uc;a.oc&&(this.oc=(new String(a.oc)).toString());this.Pc=
a.Pc;this.Wc=a.Wc;this.vc=a.vc.slice();this.h=q};W.prototype.__defineGetter__("colortable",function(){this.Ua||(this.Ua=new vc);return this.Ua});W.prototype.__defineGetter__("scalars",function(){this.A||(this.A=new dd);return this.A});W.prototype.__defineGetter__("children",v("e"));W.prototype.q=function(){var a=new ed;a.fa=this;this.dispatchEvent(a)};
function fd(a,b){(a==t||b==t||!(a instanceof W)||!(b instanceof W))&&n(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.ga?-1:1==b.ga?1:a.T!=t&&b.T!=t&&a.T>b.T?-1:1}B("X.object",W);B("X.object.prototype.modified",W.prototype.q);function gd(){}function hd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.l.get(d),l=a.l.get(d+1),k=a.l.get(d+2),j=a.ha;a.da&&0<a.da.length&&(j=a.da.get(d));var m=[];m.push(new cc(e,h));m.push(new cc(f,l));m.push(new cc(g,k));c.push(new ec(m,j))}return mc(c)}
function id(a,b){(b==t||!(b instanceof lc))&&n(Error("Invalid CSG object."));var c=new nc,d=[];Fb(b.L,function(a){var b=[],g=a.pe,b=Fb(a.Eb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Lh=Fb(c.unique(),function(a){return[a.Ja.x(),a.Ja.y(),a.Ja.c()]});a.Kh=Fb(c.unique(),function(a){return[a.la.x(),a.la.y(),a.la.c()]});a.Jh=Fb(c.unique(),function(a){return!a.color?t:[a.color[0],a.color[1],a.color[2]]});a.g=new U(9*d.length);a.l=new U(9*d.length);
a.da=new U(9*d.length);Fb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.Lh,l=this.Kh,k=this.Jh;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.l.add(l[b][0],l[b][1],l[b][2]);this.l.add(l[c][0],l[c][1],l[c][2]);this.l.add(l[a][0],l[a][1],l[a][2]);k[b]&&this.da.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.da.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.da.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.da.H&&(a.da=t);a.xa=bd}
gd.prototype.Kf=function(a){(a==t||!(a instanceof lc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=hd(b));a=new W;Ea(a,new gd);id(a,hd(this).Kf(b));return a};gd.prototype.ya=function(a){(a==t||!(a instanceof lc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=hd(b));a=new W;Ea(a,new gd);id(a,hd(this).ya(b));return a};
gd.prototype.gf=function(a){(a==t||!(a instanceof lc)&&!(a instanceof W))&&n(Error("Invalid object."));var b=a;a instanceof W&&(b=hd(b));a=new W;Ea(a,new gd);id(a,hd(this).gf(b));return a};gd.prototype.inverse=function(){var a=new W;Ea(a,new gd);id(a,hd(this).inverse());return a};B("X.constructable",gd);B("X.constructable.prototype.intersect",gd.prototype.gf);B("X.constructable.prototype.inverse",gd.prototype.inverse);B("X.constructable.prototype.subtract",gd.prototype.ya);
B("X.constructable.prototype.union",gd.prototype.Kf);function jd(a){Lb.call(this,a);this.f="event"}C(jd,Lb);var kd=ac("pan"),ld=ac("rotate"),md=ac("zoom"),nd=ac("scroll");ac("render");var od=ac("resetview"),pd=ac("windowlevel"),qd=ac("modified"),rd=ac("progress"),sd=ac("hover"),td=ac("hover_end");function ud(){jd.call(this,pd);this.Be=this.Re=0}C(ud,jd);function vd(){jd.call(this,kd);this.T=new H.j(0,0,0)}C(vd,jd);function wd(){jd.call(this,ld);this.T=new H.j(0,0,0)}C(wd,jd);function xd(){jd.call(this,md);this.Va=this.jb=u}C(xd,jd);
function yd(){jd.call(this,nd);this.Q=u}C(yd,jd);function zd(){jd.call(this,sd);this.Qd=this.Pd=0}C(zd,jd);function Ad(){jd.call(this,td)}C(Ad,jd);function Bd(){jd.call(this,od)}C(Bd,jd);function ed(){jd.call(this,qd);this.r=this.fa=t}C(ed,jd);function Cd(){jd.call(this,rd);this.ug=0}C(Cd,jd);function Dd(){Q.call(this);this.f="parser";this.F=t;this.H=0;this.Ph=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.Fd=q;this.Nk=-Infinity;this.Mk=Infinity}C(Dd,Q);Dd.prototype.parse=function(){n(Error("The function parse() should be overloaded."))};function Ed(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Fd(a,b,c){b===p&&(b=0);c===p&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function Y(a,b,c){c!=t||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array;d=4;break;case "complex":e=Float64Array;d=8;break;case "double":e=Float64Array,d=8}b=new e(a.F.slice(a.H,a.H+=c*d));if(a.Ph!=a.Fd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Gd(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],d=Kc(0,0,0,1),e=Jc();Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(0,0,b[3],1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(0,b[2],0,
1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(b[1],0,0,1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(b[1],b[2],0,1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>
c[5]?e[2]:c[5];d=Kc(b[1],0,b[3],1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(0,b[2],b[3],1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=Kc(b[1],b[2],b[3],1);Wc(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:
c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];return c}
function Hd(a,b){var c=Mc();if(!(a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2])){var d=Math.acos(a[2]),e=new Float32Array(3),f=a[0],g=a[1],h=a[2],l=b[0],k=b[1],j=b[2];e[0]=g*j-h*k;e[1]=h*l-f*j;e[2]=f*k-g*l;Ic(e,e);f=Math.cos(d/2);g=Math.sin(d/2)*e[0];h=Math.sin(d/2)*e[1];d=Math.sin(d/2)*e[2];Qc(c,0,f*f+g*g-h*h-d*d,2*(g*h-f*d),2*(g*d+f*h),0);Qc(c,1,2*(g*h+f*d),f*f+h*h-g*g-d*d,2*(h*d-f*g),0);Qc(c,2,2*(g*d-f*h),2*(h*d+f*g),f*f+d*d-h*h-g*g,0)}d=Lc();Uc(c,d);return[c,d]}
function Id(a,b,c,d,e,f,g,h){var l=new Jd;Ic(b,b);for(var k=[],j=[],m=0;6>m;m++)for(var r=Math.floor(m/2),s=(r+1)%3,y=(r+2)%3,z=(4+2*r)%6,D=0;2>D;D++){var E=(2+D+2*r)%6,G=-(b[r]*(d[m]-a[r])+b[s]*(d[E]-a[s]))/b[y]+a[y];if(G>=d[z]&&G<=d[z+1]||G<=d[z]&&G>=d[z+1]){var A=[];A[r]=d[m];A[s]=d[E];A[y]=G;k.push(A)}else A=[],A[r]=d[m],A[s]=d[E],A[y]=G,j.push(A)}a=Ec(0,0,1);a=Hd(b,a);d=a[0];a=a[1];r=[];for(j=0;j<k.length;++j)m=Kc(k[j][0],k[j][1],k[j][2],1),s=Jc(),Wc(d,m,s),r.push([s[0],s[1],s[2]]);d=Ec(1,0,
0);k=new Float32Array(3);Vc(a,d,k);j=Ec(0,1,0);d=new Float32Array(3);Vc(a,j,d);m=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];for(j=j=0;j<r.length;++j)r[j][0]<m[0]&&(m[0]=r[j][0]),r[j][0]>m[1]&&(m[1]=r[j][0]),r[j][1]<m[2]&&(m[2]=r[j][1]),r[j][1]>m[3]&&(m[3]=r[j][1]),r[j][2]<m[4]&&(m[4]=r[j][2]),r[j][2]>m[5]&&(m[5]=r[j][2]);j=Kc(m[0]+(m[1]-m[0])/2,m[2]+(m[3]-m[2])/2,m[4]+(m[5]-m[4])/2,0);r=Jc();Tc(a,j,r);var s=Math.floor(m[0]),y=Math.ceil(m[1]),
z=y-s,D=Math.floor(m[2]),E=Math.ceil(m[3]),G=E-D,j=Math.ceil(z/1),F=Math.ceil(G/1),A=new Uint8Array(4*j*F),I=new $c;I.Je=j;I.Ie=F;var F=Jc(),J=Kc(0,0,m[4],1),R=Lc();Tc(f.Gh,a,R);for(var M=E-1E-7,V=y-1E-7,aa=0,Z=0,ba=0,K=D,K=D;K<=M;K+=1){ba++;Z=0;J[1]=K;for(j=s;j<=V;j+=1){Z++;J[0]=j;Wc(R,J,F);var N=4*aa;if(0<=F[0]&&F[0]<f.I[0]&&0<=F[1]&&F[1]<f.I[1]&&0<=F[2]&&F[2]<f.I[2]){var O=e[Math.floor(F[2])][Math.floor(F[1])][Math.floor(F[0])],hb=0,Fc=0,Gc=0,Hc=0;h?((O=h.get(O))||(O=[0,0.61,0,0,1]),hb=255*O[1],
Fc=255*O[2],Gc=255*O[3],Hc=255*O[4]):(hb=Fc=Gc=255*(O/f.ea),Hc=255);A[N]=hb;A[++N]=Fc;A[++N]=Gc;A[++N]=Hc}else A[N]=0,A[++N]=0,A[++N]=0,A[++N]=0;aa++}}I.Tb=A;l.Z=I;l.Vh=m;l.Ih=a;l.Hh=R;l.Oh=D;l.Kk=E;l.Uh=s;l.Pk=y;l.Yf=Z;l.Xf=ba;l.Cc=1;l.B=z;l.sc=1;l.s=G;l.v=[r[0],r[1],r[2]];l.rc=[b[0],b[1],b[2]];l.Ld=[k[0],k[1],k[2]];l.Q=[d[0],d[1],d[2]];l.ka=u;l.zb=f;l.ub=f.zb!=t&&!g?u:q;l.nc=c;l.fc();l.ka=u;return l}
function Kd(a,b,c,d){for(var e=d.Hb,f=[],g=[],h=0;6>h;h++){var l=Math.floor(h/2),k=(l+1)%3,j=(l+2)%3,m=(2+2*l)%6,r=(4+2*l)%6,s=(e[h]-b[l])*(1/c[l]);if(Infinity!=s&&-Infinity!=s){var y=b[k]+c[k]*s,s=b[j]+c[j]*s;y>=e[m]&&y<=e[m+1]&&s>=e[r]&&s<=e[r+1]?(m=[],m[l]=e[h],m[k]=y,m[j]=s,f.push(m)):(m=[],m[l]=e[h],m[k]=y,m[j]=s,g.push(m))}}b=[f,g];e=b[0];d.b[a].wa=b;d.b[a].Fe=-(c[0]*e[0][0]+c[1]*e[0][1]+c[2]*e[0][2]);b=xc(new T(e[0][0],e[0][1],e[0][2]),new T(e[1][0],e[1][1],e[1][2]));d.b[a].Jk=b;e=Ec(0,0,1);
c=Hd(c,e);e=c[0];f=c[1];g=Kc(d.se[0],d.se[1],d.se[2],0);c=Jc();Wc(e,g,c);e=Jc();Pc(f,2,e);f=c[2];e[0]*=f;e[1]*=f;e[2]*=f;e[3]*=f;d.b[a].Ne=c[2];d.b[a].va=e;c=Math.abs(Math.floor(b/c[2]));d.lg[a]=c;d.b[a].t=c}
function Ld(a,b){var c;c=b.F;for(var d=b.I,e=b.ea,f=Array(d[2]),g=Array(d[2]),h=d[1]*d[0],l=0,k=0,j=0,m=0,r=0,m=0;m<d[2];m++){var s=c.subarray(m*h,(m+1)*h),r=0;g[m]=Array(d[1]);f[m]=Array(d[1]);for(j=0;j<d[1];j++){g[m][j]=new c.constructor(d[0]);f[m][j]=new c.constructor(d[0]);for(k=0;k<d[0];k++)l=s[r],g[m][j][k]=255*(l/e),f[m][j][k]=l,r++}}c=[f,g];b.Pa=c[0];b.Hk=c[1];H.Ta(a.f+".reslice");b.Ba=b.k!=t;b.Ua&&(b.Jc=b.Ua.lb);b.bl=[b.I[0],b.I[1],b.I[2]];b.sb=[b.ta[0]+b.tb[0]/2,b.ta[1]+b.tb[1]/2,b.ta[2]+
b.tb[2]/2];b.Hb=[Math.min(b.ta[0],b.ta[0]+b.tb[0]),Math.max(b.ta[0],b.ta[0]+b.tb[0]),Math.min(b.ta[1],b.ta[1]+b.tb[1]),Math.max(b.ta[1],b.ta[1]+b.tb[1]),Math.min(b.ta[2],b.ta[2]+b.tb[2]),Math.max(b.ta[2],b.ta[2]+b.tb[2])];b.b=[{},{},{}];c=Ec(b.sb[0],b.sb[1],b.sb[2]);b.b[0].rg=c;d=Ec(1,0,0);Ic(d,d);b.b[0].n=d;e=[1,1,0];b.b[0].ha=e;Kd(0,c,d,b);b.e[0].e=Array(b.b[0].t);c[0]=b.b[0].wa[0][0][0]+Math.abs(b.b[0].va[0])*Math.round(b.b[0].t/2);c[1]=b.b[0].wa[0][0][1]+Math.abs(b.b[0].va[1])*Math.round(b.b[0].t/
2);c[2]=b.b[0].wa[0][0][2]+Math.abs(b.b[0].va[2])*Math.round(b.b[0].t/2);c=Id(c,b.b[0].n,b.b[0].ha,b.Hb,b.Pa,b,b.Ba,b.Jc);b.Ba&&(c.k=b.k.e[0].e[Math.round(b.b[0].t/2)].Z);b.e[0].e[Math.round(b.b[0].t/2)]=c;b.vb=Math.round(b.b[0].t/2);b.Lc=Math.round(b.b[0].t/2);c=Ec(b.sb[0],b.sb[1],b.sb[2]);b.b[1].rg=c;d=Ec(0,1,0);Ic(d,d);b.b[1].n=d;e=[1,0,0];b.b[1].ha=e;Kd(1,c,d,b);b.e[1].e=Array(b.b[1].t);c[0]=b.b[1].wa[0][0][0]+Math.abs(b.b[1].va[0])*Math.round(b.b[1].t/2);c[1]=b.b[1].wa[0][0][1]+Math.abs(b.b[1].va[1])*
Math.round(b.b[1].t/2);c[2]=b.b[1].wa[0][0][2]+Math.abs(b.b[1].va[2])*Math.round(b.b[1].t/2);c=Id(c,b.b[1].n,b.b[1].ha,b.Hb,b.Pa,b,b.Ba,b.Jc);b.Ba&&(c.k=b.k.e[1].e[Math.round(b.b[1].t/2)].Z);b.e[1].e[Math.round(b.b[1].t/2)]=c;b.wb=Math.round(b.b[1].t/2);b.Mc=Math.round(b.b[1].t/2);c=Ec(b.sb[0],b.sb[1],b.sb[2]);b.b[2].rg=c;d=Ec(0,0,1);Ic(d,d);b.b[2].n=d;e=[0,1,0];b.b[2].ha=e;Kd(2,c,d,b);b.e[2].e=Array(b.b[2].t);c[0]=b.b[2].wa[0][0][0]+Math.abs(b.b[2].va[0])*Math.round(b.b[2].t/2);c[1]=b.b[2].wa[0][0][1]+
Math.abs(b.b[2].va[1])*Math.round(b.b[2].t/2);c[2]=b.b[2].wa[0][0][2]+Math.abs(b.b[2].va[2])*Math.round(b.b[2].t/2);c=Id(c,b.b[2].n,b.b[2].ha,b.Hb,b.Pa,b,b.Ba,b.Jc);b.Ba&&(c.k=b.k.e[2].e[Math.round(b.b[2].t/2)].Z);b.e[2].e[Math.round(b.b[2].t/2)]=c;b.xb=Math.round(b.b[2].t/2);b.Nc=Math.round(b.b[2].t/2);H.Oa(a.f+".reslice");return b.Pa};function Md(){Dd.call(this);this.f="parserLBL"}C(Md,Dd);
Md.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");var d=b.vc,e=d.length;0==e&&n(Error("No _pointIndices defined on the X.object."));this.F=c;var f=[],g=Y(this,"uchar",c.byteLength),h=g.length,l=u,k=0;for(c=1;c<h;c++)10==g[c-1]?(k=c,l=q):l&&32==g[c]&&(f.push(parseInt(Fd(g,k,c),10)),l=u);g=b.A.z?b.A.z:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)l=d[c],l>e&&n(Error("Could not find scalar for vertex.")),l=g[l],f[h++]=l,f[h++]=l,f[h++]=l;b.A.z=
g;b.A.Kc=f;b.A.h=q;H.Oa(this.f+".parse");d=new ed;d.fa=b;d.r=a;this.dispatchEvent(d)};B("X.parserLBL",Md);B("X.parserLBL.prototype.parse",Md.prototype.parse);function Nd(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}w=Nd.prototype;w.i=function(){return new Nd(this.x,this.y)};function Od(a,b){return new Nd(a.x-b.x,a.y-b.y)}w.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
w.translate=function(a,b){a instanceof Nd?(this.x+=a.x,this.y+=a.y):(this.x+=a,x(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.x*=a;this.y*=c;return this};function Pd(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}w=Pd.prototype;w.i=function(){return new Pd(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?u:a instanceof Pd?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
w.translate=function(a,b){a instanceof Nd?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,x(b)&&(this.top+=b,this.bottom+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function Qd(a,b){this.width=a;this.height=b}w=Qd.prototype;w.i=function(){return new Qd(this.width,this.height)};w.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.scale=function(a,b){var c=x(b)?b:a;this.width*=a;this.height*=c;return this};function Rd(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}w=Rd.prototype;w.i=function(){return new Rd(this.left,this.top,this.width,this.height)};w.Pg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return u};
w.contains=function(a){return a instanceof Rd?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function Sd(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),d=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+d*d}w.df=function(a){return Math.sqrt(Sd(this,a))};
w.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
w.translate=function(a,b){a instanceof Nd?(this.left+=a.x,this.top+=a.y):(this.left+=a,x(b)&&(this.top+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};var Td;function Ud(a,b){var c;c=a.className;c=ma(c)&&c.match(/\S+/g)||[];for(var d=Ib(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Db(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};var Vd=!L||L&&9<=yb;!ib&&!L||L&&L&&9<=yb||ib&&wb("1.9.1");L&&wb("9");function Wd(a){return a?new Xd(Yd(a)):Td||(Td=new Xd)}function Zd(a){return ma(a)?document.getElementById(a):a}var $d={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ae(a,b,c){return be(document,arguments)}
function be(a,b){var c=b[0],d=b[1];if(!Vd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Pa(d.name),'"');if(d.type){c.push(' type="',Pa(d.type),'"');var e={};Oa(e,d);delete e.type;d=e}c.push(">");c=c.join("")}var f=a.createElement(c);if(d)if(ma(d))f.className=d;else if(ka(d))Ud.apply(t,[f].concat(d));else{var c=function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in $d?f.setAttribute($d[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?
f.setAttribute(b,a):f[b]=a},g;for(g in d)c.call(p,d[g],g)}if(2<b.length){g=function(b){b&&f.appendChild(ma(b)?a.createTextNode(b):b)};for(d=2;d<b.length;d++)if(e=b[d],la(e)&&!(oa(e)&&0<e.nodeType)){var c=Eb,h;a:{if((h=e)&&"number"==typeof h.length){if(oa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(na(h)){h="function"==typeof h.item;break a}}h=u}if(h)if(h=e.length,0<h){for(var l=Array(h),k=0;k<h;k++)l[k]=e[k];e=l}else e=[];c(e,g)}else g(e)}return f}
function ce(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function de(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function ee(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Yd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function Xd(a){this.V=a||fa.document||document}w=Xd.prototype;w.Yd=Wd;
w.p=function(a){return ma(a)?this.V.getElementById(a):a};w.Bh=Xd.prototype.p;w.Dc=function(a,b,c){return be(this.V,arguments)};w.createElement=function(a){return this.V.createElement(a)};w.createTextNode=function(a){return this.V.createTextNode(String(a))};function fe(a){return"CSS1Compat"==a.V.compatMode}
function ge(a){var b=a.V;a=!jb&&"CSS1Compat"==b.compatMode?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return L&&wb("10")&&b.pageYOffset!=a.scrollTop?new Nd(a.scrollLeft,a.scrollTop):new Nd(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}w.appendChild=function(a,b){a.appendChild(b)};w.contains=ee;function he(a,b){var c=Yd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,t))?c[b]||c.getPropertyValue(b)||"":""}function ie(a,b){return he(a,b)||(a.currentStyle?a.currentStyle[b]:t)||a.style&&a.style[b]}function je(a){a=a?Yd(a):document;return L&&!(L&&9<=yb)&&!fe(Wd(a))?a.body:a.documentElement}
function ke(a){var b=a.getBoundingClientRect();L&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function le(a){if(L&&!(L&&8<=yb))return a.offsetParent;var b=Yd(a),c=ie(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=ie(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return t}
function me(a){for(var b=new Pd(0,Infinity,Infinity,0),c=Wd(a),d=c.V.body,e=c.V.documentElement,f=!jb&&"CSS1Compat"==c.V.compatMode?c.V.documentElement:c.V.body;a=le(a);)if((!L||0!=a.clientWidth)&&(!jb||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=ie(a,"overflow")){var g=ne(a),h;h=a;if(ib&&!wb("1.9")){var l=parseFloat(he(h,"borderLeftWidth"));if(oe(h))var k=h.offsetWidth-h.clientWidth-l-parseFloat(he(h,"borderRightWidth")),l=l+k;h=new Nd(l,parseFloat(he(h,"borderTopWidth")))}else h=new Nd(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(c.V.parentWindow||c.V.defaultView||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Qd(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&
b.bottom>b.top&&b.right>b.left?b:t}
function ne(a){var b,c=Yd(a),d=ie(a,"position"),e=ib&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Nd(0,0),g=je(c);if(a==g)return f;if(a.getBoundingClientRect)b=ke(a),a=ge(Wd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(jb&&"fixed"==ie(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(gb||jb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=le(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!gb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function pe(a){var b=new Nd;if(1==a.nodeType){if(a.getBoundingClientRect){var c=ke(a);b.x=c.left;b.y=c.top}else{var c=ge(Wd(a)),d=ne(a);b.x=d.x-c.x;b.y=d.y-c.y}if(ib&&!wb(12)){var e;L?e="-ms-transform":jb?e="-webkit-transform":gb?e="-o-transform":ib&&(e="-moz-transform");var f;e&&(f=ie(a,e));f||(f=ie(a,"transform"));f?(a=f.match(qe),a=!a?new Nd(0,0):new Nd(parseFloat(a[1]),parseFloat(a[2]))):a=new Nd(0,0);b=new Nd(b.x+a.x,b.y+a.y)}}else e=na(a.ti),f=a,a.targetTouches?f=a.targetTouches[0]:e&&a.gb.targetTouches&&
(f=a.gb.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function re(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function se(a){if("none"!=ie(a,"display"))return te(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=te(a);b.display=c;b.position=e;b.visibility=d;return a}
function te(a){var b=a.offsetWidth,c=a.offsetHeight,d=jb&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=ke(a),new Qd(a.right-a.left,a.bottom-a.top)):new Qd(b,c)}function ue(a,b){a.style.display=b?"":"none"}function oe(a){return"rtl"==ie(a,"direction")}function ve(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}
function we(a,b){var c=a.currentStyle?a.currentStyle[b]:t;return c?ve(a,c):0}var xe={thin:2,medium:4,thick:6};function ye(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:t))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:t;return c in xe?xe[c]:ve(a,c)}var qe=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function ze(a,b){bc.call(this);this.w=a;var c=oa(this.w)&&1==this.w.nodeType?this.w:this.w?this.w.body:t;this.Mi=!!c&&oe(c);this.Yk=P(this.w,ib?"DOMMouseScroll":"mousewheel",this,b)}C(ze,bc);
ze.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.gb;if("mousewheel"==a.type){c=1;if(L||jb&&($a||wb("532.0")))c=40;d=Ae(-a.wheelDelta,c);ia(a.wheelDeltaX)?(b=Ae(-a.wheelDeltaX,c),c=Ae(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;x(this.Ug)&&(b=Math.min(Math.max(b,-this.Ug),this.Ug));x(this.Vg)&&(c=Math.min(Math.max(c,-this.Vg),this.Vg));this.Mi&&(b=-b);b=new Be(d,a,b,c);this.dispatchEvent(b)};
function Ae(a,b){return jb&&(Za||ab)&&0!=a%b?a:a/b}function Be(a,b,c,d){b&&this.ra(b,p);this.type="mousewheel";this.detail=a;this.Tk=c;this.Ec=d}C(Be,Nb);L||jb&&wb("525");function Ce(a){Q.call(this);this.f="interactor";this.Ea=a;this.Ce=this.fg=this.eg=this.gg=this.dg=this.hg=t;this.Id=q;this.Ub=this.Ob=this.kb=u;this.ia=[0,0];this.xe=new H.j(0,0,0);this.Oc=new H.j(0,0,0);this.Rg=0;this.tg=this.Dd=t;this.qg=u;this.M={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:u,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:u}}C(Ce,Q);Ce.prototype.__defineGetter__("config",v("M"));Ce.prototype.__defineGetter__("leftButtonDown",v("kb"));
Ce.prototype.__defineGetter__("middleButtonDown",v("Ob"));Ce.prototype.__defineGetter__("rightButtonDown",v("Ub"));
Ce.prototype.ra=function(){this.M.MOUSEWHEEL_ENABLED?(this.Ce=new ze(this.Ea),this.hg=P(this.Ce,"mousewheel",this.pd.bind(this))):(Wb(this.hg),this.Ce=t);this.M.MOUSECLICKS_ENABLED?(this.dg=P(this.Ea,"mousedown",this.Zi.bind(this)),this.gg=P(this.Ea,"mouseup",this.dj.bind(this))):(Wb(this.dg),Wb(this.gg));this.Ea.oncontextmenu=this.M.CONTEXTMENU_ENABLED?t:function(){return u};window.onkeydown=this.M.KEYBOARD_ENABLED?this.ah.bind(this):t;this.M.TOUCH_ENABLED?(this.M.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},u),this.Th=P(this.Ea,"touchstart",this.qj.bind(this)),this.Sh=P(this.Ea,"touchmove",this.oj.bind(this)),this.Rh=P(this.Ea,"touchend",this.kj.bind(this))):(Wb(this.Th),Wb(this.Sh),Wb(this.Rh));Wb(this.eg);Wb(this.fg);this.eg=P(this.Ea,"mousemove",this.aj.bind(this));this.fg=P(this.Ea,"mouseout",this.bj.bind(this))};
Ce.prototype.Zi=function(a){0==a.button?this.kb=q:1==a.button?this.Ob=q:2==a.button&&(this.Ub=q);eval("this.onMouseDown("+this.kb+","+this.Ob+","+this.Ub+")");De(this);a.preventDefault()};Ce.prototype.Yi=da();Ce.prototype.dj=function(a){0==a.button?this.kb=u:1==a.button?this.Ob=u:2==a.button&&(this.Ub=u);eval("this.onMouseUp("+this.kb+","+this.Ob+","+this.Ub+")");De(this);a.preventDefault()};Ce.prototype.__defineGetter__("mousePosition",v("ia"));w=Ce.prototype;w.cj=da();
w.bj=function(a){this.Id=u;this.M.KEYBOARD_ENABLED&&(window.onkeydown=t);this.Ub=this.Ob=this.kb=u;De(this);this.xe=new H.j(0,0,0);a.preventDefault()};w.$i=da();w.qj=function(a){a.preventDefault();a.ra(a.gb.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Oc=new H.j(a.clientX,a.clientY,0);this.tg=setTimeout(this.mj.bind(this,a),500)};w.pj=da();
w.mj=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new xd;a.jb=q;a.Va=this instanceof Ee;this.dispatchEvent(a);this.Md=q};w.lj=da();function Fe(a){clearTimeout(a.tg);if(a.Md){var b=new xd;b.jb=u;b.Va=a instanceof Ee;a.dispatchEvent(b)}a.Md=u}w.kj=function(a){a.preventDefault();eval("this.onTouchEnd()");Fe(this)};w.jj=da();
w.oj=function(a){a.preventDefault();this.Md||Fe(this);this.touchmoveEvent=a=a.gb;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new H.j(c[0],c[1],0);var b=c[0]>3*this.Ea.clientWidth/4,d=c[0]<this.Ea.clientWidth/4,e=c[1]<this.Ea.clientHeight/4,c=c[1]>3*this.Ea.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Oc.ya(a);this.Oc=a.i();if(this.Md)a=new vd,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.T=e,this.dispatchEvent(a);
else if(this instanceof Ie&&(b||d))a=new yd,a.Q=0>e.y,this.dispatchEvent(a);else if(this instanceof Ee||c)e.scale(3),a=new wd,a.T=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new H.j(a[0],a[1],0),b=new H.j(b[0],b[1],0),e=yc(a,b),b=e-this.Rg,this.Rg=e,this.Oc.ya(a),this.Oc=a.i(),10<Math.abs(b)&&(a=new xd,a.jb=0<b,a.Va=this instanceof Ee,this.dispatchEvent(a)))};w.nj=da();
w.aj=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Id=q;this.M.KEYBOARD_ENABLED&&window.onkeydown==t&&(window.onkeydown=this.ah.bind(this));a.preventDefault();var b=a.shiftKey;this.qg=b;this.ia=[a.offsetX,a.offsetY];var c=new H.j(this.ia[0],this.ia[1],0);a=this.xe.ya(c);this.xe=c.i();this.M.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Ob||this.kb||this.Ub)&&De(this),this.Dd=setTimeout(function(){De(this);var a=new zd;a.Pd=c.x;a.Qd=c.y;this.dispatchEvent(a);
this.Dd=t}.bind(this),300));0!=a.Bb()&&(this.kb&&!b?(b=new wd,a.scale(3),b.T=a,this.dispatchEvent(b)):this.Ob||this.kb&&b?(b=new vd,b.T=a,this.dispatchEvent(b)):this.Ub&&(b=new xd,b.jb=0<a.y,b.Va=u,this.dispatchEvent(b)))};function De(a){a.Dd&&clearTimeout(a.Dd);a.dispatchEvent(new Ad)}w.ej=da();w.pd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");De(this);a.preventDefault()};w.Wi=da();
w.ah=function(a){if(this.Id){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");De(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Bd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new vd:b?a=new xd:(a=new wd,this instanceof Ie&&(a=new yd)),a&&(c=new H.j(0,0,0),37==f?(c.x=5,a.Q=u,b&&(a.Q=q,a.jb=q,a.Va=u)):39==f?(c.x=-5,a.Q=q,b&&(a.jb=u,a.Va=u)):38==f?(c.y=5,a.Q=q,b&&(a.jb=q,a.Va=q)):40==f&&(c.y=-5,a.Q=u,b&&(a.jb=
u,a.Va=q)),a.T=c,this.dispatchEvent(a)))}};B("X.interactor",Ce);B("X.interactor.prototype.init",Ce.prototype.ra);B("X.interactor.prototype.onMouseDown",Ce.prototype.Yi);B("X.interactor.prototype.onMouseUp",Ce.prototype.cj);B("X.interactor.prototype.onMouseMove",Ce.prototype.$i);B("X.interactor.prototype.onMouseWheel",Ce.prototype.ej);B("X.interactor.prototype.onKey",Ce.prototype.Wi);B("X.interactor.prototype.onTouchStart",Ce.prototype.pj);B("X.interactor.prototype.onTouchMove",Ce.prototype.nj);
B("X.interactor.prototype.onTouchEnd",Ce.prototype.jj);B("X.interactor.prototype.onTouchHover",Ce.prototype.lj);function Ie(a){Ce.call(this,a);this.f="interactor2D"}C(Ie,Ce);Ie.prototype.pd=function(a){Ie.u.pd.call(this,a);var b=new yd;a.Ec==t&&(a.Ec=0);b.Q=0>a.Ec;this.dispatchEvent(b)};function Jd(a){W.call(this);this.f="slice";this.v=[0,0,0];this.rc=[0,0,1];this.Q=[0,1,0];this.Ld=[1,0,0];this.s=this.B=10;this.zc=[0,1,0,0,1,1,1,1,1,0,0,0];this.k=this.zb=t;this.ub=q;this.nc=[1,1,1];a!=t&&this.ec(a)}C(Jd,W);Jd.prototype.ec=function(a){this.v=a.v.slice();this.rc=a.rc.slice();this.Q=a.Q.slice();this.B=a.B;this.s=a.s;this.zb=a.zb;this.k=a.k;this.ub=a.ub;this.nc=a.nc;this.Nh=a.Nh;Jd.u.ec.call(this,a)};Jd.prototype.__defineSetter__("height",ea("s"));
Jd.prototype.__defineSetter__("width",ea("B"));Jd.prototype.create=function(){this.fc()};
Jd.prototype.fc=function(){var a=(new T(this.rc[0],this.rc[1],this.rc[2])).normalize(),b=new T(this.Q[0],this.Q[1],this.Q[2]),c=new T(this.Ld[0],this.Ld[1],this.Ld[2]),d=new T(this.v[0],this.v[1],this.v[2]),e=zc(c.i().K().scale(this.B/2),b.i().K().scale(this.s/2)),f=new T(e.x+d.x,e.y+d.y,e.c+d.c),e=zc(c.i().K().scale(this.B/2),b.i().scale(this.s/2)),g=new T(e.x+d.x,e.y+d.y,e.c+d.c),e=zc(c.i().scale(this.B/2),b.i().K().scale(this.s/2)),h=new T(e.x+d.x,e.y+d.y,e.c+d.c),e=zc(c.i().scale(this.B/2),b.i().scale(this.s/
2)),b=new T(e.x+d.x,e.y+d.y,e.c+d.c);this.g=new U(18);this.l=new U(18);this.g.add(f.x,f.y,f.c);this.g.add(g.x,g.y,g.c);this.g.add(h.x,h.y,h.c);this.g.add(h.x,h.y,h.c);this.g.add(b.x,b.y,b.c);this.g.add(g.x,g.y,g.c);this.l.add(a.x,a.y,a.c);this.l.add(a.x,a.y,a.c);this.l.add(a.x,a.y,a.c);this.l.add(a.x,a.y,a.c);this.l.add(a.x,a.y,a.c);this.l.add(a.x,a.y,a.c);this.ub&&(a=new W,a.g=new U(24),a.l=new U(24),a.g.add(f.x,f.y,f.c),a.g.add(g.x,g.y,g.c),a.g.add(g.x,g.y,g.c),a.g.add(b.x,b.y,b.c),a.g.add(b.x,
b.y,b.c),a.g.add(h.x,h.y,h.c),a.g.add(h.x,h.y,h.c),a.g.add(f.x,f.y,f.c),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.ha=[this.nc[0],this.nc[1],this.nc[2]],a.xa="LINES",a.uc=2,this.e.push(a))};B("X.slice",Jd);B("X.slice.prototype.create",Jd.prototype.create);function S(a){W.call(this);this.f="volume";this.v=[0,0,0];this.I=[10,10,10];this.lg=[10,10,10];this.dd=[1,1,1];this.Kb=[];this.Zf=this.ag=this.$f=this.Nc=this.xb=this.Mc=this.wb=this.Lc=this.vb=0;this.ue=[10,10,10];this.ad=new W;this.bd=new W;this.cd=new W;this.Od=this.eb=u;this.Wb=0;this.k=t;this.ub=q;this.ba=Infinity;this.aa=-Infinity;this.pg=q;this.sg=["left","posterior","superior"];this.Oe=[1,0,0,0,1,0,0,0,1];this.mg=[-1,0,0,0,-1,0,0,0,1];this.ja=[-1,-1,1];this.ig=[[-1,0,0],[0,-1,0],[0,0,1]];
this.ea=0;this.F=t;Ea(this,new pc);Ea(this,new cd);a!=t&&this.ec(a)}C(S,W);
S.prototype.ec=function(a){this.v=a.v.slice();this.I=a.I.slice();this.dd=a.dd.slice();this.vb=a.vb;this.Lc=a.Lc;this.wb=a.wb;this.Mc=a.Mc;this.xb=a.xb;this.Nc=a.Nc;this.$f=a.$f;this.ag=a.ag;this.Zf=a.Zf;this.ue=a.ue.slice();this.ad=new W(a.ad);this.bd=new W(a.bd);this.cd=new W(a.cd);this.sg=a.Ef;this.Oe=a.Oe;this.mg=a.mg;this.ja=a.ja;this.ig=a.ig;this.ea=a.ea;this.F=a.F;this.eb=a.eb;this.Od=a.Od;this.Wb=a.Wb;this.k=a.k;this.ub=a.ub;S.u.ec.call(this,a)};
S.prototype.fc=function(a){this.e.length=0;this.ad.e.length=0;this.bd.e.length=0;this.cd.e.length=0;this.e.push(this.ad);this.e.push(this.bd);this.e.push(this.cd);this.ta=a.xd;this.se=a.yd;this.tb=a.wd;this.Gk=a.Fb;this.Gh=a.Gb;this.sg=a.Ef;this.Oe=a.Ka;this.ja=a.orientation;this.ea=a.max;this.F=a.data;this.h=q};
S.prototype.q=function(a){a="undefined"!==typeof a?a:q;if(0<this.e.length){this.eb!=this.Od&&(this.eb?(this.e[0].e[parseInt(this.vb,10)].visible=u,this.e[1].e[parseInt(this.wb,10)].visible=u,this.e[2].e[parseInt(this.xb,10)].visible=u):this.e[this.Wb].visible=u,this.h=q,this.Od=this.eb);if(!this.ka)return;if(this.eb)Je(this,this.Wb);else for(var b=0,b=0;3>b;b++){var c=this.e[b],d=0,e=0;0==b?(d=this.vb,e=this.Lc,this.Lc=this.vb):1==b?(d=this.wb,e=this.Mc,this.Mc=this.wb):2==b&&(d=this.xb,e=this.Nc,
this.Nc=this.xb);if(this.e[b].e[parseInt(d,10)]==t){var f=new Float32Array(3);f[0]=this.b[b].wa[0][0][0]+Math.abs(this.b[b].va[0])*parseInt(d,10);f[1]=this.b[b].wa[0][0][1]+Math.abs(this.b[b].va[1])*parseInt(d,10);f[2]=this.b[b].wa[0][0][2]+Math.abs(this.b[b].va[2])*parseInt(d,10);if(this.Ba){var g=Id(f,this.b[b].n,this.b[b].ha,this.Hb,this.k.Pa,this.k,this.k.Ba,this.k.Ua.lb);this.k.e[b].e[parseInt(d,10)]=g;this.r.add(g)}f=Id(f,this.b[b].n,this.b[b].ha,this.Hb,this.Pa,this,q,t);this.Ba&&(f.k=f.Z,
f.k=this.k.e[b].e[parseInt(d,10)].Z);c.e[parseInt(d,10)]=f;this.r.add(f)}c.e[parseInt(e,10)].visible=u;c=c.e[parseInt(d,10)];c.visible=q;c.ga=1}}a&&S.u.q.call(this)};S.prototype.__defineGetter__("dimensions",v("I"));S.prototype.__defineGetter__("range",v("lg"));S.prototype.__defineGetter__("dimensionsRAS",v("ue"));S.prototype.__defineGetter__("volumeRendering",v("eb"));S.prototype.__defineSetter__("volumeRendering",function(a){this.eb=a;this.q(u)});S.prototype.__defineGetter__("visible",v("ka"));
S.prototype.__defineSetter__("visible",function(a){if(a)this.ka=a,this.q(u);else{for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.ka=a;this.h=q}});S.prototype.__defineGetter__("center",v("v"));S.prototype.__defineSetter__("center",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid center."));this.v=a});S.prototype.__defineGetter__("image",v("Kb"));S.prototype.__defineGetter__("labelmap",function(){this.k||(this.k=new Ke(this));return this.k});
S.prototype.__defineGetter__("indexX",v("vb"));S.prototype.__defineSetter__("indexX",function(a){x(a)&&(0<=a&&a<this.ad.e.length)&&(this.vb=a,this.q(u))});S.prototype.__defineGetter__("indexY",v("wb"));S.prototype.__defineSetter__("indexY",function(a){x(a)&&(0<=a&&a<this.bd.e.length)&&(this.wb=a,this.q(u))});S.prototype.__defineGetter__("indexZ",v("xb"));S.prototype.__defineSetter__("indexZ",function(a){x(a)&&(0<=a&&a<this.cd.e.length)&&(this.xb=a,this.q(u))});
S.prototype.__defineGetter__("windowLow",v("ba"));S.prototype.__defineSetter__("windowLow",ea("ba"));S.prototype.__defineGetter__("windowHigh",v("aa"));S.prototype.__defineSetter__("windowHigh",ea("aa"));S.prototype.__defineGetter__("borders",v("ub"));S.prototype.__defineSetter__("borders",ea("ub"));S.prototype.__defineGetter__("reslicing",v("pg"));S.prototype.__defineSetter__("reslicing",ea("pg"));
function Je(a,b){if(a.eb&&(a.h||b!=a.Wb)){var c=a.e[a.Wb];c.visible=u;var c=a.e[b],d=c.e.length,e;for(e=0;e<d;e++){if(c.e[e]==t){var f=new Float32Array(3);f[0]=a.b[b].wa[0][0][0]+Math.abs(a.b[b].va[0])*e;f[1]=a.b[b].wa[0][0][1]+Math.abs(a.b[b].va[1])*e;f[2]=a.b[b].wa[0][0][2]+Math.abs(a.b[b].va[2])*e;if(a.Ba){var g=Id(f,a.b[b].n,a.b[b].ha,a.Hb,a.k.Pa,a.k,a.k.Ba,a.k.Ua.lb);a.k.e[b].e[e]=g;a.r.add(g)}f=Id(f,a.b[b].n,a.b[b].ha,a.Hb,a.Pa,a,q,t);f.e[0].ka=u;a.Ba&&(f.k=f.Z,f.k=a.k.e[b].e[e].Z);c.e[e]=f;
a.r.add(f)}c.e[e].ka=q}a.Wb=b;a.h=u}}B("X.volume",S);B("X.volume.prototype.modified",S.prototype.q);function Le(){Dd.call(this);this.f="parserSTL"}C(Le,Dd);
Le.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");this.F=c;var d=b.g,e=b.l;if("solid"==Fd(Y(this,"uchar",5))){b.g=d=new U(c.byteLength);b.l=e=new U(c.byteLength);var f=d,d=e,e=Y(this,"uchar",c.byteLength-5);c=e.length;var g=u,h=u,l=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var j=Fd(e,l,k).split(" "),h=parseFloat(j[0]),m=parseFloat(j[1]),j=parseFloat(j[2]);g?(d.add(h,m,j),d.add(h,m,j),d.add(h,m,j)):f.add(h,m,j);h=g=u}}else 32==e[k-1]&&(102==e[k]?(l=k+=13,g=q):118==e[k]&&(l=k+=7,h=q))}else{this.H=
80;f=Y(this,"uint");b.g=d=new U(9*f);b.l=e=new U(9*f);for(c=c=0;c<f;c++)g=Y(this,"float",12),l=g[0],k=g[1],h=g[2],e.add(l,k,h),e.add(l,k,h),e.add(l,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.H+=2}H.Oa(this.f+".parse");f=new ed;f.fa=b;f.r=a;this.dispatchEvent(f)};B("X.parserSTL",Le);B("X.parserSTL.prototype.parse",Le.prototype.parse);function Me(){Dd.call(this);this.f="parserDCM"}C(Me,Dd);
Me.prototype.parse=function(a,b,c){c=this.rd(c,b);if(c.ee==c.nb){var d=c.Df.length,e,f=0;for(e=0;e<d;e++){var g=c.Df[d-1-e];g!==p&&(g*=c.rb,c.data.set(c.kd.subarray(g,g+c.rb),f*c.rb),f++)}b.I=[c.Aa[0],c.Aa[1],c.Aa[2]];Infinity==c.O[2]&&(1<c.location.length?(c.location.sort(),c.O[2]=Math.abs(c.location[0]-c.location[1])):c.O[2]=1);d=[c.O[0],c.O[1],c.O[2]];b.dd=d;f=Ed(c.data);e=f[0];f=f[1];c.min=b.Za=b.ba=e;c.max=b.ea=b.aa=f;-Infinity==b.Y&&(b.Y=e);Infinity==b.$&&(b.$=f);e=0;f=c.sd[0];for(g=0;++e<c.sd.length;)c.sd[e]>
f&&(g=e,f=c.sd[e]);f=c.gh[g].split("\\");g=Ac(new T(c.Ka[0],c.Ka[1],c.Ka[2]),new T(c.Ka[3],c.Ka[4],c.Ka[5]));e=Lc();Qc(e,0,-c.Ka[0],-c.Ka[3],-g.x,-f[0]);Qc(e,1,-c.Ka[1],-c.Ka[4],-g.y,-f[1]);Qc(e,2,c.Ka[2],c.Ka[5],g.c,f[2]);Qc(e,3,0,0,0,1);c.Fb=e;c.Gb=Lc();Uc(c.Fb,c.Gb);g=Kc(0,0,0,1);f=Jc();Wc(e,g,f);g=Kc(d[0],d[1],d[2],1);d=Jc();Wc(e,g,d);e=Gd(e,[0,b.I[0],b.I[1],b.I[2]]);c.yd=[d[0]-f[0],d[1]-f[1],d[2]-f[2]];c.wd=[e[1]-e[0],e[3]-e[2],e[5]-e[4]];c.xd=[e[0],e[2],e[4]];b.fc(c);b.Kb=Ld(this,b)}c=new ed;
c.fa=b;c.r=a;this.dispatchEvent(c)};
Me.prototype.rd=function(a,b){this.F=a;var c=0;if(b.mc!=t){d=b.mc;e=Y(this,"ushort",this.F.byteLength-2*d.rb);f=0;for(l=3;0<l;)if(g=e[f++],32==g)if(h=e[f++],19==h){f++;g=e[f++];for(h=0;h<g/2;h++)k=e[f++],j=k&255,k=(k&65280)>>8,c+=String.fromCharCode(j),c+=String.fromCharCode(k),c=parseInt(c,10);d.sd.push(c);l--}else if(50==h){f++;g=e[f++];m="";for(h=0;h<g/2;h++)k=e[f++],j=k&255,k=(k&65280)>>8,m+=String.fromCharCode(j),m+=String.fromCharCode(k);d.gh.push(m);l--}else if(4161==h){f++;g=e[f++];m="";for(h=
0;h<g/2;h++)k=e[f++],j=k&255,k=(k&65280)>>8,m+=String.fromCharCode(j),m+=String.fromCharCode(k);d.location.push(m);l--}d.Aa[2]++}else{var d={rows:0,cols:0,O:t,Te:0,$h:0,nb:1,Ui:1,Xk:t,ee:0,rb:0,kd:t,wf:0,Df:[],data:t,min:Infinity,max:-Infinity,location:[],gh:[],sd:[]};d.nb=b.o.length;d.nb==t&&(d.nb=1);for(var e=Y(this,"ushort",this.F.byteLength),f=66,g=t,h=t,g=t,l=9;0<l;)if(g=e[f++],40==g)switch(h=e[f++],f++,g=e[f++],h){case 16:d.rows=e[f++];l--;break;case 17:d.cols=e[f++];l--;break;case 256:d.Te=
e[f++];l--;break;case 257:d.$h=e[f++];l--;break;case 2:d.Ui=e[f++];l--;break;case 48:m="";for(h=h=0;h<g/2;h++)var k=e[f++],j=k&255,k=(k&65280)>>8,m=m+String.fromCharCode(j),m=m+String.fromCharCode(k);m=m.split("\\");d.O=[parseFloat(m[0]),parseFloat(m[1]),Infinity];l--}else if(32==g)switch(h=e[f++],f++,g=e[f++],h){case 19:for(h=0;h<g/2;h++)k=e[f++],j=k&255,k=(k&65280)>>8,c+=String.fromCharCode(j),c+=String.fromCharCode(k),c=parseInt(c,10);l--;break;case 50:for(var m="",h=0;h<g/2;h++)k=e[f++],j=k&255,
k=(k&65280)>>8,m+=String.fromCharCode(j),m+=String.fromCharCode(k);m=m.split("\\");d.origin=[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])];l--;break;case 55:m="";for(h=0;h<g/2;h++)k=e[f++],j=k&255,k=(k&65280)>>8,m+=String.fromCharCode(j),m+=String.fromCharCode(k);m=m.split("\\");d.Ka=[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3]),parseFloat(m[4]),parseFloat(m[5])];l--}else if(16==g)switch(h=e[f++],f++,g=e[f++],h){case 8720:for(h=0;h<g/2;h++)f++}b.mc=d;d.Aa=[d.cols,d.rows,
1];d.rb=d.rows*d.cols;switch(d.Te){case 8:d.kd=new Uint8Array(d.cols*d.rows*d.nb);d.data=new Uint8Array(d.cols*d.rows*d.nb);break;case 16:d.kd=new Uint16Array(d.cols*d.rows*d.nb);d.data=new Uint16Array(d.cols*d.rows*d.nb);break;case 32:d.kd=new Uint32Array(d.cols*d.rows*d.nb),d.data=new Uint32Array(d.cols*d.rows*d.nb)}}this.H=this.F.byteLength-2*d.rb;e=t;switch(d.Te){case 8:e=Y(this,"uchar",d.rb);break;case 16:e=Y(this,"ushort",d.rb);break;case 32:e=Y(this,"uint",d.rb)}d.Df[c]=d.wf;d.kd.set(e,d.wf*
d.rb);d.wf++;++d.ee;return d};B("X.parserDCM",Me);B("X.parserDCM.prototype.parse",Me.prototype.parse);function Ne(){Dd.call(this);this.f="parserVTK"}C(Ne,Dd);
Ne.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");var d=b.g,e=b.l,f=new Uint8Array(c),g="";b.g=d=new U(c.byteLength);b.l=e=new U(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Fd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.fd=this.gd=t;this.bc=[];this.Fa=bd;this.De=this.Rb=this.Jb=this.Sb=u;c=0;for(h=g%8;h--;)Oe(this,f[c]),c++;for(h=0.125*g^0;h--;)Oe(this,f[c]),c++,Oe(this,f[c]),c++,Oe(this,f[c]),c++,Oe(this,f[c]),c++,Oe(this,f[c]),c++,Oe(this,f[c]),c++,Oe(this,f[c]),c++,
Oe(this,f[c]),c++;c=this.gd;var f=this.fd,g=f.length,l=h=this.bc.length;do{var k=this.bc[h-l],j=k.length,m;for(m=0;m<j&&!("LINES"==this.Fa&&m+1>=j);m++){var r=parseInt(k[m],10),s=c.get(r);d.add(s[0],s[1],s[2]);var y=r,z=s;"LINES"==this.Fa?(y=parseInt(k[m+1],10),z=c.get(y),d.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.Fa&&(0==m||m==j-1)&&d.add(s[0],s[1],s[2]);r<g?(z=f.get(r),e.add(z[0],z[1],z[2]),"LINES"==this.Fa?(y=f.get(y),e.add(y[0],y[1],y[2])):"TRIANGLE_STRIPS"==this.Fa&&(0==m||m==j-1)&&e.add(z[0],
z[1],z[2])):(y=new T(s[0],s[1],s[2]),y.normalize(),e.add(y.x,y.y,y.c),"LINES"==this.Fa?(y=new T(z[0],z[1],z[2]),y.normalize(),e.add(y.x,y.y,y.c)):"TRIANGLE_STRIPS"==this.Fa&&(0==m||m==j-1)&&e.add(y.x,y.y,y.c))}l--}while(0<l);b.xa=this.Fa;H.Oa(this.f+".parse");d=new ed;d.fa=b;d.r=a;this.dispatchEvent(d)};
function Oe(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Sb=q;a.Jb=u;a.Rb=u;c=parseInt(c[1],10);a.gd=new U(3*c);a.fd=new U(3*c);return;case "VERTICES":a.Jb=q;a.Sb=u;a.Rb=u;c=parseInt(c[1],10);3<=c?a.Fa=bd:1==c?a.Fa="POINTS":n(Error("This VTK file is not supported!"));a.bc=[];return;case "TRIANGLE_STRIPS":a.Jb=q;a.Sb=u;a.Rb=u;a.Fa="TRIANGLE_STRIPS";a.bc=[];return;case "LINES":a.Jb=q;a.Sb=u;a.Rb=u;a.Fa="LINES";a.bc=[];return;case "POLYGONS":a.Jb=q;
a.Sb=u;a.Rb=u;a.Fa="POLYGONS";a.bc=[];return;case "POINT_DATA":a.Rb=q;a.Sb=u;a.Jb=u;return}if(a.Sb)if(1==d||isNaN(parseFloat(e)))a.Sb=u;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.gd.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.gd.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.gd.add(d,e,c))}else a.Jb?1==d||isNaN(parseFloat(e))?a.Jb=u:(c=c.slice(1),a.bc.push(c)):a.Rb&&("NORMALS"==e?a.De=q:1==d||isNaN(parseFloat(e))?
(a.Rb=u,a.De=u):a.De&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.fd.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.fd.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.fd.add(d,e,c))))}B("X.parserVTK",Ne);B("X.parserVTK.prototype.parse",Ne.prototype.parse);function Pe(){Dd.call(this);this.f="parserFSM";this.Fd=u}C(Pe,Dd);
Pe.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");this.F=c;var d=b.g,e=b.l;b.vc=[];var f=b.vc;c=0;var g;do g=Y(this,"uchar"),c++;while(200>c&&10!=g);Y(this,"uchar");e=Y(this,"uint");c=Y(this,"uint");var h=Y(this,"float",3*e);g=Y(this,"uint",3*c);var l=new Uint32Array(e),k=new Float32Array(9*c);b.g=d=new U(9*c);b.l=e=new U(9*c);var j;for(j=0;j<c;j++){var m=3*j,r=g[m],s=g[m+1],y=g[m+2];f.push(r);f.push(s);f.push(y);l[r]+=1;l[s]+=1;l[y]+=1;var m=3*r,z=3*s,D=3*y,E=h[m],G=h[m+1],A=h[m+2],s=h[z],
y=h[z+1],r=h[z+2],F=h[D],I=h[D+1],J=h[D+2];d.add(E,G,A);d.add(s,y,r);d.add(F,I,J);E=new T(E,G,A);F=new T(F,I,J);s=(new T(s,y,r)).i().ya(E);y=F.i().ya(E);s=Ac(s,y).normalize();k[m]+=s.x;k[m+1]+=s.y;k[m+2]+=s.c;k[z]+=s.x;k[z+1]+=s.y;k[z+2]+=s.c;k[D]+=s.x;k[D+1]+=s.y;k[D+2]+=s.c}for(j=0;j<c;j++)m=3*j,r=g[m],s=g[m+1],y=g[m+2],m=3*r,z=3*s,D=3*y,f=new T(k[z],k[z+1],k[z+2]),h=new T(k[D],k[D+1],k[D+2]),m=(new T(k[m],k[m+1],k[m+2])).scale(1/l[r]).normalize(),f=f.scale(1/l[s]).normalize(),h=h.scale(1/l[y]).normalize(),
e.add(m.x,m.y,m.c),e.add(f.x,f.y,f.c),e.add(h.x,h.y,h.c);c=Y(this,"uchar",this.F.byteLength-this.H);g=t;for(m=0;m<c.length;m++)if(99==c[m]&&114==c[m+1]&&97==c[m+2]&&115==c[m+3]){for(e=g=m+9;10!=c[m]&&m<c.length;)e++,m++;g=Fd(c.subarray(g,e)).split(" ");break}g&&(b.U.vh(parseFloat(g[0])),b.U.wh(parseFloat(g[1])),b.U.xh(parseFloat(g[2])));b.xa=bd;H.Oa(this.f+".parse");c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};B("X.parserFSM",Pe);B("X.parserFSM.prototype.parse",Pe.prototype.parse);var Qe={Xe:function(a,b,c){return Qe.update(a,0,b,c)},update:function(a,b,c,d){var e=Qe.Ch,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0}};
Qe.Ch=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Re(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,l,k,j,m,r;for(m=0;m<b;++m)a[m]>c&&(c=a[m]),a[m]<d&&(d=a[m]);e=1<<c;f=new Uint32Array(e);g=1;h=0;for(l=2;g<=c;){for(m=0;m<b;++m)if(a[m]===g){k=0;j=h;for(r=0;r<g;++r)k=k<<1|j&1,j>>=1;for(r=k;r<e;r+=l)f[r]=g<<16|m;++h}++g;h<<=1;l<<=1}return[f,c,d]};function Se(a,b){this.Ue=[];this.Ve=32768;this.fb=this.hd=this.sa=this.If=0;this.input=new Uint8Array(a);this.wg=u;this.We=Te;this.Cb=u;if(b||!(b={}))b.index&&(this.sa=b.index),b.bufferSize&&(this.Ve=b.bufferSize),b.bufferType&&(this.We=b.bufferType),b.resize&&(this.Cb=b.resize);switch(this.We){case Ue:this.X=32768;this.Ha=new Uint8Array(32768+this.Ve+258);break;case Te:this.X=0;this.Ha=new Uint8Array(this.Ve);this.hc=this.mi;this.zg=this.ci;this.cf=this.gi;break;default:n(Error("invalid inflate mode"))}}
var Ue=0,Te=1;
Se.prototype.ld=function(){for(;!this.wg;){var a=Ve(this,3);a&1&&(this.wg=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.sa,c=this.Ha,d=this.X,e=p,f=p,g=p,h=c.length,e=p;this.fb=this.hd=0;e=a[b++];e===p&&n(Error("invalid uncompressed block header: LEN (first byte)"));f=e;e=a[b++];e===p&&n(Error("invalid uncompressed block header: LEN (second byte)"));f|=e<<8;e=a[b++];e===p&&n(Error("invalid uncompressed block header: NLEN (first byte)"));g=e;e=a[b++];e===p&&n(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
e<<8;f===~g&&n(Error("invalid uncompressed block header: length verify"));b+f>a.length&&n(Error("input buffer is broken"));switch(this.We){case Ue:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.X=d,c=this.hc(),d=this.X;break;case Te:for(;d+f>c.length;)c=this.hc({Fg:2});break;default:n(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d);d+=f;this.sa=b+=f;this.X=d;this.Ha=c;break;case 1:this.cf(We,Xe);break;case 2:Ye(this);break;default:n(Error("unknown BTYPE: "+a))}}return this.zg()};
var Ze=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),af=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),bf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),cf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),df=new Uint8Array(288),
ef,ff;ef=0;for(ff=df.length;ef<ff;++ef)df[ef]=143>=ef?8:255>=ef?9:279>=ef?7:8;var We=Re(df),gf=new Uint8Array(30),hf,jf;hf=0;for(jf=gf.length;hf<jf;++hf)gf[hf]=5;var Xe=Re(gf);function Ve(a,b){for(var c=a.hd,d=a.fb,e=a.input,f=a.sa,g;d<b;)g=e[f++],g===p&&n(Error("input buffer is broken")),c|=g<<d,d+=8;g=c&(1<<b)-1;a.hd=c>>>b;a.fb=d-b;a.sa=f;return g}
function kf(a,b){for(var c=a.hd,d=a.fb,e=a.input,f=a.sa,g=b[0],h=b[1],l;d<h;)l=e[f++],l===p&&n(Error("input buffer is broken")),c|=l<<d,d+=8;e=g[c&(1<<h)-1];g=e>>>16;a.hd=c>>g;a.fb=d-g;a.sa=f;return e&65535}
function Ye(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=kf(this,b),d){case 16:for(d=3+Ve(this,2);d--;)c[f++]=e;break;case 17:for(d=3+Ve(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+Ve(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=Ve(a,5)+257,d=Ve(a,5)+1,e=Ve(a,4)+4,f=new Uint8Array(Ze.length),g;for(g=0;g<e;++g)f[Ze[g]]=Ve(a,3);e=Re(f);f=new Uint8Array(c);g=new Uint8Array(d);a.cf(Re(b.call(a,c,e,f)),Re(b.call(a,d,e,g)))}w=Se.prototype;
w.cf=function(a,b){var c=this.Ha,d=this.X;this.Cg=a;for(var e=c.length-258,f,g,h;256!==(f=kf(this,a));)if(256>f)d>=e&&(this.X=d,c=this.hc(),d=this.X),c[d++]=f;else{f-=257;h=$e[f];0<af[f]&&(h+=Ve(this,af[f]));f=kf(this,b);g=bf[f];0<cf[f]&&(g+=Ve(this,cf[f]));d>=e&&(this.X=d,c=this.hc(),d=this.X);for(;h--;)c[d]=c[d++-g]}for(;8<=this.fb;)this.fb-=8,this.sa--;this.X=d};
w.gi=function(a,b){var c=this.Ha,d=this.X;this.Cg=a;for(var e=c.length,f,g,h;256!==(f=kf(this,a));)if(256>f)d>=e&&(c=this.hc(),e=c.length),c[d++]=f;else{f-=257;h=$e[f];0<af[f]&&(h+=Ve(this,af[f]));f=kf(this,b);g=bf[f];0<cf[f]&&(g+=Ve(this,cf[f]));d+h>e&&(c=this.hc(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.fb;)this.fb-=8,this.sa--;this.X=d};
w.hc=function(){var a=new Uint8Array(this.X-32768),b=this.X-32768,c=this.Ha;a.set(c.subarray(32768,a.length));this.Ue.push(a);this.If+=a.length;c.set(c.subarray(b,b+32768));this.X=32768;return c};w.mi=function(a){var b=this.input.length/this.sa+1|0,c=this.input,d=this.Ha;a&&("number"===typeof a.Fg&&(b=a.Fg),"number"===typeof a.Wh&&(b+=a.Wh));2>b?(a=(c.length-this.sa)/this.Cg[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;a=new Uint8Array(a);a.set(d);return this.Ha=a};
w.zg=function(){var a=0,b=this.Ha,c=this.Ue,d,e=new Uint8Array(this.If+(this.X-32768)),f,g,h,l;if(0===c.length)return this.Ha.subarray(32768,this.X);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(l=d.length;h<l;++h)e[a++]=d[h]}f=32768;for(g=this.X;f<g;++f)e[a++]=b[f];this.Ue=[];return this.buffer=e};w.ci=function(){var a,b=this.X;this.Cb?(a=new Uint8Array(b),a.set(this.Ha.subarray(0,b))):a=this.Ha.subarray(0,b);return this.buffer=a};new Uint8Array(256);var lf;for(lf=0;256>lf;++lf)for(var mf=lf,nf=7,mf=mf>>>1;mf;mf>>>=1)--nf;var of=[],pf;for(pf=0;288>pf;pf++)switch(q){case 143>=pf:of.push([pf+48,8]);break;case 255>=pf:of.push([pf-144+400,9]);break;case 279>=pf:of.push([pf-256+0,7]);break;case 287>=pf:of.push([pf-280+192,8]);break;default:n("invalid literal: "+pf)}
function qf(){var a=rf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:n("invalid length: "+a)}}var sf=[],rf,tf;
for(rf=3;258>=rf;rf++)tf=qf(),sf[rf]=tf[2]<<24|tf[1]<<16|tf[0];new Uint32Array(sf);function uf(){};function vf(a){this.input=a;this.sa=0;this.member=[]}
vf.prototype.ld=function(){for(var a=this.input.length;this.sa<a;){var b=new uf,c=p,d=p,e=p,f=c=e=p,g=p,c=c=p,h=this.input,d=this.sa;b.Lg=h[d++];b.Mg=h[d++];(31!==b.Lg||139!==b.Mg)&&n(Error("invalid file signature:",b.Lg,b.Mg));b.yg=h[d++];switch(b.yg){case 8:break;default:n(Error("unknown compression method: "+b.yg))}b.Wd=h[d++];c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24;b.$k=new Date(1E3*c);b.el=h[d++];b.al=h[d++];0<(b.Wd&4)&&(b.Qj=h[d++]|h[d++]<<8,d+=b.Qj);if(0<(b.Wd&8)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.Wd&16)){g=[];for(f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.Wd&2)&&(b.di=Qe.Xe(h,0,d)&65535,b.di!==(h[d++]|h[d++]<<8)&&n(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-d-4-4<512*c&&(e=c);d=new Se(h,{index:d,bufferSize:e});b.data=e=d.ld();d=d.sa;b.Rk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;Qe.Xe(e)!==c&&n(Error("invalid CRC-32 checksum: 0x"+Qe.Xe(e).toString(16)+
" / 0x"+c.toString(16)));b.Wk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0;(e.length&4294967295)!==c&&n(Error("invalid input size: "+(e.length&4294967295)+" / "+c));this.member.push(b);this.sa=d}a=this.member;b=e=d=0;for(h=a.length;b<h;++b)e+=a[b].data.length;e=new Uint8Array(e);for(b=0;b<h;++b)e.set(a[b].data,d),d+=a[b].data.length;return e};function wf(){Dd.call(this);this.f="parserMGZ";this.Fd=u}C(wf,Dd);
wf.prototype.parse=function(a,b,c,d){H.Ta(this.f+".parse");d&&(c=(new vf(new Uint8Array(c))).ld(),c=c.buffer);d=this.rd(c);var e=[d.lf,d.mf,d.nf];b.I=e;c=d.yh;b.dd=c;var f=d.min,g=d.max;b.Za=b.ba=f;b.ea=b.aa=g;-Infinity==b.Y&&(b.Y=f);Infinity==b.$&&(b.$=g);f=Lc();Qc(f,0,d.Sa[0][0],d.Sa[1][0],d.Sa[2][0],0);Qc(f,1,d.Sa[0][1],d.Sa[1][1],d.Sa[2][1],0);Qc(f,2,d.Sa[0][2],d.Sa[1][2],d.Sa[2][2],0);Qc(f,3,0,0,0,1);for(var g=e[0]/2,h=e[1]/2,l=e[2]/2,e=[0,0,0],k=0;3>k;++k)e[k]=d.Sa[3][k]-(f[k+0]*c[0]*g+f[k+
4]*c[1]*h+f[k+8]*c[2]*l);g=e[1];h=e[2];f[12]=e[0];f[13]=g;f[14]=h;f[15]=1;d.Fb=f;d.Gb=Lc();Uc(d.Fb,d.Gb);g=Kc(0,0,0,1);e=Jc();Wc(f,g,e);g=Kc(c[0],c[1],c[2],1);c=Jc();Wc(f,g,c);f=Gd(f,[0,b.I[0],b.I[1],b.I[2]]);d.yd=[c[0]-e[0],c[1]-e[1],c[2]-e[2]];d.wd=[f[1]-f[0],f[3]-f[2],f[5]-f[4]];d.xd=[f[0],f[2],f[4]];b.fc(d);H.Oa(this.f+".parse");b.Kb=Ld(this,b);d=new ed;d.fa=b;d.r=a;this.dispatchEvent(d)};
wf.prototype.rd=function(a){this.F=a;a={version:0,Fh:0,Dh:0,si:0,Eh:0,lf:0,mf:0,nf:0,Ti:0,type:0,ki:0,ph:0,Wj:t,Sa:t,yh:t,data:t,min:Infinity,max:-Infinity};a.version=Y(this,"uint");a.lf=Y(this,"uint");a.mf=Y(this,"uint");a.nf=Y(this,"uint");a.Ti=Y(this,"uint");a.type=Y(this,"uint");a.ki=Y(this,"uint");a.ph=Y(this,"ushort");if(0<a.ph){a.yh=Y(this,"float",3);var b=[];b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));a.Sa=b}this.H=284;b=a.lf*a.mf*
a.nf;switch(a.type){case 0:a.data=Y(this,"uchar",b);break;case 1:a.data=Y(this,"uint",b);break;case 3:a.data=Y(this,"float",b);break;case 4:a.data=Y(this,"ushort",b);break;default:n(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ed(a.data);a.min=b[0];a.max=b[1];this.H+16<this.F.byteLength&&(a.Fh=Y(this,"float"),a.si=Y(this,"float"),a.Dh=Y(this,"float"),a.Eh=Y(this,"float"));return a};B("X.parserMGZ",wf);B("X.parserMGZ.prototype.parse",wf.prototype.parse);function xf(){Dd.call(this);this.f="parserCRV";this.Fd=u}C(xf,Dd);
xf.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");var d=b.vc;0==d.length&&n(Error("No _pointIndices defined on the X.object."));this.F=c;this.H=3;var e=Y(this,"uint");Y(this,"uint");Y(this,"uint");var f=0,g=0,h=0,l=0,k=0,j=0,m=0,r=0,s=0,y=0,z=0;c=Array(2);var D=Array(2),E=Y(this,"float",e),G;for(G=0;G<e;G++){var A=E[G];0==G&&(c[0]=D[0]=A);0<=A?(f++,l+=A):(g++,h+=A);s+=A;z++;D[0]=Math.max(A,D[0]);c[0]=Math.min(A,c[0]);E[G]=A}0!=f&&(k=l/f);0!=g&&(j=h/g);0!=z&&(y=s/z);for(z=s=h=l=0;z<e;z++)A=
E[z],G=0,0<=A?(G=Math.pow(A-k,2),l+=G):(G=Math.pow(A-j,2),h+=G),G=Math.pow(A-y,2),s+=G;1<f&&(m=Math.sqrt(l/(f-1)));1<g&&(r=Math.sqrt(h/(g-1)));c[1]=j-2.5*r;D[1]=k+2.5*m;e=d.length;f=new Float32Array(3*e);for(z=0;z<e;z++)g=E[d[z]],h=3*z,f[h]=g,f[h+1]=g,f[h+2]=g;b.A.Za=c[1];b.A.ea=D[1];-Infinity==b.A.Y&&(b.A.Y=c[1]);Infinity==b.A.$&&(b.A.$=D[1]);b.A.z=E;b.A.Kc=f;b.A.h=q;H.Oa(this.f+".parse");d=new ed;d.fa=b;d.r=a;this.dispatchEvent(d)};B("X.parserCRV",xf);B("X.parserCRV.prototype.parse",xf.prototype.parse);function yf(){Dd.call(this);this.f="parserTRK"}C(yf,Dd);
yf.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");var d=b.g,e=b.l,f=b.da;this.F=c;Y(this,"uchar",6);Y(this,"ushort",3);var g=Y(this,"float",3);Y(this,"float",3);var h=Y(this,"ushort");Y(this,"uchar",200);Y(this,"ushort");Y(this,"uchar",200);c=Y(this,"float",16);Y(this,"uchar",444);Y(this,"uchar",4);Y(this,"uchar",4);Y(this,"float",6);Y(this,"uchar",2);Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");var l=Y(this,"uint");Y(this,"uint");var k=Y(this,
"uint"),j=[],m=[],r=Infinity,s=-Infinity,y=t,z=t,D=t,E=t,e=d=t,G=Y(this,"uint",(this.F.byteLength-1E3)/4);this.H=k;for(var A=Y(this,"float",(this.F.byteLength-1E3)/4),F=0,k=f=0;k<l;k++){for(var I=G[F],J=new U(3*I),R=0,M=0;M<I;M++){var V=A[F+3*M+M*h+1],aa=A[F+3*M+M*h+2],Z=A[F+3*M+M*h+3],V=V/g[0],aa=aa/g[1],Z=Z/g[2];J.add(V,aa,Z);if(0<M)var ba=J.get(M-1),R=R+Math.sqrt(Math.pow(V-ba[0],2)+Math.pow(aa-ba[1],2)+Math.pow(Z-ba[2],2));M<I-1&&(f+=6)}F+=3*I+I*h+1;M=J.$a;I=J.Wa;V=J.ab;aa=J.Xa;Z=J.bb;ba=J.Ya;
if(!y||M<y)y=M;if(!z||I>z)z=I;if(!D||V<D)D=V;if(!E||aa>E)E=aa;if(!d||Z<d)d=Z;if(!e||ba>e)e=ba;j.push(J);m.push(R)}g=(y+z)/2;D=(D+E)/2;h=(d+e)/2;E=new Float32Array(f);b.g=d=new U(f);b.l=e=new U(f);b.da=f=new U(f);for(k=y=0;k<l;k++){z=j[k];G=z.count;R=m[k];r=Math.min(r,R);s=Math.max(s,R);for(M=0;M<G-1;M++){F=z.get(M);A=z.get(M+1);d.add(F[0],F[1],F[2]);d.add(A[0],A[1],A[2]);var J=F[0]-g,I=F[1]-D,V=F[2]-h,aa=Math.sqrt(J*J+I*I+V*V),Z=A[0]-g,ba=A[1]-D,K=A[2]-h,N=Math.sqrt(Z*Z+ba*ba+K*K);e.add(J/aa,I/aa,
V/aa);e.add(Z/N,ba/N,K/N);A=[Math.abs(A[0]-F[0]),Math.abs(A[1]-F[1]),Math.abs(A[2]-F[2])];F=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);A[0]/=F;A[1]/=F;A[2]/=F;f.add(A[0],A[1],A[2]);f.add(A[0],A[1],A[2]);E[y++]=R;E[y++]=R;E[y++]=R;E[y++]=R;E[y++]=R;E[y++]=R}}b.xa="LINES";l=new dd;l.Za=r;l.ea=s;l.Y=r;l.$=s;l.Kc=E;l.og=u;l.h=q;b.A=l;H.Oa(this.f+".parse");H.d.Jf(c,b.U.oa);c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};B("X.parserTRK",yf);B("X.parserTRK.prototype.parse",yf.prototype.parse);function zf(){Dd.call(this);this.f="parserIMAGE"}C(zf,Dd);zf.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||n(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;Ub(f,"load",this.vj.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};zf.prototype.vj=function(a,b,c){b.Kb=a;b.Tb=t;a=new ed;a.fa=c;a.r=b;this.dispatchEvent(a)};B("X.parserIMAGE",zf);B("X.parserIMAGE.prototype.parse",zf.prototype.parse);function Af(){Dd.call(this);this.f="parserLUT"}C(Af,Dd);
Af.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");this.F=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Fd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}H.Oa(this.f+".parse");c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};
B("X.parserLUT",Af);B("X.parserLUT.prototype.parse",Af.prototype.parse);function Bf(){Dd.call(this);this.f="parserNRRD"}C(Bf,Dd);
Bf.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");this.F=c;c=Y(this,"uchar",c.byteLength);var d=c.length,e=t,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Fd(c,0,g-2);f=g+1;break}var h,l,k,j,d=e.split(/\r?\n/),e=0;for(g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Li=q;else if(!h.match(/^#/)&&(j=h.match(/(.*):(.*)/)))l=j[1].trim(),h=j[2].trim(),(k=this.oi[l])?k.call(this,h):this[l]=h;this.Li||n(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
n(Error("Only raw or gz/gzip encoding is allowed"));if(!this.S&&(this.S=[new T(1,0,0),new T(0,1,0),new T(0,0,1)],this.Gf)){d=[];for(j=0;2>=j;j++)d.push(!isNaN(this.Gf[j])?this.S[j].scale(this.Gf[j]):p)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new vf(new Uint8Array(f))).ld();f=f.buffer;c={data:t,min:Infinity,max:-Infinity};c.data=new this.Ib(f);f=Ed(c.data);e=c.min=f[0];g=c.max=f[1];b.Za=b.ba=e;b.ea=b.aa=g;b.I=[this.Bf[0],this.Bf[1],this.Bf[2]];f=(new T(this.S[0][0],this.S[0][1],
this.S[0][2])).Bb();j=(new T(this.S[1][0],this.S[1][1],this.S[1][2])).Bb();d=(new T(this.S[2][0],this.S[2][1],this.S[2][2])).Bb();b.dd=[f,j,d];-Infinity==b.Y&&(b.Y=e);Infinity==b.$&&(b.$=g);h=g=1;"left-posterior-superior"==this.Ef&&(h=g=-1);e=Mc();Qc(e,0,g*this.S[0][0],g*this.S[1][0],g*this.S[2][0],g*this.Ff[0]);Qc(e,1,h*this.S[0][1],h*this.S[1][1],h*this.S[2][1],h*this.Ff[1]);Qc(e,2,1*this.S[0][2],1*this.S[1][2],1*this.S[2][2],1*this.Ff[2]);Qc(e,3,0,0,0,1);c.Fb=e;c.Gb=Lc();Uc(c.Fb,c.Gb);h=Kc(0,0,
0,1);g=Jc();Wc(e,h,g);j=Kc(f,j,d,1);f=Jc();Wc(e,j,f);j=Gd(e,[0,b.I[0],b.I[1],b.I[2]]);c.yd=[f[0]-g[0],f[1]-g[1],f[2]-g[2]];c.wd=[j[1]-j[0],j[3]-j[2],j[5]-j[4]];c.xd=[j[0],j[2],j[4]];b.fc(c);H.Oa(this.f+".parse");b.Kb=Ld(this,b);c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};
Bf.prototype.oi={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Ib=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Ib=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Ib=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Ib=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Ib=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Ib=Uint32Array;break;case "float":this.Ib=Float32Array;break;case "double":this.Ib=Float64Array;break;default:n(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.Uk=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Aa=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));
return this.Bf=e},space:function(a){return this.Ef=a},"space origin":function(a){return this.Ff=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.S=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));
return this.Gf=e}};B("X.parserNRRD",Bf);B("X.parserNRRD.prototype.parse",Bf.prototype.parse);function Cf(){Dd.call(this);this.f="parserNII"}C(Cf,Dd);
Cf.prototype.parse=function(a,b,c){var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=e&&(d=(new vf(new Uint8Array(d))).ld(),d=d.buffer);c=this.rd(d);d=c.min;e=c.max;b.Za=b.ba=d;b.ea=b.aa=e;-Infinity==b.Y&&(b.Y=d);Infinity==b.$&&(b.$=e);d=Lc();Qc(d,3,0,0,0,1);if(0==c.xf)Qc(d,0,c.O[1],0,0,0),Qc(d,0,0,c.O[2],0,0),Qc(d,0,0,0,c.O[3],0);else if(0<c.xf){var e=0,f=c.mh,g=c.nh,h=c.oh,l=1,k=1,j=1,m=c.jh,r=c.kh,s=c.lh,e=1-(f*f+g*g+h*h);1E-7>e?(e=1/
Math.sqrt(f*f+g*g+h*h),f*=e,g*=e,h*=e,e=0):e=Math.sqrt(e);0<c.O[1]&&(l=c.O[1]);0<c.O[2]&&(k=c.O[2]);0<c.O[2]&&(j=c.O[3]);0>c.O[0]&&(j=-j);Qc(d,0,(e*e+f*f-g*g-h*h)*l,2*(f*g-e*h)*k,2*(f*h+e*g)*j,m);Qc(d,1,2*(f*g+e*h)*l,(e*e+g*g-f*f-h*h)*k,2*(g*h-e*f)*j,r);Qc(d,2,2*(f*h-e*g)*l,2*(g*h+e*f)*k,(e*e+h*h-g*g-f*f)*j,s)}else 0<c.qh?(e=c.sh,f=c.th,g=c.uh,Qc(d,0,e[0],e[1],e[2],e[3]),Qc(d,1,f[0],f[1],f[2],f[3]),Qc(d,2,g[0],g[1],g[2],g[3])):window.console.log("UNKNOWN METHOD IN PARSER NII");c.Fb=d;c.Gb=Lc();Uc(c.Fb,
c.Gb);f=Kc(0,0,0,1);e=Jc();Wc(d,f,e);g=Kc(c.O[1],c.O[2],c.O[3],1);f=Jc();Wc(d,g,f);d=Gd(d,c.Aa);c.yd=[f[0]-e[0],f[1]-e[1],f[2]-e[2]];c.wd=[d[1]-d[0],d[3]-d[2],d[5]-d[4]];c.xd=[d[0],d[2],d[4]];b.I=[c.Aa[1],c.Aa[2],c.Aa[3]];b.fc(c);b.Kb=Ld(this,b);c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};
Cf.prototype.rd=function(a){this.F=a;a={Gj:0,ei:t,fi:t,ni:0,Ej:0,zj:0,ji:t,Aa:t,Hi:0,Ii:0,Ji:0,Fi:0,bf:0,Zh:0,Kj:0,O:t,zh:0,Dj:0,Cj:0,Jj:0,Hj:t,Rj:t,ai:0,bi:0,Ij:0,Oj:0,ui:0,vi:0,hi:t,Yh:t,xf:0,qh:0,mh:0,nh:0,oh:0,jh:0,kh:0,lh:0,sh:t,th:t,uh:t,Gi:t,Ni:t,data:t,min:Infinity,max:-Infinity};a.Gj=Y(this,"uint");a.ei=Y(this,"uchar",10);a.fi=Y(this,"uchar",18);a.ni=Y(this,"uint");a.Ej=Y(this,"ushort");a.zj=Y(this,"uchar");a.ji=Y(this,"uchar");a.Aa=Y(this,"ushort",8);a.Hi=Y(this,"float");a.Ii=Y(this,"float");
a.Ji=Y(this,"float");a.Fi=Y(this,"ushort");a.bf=Y(this,"ushort");a.Zh=Y(this,"ushort");a.Kj=Y(this,"ushort");a.O=Y(this,"float",8);a.zh=Y(this,"float");a.Dj=Y(this,"float");a.Cj=Y(this,"float");a.Jj=Y(this,"ushort");a.Hj=Y(this,"uchar");a.Rj=Y(this,"uchar");a.ai=Y(this,"float");a.bi=Y(this,"float");a.Ij=Y(this,"float");a.Oj=Y(this,"float");a.ui=Y(this,"uint",1);a.vi=Y(this,"uint",1);a.hi=Y(this,"uchar",80);a.Yh=Y(this,"uchar",24);a.xf=Y(this,"ushort");a.qh=Y(this,"ushort");a.mh=Y(this,"float");a.nh=
Y(this,"float");a.oh=Y(this,"float");a.jh=Y(this,"float");a.kh=Y(this,"float");a.lh=Y(this,"float");a.sh=Y(this,"float",4);a.th=Y(this,"float",4);a.uh=Y(this,"float",4);a.Gi=Y(this,"uchar",16);a.Ni=Y(this,"uchar",4);this.H=parseInt(a.zh,10);var b=a.Aa[1]*a.Aa[2]*a.Aa[3];switch(a.bf){case 2:a.data=Y(this,"uchar",b);break;case 4:a.data=Y(this,"sshort",b);break;case 8:a.data=Y(this,"sint",b);break;case 16:a.data=Y(this,"float",b);break;case 32:a.data=Y(this,"complex",b);break;case 64:a.data=Y(this,"double",
b);break;case 256:a.data=Y(this,"schar",b);break;case 512:a.data=Y(this,"ushort",b);break;case 768:a.data=Y(this,"uint",b);break;default:n(Error("Unsupported NII data type: "+a.bf))}b=Ed(a.data);a.min=b[0];a.max=b[1];return a};B("X.parserNII",Cf);B("X.parserNII.prototype.parse",Cf.prototype.parse);function Df(){Dd.call(this);this.f="parserOBJ"}C(Df,Dd);
Df.prototype.parse=function(a,b,c){H.Ta(this.f+".parse");this.F=c;c=c.byteLength;var d=Y(this,"uchar",c),e=[];b.g=new U(c);b.l=new U(c);var f=b.g,g=b.l,h=0,l;for(l=0;l<c;++l)if(10==d[l]){var k=Fd(d,h,l).replace(/\s{2,}/g," ").split(" ");if("v"==k[0])e.push([parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])]);else if("f"==k[0]){var j=e[parseInt(k[1],10)-1],h=e[parseInt(k[2],10)-1],k=e[parseInt(k[3],10)-1];f.add(j[0],j[1],j[2]);f.add(h[0],h[1],h[2]);f.add(k[0],k[1],k[2]);j=new T(j[0],j[1],j[2]);k=
new T(k[0],k[1],k[2]);h=Ac((new T(h[0],h[1],h[2])).ya(j),k.ya(j));h.normalize();g.add(h.x,h.y,h.c);g.add(h.x,h.y,h.c);g.add(h.x,h.y,h.c)}h=l+1}H.Oa(this.f+".parse");c=new ed;c.fa=b;c.r=a;this.dispatchEvent(c)};B("X.parserOBJ",Df);B("X.parserOBJ.prototype.parse",Df.prototype.parse);function Ef(){Q.call(this);this.f="loader";this.tc=new rc;this.Yc=0}C(Ef,Q);function Ff(a,b){a.Yc+=b/a.tc.Xd()/3;a.Yc=Math.min(1,a.Yc);var c=new Cd;c.ug=a.Yc;a.dispatchEvent(c)}function Gf(a){a=a.o.Kd;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Hf||n(Error("The "+b+" file format is not supported."));return[a,b,Hf[b][0],Hf[b][1],Hf[b][2]]}
Ef.prototype.load=function(a,b){(!a||!b)&&n(Error("No container or object to load."));if(!uc(this.tc.R,a.na)||this.tc.get(a.na)){this.tc.set(a.na,u);var c=Gf(a)[0];if(a.ib!=t)this.parse(t,a,b);else{var d=new XMLHttpRequest;P(d,"abort",this.Eg.bind(this,d,a,b));P(d,"error",this.Eg.bind(this,d,a,b));P(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,q);d.responseType="arraybuffer";d.send(t)}}};
Ef.prototype.parse=function(a,b,c){Ff(this,1);setTimeout(function(){var d=Gf(b),e=d[3],d=new d[2];Ub(d,qd,this.complete.bind(this));var f=b.ib;f==t&&(f=a.response,b.ib=f);d.parse(b,c,f,e)}.bind(this),100)};Ef.prototype.complete=function(a){Ff(this,1);setTimeout(function(){var b=a.r,c=a.fa;b.o.h=u;b.h=q;c.q();this.tc.set(b.na,q)}.bind(this),100)};Ef.prototype.Eg=function(a,b,c){n(Error("Loading failed: ",b,c))};
var Hf={OBJ:[Df,t],STL:[Le,t],VTK:[Ne,t],TRK:[yf,t],FSM:[Pe,t],INFLATED:[Pe,t],SMOOTHWM:[Pe,t],SPHERE:[Pe,t],PIAL:[Pe,t],ORIG:[Pe,t],NRRD:[Bf,t],NII:[Cf,t],GZ:[Cf,t],DCM:[Me,t],DICOM:[Me,t],"":[Me,t],CRV:[xf,t],LABEL:[Md,t],MGH:[wf,u],MGZ:[wf,q],TXT:[Af,t],LUT:[Af,t],PNG:[zf,"png"],JPG:[zf,"jpeg"],JPEG:[zf,"jpeg"],GIF:[zf,"gif"]};function If(a,b){(!x(a)||!x(b))&&n(Error("A camera needs valid width and height values."));Q.call(this);this.f="camera";this.cc=new H.j(0,100,0);this.qc=new H.j(0,0,0);this.Q=new H.j(0,0,1);this.B=a;this.s=b;this.m=this.ge(this.cc,this.qc)}C(If,Q);If.prototype.observe=function(a){(a==t||!(a instanceof Ce))&&n(Error("Could not observe the interactor."));P(a,ld,this.hj.bind(this));P(a,kd,this.fj.bind(this));P(a,md,this.tj.bind(this))};
If.prototype.hj=function(a){a instanceof wd||n(Error("Received no valid rotate event."));this.rotate(a.T)};If.prototype.tj=function(a){a instanceof xd||n(Error("Received no valid zoom event."));a.jb?this.Nf(a.Va):this.Of(a.Va)};If.prototype.fj=function(a){a instanceof vd||n(Error("Received no valid pan event."));this.tf(a.T)};If.prototype.__defineGetter__("view",v("m"));If.prototype.__defineSetter__("view",function(a){(a==t||!(a instanceof Float32Array))&&n(Error("Invalid view matrix."));this.m=a});
If.prototype.__defineGetter__("position",function(){return[this.cc.x,this.cc.y,this.cc.c]});If.prototype.__defineSetter__("position",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid position."));this.cc=new H.j(a[0],a[1],a[2]);this.reset()});If.prototype.__defineGetter__("focus",function(){return[this.qc.x,this.qc.y,this.qc.c]});If.prototype.__defineSetter__("focus",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid focus"));this.qc=new H.j(a[0],a[1],a[2]);this.reset()});
If.prototype.__defineGetter__("up",function(){return[this.Q.x,this.Q.y,this.Q.c]});If.prototype.__defineSetter__("up",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid up vector."));this.Q=new H.j(a[0],a[1],a[2]);this.reset()});w=If.prototype;w.reset=function(){this.m=this.ge(this.cc,this.qc)};w.rotate=function(a){ka(a)&&2==a.length?a=new H.j(a[0],a[1],0):a instanceof H.j||n(Error("Invalid distance vector for rotate operation."));return a};
w.tf=function(a){ka(a)&&2==a.length?a=new H.j(a[0],a[1],0):a instanceof H.j||n(Error("Invalid distance vector for pan operation."));this.m[12]-=a.x;this.m[13]+=a.y};w.Nf=function(a){var b=20;a!=t&&!a&&(b=1);this.m[14]+=b};w.Of=function(a){var b=20;a!=t&&!a&&(b=1);this.m[14]-=b};w.ge=function(a,b){(!(a instanceof H.j)||!(b instanceof H.j))&&n(Error("3D vectors required for calculating the view."));return H.d.nd()};B("X.camera",If);B("X.camera.prototype.pan",If.prototype.tf);
B("X.camera.prototype.rotate",If.prototype.rotate);B("X.camera.prototype.zoomIn",If.prototype.Nf);B("X.camera.prototype.zoomOut",If.prototype.Of);function Jf(a){function b(a,b,d){b=2*b*Math.PI;b=za(Aa(l,Math.cos(b)),Aa(k,Math.sin(b)));a=za(za(c,Aa(e,a)),Aa(b,f));d=za(Aa(b,1-Math.abs(d)),Aa(g,d));return new cc(a,d)}this.L=[];a=a||{};var c=new xa(a.start||[0,-1,0]),d=new xa(a.end||[0,1,0]),e=Ba(d,c),f=a.ob||1;a=a.Cf||16;for(var g=Ca(e),h=0.5<Math.abs(g.y()),l=Ca((new xa(h,!h,0)).gc(g)),k=Ca(l.gc(g)),h=new cc(c,Da(g)),d=new cc(d,Ca(g)),j=[],m=0;m<a;m++){var r=m/a,s=(m+1)/a;j.push(new ec([h,b(0,r,-1),b(0,s,-1)]));j.push(new ec([b(0,s,0),b(0,r,
0),b(1,r,0),b(1,s,0)]));j.push(new ec([d,b(1,s,1),b(1,r,1)]))}return mc(j)}C(Jf,lc);function Kf(){W.call(this);this.f="cylinder";this.Pe=[-10,-10,-10];this.ve=[10,10,10];this.dc=10;this.Ra=32;Ea(this,new gd)}C(Kf,W);Kf.prototype.__defineGetter__("start",v("Pe"));Kf.prototype.__defineSetter__("start",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid start"));this.Pe=a});Kf.prototype.__defineGetter__("end",v("ve"));Kf.prototype.__defineSetter__("end",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid end"));this.ve=a});Kf.prototype.__defineGetter__("radius",v("dc"));
Kf.prototype.__defineSetter__("radius",function(a){x(a)||n(Error("Invalid radius."));this.dc=a});Kf.prototype.q=function(){id(this,new Jf({start:this.Pe,end:this.ve,ob:this.dc,Cf:this.Ra}));Kf.u.q.call(this)};B("X.cylinder",Kf);B("X.cylinder.prototype.modified",Kf.prototype.q);function Lf(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new xa(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new cc(za(c,Aa(e,d)),e))}this.L=[];a=a||{};var c=new xa(a.Ye||[0,0,0]),d=a.ob||1,e=a.Cf||16;a=a.Lj||8;for(var f=[],g=[],h=0;h<e;h++)for(var l=0;l<a;l++)g=[],b(h/e,l/a),0<l&&b((h+1)/e,l/a),l<a-1&&b((h+1)/e,(l+1)/a),b(h/e,(l+1)/a),f.push(new ec(g));return mc(f)}C(Lf,lc);function Mf(){W.call(this);this.f="sphere";this.v=[0,0,0];this.dc=5;this.Ra=32;this.Qh=16;Ea(this,new gd)}C(Mf,W);Mf.prototype.__defineGetter__("center",v("v"));Mf.prototype.__defineSetter__("center",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid center"));this.v=a});Mf.prototype.__defineGetter__("radius",v("dc"));Mf.prototype.__defineSetter__("radius",function(a){x(a)||n(Error("Invalid radius."));this.dc=a});
Mf.prototype.q=function(){id(this,new Lf({Ye:this.v,ob:this.dc,Cf:this.Ra,Lj:this.Qh}));Mf.u.q.call(this)};B("X.sphere",Mf);B("X.sphere.prototype.modified",Mf.prototype.q);function Ke(a){S.call(this);this.f="labelmap";this.zb=a;this.Me=new Float32Array([-255,-255,-255,-255])}C(Ke,S);Ke.prototype.q=function(){var a=new ed;a.fa=this;this.dispatchEvent(a);this.zb.q()};Ke.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=t&&(ka(a)&&4==a.length?b=a:(this.Ua||n(Error("No colortable assigned.")),b=this.Ua.lb.get(a).slice(1,5)));this.Me=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});
B("X.labelmap",Ke);function Nf(a){this.L=[];a=a||{};var b=new xa(a.Ye||[0,0,0]),c=!a.ob?[1,1,1]:a.ob.length?a.ob:[a.ob,a.ob,a.ob];return mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new ec(a[0].map(function(e){e=new xa(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.c()+c[2]*(2*!!(e&4)-1));return new cc(e,new xa(a[1]))}))}))}C(Nf,lc);function Of(){W.call(this);this.f="cube";this.v=[0,0,0];this.Ae=this.ze=this.ye=20;this.zc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ea(this,new gd)}C(Of,W);Of.prototype.__defineGetter__("center",v("v"));Of.prototype.__defineSetter__("center",function(a){(a==t||!ka(a)||3!=a.length)&&n(Error("Invalid center"));this.v=a});Of.prototype.__defineGetter__("lengthX",v("ye"));
Of.prototype.__defineSetter__("lengthX",function(a){x(a)||n(Error("Invalid lengthX."));this.ye=a});Of.prototype.__defineGetter__("lengthY",v("ze"));Of.prototype.__defineSetter__("lengthY",function(a){x(a)||n(Error("Invalid lengthY."));this.ze=a});Of.prototype.__defineGetter__("lengthZ",v("Ae"));Of.prototype.__defineSetter__("lengthZ",function(a){x(a)||n(Error("Invalid lengthZ."));this.Ae=a});Of.prototype.q=function(){id(this,new Nf({Ye:this.v,ob:[this.ye/2,this.ze/2,this.Ae/2]}));Of.u.q.call(this)};
B("X.cube",Of);B("X.cube.prototype.modified",Of.prototype.q);function Ee(a){Ce.call(this,a);this.f="interactor3D";this.Ik=u}C(Ee,Ce);Ee.prototype.pd=function(a){Ee.u.pd.call(this,a);var b=new xd;a.Ec==t&&(a.Ec=0);b.jb=0>a.Ec;b.Va=q;this.dispatchEvent(b)};function Pf(a){Q.call(this);this.f="array";this.z=[];this.Rf=a}C(Pf,Q);function Qf(a,b,c){for(var d=0;4>d;d++)if(a[d+0]!==b[d+c])return u;return q}Pf.prototype.add=function(a){this.z.push(a);return q};Pf.prototype.remove=function(a){a=this.z.indexOf(a);-1<a&&this.z.splice(a,1);return q};Pf.prototype.clear=function(){this.z.length=0};
function Rf(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Rf(a,b,d);for(Rf(a,d,c);b<d;++b)if(0<a.Rf(a.z[b],a.z[d])){var e=a.z[b];a.z[b]=a.z[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Rf(f.z[g+1],e);){var l=f,k=g+1,j=l.z[g];l.z[g]=l.z[k];l.z[k]=j;++g}f.z[g]=e}}}Pf.prototype.sort=function(){Rf(this,0,this.z.length)};function Sf(a,b){If.call(this,a,b);this.f="camera2D"}C(Sf,If);Sf.prototype.rotate=function(a){a=Sf.u.rotate.call(this,a);var b=new ud;0<a.x?b.Re--:0>a.x&&b.Re++;0<a.y?b.Be++:0>a.y&&b.Be--;this.dispatchEvent(b)};Sf.prototype.Nf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.m[14]+=b};Sf.prototype.Of=function(a){var b=20;a!=t&&!a&&(b=0.02);this.m[14]-=b};
Sf.prototype.tf=function(a){ka(a)&&2==a.length?a=new H.j(a[0],a[1],0):a instanceof H.j||n(Error("Invalid distance vector for pan operation."));this.m[12]-=a.x/this.m[14];this.m[13]+=a.y/this.m[14]};function Tf(a,b){If.call(this,a,b);this.f="camera3D";this.Tf=45;this.He=H.d.jf(H.d.nd(),this.Tf,a/b,1,1E4)}C(Tf,If);Tf.prototype.rotate=function(a){a=Tf.u.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new H.j(this.m[1],this.m[5],this.m[9]),d=new H.j(this.m[0],this.m[4],this.m[8]);c.normalize();d.normalize();H.d.rotate(this.m,b,c.x,c.y,c.c);H.d.rotate(this.m,a,d.x,d.y,d.c)};Tf.prototype.ge=function(a,b){var c=Tf.u.ge.call(this,a,b);H.d.Tg(c,a,b,this.Q);return c};
function Uf(a,b,c,d){var e=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);new Float32Array(16);H.d.multiply(a.He,a.m,h);H.d.K(h,g);e[0]=b;e[1]=c;e[2]=2*d-1;e[3]=1;H.d.Xg(g,e,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f}B("X.camera3D",Tf);function Vf(a){Jb.call(this);this.Ab=a;this.G=[]}C(Vf,Jb);var Wf=[];function Xf(a,b,c,d,e){ka(c)||(Wf[0]=c,c=Wf);for(var f=0;f<c.length;f++){var g=P(b,c[f],d||a,e||u,a.Ab||a);a.G.push(g)}}Vf.prototype.yf=function(){Eb(this.G,Wb);this.G.length=0};Vf.prototype.handleEvent=function(){n(Error("EventHandler.handleEvent not implemented"))};function Yf(){}Yf.Gg=function(){return Yf.Og?Yf.Og:Yf.Og=new Yf};Yf.prototype.Si=0;Yf.Gg();function Zf(a){bc.call(this);this.Xb=a||Wd();this.Bj=$f}C(Zf,bc);Zf.prototype.Di=Yf.Gg();var $f=t;w=Zf.prototype;w.Ng=t;w.Gc=u;w.w=t;w.Bj=t;w.qd=t;w.jd=t;w.Ze=t;w.p=v("w");w.Af=function(a){this.qd&&this.qd!=a&&n(Error("Method not supported"));Zf.u.Af.call(this,a)};w.Yd=v("Xb");w.Dc=function(){this.w=this.Xb.createElement("div")};w.lc=function(a){this.$b(a)};
w.$b=function(a,b){this.Gc&&n(Error("Component already rendered"));this.w||this.Dc();a?a.insertBefore(this.w,b||t):this.Xb.V.body.appendChild(this.w);(!this.qd||this.qd.Gc)&&this.Ud()};w.Ud=function(){function a(a){!a.Gc&&a.p()&&a.Ud()}this.Gc=q;this.jd&&Eb(this.jd,a,p)};w.Vd=function(){function a(a){a.Gc&&a.Vd()}this.jd&&Eb(this.jd,a,p);this.wi&&this.wi.yf();this.Gc=u};
w.removeChild=function(a,b){if(a){var c=ma(a)?a:a.Ng||(a.Ng=":"+(a.Di.Si++).toString(36)),d;this.Ze&&c?(d=this.Ze,d=(c in d?d[c]:p)||t):d=t;a=d;c&&a&&(d=this.Ze,c in d&&delete d[c],Hb(this.jd,a),b&&(a.Vd(),a.w&&ce(a.w)),c=a,c==t&&n(Error("Unable to set parent component")),c.qd=t,Zf.u.Af.call(c,t))}a||n(Error("Child is not in parent component"));return a};function ag(){bc.call(this)}C(ag,bc);w=ag.prototype;w.Lf=0;w.od=0;w.kf=100;w.Dg=0;w.Hf=1;w.Ki=u;w.Ri=u;w.oe=function(a){a=bg(this,a);this.Lf!=a&&(this.Lf=a+this.Dg>this.kf?this.kf-this.Dg:a<this.od?this.od:a,!this.Ki&&!this.Ri&&this.dispatchEvent("change"))};w.ae=function(){return bg(this,this.Lf)};w.$d=function(){return bg(this,this.od)};w.Zd=function(){return bg(this,this.kf)};function bg(a,b){return a.Hf==t?b:a.od+Math.round((b-a.od)/a.Hf)*a.Hf};function cg(a){Zf.call(this,a);this.td=new ag;P(this.td,"change",this.xi,u,this)}C(cg,Zf);var dg={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=cg.prototype;w.Dc=function(){this.pb=this.Yd().Dc("div","progress-bar-thumb");var a=dg[this.fh];this.w=this.Yd().Dc("div",a,this.pb);fg(this);a=this.$d();this.p().setAttribute("aria-valuemin",a);a=this.Zd();this.p().setAttribute("aria-valuemax",a)};
w.Ud=function(){cg.u.Ud.call(this);L&&7>pb&&P(this.p(),"resize",this.re,u,this);this.re();var a=this.p();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};w.Vd=function(){cg.u.Vd.call(this);L&&7>pb&&Vb(this.p(),"resize",this.re,u,this)};w.ae=function(){return this.td.ae()};w.oe=function(a){this.td.oe(a);this.p()&&fg(this)};function fg(a){var b=a.ae();a.p().setAttribute("aria-valuenow",b)}w.$d=function(){return this.td.$d()};w.Zd=function(){return this.td.Zd()};w.fh="horizontal";
w.xi=function(){this.re();this.dispatchEvent("change")};w.re=function(){if(this.pb){var a=this.$d(),b=this.Zd(),a=(this.ae()-a)/(b-a),b=Math.round(100*a);"vertical"==this.fh?L&&7>pb?(this.pb.style.top=0,this.pb.style.height="100%",b=this.pb.offsetHeight,a=Math.round(a*b),this.pb.style.top=b-a+"px",this.pb.style.height=a+"px"):(this.pb.style.top=100-b+"%",this.pb.style.height=b+"%"):this.pb.style.width=b+"%"}};function gg(a,b){a==t&&n(Error("No valid parent element."));b==t&&n(Error("Invalid initial value."));cg.call(this);this.f="progressbar";this.Qa=a;this.Ge="";this.Ad=this.yb=t;this.ac=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.ac=[c,d,e];this.oe(b);this.ff()}C(gg,cg);
gg.prototype.ff=function(){var a=he(this.Qa,"position");if("static"==a||""==a)this.Ge=this.Qa.style.position,this.Qa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ae("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.ac[0])),d=document.createTextNode(String(this.ac[1])),e=document.createTextNode(String(this.ac[2]));a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.yb=b;this.lc(this.Qa);a=this.p();a.style.position=
"absolute";a.style.top=(this.Qa.clientHeight-5)/2+"px";a.style.left=(this.Qa.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function hg(a){var b=a.p().style.top,c=a.p().style.left;ce(a.p());var d=new gg(a.Qa,100),e=d.p();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=p?e.firstElementChild:de(e.firstChild)).classList.add("progress-bar-thumb-done");a.Ad=d}
gg.prototype.ce=function(){this.yb&&ce(this.yb);this.p()&&ce(this.p());this.Ad&&ce(this.Ad.p());this.Ad=this.yb=t;this.Ge&&(this.Qa.style.position=this.Ge)};function ig(a,b,c){na(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):n(Error("Invalid listener argument"));return 2147483647<b?-1:fa.setTimeout(a,b||0)};function jg(){Q.call(this);this.f="renderer";this.r=window.document.body;this.B=this.r.clientWidth;this.s=this.r.clientHeight;this.J=this.D=this.ma=t;this.mb=new Pf(fd);this.cb=[];this.N=t;this.Ee=this.Gd=this.Hd=u;this.a=this.za=t;this.M={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:u,SLICENAVIGATORS:q};this.Pf=-1;window.console.log("XTK release 10 -- 2013-08-19 17:02:47 -- http://www.goXTK.com -- @goXTK")}C(jg,Q);w=jg.prototype;w.gj=function(a){this.za&&this.za.oe(100*a.ug)};
w.Xi=function(a){a!=t&&a instanceof ed&&a.fa&&this.qb(a.fa)};w.qf=function(a){(a==t||!(a instanceof zd))&&n(Error("Invalid hover event."))};w.rf=function(){var a=Zd(this.r);this.B=a.clientWidth;this.s=a.clientHeight;a=Zd(this.ma);a.width=this.B;a.height=this.s;"renderer3D"==this.f&&(this.a.viewport(0,0,this.B,this.s),this.D.He=H.d.jf(H.d.nd(),this.D.Tf,this.ma.width/this.ma.height,1,1E4))};w.sf=function(a){(a==t||!(a instanceof yd))&&n(Error("Invalid scroll event."))};
jg.prototype.__defineGetter__("config",v("M"));jg.prototype.__defineGetter__("interactor",v("J"));jg.prototype.__defineGetter__("camera",v("D"));jg.prototype.__defineGetter__("loadingCompleted",v("Gd"));jg.prototype.__defineGetter__("container",v("r"));jg.prototype.__defineSetter__("container",function(a){a==t&&n(Error("An ID to a valid container (<div>..) is required."));var b=a;ma(b)&&(b=Zd(a));oa(b)&&1==b.nodeType||n(Error("Could not find the given container."));this.r=b});w=jg.prototype;
w.ud=function(){this.D.reset()};
w.ra=function(a){var b=ae("canvas");this.r.appendChild(b);this.B=this.r.clientWidth;this.s=this.r.clientHeight;b.width=this.B;b.height=this.s;try{var c=b.getContext(a);c||n(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.r.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
n(Error(e))}this.N=new Ef;P(this.N,rd,this.gj.bind(this));this.ma=b;this.a=c;b=new Ee(this.ma);"2d"==a&&(b=new Ie(this.ma));b.ra();P(b,od,this.ud.bind(this));P(b,sd,this.qf.bind(this));P(b,nd,this.sf.bind(this));this.J=b;b=new Tf(this.B,this.s);"2d"==a&&(b=new Sf(this.B,this.s));b.observe(this.J);this.D=b;P(window,"resize",this.rf,u,this)};w.add=function(a){a.r=this;(a instanceof Of||a instanceof Mf||a instanceof Kf)&&a.q();this.cb.push(a);this.qb(a)};
w.remove=function(a){(!this.ma||!this.a)&&n(Error("The renderer was not initialized properly."));a==t&&n(Error("Illegal object."));return u};w.qb=function(a){(!this.ma||!this.a)&&n(Error("The renderer was not initialized properly."));if(a!=t){var b;b=pa(a);var c=Qb[b];if(c){var d=ia(qd),e=ia(p);d&&e?(c=Pb[qd],b=!!c&&!!c[p]&&b in c[p]):b=!d&&!e?q:Gb(c,function(a){return d&&a.type==qd||e&&a.capture==p})}else b=u;b||P(a,qd,this.Xi.bind(this))}};
w.get=function(a){a==t&&n(Error("Invalid object id."));for(var b=this.mb.z,c=b.length,d=0,d=0;d<c;d++)if(b[d].na==a)return b[d];return t};
w.lc=function(){(!this.ma||!this.a)&&n(Error("The renderer was not initialized properly."));if(this.ng==t){if(tc(this.N.tc)){if(this.M.PROGRESSBAR_ENABLED&&!this.za&&(this.za=new gg(this.r,3)),this.Ee=this.Gd=u,this.ng=ig(function(){this.ng=t;this.lc()}.bind(this),100),!this.M.INTERMEDIATE_RENDERING)return}else if(!this.Gd&&!this.Ee&&(this.Ee=q,eval("this.onShowtime()"),this.Gd=q),this.za){this.M.PROGRESSBAR_ENABLED&&(this.za&&!this.Qf)&&(hg(this.za),this.Qf=ig(function(){this.Qf=t;this.za&&(this.za.ce(),
this.za=t);this.lc()}.bind(this),700));return}this.Pf=window.requestAnimationFrame(this.lc.bind(this),this.ma);eval("this.onRender()");this.$b(u,q)}};w.eh=da();w.bh=da();w.$b=da();
w.Sd=function(){window.cancelAnimationFrame(this.Pf);this.N&&(delete this.N,this.N=t);this.za&&(this.za.ce(),delete this.za,this.za=t);this.mb.clear();delete this.mb;this.cb.length=0;delete this.cb;delete this.N;this.N=t;delete this.D;this.D=t;delete this.J;this.J=t;delete this.a;this.a=t;ce(this.ma);delete this.ma;this.ma=t};function kg(){Q.call(this);this.f="shaders";this.Nd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.Nd=a+="}\n";this.Bd="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";a+="uniform float volumeLowerThreshold;\n";
a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";
a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";
a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold ||\n";a+="         texture1.a == 0.0 ) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";
a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Bd=a+="}\n"}
C(kg,Q);
var lg={tk:"vertexPosition",sk:"vertexNormal",rk:"vertexColor",vk:"vertexTexturePos",uk:"vertexScalar"},mg={wk:"view",ak:"perspective",Sj:"center",$j:"objectTransform",nk:"useObjectColor",Yj:"objectColor",pk:"useScalars",jk:"scalarsReplaceMode",gk:"scalarsMin",dk:"scalarsMax",hk:"scalarsMinColor",ek:"scalarsMaxColor",ik:"scalarsMinThreshold",fk:"scalarsMaxThreshold",ck:"scalarsInterpolation",bk:"pointSize",Zj:"objectOpacity",Xj:"normal",ok:"usePicking",qk:"useTexture",mk:"useLabelMapTexture",Vj:"labelmapOpacity",
Uj:"labelmapColor",kk:"textureSampler",lk:"textureSampler2",xk:"volumeLowerThreshold",Dk:"volumeUpperThreshold",Ak:"volumeScalarMin",yk:"volumeScalarMax",Bk:"volumeScalarMinColor",zk:"volumeScalarMaxColor",Fk:"volumeWindowLow",Ek:"volumeWindowHigh",Ck:"volumeTexture"};function ng(a,b,c){a==t&&n(Error("Invalid GL Buffer."));b==t&&n(Error("Invalid number of items."));c==t&&n(Error("Invalid item size."));Q.call(this);this.f="buffer";this.C=a;this.Lb=b;this.Mb=c}C(ng,Q);function og(a,b,c,d,e,f,g,h){var l,k;if(l=c.offsetParent){var j="HTML"==l.tagName||"BODY"==l.tagName;if(!j||"static"!=ie(l,"position"))k=ne(l),j||(j=(j=oe(l))&&ib?-l.scrollLeft:j&&(!L||!wb("8"))&&"visible"!=ie(l,"overflowX")?l.scrollWidth-l.clientWidth-l.scrollLeft:l.scrollLeft,k=Od(k,new Nd(j,l.scrollTop)))}l=k||new Nd;k=ne(a);j=se(a);k=new Rd(k.x,k.y,j.width,j.height);(j=me(a))&&k.Pg(new Rd(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=Wd(a),m=Wd(c);if(j.V!=m.V){var r=j.V.body,m=m.V.parentWindow||
m.V.defaultView,s=new Nd(0,0),y=Yd(r)?Yd(r).parentWindow||Yd(r).defaultView:window,z=r;do{var D=y==m?ne(z):pe(z);s.x+=D.x;s.y+=D.y}while(y&&y!=m&&(z=y.frameElement)&&(y=y.parent));r=Od(s,ne(r));L&&!fe(j)&&(r=Od(r,ge(j)));k.left+=r.x;k.top+=r.y}a=(b&4&&oe(a)?b^2:b)&-5;b=new Nd(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);b=Od(b,l);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var E;if(g&&(E=me(c)))E.top-=l.y,E.right-=l.x,E.bottom-=l.y,E.left-=l.x;return pg(b,c,d,f,E,g,h)}
function pg(a,b,c,d,e,f,g){a=a.i();var h=0,l=(c&4&&oe(b)?c^2:c)&-5;c=se(b);g=g?g.i():c.i();if(d||0!=l)l&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),l&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&(h.x+g.width>e.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y<=e.top&&(h.y+g.height<e.bottom&&f&32)&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8);h.y>=e.top&&(h.y+g.height>e.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=ib&&(Za||nb)&&wb("1.9");f instanceof
Nd?(a=f.x,f=f.y):(a=f,f=p);b.style.left=re(a,e);b.style.top=re(f,e);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=fe(Wd(Yd(b))),L&&(!a||!wb("8"))?(c=b.style,a?(L?(a=we(b,"paddingLeft"),e=we(b,"paddingRight"),f=we(b,"paddingTop"),d=we(b,"paddingBottom"),a=new Pd(f,e,d,a)):(a=he(b,"paddingLeft"),e=he(b,"paddingRight"),f=he(b,"paddingTop"),d=he(b,"paddingBottom"),a=new Pd(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),L?(e=ye(b,"borderLeft"),f=ye(b,"borderRight"),d=ye(b,"borderTop"),
b=ye(b,"borderBottom"),b=new Pd(d,f,b,e)):(e=he(b,"borderLeftWidth"),f=he(b,"borderRightWidth"),d=he(b,"borderTopWidth"),b=he(b,"borderBottomWidth"),b=new Pd(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,ib?b.MozBoxSizing="border-box":jb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",
b.height=Math.max(g.height,0)+"px");return h};function qg(){}qg.prototype.hb=da();function rg(a,b){this.$e=a instanceof Nd?a:new Nd(a,b)}C(rg,qg);rg.prototype.hb=function(a,b,c,d){og(je(a),0,a,b,this.$e,c,t,d)};function sg(a,b,c){this.element=a;this.Bg=b;this.uj=c}C(sg,qg);sg.prototype.hb=function(a,b,c){og(this.element,this.Bg,a,b,p,c,this.uj)};function tg(a,b){bc.call(this);this.Ab=new Vf(this);this.zf(a||t);b&&(this.Hc=b)}C(tg,bc);w=tg.prototype;w.w=t;w.Xh=q;w.vg=t;w.Ca=u;w.Fj=u;w.hf=-1;w.Sg=-1;w.Ci=u;w.li=q;w.Hc="toggle_display";w.p=v("w");w.zf=function(a){this.Ca&&n(Error("Can not change this state of the popup while showing."));this.w=a};
function ug(a,b){a.qe&&a.qe.stop();a.be&&a.be.stop();if(b){if(!a.Ca&&a.of()){a.w||n(Error("Caller must call setElement before trying to show the popup"));a.hb();var c=Yd(a.w);a.Ci&&Xf(a.Ab,c,"keydown",a.Vi,q);if(a.Xh)if(Xf(a.Ab,c,"mousedown",a.$g,q),L){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Xf(a.Ab,c,"mousedown",a.$g,q);Xf(a.Ab,c,"deactivate",a.Zg)}else Xf(a.Ab,c,"blur",a.Zg);"toggle_display"==
a.Hc?(a.w.style.visibility="visible",ue(a.w,q)):"move_offscreen"==a.Hc&&a.hb();a.Ca=q;a.qe?(Ub(a.qe,"end",a.dh,u,a),a.qe.play()):a.dh()}}else vg(a)}w.hb=ga;function vg(a,b){if(!a.Ca||!a.dispatchEvent({type:"beforehide",target:b}))return u;a.Ab&&a.Ab.yf();a.Ca=u;a.Sg=wa();a.be?(Ub(a.be,"end",va(a.Ag,b),u,a),a.be.play()):a.Ag(b);return q}w.Ag=function(a){"toggle_display"==this.Hc?this.Fj?ig(this.Kg,0,this):this.Kg():"move_offscreen"==this.Hc&&(this.w.style.top="-10000px");this.pf(a)};
w.Kg=function(){this.w.style.visibility="hidden";ue(this.w,u)};w.of=function(){return this.dispatchEvent("beforeshow")};w.dh=function(){this.hf=wa();this.Sg=-1;this.dispatchEvent("show")};w.pf=function(a){this.dispatchEvent({type:"hide",target:a})};w.$g=function(a){a=a.target;!ee(this.w,a)&&((!this.vg||ee(this.vg,a))&&!(150>wa()-this.hf))&&vg(this,a)};w.Vi=function(a){27==a.keyCode&&vg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.Zg=function(a){if(this.li){var b=Yd(this.w);if(L||gb){if(a=b.activeElement,!a||ee(this.w,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.hf||vg(this)}};function wg(a,b){this.yj=4;this.he=b||p;tg.call(this,a)}C(wg,tg);wg.prototype.hb=function(){if(this.he){var a=!this.Ca&&"move_offscreen"!=this.Hc,b=this.p();a&&(b.style.visibility="hidden",ue(b,q));this.he.hb(b,this.yj,this.Zk);a&&ue(b,u)}};function xg(a){this.R=new rc;a&&this.Se(a)}function yg(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}w=xg.prototype;w.Xd=function(){return this.R.Xd()};w.add=function(a){this.R.set(yg(a),a)};w.Se=function(a){a=qc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.yf=function(a){a=qc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.R.remove(yg(a))};w.clear=function(){this.R.clear()};
w.contains=function(a){a=yg(a);return uc(this.R.R,a)};w.Pg=function(a){var b=new xg;a=qc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};w.md=function(){return this.R.md()};w.i=function(){return new xg(this)};function zg(a,b,c){this.Xb=c||(a?Wd(Zd(a)):Wd());wg.call(this,this.Xb.Dc("div",{style:"position:absolute;display:none;"}));this.af=new Nd(1,1);this.Td=new xg;a&&Ag(this,a);if(b!=t)if(a=this.p(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Yd(a).createTextNode(String(b)))}}C(zg,wg);var Bg=[];w=zg.prototype;w.Ga=t;w.className="goog-tooltip";
w.rh=500;w.Bi=0;w.Yd=v("Xb");function Ag(a,b){b=Zd(b);a.Td.add(b);P(b,"mouseover",a.Ai,u,a);P(b,"mouseout",a.Hg,u,a);P(b,"mousemove",a.zi,u,a);P(b,"focus",a.yi,u,a);P(b,"blur",a.Hg,u,a)}w.zf=function(a){var b=this.p();b&&ce(b);zg.u.zf.call(this,a);a&&(b=this.Xb.V.body,b.insertBefore(a,b.lastChild))};
w.of=function(){if(!tg.prototype.of.call(this))return u;if(this.anchor)for(var a,b=0;a=Bg[b];b++)ee(a.p(),this.anchor)||ug(a,u);0<=Db(Bg,this)||Bg.push(this);a=this.p();a.className=this.className;Cg(this);P(a,"mouseover",this.Jg,u,this);P(a,"mouseout",this.Ig,u,this);Dg(this);return q};
w.pf=function(){Hb(Bg,this);for(var a=this.p(),b,c=0;b=Bg[c];c++)b.anchor&&ee(a,b.anchor)&&ug(b,u);this.hh&&Eg(this.hh);Vb(a,"mouseover",this.Jg,u,this);Vb(a,"mouseout",this.Ig,u,this);this.anchor=p;if(0==(this.Db?this.Ca?4:1:this.Fc?3:this.Ca?2:0))this.me=u;tg.prototype.pf.call(this)};w.Wg=function(a,b){this.anchor==a&&this.Td.contains(this.anchor)&&(this.me||!this.cl?(ug(this,u),this.Ca||(this.anchor=a,this.he=b||Fg(this,0)||p,this.Ca&&this.hb(),ug(this,q))):this.anchor=p);this.Db=p};
w.Qi=function(a){this.Fc=p;a==this.anchor&&(this.Ga==t||this.Ga!=this.p()&&!this.Td.contains(this.Ga))&&(!this.xg||!this.xg.Ga)&&ug(this,u)};function Gg(a,b){var c=ge(a.Xb);a.af.x=b.clientX+c.x;a.af.y=b.clientY+c.y}w.Ai=function(a){var b=Hg(this,a.target);this.Ga=b;Cg(this);b!=this.anchor&&(this.anchor=b,this.Db||(this.Db=ig(ua(this.Wg,this,b,p),this.rh)),Ig(this),Gg(this,a))};function Hg(a,b){try{for(;b&&!a.Td.contains(b);)b=b.parentNode;return b}catch(c){return t}}
w.zi=function(a){Gg(this,a);this.me=q};w.yi=function(a){this.Ga=a=Hg(this,a.target);this.me=q;if(this.anchor!=a){this.anchor=a;var b=Fg(this,1);Cg(this);this.Db||(this.Db=ig(ua(this.Wg,this,a,b),this.rh));Ig(this)}};function Fg(a,b){if(0==b){var c=a.af.i();return new Jg(c)}return new Kg(a.Ga)}function Ig(a){if(a.anchor)for(var b,c=0;b=Bg[c];c++)ee(b.p(),a.anchor)&&(b.xg=a,a.hh=b)}
w.Hg=function(a){var b=Hg(this,a.target),c=Hg(this,a.relatedTarget);b!=c&&(b==this.Ga&&(this.Ga=t),Dg(this),this.me=u,this.Ca&&(!a.relatedTarget||!ee(this.p(),a.relatedTarget))?Eg(this):this.anchor=p)};w.Jg=function(){var a=this.p();this.Ga!=a&&(Cg(this),this.Ga=a)};w.Ig=function(a){var b=this.p();if(this.Ga==b&&(!a.relatedTarget||!ee(b,a.relatedTarget)))this.Ga=t,Eg(this)};function Dg(a){a.Db&&(fa.clearTimeout(a.Db),a.Db=p)}
function Eg(a){if(2==(a.Db?a.Ca?4:1:a.Fc?3:a.Ca?2:0))a.Fc=ig(ua(a.Qi,a,a.anchor),a.Bi)}function Cg(a){a.Fc&&(fa.clearTimeout(a.Fc),a.Fc=p)}function Jg(a,b){rg.call(this,a,b)}C(Jg,rg);Jg.prototype.hb=function(a,b,c){b=je(a);b=me(b);c=c?new Pd(c.top+10,c.right,c.bottom,c.left+10):new Pd(10,0,0,10);pg(this.$e,a,4,c,b,9)&496&&pg(this.$e,a,4,c,b,5)};function Kg(a){sg.call(this,a,3)}C(Kg,sg);
Kg.prototype.hb=function(a,b,c){var d=new Nd(10,0);og(this.element,this.Bg,a,b,d,c,9)&496&&og(this.element,2,a,1,d,c,5)};function Lg(a,b,c,d){a==t&&n(Error("No valid parent element."));(!x(b)||!x(c))&&n(Error("Invalid coordinates."));(d==t||!(d instanceof Ce))&&n(Error("Invalid interactor."));zg.call(this);this.f="caption";this.Qa=a;this.Pd=b;this.Qd=c;this.J=d;this.yb=t;this.ac=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.ac=[a];Ub(d,td,this.ce.bind(this));this.ff()}C(Lg,zg);
Lg.prototype.ff=function(){var a=he(this.Qa,"position");if("static"==a||""==a)this.Qa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ae("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.ac[0]));a.appendChild(b);b.appendChild(c);this.yb=b;this.he=new rg(this.Pd,this.Qd)||p;this.Ca&&this.hb();ug(this,q);Ag(this,this.Qa);this.p().classList.add("x-tooltip")};
Lg.prototype.ce=function(){ug(this,u);this.yb&&ce(this.yb);this.p()&&ce(this.p());this.yb=t};function Mg(){jg.call(this);this.f="renderer3D";this.Sc=this.Vc=this.Rc=this.Uc=this.Qc=this.Tc=this.Ke=this.Le=t;this.v=[0,0,0];this.Ic=[0,0,0];this.jg=t;this.te=new rc;this.ed=new rc;this.Vb=new rc;this.Jd=new rc;this.pc=new rc;this.wc=new rc;this.Ac=new rc;this.Bc=new rc;this.M={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:u,INTERMEDIATE_RENDERING:u}}C(Mg,jg);Mg.prototype.__defineGetter__("config",v("M"));w=Mg.prototype;
w.Aj=function(){this.Sc=this.Vc=this.Rc=this.Uc=this.Qc=this.Tc=t;this.v=[0,0,0]};w.qf=function(a){Mg.u.qf.call(this,a);var b=a.Pd;a=a.Qd;var c=this.vf(b,a);if(c=this.get(c))if(c=c.oc){var d=pe(this.r);(new Lg(this.r,d.x+b+10,d.y+a+10,this.J)).p().innerHTML=c}};
w.ra=function(){Mg.u.ra.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.B,this.s),this.a.clearColor(this.Ic[0],this.Ic[1],this.Ic[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.M.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.B,this.s,0,this.a.RGB,this.a.UNSIGNED_BYTE,t);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,
a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.B,this.s);this.a.bindRenderbuffer(this.a.RENDERBUFFER,t);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);this.jg=a}}catch(d){n(Error("Exception while accessing GL Context!\n"+d))}a=new kg;
(this.ma==t||this.a==t||this.D==t)&&n(Error("Renderer was not initialized properly."));(a==t||!(a instanceof kg))&&n(Error("Could not add shaders."));b=Object.keys(mg);Object.keys(lg).every(function(a){a=lg[a];return-1!=this.Nd.search(a)||-1!=this.Bd.search(a)}.bind(a))||n(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=mg[a];return-1!=this.Nd.search(a)||-1!=this.Bd.search(a)}.bind(a))||n(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);
c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Bd);this.a.shaderSource(c,a.Nd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||n(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||n(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);this.a.attachShader(e,b);this.a.linkProgram(e);
this.a.getProgramParameter(e,this.a.LINK_STATUS)||n(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.Ke=e;Object.keys(lg).forEach(function(a){a=lg[a];this.te.set(a,this.a.getAttribLocation(this.Ke,a));this.a.enableVertexAttribArray(this.te.get(a))}.bind(this));Object.keys(mg).forEach(function(a){a=mg[a];this.ed.set(a,this.a.getUniformLocation(this.Ke,a))}.bind(this));this.Le=a};
w.qb=function(a){Mg.u.qb.call(this,a);var b=u;if(a!=t){this.get(a.na)&&(b=q);var c=a.na,d=a.g,e=a.l,f=a.da,g=a.Z,h=a.o,l=a.U,k=a.Ua,j=a.k,m=a.A;if(j!=t&&j.o!=t&&j.o.h)this.qb(j);else if(j!=t&&j.h&&this.qb(j),k!=t&&k.o!=t&&k.o.h)this.N.load(k,a);else if(g!=t&&g.o!=t&&g.o.h)this.N.load(g,a);else{if(h!=t&&ka(h))if(a.mc!=t){if(a.mc.ee!=h.length||!a.h)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.N.load(h[b],a);return}else{if(h!=t&&h.h){this.N.load(a,a);return}if(m!=t&&m.o!=t&&m.o.h){this.N.load(m,a);
return}}if(0<a.e.length){h=a.e;k=h.length;for(j=j=0;j<k;j++)this.qb(h[j])}if(d){for(h=0;this.Hd;)h++,window.console.log("Possible thread lock avoided: "+h);this.Hd=q;k=a instanceof Jd&&a.zb instanceof Ke;b&&(g!=t&&g.h)&&(h=this.Ac.get(c),h!=t&&this.a.isBuffer(h.C)&&this.a.deleteBuffer(h.C));h=t;g!=t&&(!b||g.h?(h=a.zc,h==t&&n(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=u,g.Tb&&(j=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,j),j=
this.a.createTexture(),j.Ei=g.Kb,this.Bc.set(g.na,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.Tb?(j=this.a.RGBA,g.Wf&&(j=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,j,g.Je,g.Ie,0,j,this.a.UNSIGNED_BYTE,g.Tb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.Ei),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,
this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,t),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),
this.a.STATIC_DRAW),h=new ng(j,h.length,2),g.h=u):h=this.Ac.get(c));Ff(this.N,0.1);if(k)this.Hd=u,H.Oa(this.f+".update"),Ff(this.N,0.9);else{if(!b||d.h||l.h){k=l.oa;g=H.d.W(k,d.$a,d.ab,d.bb);k=H.d.W(k,d.Wa,d.Xa,d.Ya);if(this.Tc===t||g.x<this.Tc)this.Tc=g.x;if(this.Qc===t||k.x>this.Qc)this.Qc=k.x;if(this.Uc===t||g.y<this.Uc)this.Uc=g.y;if(this.Rc===t||k.y>this.Rc)this.Rc=k.y;if(this.Vc===t||g.c<this.Vc)this.Vc=g.c;if(this.Sc===t||k.c>this.Sc)this.Sc=k.c;this.v=[(this.Tc+this.Qc)/2,(this.Uc+this.Rc)/
2,(this.Vc+this.Sc)/2];l.h=u}b&&d.h&&(l=this.Vb.get(c),l!=t&&this.a.isBuffer(l.C)&&this.a.deleteBuffer(l.C));l=t;!b||d.h?(l=this.a.createBuffer(),d.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,d.P,this.a.STATIC_DRAW),l=new ng(l,d.count,3),d.h=u):l=this.Vb.get(c);Ff(this.N,0.3);b&&e.h&&(g=this.Vb.get(c),g!=t&&this.a.isBuffer(g.C)&&this.a.deleteBuffer(g.C));g=t;!b||e.h?(g=this.a.createBuffer(),e.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,
e.P,this.a.STATIC_DRAW),g=new ng(g,e.count,3),e.h=u):g=this.Jd.get(c);Ff(this.N,0.3);b&&(f&&f.h)&&(e=this.pc.get(c),e!=t&&this.a.isBuffer(e.C)&&this.a.deleteBuffer(e.C));e=t;f&&(!b||f.h?(f.length!=d.length&&n(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.P,this.a.STATIC_DRAW),e=new ng(e,f.count,3),f.h=u):e=this.pc.get(c));Ff(this.N,0.2);b&&(m&&m.h)&&(f=this.wc.get(c),f!=t&&this.a.isBuffer(f.C)&&
this.a.deleteBuffer(f.C));f=t;m&&(f=m.Kc,!b||m.h?(f.length!=d.length&&n(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new ng(d,f.length,3),m.h=u):f=this.wc.get(c));Ff(this.N,0.1);b||this.mb.add(a);this.Vb.set(c,l);this.Jd.set(c,g);this.pc.set(c,e);this.Ac.set(c,h);this.wc.set(c,f);this.Hd=a.h=u}}else a.h=u}}};
function Ng(a,b){var c=b.g.zd,c=H.d.W(b.U.oa,c[0],c[1],c[2]),c=H.d.W(a.D.m,c.x,c.y,c.c),c=H.j.df(a.D.cc,c);return Math.round(1E3*c)/1E3}w.vf=function(a,b){if(this.M.PICKING_ENABLED){this.$b(q,u);var c=new Uint8Array(4);this.a.readPixels(a,this.s-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.$b=function(a,b){Mg.u.$b.call(this,a,b);this.a.viewport(0,0,this.B,this.s);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.mb.z,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.jg):this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);var e=this.D.He,f=this.D.m;this.a.uniformMatrix4fv(this.ed.get("perspective"),u,e);this.a.uniformMatrix4fv(this.ed.get("view"),u,f);e=this.v;this.a.uniform3f(this.ed.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.cb.length;for(e=0;e<f;++e){var g=this.cb[e];if(g instanceof S){var h=H.d.W(this.D.m,g.b[0].n[0],g.b[0].n[1],g.b[0].n[2]),l=H.d.W(this.D.m,-g.b[0].n[0],-g.b[0].n[1],-g.b[0].n[2]),k=Math.abs(h.c-l.c),h=H.d.W(this.D.m,g.b[1].n[0],g.b[1].n[1],g.b[1].n[2]),l=H.d.W(this.D.m,-g.b[1].n[0],-g.b[1].n[1],-g.b[1].n[2]),j=Math.abs(h.c-l.c),h=H.d.W(this.D.m,g.b[2].n[0],g.b[2].n[1],g.b[2].n[2]),l=H.d.W(this.D.m,-g.b[1].n[0],-g.b[1].n[1],-g.b[1].n[2]),h=Math.max(k,j,Math.abs(h.c-l.c));h==k?Je(g,0):h==j?Je(g,
1):Je(g,2)}}if(this.M.ORDERING_ENABLED){k=u;f=this.cb;g=f.length-1;do if(e=f[g],e instanceof S&&e.eb){k=e.e[e.Wb].e;j=k.length;h=k[0];h.T=Ng(this,h);h.ga=e.ga;l=k[j-1];l.T=Ng(this,l);l.ga=e.ga;for(var l=Math.round(1E3*((l.T-h.T)/j))/1E3,m=1,m=1;m<j-1;m++){var r=Math.round(1E3*(h.T+m*l))/1E3;k[m].T=r;k[m].ga=e.ga}k=q}while(g--);f=this.mb.z;g=f.length-1;do if(e=f[g],e.ka&&!(1==e.ga||e instanceof Jd))e.T=Ng(this,e),k=q;while(g--);k&&this.mb.sort()}if(f=!a&&b!=t&&b&&this.M.STATISTICS_ENABLED)var s=0,
y=0,z=0,D=0;var e=this.te,g=e.get("vertexPosition"),k=e.get("vertexNormal"),j=e.get("vertexColor"),h=e.get("vertexTexturePos"),l=e.get("vertexScalar"),e=this.ed,m=e.get("usePicking"),r=e.get("useObjectColor"),E=e.get("objectColor"),G=e.get("useScalars"),A=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),I=e.get("scalarsMax"),J=e.get("scalarsMinColor"),R=e.get("scalarsMaxColor"),M=e.get("scalarsInterpolation"),V=e.get("scalarsMinThreshold"),aa=e.get("scalarsMaxThreshold"),Z=e.get("objectOpacity"),
ba=e.get("labelmapOpacity"),K=e.get("labelmapColor"),N=e.get("useTexture"),O=e.get("useLabelMapTexture"),hb=e.get("textureSampler"),Fc=e.get("textureSampler2"),Gc=e.get("volumeLowerThreshold"),Hc=e.get("volumeUpperThreshold"),Rg=e.get("volumeScalarMin"),Sg=e.get("volumeScalarMax"),Tg=e.get("volumeWindowLow"),Ug=e.get("volumeWindowHigh"),Vg=e.get("volumeScalarMinColor"),Wg=e.get("volumeScalarMaxColor"),eg=e.get("volumeTexture"),Xg=e.get("objectTransform"),Yg=e.get("pointSize"),e=d;do{var ca=c[d-e];
if(ca){var ja=t;ca instanceof Jd&&ca.zb&&(ja=ca.zb);if(ca.ka&&(!ja||ja.ka)&&(!a||ca.Wc)){var ya=ca.na,bb=ca.Pc,Ma=this.Vb.get(ya),lb=this.Jd.get(ya),Ge=this.pc.get(ya),Cb=this.wc.get(ya),He=this.Ac.get(ya);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ma.C);this.a.vertexAttribPointer(g,Ma.Mb,this.a.FLOAT,u,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,lb.C);this.a.vertexAttribPointer(k,lb.Mb,this.a.FLOAT,u,0,0);a?this.a.uniform1i(m,q):this.a.uniform1i(m,u);Ge&&!a&&!bb?(this.a.uniform1i(r,u),this.a.bindBuffer(this.a.ARRAY_BUFFER,
Ge.C),this.a.vertexAttribPointer(j,Ge.Mb,this.a.FLOAT,u,0,0)):(lb=1,bb&&!a&&(lb=0),this.a.uniform1i(r,lb),lb=ca.ha,a&&(lb=[Math.floor(ya%65025%255)/255,Math.floor(ya%65025/255)/255,Math.floor(ya/65025)/255]),this.a.uniform3f(E,parseFloat(lb[0]),parseFloat(lb[1]),parseFloat(lb[2])),this.a.vertexAttribPointer(j,Ma.Mb,this.a.FLOAT,u,0,0));Cb&&!a&&!bb?(this.a.uniform1i(G,q),this.a.uniform1i(A,ca.A.og),ya=ca.A.Pb,bb=ca.A.Nb,this.a.uniform3f(J,parseFloat(ya[0]),parseFloat(ya[1]),parseFloat(ya[2])),this.a.uniform3f(R,
parseFloat(bb[0]),parseFloat(bb[1]),parseFloat(bb[2])),this.a.uniform1f(V,parseFloat(ca.A.Y)),this.a.uniform1f(aa,parseFloat(ca.A.$)),this.a.uniform1f(F,parseFloat(ca.A.Za)),this.a.uniform1f(I,parseFloat(ca.A.ea)),this.a.uniform1i(M,parseInt(ca.A.we,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Cb.C),this.a.vertexAttribPointer(l,Cb.Mb,this.a.FLOAT,u,0,0)):(this.a.uniform1i(G,u),this.a.vertexAttribPointer(l,Ma.Mb,this.a.FLOAT,u,0,0));this.a.uniform1f(Z,parseFloat(ca.ga));ca.Z&&He&&!a?(this.a.uniform1i(N,
q),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.Bc.get(ca.Z.na)),this.a.uniform1i(hb,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,He.C),this.a.vertexAttribPointer(h,He.Mb,this.a.FLOAT,u,0,0),this.a.uniform1i(eg,u)):(this.a.uniform1i(N,u),this.a.vertexAttribPointer(h,Ma.Mb,this.a.FLOAT,u,0,0));ja&&(this.a.uniform1i(eg,q),this.a.uniform1f(Gc,ja.Y),this.a.uniform1f(Hc,ja.$),this.a.uniform1f(Rg,ja.Za),this.a.uniform1f(Sg,ja.ea),ya=ja.Pb,bb=ja.Nb,this.a.uniform3f(Vg,parseFloat(ya[0]),
parseFloat(ya[1]),parseFloat(ya[2])),this.a.uniform3f(Wg,parseFloat(bb[0]),parseFloat(bb[1]),parseFloat(bb[2])),this.a.uniform1f(Tg,ja.ba),this.a.uniform1f(Ug,ja.aa),Cb=ja.k,this.a.uniform1i(O,u),ja.eb?this.a.uniform1f(Z,parseFloat(ja.ga)):Cb&&Cb.ka&&(ja=ca.k.na,this.a.uniform1i(O,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Bc.get(ja)),this.a.uniform1i(Fc,1),this.a.uniform1f(ba,Cb.ga),this.a.uniform4fv(K,Cb.Me)));this.a.uniformMatrix4fv(Xg,u,ca.U.oa);ja=1;"POINTS"==
ca.xa&&(ja=ca.Xc);this.a.uniform1f(Yg,ja);ja=-1;ca.xa==bd?(ja=this.a.TRIANGLES,f&&(y+=Ma.Lb/3)):"LINES"==ca.xa?(this.a.lineWidth(ca.uc),ja=this.a.LINES,f&&(z+=Ma.Lb/2)):"POINTS"==ca.xa?(ja=this.a.POINTS,f&&(D+=Ma.Lb)):"TRIANGLE_STRIPS"==ca.xa?(ja=this.a.TRIANGLE_STRIP,f&&(y+=Ma.Lb/3)):"POLYGONS"==ca.xa&&(ja=0==Ma.Lb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(y+=Ma.Lb/3));f&&(s+=Ma.Lb);this.a.drawArrays(ja,0,Ma.Lb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+s+" | "),c+="Triangles: "+Math.round(y)+
" | ",c+="Lines: "+z+" | ",c+="Points: "+D+" | ",c+="Textures: "+this.Bc.Xd(),window.console.log(c))}};
w.remove=function(a){Mg.u.remove.call(this,a);if(0<a.e.length)for(var b=a.e,c=b.length,d=0,d=0;d<c;d++)this.remove(b[d]);b=a.na;if(this.get(b)){c=this.Ac.get(b);c!=t&&this.a.isBuffer(c.C)&&this.a.deleteBuffer(c.C);if(a.dl&&(c=this.Bc.get(a.Z.na)))this.a.deleteTexture(c),this.Bc.remove(a.Z.na);c=this.Vb.get(b);c!=t&&this.a.isBuffer(c.C)&&this.a.deleteBuffer(c.C);c=this.Vb.get(b);c!=t&&this.a.isBuffer(c.C)&&this.a.deleteBuffer(c.C);c=this.pc.get(b);c!=t&&this.a.isBuffer(c.C)&&this.a.deleteBuffer(c.C);
c=this.wc.get(b);c!=t&&this.a.isBuffer(c.C)&&this.a.deleteBuffer(c.C);this.Vb.remove(b);this.Jd.remove(b);this.pc.remove(b);this.Ac.remove(b);this.wc.remove(b);this.mb.remove(a);return q}return u};w.Sd=function(){this.Le=t;delete this.Le;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Mg.u.Sd.call(this)};Mg.prototype.__defineGetter__("bgColor",v("Ic"));Mg.prototype.__defineSetter__("bgColor",ea("Ic"));
Mg.prototype.wj=function(a,b,c,d){c!=t||(c=4);d!=t||(d=2);var e=this.vf(a,b);if(-1==e)return t;e=this.get(e);if(!e)return t;var f=Uf(this.D,2*(a/this.B)-1,2*((this.s-b)/this.s)-1,0);a=Uf(this.D,2*(a/this.B)-1,2*((this.s-b)/this.s)-1,1);f[0]+=this.v[0];f[1]+=this.v[1];f[2]+=this.v[2];a[0]+=this.v[0];a[1]+=this.v[1];a[2]+=this.v[2];b=[e.g.$a,e.g.ab,e.g.bb];var g=[e.g.Wa,e.g.ab,e.g.bb],h=[e.g.Wa,e.g.Xa,e.g.bb],l=[e.g.$a,e.g.Xa,e.g.bb],k=[e.g.$a,e.g.Xa,e.g.Ya],j=[e.g.$a,e.g.ab,e.g.Ya],m=[e.g.Wa,e.g.Xa,
e.g.Ya],r=[e.g.Wa,e.g.ab,e.g.Ya];b=[H.d.W(e.U.d,b[0],b[1],b[2]),H.d.W(e.U.d,g[0],g[1],g[2]),H.d.W(e.U.d,h[0],h[1],h[2]),H.d.W(e.U.d,l[0],l[1],l[2]),H.d.W(e.U.d,k[0],k[1],k[2]),H.d.W(e.U.d,j[0],j[1],j[2]),H.d.W(e.U.d,m[0],m[1],m[2]),H.d.W(e.U.d,r[0],r[1],r[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],s;for(s in b)s=b[s],g=[Math.min(g[0],s.x),Math.max(g[1],s.x),Math.min(g[2],s.y),Math.max(g[3],s.y),Math.min(g[4],s.c),Math.max(g[5],s.c)];s=g;b=[];g=[];for(h=0;6>h;h++){var l=
Math.floor(h/2),k=(l+1)%3,j=(l+2)%3,r=(2+2*l)%6,y=(4+2*l)%6,z=(s[h]-f[l])*(1/a[l]);Infinity!=z&&-Infinity!=z&&(m=f[k]+a[k]*z,z=f[j]+a[j]*z,m>=s[r]&&m<=s[r+1]&&z>=s[y]&&z<=s[y+1]?(r=[],r[l]=s[h],r[k]=m,r[j]=z,b.push(r)):(r=[],r[l]=s[h],r[k]=m,r[j]=z,g.push(r)))}a=[b,g];a=a[0];if(0==a.length)return t;g=Array(2);for(s=0;2>s;s++)b=a[s],g[s]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=s=t;g[0]<g[1]?(s=a[0],b=a[1]):(s=a[1],b=a[0]);f=Math.sqrt((s[0]-b[0])*(s[0]-
b[0])+(s[1]-b[1])*(s[1]-b[1])+(s[2]-b[2])*(s[2]-b[2]));f/=c;a=s;s=[b[0]-s[0],b[1]-s[1],b[2]-s[2]];b=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);g=[s[0]/b,s[1]/b,s[2]/b];h=e.g.P;l=h.length;for(s=0;s<f;s+=c){a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]];for(b=0;b<l;b+=3)if(k=h[b],j=h[b+1],m=h[b+2],r=new H.j(k,j,m),r=H.d.W(e.U.d,k,j,m),Math.sqrt((a[0]-r.x)*(a[0]-r.x)+(a[1]-r.y)*(a[1]-r.y)+(a[2]-r.c)*(a[2]-r.c))<=d)return[r.x,r.y,r.c]}return t};B("X.renderer3D",Mg);B("X.renderer3D.prototype.init",Mg.prototype.ra);
B("X.renderer3D.prototype.add",Mg.prototype.add);B("X.renderer3D.prototype.onShowtime",Mg.prototype.eh);B("X.renderer3D.prototype.onRender",Mg.prototype.bh);B("X.renderer3D.prototype.get",Mg.prototype.get);B("X.renderer3D.prototype.render",Mg.prototype.lc);B("X.renderer3D.prototype.destroy",Mg.prototype.Sd);B("X.renderer3D.prototype.remove",Mg.prototype.remove);B("X.renderer3D.prototype.resetBoundingBox",Mg.prototype.Aj);B("X.renderer3D.prototype.resetViewAndRender",Mg.prototype.ud);
B("X.renderer3D.prototype.pick",Mg.prototype.vf);B("X.renderer3D.prototype.pick3d",Mg.prototype.wj);function Og(){jg.call(this);this.f="renderer2D";this.ja=t;this.ua=-1;this.Qb=[];this.bg=this.Ed=this.Uf=this.Cd=t;this.xc=this.yc=this.Zc=this.$c=0;this.aa=this.ba=this.$=this.Y=this.Sf=-1;this.cg=new Float32Array([-255,-255,-255,-255]);this.kg=q}C(Og,jg);Og.prototype.ij=da();Og.prototype.rj=da();Og.prototype.sf=function(a){Og.u.sf.call(this,a);var b=this.cb[0];if(b){var c="",c=0==this.ua?"indexX":1==this.ua?"indexY":"indexZ";b[c]=a.Q?b[c]+1:b[c]-1;eval("this.onScroll();")}};
Og.prototype.sj=function(a){var b=this.cb[0];if(b){var c=b.aa-b.ba,d=c/2,e=parseInt(c+c/15*-a.Re,10);a=parseInt(d+d/15*a.Be,10);c==e&&e++;d==a&&a++;b.ba-=parseInt(d-a,10);b.ba-=parseInt(c-e,10);b.ba=Math.max(b.ba,b.Za);b.aa-=parseInt(d-a,10);b.aa+=parseInt(c-e,10);b.aa=Math.min(b.aa,b.ea);eval("this.onWindowLevel();")}};Og.prototype.__defineGetter__("orientation",v("ja"));
Og.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this.ua=2):"SAGITTAL"==a?(a="X",this.ua=0):"CORONAL"==a&&(a="Y",this.ua=1);"X"!=a&&("Y"!=a&&"Z"!=a)&&n(Error("Invalid orientation."));this.ja=a});Og.prototype.__defineGetter__("radiological",v("kg"));Og.prototype.__defineSetter__("radiological",ea("kg"));w=Og.prototype;
w.ra=function(){this.ja||n(Error("No 2D orientation set."));Og.u.ra.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.ma.width,this.ma.height);this.Cd=ae("canvas");this.Ed=ae("canvas");P(this.D,pd,this.sj.bind(this))};w.rf=function(){Og.u.rf.call(this);Pg(this)};w.ud=function(){Og.u.ud.call(this);Pg(this);var a=this.cb[0];a&&(a.aa=a.ea,a.ba=a.Za)};
w.qb=function(a){Og.u.qb.call(this,a);var b=u;this.get(a.na)&&(b=q);if(a instanceof S){var c=a.o,d=a.k,e=a.Ua;if(d!=t&&d.o!=t&&d.o.h)this.qb(d);else if(e!=t&&e.o!=t&&e.o.h)this.N.load(e,a);else{if(c!=t&&ka(c))if(a.mc!=t){if(a.mc.ee!=c.length||b&&!a.h)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.N.load(c[b],a);return}else if(c!=t&&c.h){this.N.load(a,a);return}this.ua="X"==this.ja?0:"Y"==this.ja?1:2;this.Ra=a.e[this.ua].e;e=t;e=0==this.ua?a.indexX:1==this.ua?a.indexY:a.indexZ;c=a.e[this.ua].e[e].Yf;
d=a.e[this.ua].e[e].Xf;this.yc=a.e[this.ua].e[e].Cc;this.xc=a.e[this.ua].e[e].sc;this.$c=c;this.Zc=d;e=this.Cd;e.width=c;e.height=d;var f=this.Ed;f.width=c;f.height=d;this.Uf=e.getContext("2d");this.bg=f.getContext("2d");b||(this.mb.add(a),Pg(this))}}};function Pg(a){var b=Math.min(a.B/(a.$c*a.yc),a.s/(a.Zc*a.xc));a.D.m[14]=b}
w.Ah=function(a,b){var c=this.cb[0],d=this.D.m,e=t,f=this.$c,g=this.Zc,h=t,l=t;if("Y"==this.ja)e=this.Ra[parseInt(c.indexY,10)],h=e.Cc,l=e.sc,this.Qb[0]="yellow",this.Qb[1]="green";else if("Z"==this.ja)e=this.Ra[parseInt(c.indexZ,10)],h=e.Cc,l=e.sc,this.Qb[0]="yellow",this.Qb[1]="red";else{e=this.Ra[parseInt(c.indexX,10)];h=e.sc;l=e.Cc;this.Qb[0]="red";this.Qb[1]="green";var k=f,f=g,g=k,k=h,h=l,l=k}var j=1*d[12],m=-1*d[13],k=Math.max(d[14],0.6),d=[this.B/2,this.s/2],h=f*h*k,r=g*l*k,l=d[0]-h/2,d=d[1]-
r/2,m=(b-(d+m*k))/r,j=(a-(l+j*k))/h*f,m=m*g,h=e.Vh[4];"X"==this.ja?(k=f-j,j=m,m=k):"Y"==this.ja?j=f-j:"Z"==this.ja&&(j=f-j,m=g-m);j=e.Uh+j*e.Cc;m=e.Oh+m*e.sc;j=Kc(j,m,h,1);f=Lc();Wc(e.Hh,j,f);g=Lc();Wc(e.Ih,j,g);e=Math.round((c.b[0].n[0]*g[0]+c.b[0].n[1]*g[1]+c.b[0].n[2]*g[2]+c.b[0].Fe)/Math.abs(c.b[0].Ne));e>=c.b[0].t?e=c.b[0].t-1:0>e&&(e=0);j=Math.round((c.b[1].n[0]*g[0]+c.b[1].n[1]*g[1]+c.b[1].n[2]*g[2]+c.b[1].Fe)/Math.abs(c.b[1].Ne));j>=c.b[1].t?j=c.b[1].t-1:0>j&&(j=0);m=Math.round((c.b[2].n[0]*
g[0]+c.b[2].n[1]*g[1]+c.b[2].n[2]*g[2]+c.b[2].Fe)/Math.abs(c.b[2].Ne));m>=c.b[2].t?m=c.b[2].t-1:0>m&&(m=0);return[[e,j,m],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]};
w.$b=function(a,b){Og.u.$b.call(this,a,b);if(0!=this.mb.z.length){var c=this.cb[0],d=t,d=0==this.ua?c.indexX:1==this.ua?c.indexY:c.indexZ,e=this.Ra[parseInt(d,10)].Yf,f=this.Ra[parseInt(d,10)].Xf;this.yc=this.Ra[parseInt(d,10)].Cc;this.xc=this.Ra[parseInt(d,10)].sc;this.$c=e;this.Zc=f;var g=this.B,h=this.s,l=this.D.m;this.a.save();this.a.clearRect(-g,-h,2*g,2*h);this.a.restore();var k=Math.max(l[14],0.1);this.a.setTransform(k,0,0,k,0,0);var j=1*l[12],l=-1*l[13],m=t;c.k&&(m=c.k.Me);var r=this.Ra[parseInt(d,
10)],s=r.Z.Tb,r=r.k,y=t;r&&(y=r.Tb);var z=this.$c,D=this.Zc,E=this.Uf,G=this.bg,A=E.getImageData(0,0,z,D),F=G.getImageData(0,0,z,D),I=A.data,J=F.data,R=I.length,M=c.ea,V=c.Y,aa=c.$,Z=c.ba/M,ba=c.aa/M;if(this.Sf!=d||this.Y!=V||this.$!=aa||this.ba!=Z||this.aa!=ba||m&&!Qf(m,this.cg,0)){var K=this.Cd;K.width=e;K.height=f;K=this.Ed;K.width=e;K.height=f;e=0;do{var K=[0,0,0,0],f=[0,0,0,0],N=s[e]/255*M,O=s[e],O=(O/255-Z)/(ba-Z),O=255*O;N>=V&&N<=aa&&(K=new T(c.Pb[0],c.Pb[1],c.Pb[2]),K=(new T(c.Nb[0],c.Nb[1],
c.Nb[2])).scale(O).add(K.scale(255-O)),K=[Math.floor(K.x),Math.floor(K.y),Math.floor(K.c),255],r&&(-255==m[3]?f=[y[e],y[e+1],y[e+2],y[e+3]]:Qf(m,y,e)&&(f=[y[e],y[e+1],y[e+2],y[e+3]])));"X"==this.ja?(I[e]=K[0],I[e+1]=K[1],I[e+2]=K[2],I[e+3]=K[3],J[e]=f[0],J[e+1]=f[1],J[e+2]=f[2],J[e+3]=f[3]):"Y"==this.ja?(O=4*z*Math.floor(e/(4*z))-e%(4*z),I[O]=K[0],I[O+1]=K[1],I[O+2]=K[2],I[O+3]=K[3],J[O]=f[0],J[O+1]=f[1],J[O+2]=f[2],J[O+3]=f[3]):(O=R-1-e,I[O-3]=K[0],I[O-2]=K[1],I[O-1]=K[2],I[O]=K[3],J[O-3]=f[0],J[O-
2]=f[1],J[O-1]=f[2],J[O]=f[3]);e+=4}while(e<R);E.putImageData(A,0,0);G.putImageData(F,0,0);this.Sf=d;this.Y=V;this.$=aa;this.ba=Z;this.aa=ba;r&&(this.cg=m)}this.a.globalAlpha=1;this.a.translate(g/2/k,h/2/k);"X"==this.ja&&(this.a.rotate(0.5*Math.PI),d=j,j=l,l=-d);j=-z*this.yc/2+j;l=-D*this.xc/2+l;this.a.drawImage(this.Cd,j,l,z*this.yc,D*this.xc);r&&c.k.ka&&(this.a.globalAlpha=c.k.ga,this.a.drawImage(this.Ed,j,l,z*this.yc,D*this.xc));if(this.M.SLICENAVIGATORS&&(this.J.Id&&this.J.qg&&!this.J.kb)&&(j=
this.J.ia,j=this.Ah(j[0],j[1])))c.vb=j[0][0],c.wb=j[0][1],c.xb=j[0][2],c.q(u),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.J.ia[0],0),this.a.lineTo(this.J.ia[0],this.J.ia[1]-10),this.a.moveTo(this.J.ia[0],this.J.ia[1]+10),this.a.lineTo(this.J.ia[0],this.s),this.a.strokeStyle=this.Qb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.J.ia[1]),this.a.lineTo(this.J.ia[0]-10,this.J.ia[1]),this.a.moveTo(this.J.ia[0]+10,this.J.ia[1]+
0.5),this.a.lineTo(this.B,this.J.ia[1]),this.a.strokeStyle=this.Qb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+j[2][0].toFixed(2)+", "+j[2][1].toFixed(2)+", "+j[2][2].toFixed(2),0,0),z=r=l="undefined","undefined"!=typeof c.Pa[j[1][2].toFixed(0)]&&"undefined"!=typeof c.Pa[j[1][2].toFixed(0)][j[1][1].toFixed(0)]&&(l=c.Pa[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],c.Ba&&
(r=c.k.Pa[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],c.k.Jc&&(z=c.k.Jc.get(r),"undefined"!=typeof z&&(z=z[0])))),this.a.fillText("Background:  "+l+" ("+j[1][0].toFixed(0)+", "+j[1][1].toFixed(0)+", "+j[1][2].toFixed(0)+")",0,15),c.Ba&&this.a.fillText("Labelmap:  "+z+" ("+r+")",0,30)}};B("X.renderer2D",Og);B("X.renderer2D.prototype.init",Og.prototype.ra);B("X.renderer2D.prototype.add",Og.prototype.add);B("X.renderer2D.prototype.onShowtime",Og.prototype.eh);
B("X.renderer2D.prototype.onRender",Og.prototype.bh);B("X.renderer2D.prototype.onScroll",Og.prototype.ij);B("X.renderer2D.prototype.onWindowLevel",Og.prototype.rj);B("X.renderer2D.prototype.get",Og.prototype.get);B("X.renderer2D.prototype.resetViewAndRender",Og.prototype.ud);B("X.renderer2D.prototype.xy2ijk",Og.prototype.Ah);B("X.renderer2D.prototype.render",Og.prototype.lc);B("X.renderer2D.prototype.destroy",Og.prototype.Sd);function Qg(){W.call(this);this.f="fibers";Ea(this,new pc)}C(Qg,W);B("X.fibers",Qg);function Zg(){W.call(this);this.f="mesh";Ea(this,new pc)}C(Zg,W);B("X.mesh",Zg);
