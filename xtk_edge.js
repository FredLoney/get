/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,p=!0,q=null,s=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function u(a){return function(){return this[a]}}var v,ca=this;function da(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==m}function x(a){return a!=q}function ja(a){return"array"==fa(a)}function ka(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function la(a){return"string"==typeof a}function z(a){return"number"==typeof a}function ma(a){return"function"==fa(a)}function pa(a){a=fa(a);return"object"==a||"array"==a||"function"==a}function qa(a){return a[sa]||(a[sa]=++ta)}
var sa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ta=0;function ua(a,b,c){return a.call.apply(a.bind,arguments)}function va(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function wa(a,b,c){wa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua:va;return wa.apply(q,arguments)}function xa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var Ba=Date.now||function(){return+new Date};
function A(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function F(a,b){function c(){}c.prototype=b.prototype;a.h=b.prototype;a.prototype=new c};function Ca(a,b,c){this.na=this.ma=this.la=0;3==arguments.length?(this.la=Number(a),this.ma=Number(b),this.na=Number(c)):a instanceof Ca?(this.la=Number(a.x()),this.ma=Number(a.y()),this.na=Number(a.b())):(this.la=Number(a[0]),this.ma=Number(a[1]),this.na=Number(a[2]))}
Ca.prototype={f:function(){return new Ca(this.la,this.ma,this.na)},xe:function(){return new Ca(-this.la,-this.ma,-this.na)},ac:function(a){return new Ca(this.la+a.x(),this.ma+a.y(),this.na+a.b())},Dc:function(a){return new Ca(this.la-a.x(),this.ma-a.y(),this.na-a.b())},ob:function(a){return new Ca(this.la*a,this.ma*a,this.na*a)},ug:function(a){return new Ca(this.la/a,this.ma/a,this.na/a)},Yb:function(a){return this.la*a.x()+this.ma*a.y()+this.na*a.b()},Bf:function(a,b){return this.ac(a.Dc(this).ob(b))},
length:function(){return Math.sqrt(this.Yb(this))},Kc:function(){return this.ug(this.length())},je:function(a){return new Ca(this.ma*a.b()-this.na*a.y(),this.na*a.x()-this.la*a.b(),this.la*a.y()-this.ma*a.x())},x:u("la"),y:u("ma"),b:u("na")};var Da=Da||{};Da.Dh=p;window["X.counter"]=new function(){this.ig=0;this.zh=function(){return this.ig++}};function Ea(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});A("Function.prototype.bind",Function.prototype.bind);function Fa(a){if(!Ga.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ha,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ia,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ja,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ka,"&quot;"));return a}var Ha=/&/g,Ia=/</g,Ja=/>/g,Ka=/\"/g,Ga=/[&<>\"]/;var La,Ma,Na,Oa,Pa,Qa,Ra;function Sa(){return ca.navigator?ca.navigator.userAgent:q}function Ta(){return ca.navigator}Pa=Oa=Na=Ma=La=s;var Ua;if(Ua=Sa()){var Va=Ta();La=0==Ua.indexOf("Opera");Ma=!La&&-1!=Ua.indexOf("MSIE");Oa=(Na=!La&&-1!=Ua.indexOf("WebKit"))&&-1!=Ua.indexOf("Mobile");Pa=!La&&!Na&&"Gecko"==Va.product}var Wa=La,G=Ma,Xa=Pa,Ya=Na,$a=Oa,ab,bb=Ta();ab=bb&&bb.platform||"";Qa=-1!=ab.indexOf("Mac");Ra=-1!=ab.indexOf("Win");var cb=!!Ta()&&-1!=(Ta().appVersion||"").indexOf("X11"),db;
a:{var eb="",gb;if(Wa&&ca.opera)var hb=ca.opera.version,eb="function"==typeof hb?hb():hb;else if(Xa?gb=/rv\:([^\);]+)(\)|;)/:G?gb=/MSIE\s+([^\);]+)(\)|;)/:Ya&&(gb=/WebKit\/(\S+)/),gb)var ib=gb.exec(Sa()),eb=ib?ib[1]:"";if(G){var jb,lb=ca.document;jb=lb?lb.documentMode:m;if(jb>parseFloat(eb)){db=""+jb;break a}}db=eb}var mb={};
function nb(a){var b;if(!(b=mb[a])){b=0;for(var c=(""+db).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var n=j.exec(g)||["","",""],l=k.exec(h)||["","",""];if(0==n[0].length&&0==l[0].length)break;b=((0==n[1].length?0:parseInt(n[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==n[1].length?0:parseInt(n[1],
10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==n[2].length)<(0==l[2].length)?-1:(0==n[2].length)>(0==l[2].length)?1:0)||(n[2]<l[2]?-1:n[2]>l[2]?1:0)}while(0==b)}b=mb[a]=0<=b}return b}var ob={};function pb(a){return ob[a]||(ob[a]=G&&document.documentMode&&document.documentMode>=a)};function qb(a,b){for(var c in a)b.call(m,a[c],c,a)}function rb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function sb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var tb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function ub(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tb.length;f++)c=tb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var vb=Array.prototype,wb=vb.indexOf?function(a,b,c){return vb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(la(a))return!la(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=vb.forEach?function(a,b,c){vb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=vb.map?function(a,b,c){return vb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
la(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},zb=vb.some?function(a,b,c){return vb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s},Eb=vb.every?function(a,b,c){return vb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return p};function Fb(a,b){var c=wb(a,b);0<=c&&vb.splice.call(a,c,1)}
function Gb(a){return vb.concat.apply(vb,arguments)}function Hb(a){if(ja(a))return Gb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Ib(a,b,c){return 2>=arguments.length?vb.slice.call(a,b):vb.slice.call(a,b,c)};function Jb(a){if("function"==typeof a.ha)a=a.ha();else if(ka(a)||la(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Kb(a){if("function"==typeof a.Kb)return a.Kb();if(la(a))return a.split("");if(ka(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return rb(a)}
function Lb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ka(a)||la(a))return Eb(a,b,m);var c;if("function"==typeof a.zc)c=a.zc();else if("function"!=typeof a.Kb)if(ka(a)||la(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=sb(a);else c=m;for(var d=Kb(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return s;return p};var Mb="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Nb(){}Nb.prototype.next=function(){i(Mb)};Nb.prototype.fc=function(){return this};function Ob(a){if(a instanceof Nb)return a;if("function"==typeof a.fc)return a.fc(s);if(ka(a)){var b=0,c=new Nb;c.next=function(){for(;;){b>=a.length&&i(Mb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Pb(a,b){if(ka(a))try{xb(a,b,m)}catch(c){c!==Mb&&i(c)}else{a=Ob(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Mb&&i(d)}}};function Qb(a,b){this.A={};this.p=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.de(a)}v=Qb.prototype;v.C=0;v.Lc=0;v.ha=u("C");v.Kb=function(){Rb(this);for(var a=[],b=0;b<this.p.length;b++)a.push(this.A[this.p[b]]);return a};v.zc=function(){Rb(this);return this.p.concat()};v.he=function(a){for(var b=0;b<this.p.length;b++){var c=this.p[b];if(Sb(this.A,c)&&this.A[c]==a)return p}return s};
v.vc=function(a,b){if(this===a)return p;if(this.C!=a.ha())return s;var c=b||Tb;Rb(this);for(var d,e=0;d=this.p[e];e++)if(!c(this.get(d),a.get(d)))return s;return p};function Tb(a,b){return a===b}v.clear=function(){this.A={};this.Lc=this.C=this.p.length=0};v.remove=function(a){return Sb(this.A,a)?(delete this.A[a],this.C--,this.Lc++,this.p.length>2*this.C&&Rb(this),p):s};
function Rb(a){if(a.C!=a.p.length){for(var b=0,c=0;b<a.p.length;){var d=a.p[b];Sb(a.A,d)&&(a.p[c++]=d);b++}a.p.length=c}if(a.C!=a.p.length){for(var e={},c=b=0;b<a.p.length;)d=a.p[b],Sb(e,d)||(a.p[c++]=d,e[d]=1),b++;a.p.length=c}}v.get=function(a,b){return Sb(this.A,a)?this.A[a]:b};v.set=function(a,b){Sb(this.A,a)||(this.C++,this.p.push(a),this.Lc++);this.A[a]=b};v.de=function(a){var b;a instanceof Qb?(b=a.zc(),a=a.Kb()):(b=sb(a),a=rb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};v.f=function(){return new Qb(this)};
v.fc=function(a){Rb(this);var b=0,c=this.p,d=this.A,e=this.Lc,f=this,g=new Nb;g.next=function(){for(;;){e!=f.Lc&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Mb);var g=c[b++];return a?g:d[g]}};return g};function Sb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ub(a){this.A=new Qb;a&&this.de(a)}function Vb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+qa(a):b.substr(0,1)+a}v=Ub.prototype;v.ha=function(){return this.A.ha()};v.add=function(a){this.A.set(Vb(a),a)};v.de=function(a){for(var a=Kb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};v.Cd=function(a){for(var a=Kb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};v.remove=function(a){return this.A.remove(Vb(a))};v.clear=function(){this.A.clear()};
v.contains=function(a){a=Vb(a);return Sb(this.A.A,a)};v.zf=function(a){for(var b=new Ub,a=Kb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};v.Kb=function(){return this.A.Kb()};v.f=function(){return new Ub(this)};v.vc=function(a){return this.ha()==Jb(a)&&Wb(this,a)};
function Wb(a,b){var c=Jb(b);if(a.ha()>c)return s;!(b instanceof Ub)&&5<c&&(b=new Ub(b));return Lb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.he)a=b.he(a);else if(ka(b)||la(b))a=0<=wb(b,a);else a:{for(var c in b)if(b[c]==a){a=p;break a}a=s}return a})}v.fc=function(){return this.A.fc(s)};function Yb(){}Yb.prototype.nf=s;Yb.prototype.Aa=function(){this.nf||(this.nf=p,this.D())};Yb.prototype.D=function(){this.sg&&Zb.apply(q,this.sg)};function $b(a){a&&"function"==typeof a.Aa&&a.Aa()}function Zb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ka(d)?Zb.apply(q,d):$b(d)}};function ac(a,b){this.Df=b;this.yc=[];a>this.Df&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.yc.push(this.kd())}F(ac,Yb);v=ac.prototype;v.kf=q;v.mf=q;function bc(a,b){a.yc.length<a.Df?a.yc.push(b):a.le(b)}v.kd=function(){return this.kf?this.kf():{}};v.le=function(a){if(this.mf)this.mf(a);else if(pa(a))if(ma(a.Aa))a.Aa();else for(var b in a)delete a[b]};v.D=function(){ac.h.D.call(this);for(var a=this.yc;a.length;)this.le(a.pop());delete this.yc};function cc(){this.wc=[];this.Ee=new Qb;this.$f=this.ag=this.bg=this.Xf=0;this.Jc=new Qb;this.gf=this.Zf=0;this.ye=1;this.me=new ac(0,4E3);this.me.kd=function(){return new dc};this.Yf=new ac(0,50);this.Yf.kd=function(){return new ec};var a=this;this.qe=new ac(0,2E3);this.qe.kd=function(){return""+a.ye++};this.qe.le=aa()}function ec(){this.Oe=this.time=this.count=0}
ec.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.Oe&&a.push(" [VarAlloc = ",this.Oe,"]");return a.join("")};function dc(){}function fc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(gc(a.of-c));e.push(" ",hc(a.of-b));0==a.ne?e.push(" Start        "):1==a.ne?(e.push(" Done "),e.push(gc(a.oi-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.vh&&e.push("[VarAlloc ",a.vh,"] ");return e.join("")}
dc.prototype.toString=function(){return this.type==q?this.rg:"["+this.type+"] "+this.rg};cc.prototype.reset=function(){for(var a=0;a<this.wc.length;a++){var b=this.me.id;b&&bc(this.qe,b);bc(this.me,this.wc[a])}this.wc.length=0;this.Ee.clear();this.Xf=Ba();this.gf=this.Zf=this.$f=this.ag=this.bg=0;b=this.Jc.zc();for(a=0;a<b.length;a++){var c=this.Jc.get(b[a]);c.count=0;c.time=0;c.Oe=0;bc(this.Yf,c)}this.Jc.clear()};
cc.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.wc.length;d++){var e=this.wc[d];1==e.ne&&c.pop();a.push(" ",fc(e,this.Xf,b,c.join("")));b=e.of;a.push("\n");0==e.ne&&c.push("|  ")}if(0!=this.Ee.ha()){var f=Ba();a.push(" Unstopped timers:\n");Pb(this.Ee,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",hc(b.startTime),")\n")})}b=this.Jc.zc();for(d=0;d<b.length;d++)c=this.Jc.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Zf,"\n","Total comments created ",
this.gf,"\n","Overhead start: ",this.bg," ms\n","Overhead end: ",this.ag," ms\n","Overhead comment: ",this.$f," ms\n");return a.join("")};function gc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function hc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new cc;function ic(){}var jc=0;v=ic.prototype;v.key=0;v.cc=s;v.ee=s;v.Z=function(a,b,c,d,e,f){ma(a)?this.Af=p:a&&a.handleEvent&&ma(a.handleEvent)?this.Af=s:i(Error("Invalid listener argument"));this.Bc=a;this.Uf=b;this.src=c;this.type=d;this.capture=!!e;this.oe=f;this.ee=s;this.key=++jc;this.cc=s};v.handleEvent=function(a){return this.Af?this.Bc.call(this.oe||this.src,a):this.Bc.handleEvent.call(this.Bc,a)};!G||pb(9);var kc=!G||pb(9),lc=G&&!nb("8");!Ya||nb("528");Xa&&nb("1.9b")||G&&nb("8")||Wa&&nb("9.5")||Ya&&nb("528");!Xa||nb("8");function mc(a,b){this.type=a;this.currentTarget=this.target=b}F(mc,Yb);v=mc.prototype;v.D=function(){delete this.type;delete this.target;delete this.currentTarget};v.Nb=s;v.Hc=p;v.stopPropagation=function(){this.Nb=p};v.preventDefault=function(){this.Hc=s};function nc(a){nc[" "](a);return a}nc[" "]=da;function oc(a,b){a&&this.Z(a,b)}F(oc,mc);v=oc.prototype;v.target=q;v.relatedTarget=q;v.offsetX=0;v.offsetY=0;v.clientX=0;v.clientY=0;v.screenX=0;v.screenY=0;v.button=0;v.keyCode=0;v.charCode=0;v.ctrlKey=s;v.altKey=s;v.shiftKey=s;v.metaKey=s;v.Ja=q;
v.Z=function(a,b){var c=this.type=a.type;mc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Xa){var e;a:{try{nc(d.nodeName);e=p;break a}catch(f){}e=s}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ya||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Ya||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ja=a;delete this.Hc;delete this.Nb};v.stopPropagation=function(){oc.h.stopPropagation.call(this);this.Ja.stopPropagation?this.Ja.stopPropagation():this.Ja.cancelBubble=p};
v.preventDefault=function(){oc.h.preventDefault.call(this);var a=this.Ja;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,lc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};v.Ag=u("Ja");v.D=function(){oc.h.D.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ja=q};var pc={},qc={},rc={},sc={};
function I(a,b,c,d,e){if(b){if(ja(b)){for(var f=0;f<b.length;f++)I(a,b[f],c,d,e);return q}var d=!!d,g=qc;b in g||(g[b]={C:0,ra:0});g=g[b];d in g||(g[d]={C:0,ra:0},g.C++);var g=g[d],h=qa(a),j;g.ra++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.Bc==c&&g.oe==e){if(g.cc)break;return j[f].key}}else j=g[h]=[],g.C++;f=tc();f.src=a;g=new ic;g.Z(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);pc[c]=g;rc[h]||(rc[h]=[]);rc[h].push(g);a.addEventListener?(a==ca||!a.lf)&&a.addEventListener(b,f,d):a.attachEvent(b in
sc?sc[b]:sc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function tc(){var a=uc,b=kc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function vc(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)vc(a,b[f],c,d,e);else a=I(a,b,c,d,e),pc[a].ee=p}
function wc(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)wc(a,b[f],c,d,e);else{d=!!d;a:{f=qc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=qa(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].Bc==c&&a[f].capture==d&&a[f].oe==e){yc(a[f].key);break}}}
function yc(a){if(!pc[a])return s;var b=pc[a];if(b.cc)return s;var c=b.src,d=b.type,e=b.Uf,f=b.capture;c.removeEventListener?(c==ca||!c.lf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in sc?sc[d]:sc[d]="on"+d,e);c=qa(c);e=qc[d][f][c];if(rc[c]){var g=rc[c];Fb(g,b);0==g.length&&delete rc[c]}b.cc=p;e.Hf=p;zc(d,f,c,e);delete pc[a];return p}
function zc(a,b,c,d){if(!d.vd&&d.Hf){for(var e=0,f=0;e<d.length;e++)d[e].cc?d[e].Uf.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Hf=s;0==f&&(delete qc[a][b][c],qc[a][b].C--,0==qc[a][b].C&&(delete qc[a][b],qc[a].C--),0==qc[a].C&&delete qc[a])}}function Ac(a){var b,c=0,d=b==q;b=!!b;if(a==q)qb(rc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)yc(f.key),c++}});else if(a=qa(a),rc[a])for(var a=rc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)yc(f.key),c++}}
function Bc(a){var b=Cc,a=qa(a),c=rc[a];if(c){var d=ia(b),e=ia(m);return d&&e?(c=qc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?p:zb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return s}function Dc(a,b,c,d,e){var f=1,b=qa(b);if(a[b]){a.ra--;a=a[b];a.vd?a.vd++:a.vd=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.cc&&(f&=Ec(j,e)!==s)}}finally{a.vd--,zc(c,d,b,a)}}return Boolean(f)}function Ec(a,b){var c=a.handleEvent(b);a.ee&&yc(a.key);return c}
function uc(a,b){if(!pc[a])return p;var c=pc[a],d=c.type,e=qc;if(!(d in e))return p;var e=e[d],f,g;if(!kc){var h;if(!(h=b))a:{h=["window","event"];for(var j=ca;f=h.shift();)if(x(j[f]))j=j[f];else{h=q;break a}h=j}f=h;h=p in e;j=s in e;if(h){if(0>f.keyCode||f.returnValue!=m)return p;a:{var k=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(n){k=p}if(k||f.returnValue==m)f.returnValue=p}}k=new oc;k.Z(f,this);f=p;try{if(h){for(var l=[],o=k.currentTarget;o;o=o.parentNode)l.push(o);g=e[p];g.ra=g.C;for(var r=
l.length-1;!k.Nb&&0<=r&&g.ra;r--)k.currentTarget=l[r],f&=Dc(g,l[r],d,p,k);if(j){g=e[s];g.ra=g.C;for(r=0;!k.Nb&&r<l.length&&g.ra;r++)k.currentTarget=l[r],f&=Dc(g,l[r],d,s,k)}}else f=Ec(c,k)}finally{l&&(l.length=0),k.Aa()}return f}d=new oc(b,this);try{f=Ec(c,d)}finally{d.Aa()}return f}var Fc=0;function Gc(a){return a+"_"+Fc++};function Hc(){}F(Hc,Yb);v=Hc.prototype;v.lf=p;v.xd=q;v.He=ba("xd");v.addEventListener=function(a,b,c,d){I(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){wc(this,a,b,c,d)};
v.dispatchEvent=function(a){var b=a.type||a,c=qc;if(b in c){if(la(a))a=new mc(a,this);else if(a instanceof mc)a.target=a.target||this;else{var d=a,a=new mc(b,this);ub(a,d)}var d=1,e,c=c[b],b=p in c,f;if(b){e=[];for(f=this;f;f=f.xd)e.push(f);f=c[p];f.ra=f.C;for(var g=e.length-1;!a.Nb&&0<=g&&f.ra;g--)a.currentTarget=e[g],d&=Dc(f,e[g],a.type,p,a)&&a.Hc!=s}if(s in c)if(f=c[s],f.ra=f.C,b)for(g=0;!a.Nb&&g<e.length&&f.ra;g++)a.currentTarget=e[g],d&=Dc(f,e[g],a.type,s,a)&&a.Hc!=s;else for(e=this;!a.Nb&&e&&
f.ra;e=e.xd)a.currentTarget=e,d&=Dc(f,e,a.type,s,a)&&a.Hc!=s;a=Boolean(d)}else a=p;return a};v.D=function(){Hc.h.D.call(this);Ac(this);this.xd=q};function J(){this.e="base";this.wa=window["X.counter"].zh();this.c=s}F(J,Hc);J.prototype.__defineGetter__("classname",u("e"));J.prototype.__defineGetter__("id",u("wa"));A("X.base",J);function Ic(a,b){this.ka=new Ca(a);this.T=new Ca(b)}Ic.prototype={f:function(){return new Ic(this.ka.f(),this.T.f())},Jb:function(){this.T=this.T.xe()},Hg:function(a,b){return new Ic(this.ka.Bf(a.ka,b),this.T.Bf(a.T,b))}};function Jc(a,b){this.T=a;this.Mc=b}Jc.prototype={f:function(){return new Jc(this.T.f(),this.Mc)},Jb:function(){this.T=this.T.xe();this.Mc=-this.Mc}};function Kc(a,b){this.Ya=a;this.Gd=b;var c=a[0].ka,d=a[2].ka,d=a[1].ka.Dc(c).je(d.Dc(c)).Kc();this.ja=new Jc(d,d.Yb(c))}
Kc.prototype={f:function(){var a=this.Ya.map(function(a){return a.f()});return new Kc(a,this.Gd)},Jb:function(){this.Ya.reverse().map(function(a){a.Jb()});this.ja.Jb()},Wf:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.Ya.length;h++){var j=a.T.Yb(this.Ya[h].ka)-a.Mc,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.T.Yb(this.ja.T)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.Ya.length;h++){var k=(h+1)%this.Ya.length,j=g[h],
n=g[k],f=this.Ya[h],k=this.Ya[k];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.f():f);3==(j|n)&&(j=(a.Mc-a.T.Yb(f.ka))/a.T.Yb(k.ka.Dc(f.ka)),j=f.Hg(k,j),b.push(j),c.push(j.f()))}3<=b.length&&d.push(new Kc(b,this.Gd));3<=c.length&&e.push(new Kc(c,this.Gd))}}};function Lc(a){this.V=this.W=this.ja=q;this.t=[];a&&this.Vb(a)}
Lc.prototype={f:function(){var a=new Lc;a.ph(this.ja&&this.ja.f());a.oh(this.W&&this.W.f());a.nh(this.V&&this.V.f());a.Ed(this.t.map(function(a){return a.f()}));return a},O:function(){for(var a=0;a<this.t.length;a++)this.t[a].Jb();this.ja.Jb();this.W&&this.W.O();this.V&&this.V.O();a=this.W;this.W=this.V;this.V=a},ge:function(a){if(!this.ja)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Wf(this.ja,b,c,b,c);this.W&&(b=this.W.ge(b));c=this.V?this.V.ge(c):[];return b.concat(c)},za:function(a){this.t=
a.ge(this.t);this.W&&this.W.za(a);this.V&&this.V.za(a)},nb:function(){var a=this.t.slice();this.W&&(a=a.concat(this.W.nb()));this.V&&(a=a.concat(this.V.nb()));return a},Vb:function(a){if(a.length){this.ja||(this.ja=a[0].ja.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Wf(this.ja,this.t,this.t,b,c);b.length&&(this.W||(this.W=new Lc),this.W.Vb(b));c.length&&(this.V||(this.V=new Lc),this.V.Vb(c))}},ph:ba("ja"),oh:ba("W"),nh:ba("V"),Ed:ba("t")};function Mc(){this.t=[]}function Nc(a){var b=new Mc;b.Ed(a);return b}
Mc.prototype={f:function(){var a=new Mc;a.Ed(this.t.map(function(a){return a.f()}));return a},Me:function(a){var b=new Lc(this.f().t),a=new Lc(a.f().t);b.za(a);a.za(b);a.O();a.za(b);a.O();b.Vb(a.nb());return Nc(b.nb())},Xa:function(a){var b=new Lc(this.f().t),a=new Lc(a.f().t);b.O();b.za(a);a.za(b);a.O();a.za(b);a.O();b.Vb(a.nb());b.O();return Nc(b.nb())},se:function(a){var b=new Lc(this.f().t),a=new Lc(a.f().t);b.O();a.za(b);a.O();b.za(a);a.za(b);b.Vb(a.nb());b.O();return Nc(b.nb())},inverse:function(){var a=
this.f();a.t.map(function(a){a.Jb()});return a},Ed:ba("t")};function Oc(){J.call(this);this.e="indexer";this.ce=[];this.aa={}}F(Oc,J);Oc.prototype.add=function(a){x(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.aa||(this.aa[b]=this.ce.length,this.ce.push(a));return this.aa[b]};Oc.prototype.unique=u("ce");function Pc(a){J.call(this);this.e="file";this.Xd=a;this.c=p}F(Pc,J);function Qc(){this.Rc=this.r=q}Qc.prototype.__defineSetter__("file",function(a){this.r=x(a)?new Pc(a):q});Qc.prototype.__defineGetter__("file",function(){return!this.r?"":this.r.Xd});Qc.prototype.__defineGetter__("filedata",u("Rc"));Qc.prototype.__defineSetter__("filedata",ba("Rc"));function Rc(){J.call(this);this.e="colortable";this.aa=new Qb;Ea(this,new Qc)}F(Rc,J);Rc.prototype.add=function(a,b,c,d,e,f){(!z(a)||!z(c)||!z(d)||!z(e)||!z(f))&&i(Error("Invalid color table entry."));this.aa.set(a,[b,c,d,e,f]);this.c=p};function Sc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.b=ia(c)?c:0}Sc.prototype.f=function(){return new Sc(this.x,this.y,this.b)};Sc.prototype.Le=function(){return[this.x,this.y,this.b]};function K(a,b,c){this.x=a;this.y=b;this.b=c}F(K,Sc);v=K.prototype;v.f=function(){return new K(this.x,this.y,this.b)};v.Mb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};v.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};v.O=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};v.normalize=function(){return this.scale(1/this.Mb())};v.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
v.Xa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};v.vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Tc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Uc(a,b){return new K(a.x+b.x,a.y+b.y,a.b+b.b)}function Vc(a,b){return new K(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Wc(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}Wc.prototype.f=function(){return new Wc(this.x,this.y)};function Xc(a,b){return new Wc(a.x-b.x,a.y-b.y)};function Yc(a,b){this.x=a;this.y=b}F(Yc,Wc);v=Yc.prototype;v.f=function(){return new Yc(this.x,this.y)};v.Mb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};v.scale=function(a){this.x*=a;this.y*=a;return this};v.O=function(){this.x=-this.x;this.y=-this.y;return this};v.normalize=function(){return this.scale(1/this.Mb())};v.add=function(a){this.x+=a.x;this.y+=a.y;return this};v.Xa=function(a){this.x-=a.x;this.y-=a.y;return this};
v.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};v.vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Zc(a,b){this.width=a;this.height=b}function $c(a,b){return a==b?p:!a||!b?s:a.width==b.width&&a.height==b.height}Zc.prototype.f=function(){return new Zc(this.width,this.height)};Zc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Zc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Zc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function cd(a,b){if(a instanceof cd)this.G=a.Le();else{var c;if(c=ka(a))a:{for(var d=c=0;d<a.length;d++){if(!ka(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!z(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.G=Hb(a):a instanceof Zc?this.G=dd(a.height,a.width):z(a)&&z(b)&&0<a&&0<b?this.G=dd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.w=new Zc(this.G[0].length,this.G.length)}
function ed(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new cd(b)}function fd(a,b,c){for(var d=0;d<a.ia().height;d++)for(var e=0;e<a.ia().width;e++)b.call(c,a.G[d][e],d,e,a)}function gd(a,b){var c=new cd(a.ia());fd(a,function(d,e,f){c.G[e][f]=b.call(m,d,e,f,a)});return c}function dd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}v=cd.prototype;
v.add=function(a){$c(this.w,a.ia())||i(Error("Matrix summation is only supported on arrays of equal size"));return gd(this,function(b,c,d){return b+a.G[c][d]})};v.vc=function(a,b){if(this.w.width!=a.w.width||this.w.height!=a.w.height)return s;for(var c=b||0,d=0;d<this.w.height;d++)for(var e=0;e<this.w.width;e++)if(!(Math.abs(this.G[d][e]-a.G[d][e])<=(c||1.0E-6)))return s;return p};v.ia=u("w");v.H=function(a,b){return!(0<=a&&a<this.w.height&&0<=b&&b<this.w.width)?q:this.G[a][b]};
function M(a,b,c,d){0<=b&&b<a.w.height&&0<=c&&c<a.w.width||i(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.w.height+","+a.w.width+")"));a.G[b][c]=d}v.multiply=function(a){if(a instanceof cd)return this.w.width!=a.ia().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),hd(this,a);if(z(a))return id(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
v.Xa=function(a){$c(this.w,a.ia())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return gd(this,function(b,c,d){return b-a.G[c][d]})};v.Le=u("G");function hd(a,b){var c=new cd(a.w.height,b.ia().width);fd(c,function(a,e,f){for(var g=a=0;g<this.w.width;g++)a+=this.H(e,g)*b.H(g,f);M(c,e,f,a)},a);return c}function id(a,b){return gd(a,function(a){return a*b})};function O(a,b){cd.call(this,a,b);this.e="matrix"}F(O,cd);function jd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new O(b)}v=O.prototype;v.N=function(){var a=[],b=this.ia();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.H(c,d));return a};
v.translate=function(a){this.w.width!=this.w.height&&i(Error("Can not translate non-square matrix."));var b=this.ia(),c=ed(b.height);a instanceof Yc&&3==b.height?(M(c,0,2,a.x),M(c,1,2,a.y)):a instanceof K&&4==b.height?(M(c,0,3,a.x),M(c,1,3,a.y),M(c,2,3,a.b)):i(Error("Translation failed."));return new O(this.multiply(c))};
v.rotate=function(a,b){(4!=this.ia().height||this.w.width!=this.w.height)&&i(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof K))&&i(Error("Invalid axis vector."));z(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=ed(4);M(f,0,0,d+c.x*c.x*(1-d));M(f,0,1,c.x*c.y*(1-d)-c.b*e);M(f,0,2,c.x*c.b*(1-d)+c.y*e);M(f,1,0,c.y*c.x*(1-d)+c.b*e);M(f,1,1,d+c.y*c.y*(1-d));M(f,1,2,c.y*c.b*(1-d)-c.x*e);M(f,2,0,c.b*c.x*(1-d)-c.y*e);M(f,2,1,c.b*c.y*(1-d)+c.x*e);M(f,2,
2,d+c.b*c.b*(1-d));return new O(this.multiply(f))};v.Ca=function(a){var b=this.ia(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof K&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new cd(c));return new K(parseFloat(a.H(0,0)),parseFloat(a.H(1,0)),parseFloat(a.H(2,0)))};v.uh=function(a,b){var c=this.G[a];this.G[a]=this.G[b];this.G[b]=c};
v.th=function(a,b){for(var c=this.ia(),d=0,d=0;d<c.height;d++){var e=this.H(d,a);e||(e=0);var f=this.H(d,b);f||(f=0);M(this,d,a,f);M(this,d,b,e)}};A("X.matrix",O);A("X.matrix.createIdentityMatrix",jd);A("X.matrix.prototype.flatten",O.prototype.N);A("X.matrix.prototype.translate",O.prototype.translate);A("X.matrix.prototype.rotate",O.prototype.rotate);A("X.matrix.prototype.toArray",O.prototype.Le);A("X.matrix.prototype.getValueAt",O.prototype.H);A("X.matrix.prototype.multiplyByVector",O.prototype.Ca);
A("X.matrix.prototype.swapRows",O.prototype.uh);A("X.matrix.prototype.swapCols",O.prototype.th);function kd(){J.call(this);this.e="transform";this.k=jd(4);this.Ma=new Float32Array(this.k.N())}F(kd,J);kd.prototype.__defineGetter__("matrix",u("k"));kd.prototype.__defineSetter__("matrix",function(a){(!x(a)||!(a instanceof O))&&i(Error("Invalid matrix."));this.k=a;this.Ma=new Float32Array(this.k.N());this.c=p});v=kd.prototype;v.kh=function(a){(!z(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.k=this.k.rotate(a*Math.PI/180,new K(0,1,0));this.Ma=new Float32Array(this.k.N());this.c=p};
v.lh=function(a){(!z(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.k=this.k.rotate(a*Math.PI/180,new K(1,0,0));this.Ma=new Float32Array(this.k.N());this.c=p};v.mh=function(a){(!z(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.k=this.k.rotate(a*Math.PI/180,new K(0,0,1));this.Ma=new Float32Array(this.k.N());this.c=p};v.wh=function(a){z(a)||i(Error("Invalid distance."));this.k=this.k.translate(new K(a,0,0));this.Ma=new Float32Array(this.k.N());this.c=p};
v.xh=function(a){z(a)||i(Error("Invalid distance."));this.k=this.k.translate(new K(0,a,0));this.Ma=new Float32Array(this.k.N());this.c=p};v.yh=function(a){z(a)||i(Error("Invalid distance."));this.k=this.k.translate(new K(0,0,a));this.Ma=new Float32Array(this.k.N());this.c=p};function ld(a,b,c){var d=a.k.H(b,c);d||(d=0);M(a.k,b,c,-1*d);a.Ma=new Float32Array(a.k.N());a.c=p}v.xg=function(){ld(this,0,0)};v.yg=function(){ld(this,1,1)};v.zg=function(){ld(this,2,2)};A("X.transform",kd);
A("X.transform.prototype.rotateX",kd.prototype.kh);A("X.transform.prototype.rotateY",kd.prototype.lh);A("X.transform.prototype.rotateZ",kd.prototype.mh);A("X.transform.prototype.translateX",kd.prototype.wh);A("X.transform.prototype.translateY",kd.prototype.xh);A("X.transform.prototype.translateZ",kd.prototype.yh);A("X.transform.prototype.flipX",kd.prototype.xg);A("X.transform.prototype.flipY",kd.prototype.yg);A("X.transform.prototype.flipZ",kd.prototype.zg);function md(){J.call(this);this.e="texture";this.jb=this.Te=this.r=q;this.Yc=this.Zc=0;Ea(this,new Qc)}F(md,J);A("X.texture",md);function P(a){J.call(this);this.e="triplets";this.zb=Infinity;this.wb=-Infinity;this.Ab=Infinity;this.xb=-Infinity;this.Bb=Infinity;this.yb=-Infinity;this.Nc=[0,0,0];this.U=[];x(a)&&(this.U=a.U.slice(),this.zb=a.zb,this.wb=a.wb,this.Ab=a.Ab,this.xb=a.xb,this.Bb=a.Bb,this.yb=a.yb,this.Nc=a.Nc.slice())}F(P,J);
P.prototype.add=function(a,b,c){(!z(a)||!z(b)||!z(c))&&i(Error("Invalid triplet."));this.zb=Math.min(this.zb,a);this.wb=Math.max(this.wb,a);this.Ab=Math.min(this.Ab,b);this.xb=Math.max(this.xb,b);this.Bb=Math.min(this.Bb,c);this.yb=Math.max(this.yb,c);this.Nc=[(this.zb+this.wb)/2,(this.Ab+this.xb)/2,(this.Bb+this.yb)/2];this.c=p;return this.U.push(a,b,c)/3};
P.prototype.get=function(a){(!z(a)||0>a||3*a>this.U.length||a==this.U.length/3)&&i(Error("Invalid id."));a*=3;return[this.U[a],this.U[a+1],this.U[a+2]]};P.prototype.remove=function(a){(!z(a)||0>a||3*a>this.U.length||a==this.count)&&i(Error("Invalid id."));this.U.splice(a,3);this.c=p};P.prototype.clear=function(){this.U=[];this.c=p};P.prototype.__defineGetter__("count",function(){return this.U.length/3});P.prototype.__defineGetter__("length",function(){return this.U.length});A("X.triplets",P);
A("X.triplets.prototype.add",P.prototype.add);A("X.triplets.prototype.get",P.prototype.get);A("X.triplets.prototype.remove",P.prototype.remove);A("X.triplets.prototype.clear",P.prototype.clear);function Q(){this.ga=nd;this.Gb=new kd;this.pb=[1,1,1];this.j=new P;this.l=new P;this.va=new P;this.Fb=this.Y=q;this.Xc=[];this.xa=p;this.Ub=this.qc=1;this.Qb=q;this.jc=s;this.L=1;this.J=0}var nd="TRIANGLES";Q.prototype.__defineGetter__("texture",function(){this.Y||(this.Y=new md);return this.Y});Q.prototype.__defineGetter__("transform",u("Gb"));Q.prototype.__defineGetter__("points",u("j"));Q.prototype.__defineGetter__("normals",u("l"));Q.prototype.__defineGetter__("colors",u("va"));
Q.prototype.__defineGetter__("color",u("pb"));Q.prototype.__defineSetter__("color",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.pb=a;this.c=p});Q.prototype.__defineGetter__("opacity",u("L"));Q.prototype.__defineSetter__("opacity",function(a){(!z(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.L=a;this.c=p});
Q.prototype.__defineGetter__("caption",u("Qb"));Q.prototype.__defineSetter__("caption",function(a){this.Qb=a;this.c=p});Q.prototype.__defineGetter__("visible",u("xa"));Q.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.xa=a;this.c=p});Q.prototype.__defineGetter__("pointsize",u("qc"));Q.prototype.__defineSetter__("pointsize",function(a){z(a)||i(Error("Invalid point size."));this.qc=a;this.c=p});
Q.prototype.__defineGetter__("magicmode",u("jc"));Q.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.jc=a;this.c=p});Q.prototype.__defineGetter__("linewidth",u("Ub"));Q.prototype.__defineSetter__("linewidth",function(a){z(a)||i(Error("Invalid line width."));this.Ub=a;this.c=p});function od(){this.Oa=Infinity;this.oa=this.Ga=-Infinity;this.qa=Infinity}od.prototype.__defineGetter__("lowerThreshold",u("oa"));od.prototype.__defineSetter__("lowerThreshold",function(a){a>=this.Oa&&a<=this.Ga&&(this.oa=a)});od.prototype.__defineGetter__("upperThreshold",u("qa"));od.prototype.__defineSetter__("upperThreshold",function(a){a>=this.Oa&&a<=this.Ga&&(this.qa=a)});od.prototype.__defineGetter__("min",u("Oa"));od.prototype.__defineGetter__("max",u("Ga"));function pd(){J.call(this);this.e="scalars";this.Tc=this.u=q;this.Sd=[0,1,0];this.Rd=[1,0,0];this.bf=p;Ea(this,new Qc);Ea(this,new od)}F(pd,J);pd.prototype.__defineGetter__("array",u("u"));pd.prototype.__defineSetter__("array",function(a){this.Tc=this.u=a;this.c=p});pd.prototype.__defineGetter__("minColor",u("Sd"));pd.prototype.__defineSetter__("minColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid min. color."));this.Sd=a});pd.prototype.__defineGetter__("maxColor",u("Rd"));
pd.prototype.__defineSetter__("maxColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid max. color."));this.Rd=a});A("X.scalars",pd);function S(a){J.call(this);this.e="object";this.d=[];this.z=this.Q=q;Ea(this,new Q);x(a)&&this.Hb(a)}F(S,J);
S.prototype.Hb=function(a){this.ga=a.ga;this.Gb=new kd;this.Gb.k=new O(a.Gb.k.G);this.pb=a.pb.slice();this.j=new P(a.j);this.l=new P(a.l);this.va=new P(a.va);this.Y=a.Y;this.Fb=a.Fb;a.r&&(this.r=new Pc((new String(a.r.Xd)).toString()));this.L=a.L;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new Da[b[d].e](b[d]));this.xa=a.xa;this.qc=a.qc;this.Ub=a.Ub;a.Qb&&(this.Qb=(new String(a.Qb)).toString());this.jc=a.jc;this.Xc=a.Xc.slice();this.c=p};
S.prototype.__defineGetter__("colortable",function(){this.Q||(this.Q=new Rc);return this.Q});S.prototype.__defineGetter__("scalars",function(){this.z||(this.z=new pd);return this.z});S.prototype.__defineGetter__("children",u("d"));S.prototype.P=function(){var a=new qd;a.da=this;this.dispatchEvent(a)};function rd(a,b){(!x(a)||!x(b)||!(a instanceof S)||!(b instanceof S))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.L?-1:1==b.L?1:x(a.J)&&x(b.J)&&a.J>b.J?-1:1}
A("X.object",S);A("X.object.prototype.modified",S.prototype.P);function sd(){}function td(a){for(var b=a.j.count,c=[],d=0,d=0;d<b;d+=3){var e=a.j.get(d),f=a.j.get(d+1),g=a.j.get(d+2),h=a.l.get(d),j=a.l.get(d+1),k=a.l.get(d+2),n=a.pb;0<a.va.length&&(n=a.va.get(d));var l=[];l.push(new Ic(e,h));l.push(new Ic(f,j));l.push(new Ic(g,k));c.push(new Kc(l,n))}return Nc(c)}
function ud(a,b){(!x(b)||!(b instanceof Mc))&&i(Error("Invalid CSG object."));a.j.clear();a.l.clear();a.va.clear();var c=new Oc,d=[];yb(b.t,function(a){for(var b=[],g=a.Gd,b=yb(a.Ya,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.hg=yb(c.unique(),function(a){return[a.ka.x(),a.ka.y(),a.ka.b()]});a.gg=yb(c.unique(),function(a){return[a.T.x(),a.T.y(),a.T.b()]});a.fg=yb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});yb(d,
function(a){var b=a[0],c=a[1],a=a[2],d=this.hg,j=this.gg,k=this.fg;this.j.add(d[b][0],d[b][1],d[b][2]);this.j.add(d[c][0],d[c][1],d[c][2]);this.j.add(d[a][0],d[a][1],d[a][2]);this.l.add(j[b][0],j[b][1],j[b][2]);this.l.add(j[c][0],j[c][1],j[c][2]);this.l.add(j[a][0],j[a][1],j[a][2]);k[b]&&this.va.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.va.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.va.add(k[a][0],k[a][1],k[a][2])}.bind(a));a.ga=nd}
sd.prototype.Me=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=td(b));a=new S;Ea(a,new sd);ud(a,td(this).Me(b));return a};sd.prototype.Xa=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=td(b));a=new S;Ea(a,new sd);ud(a,td(this).Xa(b));return a};
sd.prototype.se=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=td(b));a=new S;Ea(a,new sd);ud(a,td(this).se(b));return a};sd.prototype.inverse=function(){var a=new S;Ea(a,new sd);ud(a,td(this).inverse());return a};A("X.constructable",sd);A("X.constructable.prototype.intersect",sd.prototype.se);A("X.constructable.prototype.inverse",sd.prototype.inverse);A("X.constructable.prototype.subtract",sd.prototype.Xa);
A("X.constructable.prototype.union",sd.prototype.Me);function T(a){mc.call(this,a);this.e="event"}F(T,mc);var vd=Gc("pan"),wd=Gc("rotate"),xd=Gc("zoom"),yd=Gc("scroll"),zd=Gc("render"),Ad=Gc("resetview"),Cc=Gc("modified"),Bd=Gc("progress"),Cd=Gc("hover"),Dd=Gc("hover_end");function Ed(){T.call(this,vd);this.J=new Yc(0,0)}F(Ed,T);function Fd(){T.call(this,wd);this.J=new Yc(0,0)}F(Fd,T);function Gd(){T.call(this,xd);this.Za=this.ub=s}F(Gd,T);function Hd(){T.call(this,yd);this.B=s}F(Hd,T);function Id(){T.call(this,zd)}F(Id,T);
function Jd(){T.call(this,Cd);this.fd=this.ed=0}F(Jd,T);function Kd(){T.call(this,Dd)}F(Kd,T);function Ld(){T.call(this,Ad)}F(Ld,T);function qd(){T.call(this,Cc);this.da=new S;this.q=q}F(qd,T);function Md(){T.call(this,Bd);this.df=0}F(Md,T);function Nd(a){this.m=a;this.Cf=I(this.m,Xa?"DOMMouseScroll":"mousewheel",this)}F(Nd,Hc);
Nd.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ja;if("mousewheel"==a.type){c=1;if(G||Ya&&(Ra||nb("532.0")))c=40;d=Ya&&Qa&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ia(a.wheelDeltaX)?(b=Ya&&Qa&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ya&&Qa&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;z(this.Ef)&&Math.min(Math.max(b,-this.Ef),this.Ef);z(this.Ff)&&(c=Math.min(Math.max(c,
-this.Ff),this.Ff));b=new Od(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Aa()}};Nd.prototype.D=function(){Nd.h.D.call(this);yc(this.Cf);delete this.Cf};function Od(a,b,c,d){b&&this.Z(b,m);this.type="mousewheel";this.detail=a;this.Xb=d}F(Od,oc);G||Ya&&nb("525");var Rd;function Sd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Ib(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=wb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Td=!G||pb(9);!Xa&&!G||G&&pb(9)||Xa&&nb("1.9.1");G&&nb("9");function Ud(a){return a?new Vd(Wd(a)):Rd||(Rd=new Vd)}function Xd(a){return la(a)?document.getElementById(a):a}function Yd(a,b){qb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Zd?a.setAttribute(Zd[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var Zd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function $d(a,b,c){return ae(document,arguments)}
function ae(a,b){var c=b[0],d=b[1];if(!Td&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Fa(d.name),'"');if(d.type){c.push(' type="',Fa(d.type),'"');var e={};ub(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(la(d)?c.className=d:ja(d)?Sd.apply(q,[c].concat(d)):Yd(c,d));2<b.length&&be(a,c,b);return c}
function be(a,b,c){function d(c){c&&b.appendChild(la(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ka(f)&&!(pa(f)&&0<f.nodeType)?xb(ce(f)?Hb(f):f,d):d(f)}}function de(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ee(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function fe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Wd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ce(a){if(a&&"number"==typeof a.length){if(pa(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return s}function Vd(a){this.F=a||ca.document||document}v=Vd.prototype;
v.pd=Ud;v.g=function(a){return la(a)?this.F.getElementById(a):a};v.Wb=function(a,b,c){return ae(this.F,arguments)};v.createElement=function(a){return this.F.createElement(a)};v.createTextNode=function(a){return this.F.createTextNode(a)};function ge(a){return"CSS1Compat"==a.F.compatMode}function he(a){var b=a.F,a=!Ya&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Wc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}v.appendChild=function(a,b){a.appendChild(b)};
v.contains=fe;function U(a){(!x(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));J.call(this);this.e="interactor";this.Rb=a;this.Ud=this.Xe=this.We=this.Ye=this.Ve=this.Ze=q;this.Td=p;this.kb=this.gb=this.Na=s;this.Wc=[0,0];this.Md=new Yc(0,0);this.config={MOUSEWHEEL_ENABLED:p,MOUSECLICKS_ENABLED:p,KEYBOARD_ENABLED:p,HOVERING_ENABLED:p,CONTEXTMENU_ENABLED:s}}F(U,J);U.prototype.__defineGetter__("leftButtonDown",u("Na"));U.prototype.__defineGetter__("middleButtonDown",u("gb"));
U.prototype.__defineGetter__("rightButtonDown",u("kb"));
U.prototype.Z=function(){this.config.MOUSEWHEEL_ENABLED?(this.Ud=new Nd(this.Rb),this.Ze=I(this.Ud,"mousewheel",this.Ec.bind(this))):(yc(this.Ze),this.Ud=q);this.config.MOUSECLICKS_ENABLED?(this.Ve=I(this.Rb,"mousedown",this.Tg.bind(this)),this.Ye=I(this.Rb,"mouseup",this.Yg.bind(this))):(yc(this.Ve),yc(this.Ye));this.Rb.oncontextmenu=this.config.CONTEXTMENU_ENABLED?q:function(){return s};window.onkeydown=this.config.KEYBOARD_ENABLED?this.Kf.bind(this):q;yc(this.We);yc(this.Xe);this.We=I(this.Rb,
"mousemove",this.Vg.bind(this));this.Xe=I(this.Rb,"mouseout",this.Wg.bind(this))};U.prototype.Tg=function(a){0==a.button?this.Na=p:1==a.button?this.gb=p:2==a.button&&(this.kb=p);eval("this.onMouseDown("+this.Na+","+this.gb+","+this.kb+")");ie(this);a.preventDefault()};U.prototype.Sg=aa();U.prototype.Yg=function(a){0==a.button?this.Na=s:1==a.button?this.gb=s:2==a.button&&(this.kb=s);eval("this.onMouseUp("+this.Na+","+this.gb+","+this.kb+")");ie(this);a.preventDefault()};
U.prototype.__defineGetter__("mousePosition",u("Wc"));v=U.prototype;v.Xg=aa();v.Wg=function(a){this.Td=s;this.config.KEYBOARD_ENABLED&&(window.onkeydown=q);this.kb=this.gb=this.Na=s;ie(this);this.Md=new Yc(0,0);a.preventDefault()};v.Ug=aa();
v.Vg=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Td=p;this.config.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.Kf.bind(this));a.preventDefault();var b=a.shiftKey;this.Wc=[a.offsetX,a.offsetY];var c=new Yc(this.Wc[0],this.Wc[1]),a=this.Md.Xa(c);this.Md=c.f();this.config.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.gb||this.Na||this.kb)&&ie(this),this.pe=setTimeout(function(){ie(this);var a=new Jd;a.ed=c.x;a.fd=c.y;this.dispatchEvent(a);
this.pe=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.Mb()&&(this.Na&&!b?(b=new Fd,b.J=a,b.ji=0,this.dispatchEvent(b)):this.gb||this.Na&&b?(b=new Ed,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.J=a,this.dispatchEvent(b)):this.kb&&(b=new Gd,b.ub=0<a.y,b.Za=s,this.dispatchEvent(b)))};function ie(a){a.pe&&clearTimeout(a.pe);a.dispatchEvent(new Kd)}v.Zg=aa();
v.Ec=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ie(this);a.preventDefault()};v.Qg=aa();
v.Kf=function(a){if(this.Td){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ie(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Ld,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Ed:b?a=new Gd:(a=new Fd,this instanceof je&&(a=new Hd)),a&&(c=new Yc(0,0),37==f?(c.x=5,a.B=s,b&&(a.B=p,a.ub=p,a.Za=s)):39==f?(c.x=-5,a.B=p,b&&(a.ub=s,a.Za=s)):38==f?(c.y=5,a.B=p,b&&(a.ub=p,a.Za=p)):40==f&&(c.y=-5,a.B=s,b&&(a.ub=s,
a.Za=p)),a.J=c,this.dispatchEvent(a)))}};A("X.interactor",U);A("X.interactor.prototype.init",U.prototype.Z);A("X.interactor.prototype.onMouseDown",U.prototype.Sg);A("X.interactor.prototype.onMouseUp",U.prototype.Xg);A("X.interactor.prototype.onMouseMove",U.prototype.Ug);A("X.interactor.prototype.onMouseWheel",U.prototype.Zg);A("X.interactor.prototype.onKey",U.prototype.Qg);function je(a){U.call(this,a);this.e="interactor2D"}F(je,U);je.prototype.Ec=function(a){je.h.Ec.call(this,a);var b=new Hd;x(a.Xb)||(a.Xb=0);b.B=0>a.Xb;this.dispatchEvent(b)};function V(a,b){(!z(a)||!z(b))&&i(Error("A camera needs valid width and height values."));J.call(this);this.e="camera";this.fa=new K(0,0,100);this.Sb=new K(0,0,0);this.B=new K(0,1,0);this.s=this.wd(this.fa,this.Sb);this.tb=new Float32Array(this.s.N())}F(V,J);V.prototype.ze=function(a){(!x(a)||!(a instanceof U))&&i(Error("Could not observe the interactor."));I(a,vd,this.$g.bind(this));I(a,xd,this.eh.bind(this))};
V.prototype.eh=function(a){a instanceof Gd||i(Error("Received no valid zoom event."));a.ub?this.dg(a.Za):this.eg(a.Za)};V.prototype.$g=function(a){a instanceof Ed||i(Error("Received no valid pan event."));this.Of(a.J)};V.prototype.__defineGetter__("view",u("s"));V.prototype.__defineSetter__("view",function(a){(!x(a)||!(a instanceof O))&&i(Error("Invalid view matrix."));this.s=a;this.tb=new Float32Array(this.s.N())});V.prototype.__defineGetter__("position",function(){return[this.fa.x,this.fa.y,this.fa.b]});
V.prototype.__defineSetter__("position",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid position."));this.fa=new K(a[0],a[1],a[2]);this.reset()});V.prototype.__defineGetter__("focus",function(){return[this.Sb.x,this.Sb.y,this.Sb.b]});V.prototype.__defineSetter__("focus",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid focus"));this.Sb=new K(a[0],a[1],a[2]);this.reset()});V.prototype.__defineGetter__("up",function(){return[this.B.x,this.B.y,this.B.b]});
V.prototype.__defineSetter__("up",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid up vector."));this.B=new K(a[0],a[1],a[2]);this.reset()});v=V.prototype;v.reset=function(){this.s=this.wd(this.fa,this.Sb);this.tb=new Float32Array(this.s.N())};v.Of=function(a){a instanceof Yc||i(Error("Invalid distance vector for pan operation."));a=new K(-a.x,a.y,0);a=jd(4).translate(a);this.s=new O(a.multiply(this.s));this.tb=new Float32Array(this.s.N());this.dispatchEvent(new Id)};
v.dg=function(a){var b=20;x(a)&&!a&&(b=1);a=new K(0,0,b);a=jd(4).translate(a);this.s=new O(a.multiply(this.s));this.tb=new Float32Array(this.s.N());this.dispatchEvent(new Id)};v.eg=function(a){var b=30;x(a)&&!a&&(b=1);a=new K(0,0,-b);a=jd(4).translate(a);this.s=new O(a.multiply(this.s));this.tb=new Float32Array(this.s.N());this.dispatchEvent(new Id)};v.wd=function(a,b){(!(a instanceof K)||!(b instanceof K))&&i(Error("3D vectors required for calculating the view."));return jd(4)};A("X.camera",V);
A("X.camera.prototype.pan",V.prototype.Of);A("X.camera.prototype.zoomIn",V.prototype.dg);A("X.camera.prototype.zoomOut",V.prototype.eg);function ke(a,b){V.call(this,a,b);this.e="camera3D";this.jg=45;var c=Float32Array,d;d=a/b;var e=1*Math.tan(this.jg*Math.PI/360),f=-e;d=new O([[2/(e*d-f*d),0,(e*d+f*d)/(e*d-f*d),0],[0,2/(e-f),(e+f)/(e-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.lg=new c(d.N())}F(ke,V);ke.prototype.ze=function(a){ke.h.ze.call(this,a);I(a,wd,this.bh.bind(this))};ke.prototype.bh=function(a){a instanceof Fd||i(Error("Received no valid rotate event."));this.rotate(a.J)};
ke.prototype.rotate=function(a){a instanceof Array&&2==a.length?a=new Yc(a[0],a[1]):a instanceof Yc||i(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=jd(4),d=new K(parseFloat(this.view.H(0,0)),parseFloat(this.view.H(0,1)),parseFloat(this.view.H(0,2))),b=c.rotate(b,new K(parseFloat(this.view.H(1,0)),parseFloat(this.view.H(1,1)),parseFloat(this.view.H(1,2)))),a=c.rotate(a,d);this.view=new O(this.view.multiply(a.multiply(b)));this.tb=new Float32Array(this.view.N());
this.dispatchEvent(new Id)};ke.prototype.wd=function(a,b){ke.h.wd.call(this,a,b);var c=jd(4),d=new K(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.B.f();e.vc(d)&&(e.b+=1.0E-6);var f=Vc(e,d),e=Vc(d,f),f=f.normalize(),e=e.normalize();M(c,0,0,f.x);M(c,0,1,f.y);M(c,0,2,f.b);M(c,0,3,0);M(c,1,0,e.x);M(c,1,1,e.y);M(c,1,2,e.b);M(c,1,3,0);M(c,2,0,d.x);M(c,2,1,d.y);M(c,2,2,d.b);M(c,2,3,0);M(c,3,0,0);M(c,3,1,0);M(c,3,2,0);M(c,3,3,1);d=a.f();return c.translate(d.O())};A("X.camera3D",ke);
A("X.camera3D.prototype.rotate",ke.prototype.rotate);function le(){J.call(this);this.e="parser"}F(le,J);v=le.prototype;v.parse=function(){i(Error("The function parse() should be overloaded."))};v.Fc=function(a,b){var c=this.n(a,b+2),d=this.n(a,b+3),e=(d<<1&255|c>>7)-127,c=(c&127)<<16|this.n(a,b+1)<<8|this.n(a,b);return 0==c&&-127==e?0:(1-2*(d>>7))*(1+c*Math.pow(2,-23))*Math.pow(2,e)};
function me(a,b,c){var d=a.n(b,c),e=a.n(b,c+1),f=(d<<1&255|e>>7)-127,a=(e&127)<<16|a.n(b,c+2)<<8|a.n(b,c+3);return 0==a&&-127==f?0:(1-2*(d>>7))*(1+a*Math.pow(2,-23))*Math.pow(2,f)}function ne(a,b,c,d){var e=[],f=0,g=Infinity,h;for(h=0;h<d;h++){var j=a.Fc(b,c+4*h);e[h]=j;f=Math.max(f,j);g=Math.min(g,j)}return[e,f,g]}v.Fe=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=me(this,a,b+4*g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};
function oe(a,b,c){return(a.n(b,c+3)<<24)+(a.n(b,c+2)<<16)+(a.n(b,c+1)<<8)+a.n(b,c)}function pe(a,b,c){return(a.n(b,c)<<24)+(a.n(b,c+1)<<16)+(a.n(b,c+2)<<8)+a.n(b,c+3)}v.Sf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=pe(this,a,b+4*g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};v.Ad=function(a,b){return(this.n(a,b+1)<<8)+this.n(a,b)};
v.Rf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=(this.n(a,b+2*g)<<8)+this.n(a,b+2*g+1);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};v.gh=function(a,b){var c=this.n(a,b);return 127<c?c-256:c};v.n=function(a,b){return a.charCodeAt(b)&255};v.Qf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=this.n(a,b+g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};
function qe(a,b,c,d){for(var e=c[2],f=c[1],c=c[0],g=a.v!=q,h=f*c,j=Array(e),k=0;k<e;k++){j[k]=Array(f);for(var n=0;n<f;n++)j[k][n]=Array(c)}for(var l=0,k=k=0;k<e;k++){for(var n=b.slice(k*h,(k+1)*h),o=new Uint8Array(4*h),r=0,t=0,w=0,r=0;r<f;r++)for(t=0;t<c;t++){var l=n[w],B=0,D=0,C=0,y=0;a.Q?((y=a.Q.aa.get(Math.floor(l)))||(y=a.Q.aa.get(a.Q.aa.ha()-1)),B=255*y[1],D=255*y[2],C=255*y[3],y=255*y[4]):(B=D=C=255*(l/d),y=255);var E=4*w;o[E]=B;o[++E]=D;o[++E]=C;o[++E]=y;j[k][r][t]=l;w++}l=new md;l.jb=o;l.Zc=
c;l.Yc=f;n=a.Ta.d[k];n.Y=l;g&&(n.v=a.v.Ta.d[k].Y)}for(r=0;r<f;r++){o=new Uint8Array(4*e*c);for(k=w=0;k<e;k++)for(t=0;t<c;t++)l=j[k][r][t],a.Q?((y=a.Q.aa.get(Math.floor(l)))||(y=a.Q.aa.get(a.Q.aa.ha()-1)),B=255*y[1],D=255*y[2],C=255*y[3],y=255*y[4]):(B=D=C=255*(l/d),y=255),E=4*w,o[E]=B,o[++E]=D,o[++E]=C,o[++E]=y,w++;l=new md;l.jb=o;l.Zc=c;l.Yc=e;n=a.Sa.d[r];n.Y=l;g&&(n.v=a.v.Sa.d[r].Y)}for(t=0;t<c;t++){o=new Uint8Array(4*e*f);for(k=w=0;k<e;k++)for(r=0;r<f;r++)l=j[k][r][t],a.Q?((y=a.Q.aa.get(Math.floor(l)))||
(y=a.Q.aa.get(a.Q.aa.ha()-1)),B=255*y[1],D=255*y[2],C=255*y[3],y=255*y[4]):(B=D=C=255*(l/d),y=255),E=4*w,o[E]=B,o[++E]=D,o[++E]=C,o[++E]=y,w++;l=new md;l.jb=o;l.Zc=f;l.Yc=e;n=a.Ra.d[t];n.Y=l;g&&(n.v=a.v.Ra.d[t].Y)}};function re(){le.call(this);this.e="parserIMAGE"}F(re,le);re.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;vc(f,"load",this.fh.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};re.prototype.fh=function(a,b,c){b.Te=a;a=new qd;a.da=c;a.q=b;this.dispatchEvent(a)};A("X.parserIMAGE",re);A("X.parserIMAGE.prototype.parse",re.prototype.parse);function se(a,b){V.call(this,a,b);this.e="camera2D"}F(se,V);function te(){J.call(this);this.e="shaders";this.cd="";this.cd="precision mediump float;attribute vec3 vp,vn,vc;attribute vec2 vtp;attribute float vs;uniform mat4 uv,up,uot;uniform bool uuoc,uus,usrm;uniform vec3 uc,uoc,usminc,usmaxc;uniform float usmin,usmax,ups,usmint,usmaxt;varying float fdn;varying vec4 fvp;varying vec2 ftp;varying vec3 fc,fvn,ftvn;void main(){ftvn=mat3(uv[0].xyz,uv[1].xyz,uv[2].xyz)*mat3(uot[0].xyz,uot[1].xyz,uot[2].xyz)*vn;fvn=vn;fdn=0.;vec3 v=vp-uc;fvp=uv*uot*vec4(v,1.);ftp=vtp;if(uus){float f=vs;if(f<usmint||f>usmaxt){if(usrm)fc=uoc;else fdn=1.;}else{if(usrm)fc=f*usmaxc+(1.-f)*usminc;else fc=vc;}}else if(uuoc)fc=uoc;else fc=vc;gl_PointSize=ups;gl_Position=up*fvp;}";
this.Sc="";this.Sc="precision mediump float;uniform bool uup,uut,uutt,uulmt;uniform sampler2D uts,uts2;uniform float uoo,ulmo,uvlt,uvut,uvsmin,uvsmax;varying float fdn;varying vec4 fvp;varying vec3 fc,fvn,ftvn;varying vec2 ftp;void main(){if(fdn>0.){discard;}if(uup)gl_FragColor=vec4(fc,1.);else if(uut){vec4 f=texture2D(uts,ftp),v=f;if(uulmt){vec4 r=texture2D(uts2,ftp);if(r.w>0.){if(ulmo<1.)v=mix(r,v,1.-ulmo);else v=r;}}if(uutt){float r=uvlt/uvsmax,l=uvut/uvsmax;if(f.x<r||f.x>l){discard;}}gl_FragColor=v;gl_FragColor.w=uoo;}else{vec3 f=normalize(ftvn);if(fvn==vec3(0.,0.,0.)){gl_FragColor=vec4(fc,1.);return;}vec3 v=vec3(0.,0.,1.),r=vec3(0,0,-10);r=normalize(r);vec3 l=normalize(-fvp.xyz),u=reflect(-r,f);float d=pow(max(dot(u,l),0.),10.),o=.8*max(dot(f,v),0.),t=.3;gl_FragColor=vec4(fc*t+fc*o+vec3(.2,.2,.2)*d,uoo);}}"}
F(te,J);var ue={bi:"vp",ai:"vn",$h:"vc",di:"vtp",ci:"vs"},ve={ei:"uv",Jh:"up",Ch:"uc",Ih:"uot",Vh:"uuoc",Gh:"uoc",Xh:"uus",Rh:"usrm",Oh:"usmin",Lh:"usmax",Ph:"usminc",Mh:"usmaxc",Qh:"usmint",Nh:"usmaxt",Kh:"ups",Hh:"uoo",Fh:"un",Wh:"uup",Yh:"uut",Zh:"uutt",Uh:"uulmt",Eh:"ulmo",Sh:"uts",Th:"uts2",fi:"uvlt",ii:"uvut",hi:"uvsmin",gi:"uvsmax"};
function we(a){var b=Object.keys(ve);Object.keys(ue).every(function(a){a=ue[a];return-1!=this.cd.search(a)||-1!=this.Sc.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=ve[a];return-1!=this.cd.search(a)||-1!=this.Sc.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function xe(a,b,c){x(a)||i(Error("Invalid GL Buffer."));x(b)||i(Error("Invalid number of items."));x(c)||i(Error("Invalid item size."));J.call(this);this.e="buffer";this.X=a;this.eb=b;this.fb=c}F(xe,J);function ye(a){S.call(this);this.e="slice";this.i=[0,0,0];this.Tb=[0,0,1];this.B=[0,1,0];this.K=this.S=10;this.Fb=[0,1,0,0,1,1,1,1,1,0,0,0];this.v=this.Va=q;this.Fa=p;this.Pb=[1,1,1];x(a)&&this.Hb(a)}F(ye,S);ye.prototype.Hb=function(a){this.i=a.i.slice();this.Tb=a.Tb.slice();this.B=a.B.slice();this.S=a.S;this.K=a.K;this.Va=a.Va;this.v=a.v;this.Fa=a.Fa;this.Pb=a.Pb;this.kg=a.kg;ye.h.Hb.call(this,a)};
ye.prototype.ld=function(){this.j.clear();var a=new K(this.Tb[0],this.Tb[1],this.Tb[2]),b=new K(this.B[0],this.B[1],this.B[2]),c=Vc(b,a),d=new K(this.i[0],this.i[1],this.i[2]),e=new K(1,1,1);1==a.x?(e=new K(this.i[0],this.K/2,this.S/2),this.Fb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new K(this.S/2,this.i[1],this.K/2),this.Fb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new K(this.S/2,this.K/2,this.i[2]));var f=Uc(c.f().O(),b.f().O()),f=new K(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Uc(c.f().O(),b),g=new K(g.x*
e.x,g.y*e.y,g.b*e.b);g.add(d);var h=Uc(c,b.f().O()),h=new K(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Uc(c,b),b=new K(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.j.add(f.x,f.y,f.b);this.j.add(g.x,g.y,g.b);this.j.add(h.x,h.y,h.b);this.j.add(j.x,j.y,j.b);this.j.add(b.x,b.y,b.b);this.j.add(d.x,d.y,d.b);this.l.add(a.x,a.y,a.b);this.l.add(a.x,a.y,a.b);this.l.add(a.x,a.y,a.b);this.l.add(a.x,a.y,a.b);this.l.add(a.x,a.y,a.b);this.l.add(a.x,a.y,a.b);this.Fa&&(a=new S,a.j.add(f.x,f.y,f.b),a.j.add(g.x,g.y,
g.b),a.j.add(g.x,g.y,g.b),a.j.add(b.x,b.y,b.b),a.j.add(b.x,b.y,b.b),a.j.add(h.x,h.y,h.b),a.j.add(h.x,h.y,h.b),a.j.add(f.x,f.y,f.b),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.l.add(0,0,0),a.pb=[this.Pb[0],this.Pb[1],this.Pb[2]],a.ga="LINES",a.Ub=2,this.d.push(a))};A("X.slice",ye);function W(a){S.call(this);this.e="volume";this.i=[0,0,0];this.$=[10,10,10];this.M=[1,1,1];this.ic=this.cb=this.hc=this.bb=this.gc=this.ab=0;this.Ra=new S;this.Sa=new S;this.Ta=new S;this.dd=this.ya=s;this.mb=0;this.v=q;this.Fa=p;Ea(this,new Qc);Ea(this,new od);x(a)&&this.Hb(a)}F(W,S);
W.prototype.Hb=function(a){window.console.log(a);this.i=a.i.slice();this.$=a.$.slice();this.M=a.M.slice();this.ab=a.ab;this.gc=a.gc;this.bb=a.bb;this.hc=a.hc;this.cb=a.cb;this.ic=a.ic;this.Ra=new S(a.Ra);this.Sa=new S(a.Sa);this.Ta=new S(a.Ta);this.ya=a.ya;this.dd=a.dd;this.mb=a.mb;this.v=a.v;this.Fa=a.Fa;W.h.Hb.call(this,a)};
W.prototype.ld=function(){this.d.length=0;this.Ra.d.length=0;this.Sa.d.length=0;this.Ta.d.length=0;this.d.push(this.Ra);this.d.push(this.Sa);this.d.push(this.Ta);for(var a=0,a=0;3>a;a++){for(var b=(this.$[a]-1)/2,c=b,d=0,d=0;d<this.$[a];d++){var e=-b*this.M[a]+d*this.M[a],f=[[this.i[0]+e,this.i[1],this.i[2]],[this.i[0],this.i[1]+e,this.i[2]],[this.i[0],this.i[1],this.i[2]+e]],e=this.d[a].d,g=0,h=0,j=[1,1,1],k=this.Fa;0==a?(g=this.$[2]*this.M[2]-this.M[2],h=this.$[1]*this.M[1]-this.M[1],j=[1,1,0]):
1==a?(g=this.$[0]*this.M[0]-this.M[0],h=this.$[2]*this.M[2]-this.M[2],j=[1,0,0]):2==a&&(g=this.$[0]*this.M[0]-this.M[0],h=this.$[1]*this.M[1]-this.M[1],j=[0,1,0]);x(this.Va)&&(k=s);var n=new ye,l=n,f=f[a],o=[[1,0,0],[0,1,0],[0,0,1]][a],r=[[0,1,0],[0,0,-1],[0,1,0]][a];(!x(f)||!(f instanceof Array)||3!=f.length)&&i(Error("Invalid center."));(!x(o)||!(o instanceof Array)||3!=o.length)&&i(Error("Invalid front direction."));(!x(r)||!(r instanceof Array)||3!=r.length)&&i(Error("Invalid up direction."));
z(g)||i(Error("Invalid width."));z(h)||i(Error("Invalid height."));var t=s;x(k)&&(t=k);k=[1,1,1];x(j)&&(k=j);l.i=f;l.Tb=o;l.B=r;l.S=g;l.K=h;l.Fa=t;l.Pb=k;l.ld();n.Va=this;n.visible=d==Math.floor(c);e.push(n)}0==a?this.gc=this.ab=c:1==a?this.hc=this.bb=c:2==a&&(this.ic=this.cb=c)}this.c=p};
W.prototype.P=function(){if(0<this.d.length)if(this.ya!=this.dd&&(this.ya?(this.d[0].d[parseInt(this.ab,10)].visible=s,this.d[1].d[parseInt(this.bb,10)].visible=s,this.d[2].d[parseInt(this.cb,10)].visible=s):this.d[this.mb].visible=s,this.c=p,this.dd=this.ya),this.ya)ze(this,this.mb);else for(var a=0,a=0;3>a;a++){var b=this.d[a],c=0,d=0;0==a?(c=this.ab,d=this.gc,this.gc=this.ab):1==a?(c=this.bb,d=this.hc,this.hc=this.bb):2==a&&(c=this.cb,d=this.ic,this.ic=this.cb);b.d[parseInt(d,10)].visible=s;b=
b.d[parseInt(c,10)];b.visible=p;b.L=1}W.h.P.call(this)};W.prototype.__defineGetter__("dimensions",u("$"));W.prototype.__defineGetter__("volumeRendering",u("ya"));W.prototype.__defineSetter__("volumeRendering",ba("ya"));W.prototype.__defineSetter__("visible",ba("xa"));W.prototype.__defineGetter__("center",u("i"));W.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));this.i=a});
W.prototype.__defineGetter__("labelmap",function(){this.v||(this.v=new Ae(this));return this.v});W.prototype.__defineGetter__("indexX",u("ab"));W.prototype.__defineSetter__("indexX",function(a){z(a)&&0<=a&&a<this.Ra.d.length&&(this.ab=a)});W.prototype.__defineGetter__("indexY",u("bb"));W.prototype.__defineSetter__("indexY",function(a){z(a)&&0<=a&&a<this.Sa.d.length&&(this.bb=a)});W.prototype.__defineGetter__("indexZ",u("cb"));
W.prototype.__defineSetter__("indexZ",function(a){z(a)&&0<=a&&a<this.Ta.d.length&&(this.cb=a)});W.prototype.__defineGetter__("borders",u("Fa"));W.prototype.__defineSetter__("borders",ba("Fa"));function ze(a,b){if(a.ya&&(a.c||b!=a.mb)){var c=a.d[a.mb];c.visible=s;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].xa=p;a.mb=b;a.c=s}}A("X.volume",W);A("X.volume.prototype.modified",W.prototype.P);function Be(){le.call(this);this.e="parserSTL"}F(Be,le);Be.prototype.parse=function(a,b,c){for(var c=c.split("\n"),d=c.length,e=b.j,f=b.l,g=0,h=d%8;h--;)this.I(e,f,c[g]),g++;for(h=0.125*d^0;h--;)this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++,this.I(e,f,c[g]),g++;c=new qd;c.da=b;c.q=a;this.dispatchEvent(c)};
Be.prototype.I=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),d=c.split(" ");if("vertex"==d[0]){var c=parseFloat(d[1]),e=parseFloat(d[2]),d=parseFloat(d[3]);a.add(c,e,d)}else"facet"==d[0]&&(c=parseFloat(d[2]),e=parseFloat(d[3]),d=parseFloat(d[4]),b.add(c,e,d),b.add(c,e,d),b.add(c,e,d))};A("X.parserSTL",Be);A("X.parserSTL.prototype.parse",Be.prototype.parse);function Ce(){le.call(this);this.e="parserVTK"}F(Ce,le);
Ce.prototype.parse=function(a,b,c){var d=b.j,e=b.l,f=c.split("\n"),g=f.length,c=new P,h=new P;this.sb=[];this.ea=nd;this.Wd=this.hb=this.$a=this.ib=s;for(var j=0,k=g%8;k--;)this.I(c,h,f[j]),j++;for(k=0.125*g^0;k--;)this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++,this.I(c,h,f[j]),j++;f=h.length;j=g=this.sb.length;do{var k=this.sb[g-j],n=k.length,l;for(l=0;l<n&&!("LINES"==this.ea&&l+1>=n);l++){var o=parseInt(k[l],
10),r=c.get(o);d.add(r[0],r[1],r[2]);var t=o,w=r;"LINES"==this.ea?(t=parseInt(k[l+1],10),w=c.get(t),d.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==this.ea&&(0==l||l==n-1)&&d.add(r[0],r[1],r[2]);o<f?(w=h.get(o),e.add(w[0],w[1],w[2]),"LINES"==this.ea?(t=h.get(t),e.add(t[0],t[1],t[2])):"TRIANGLE_STRIPS"==this.ea&&(0==l||l==n-1)&&e.add(w[0],w[1],w[2])):(t=new K(r[0],r[1],r[2]),t.normalize(),e.add(t.x,t.y,t.b),"LINES"==this.ea?(t=new K(w[0],w[1],w[2]),t.normalize(),e.add(t.x,t.y,t.b)):"TRIANGLE_STRIPS"==this.ea&&
(0==l||l==n-1)&&e.add(t.x,t.y,t.b))}j--}while(0<j);b.ga=this.ea;d=new qd;d.da=b;d.q=a;this.dispatchEvent(d)};
Ce.prototype.I=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),c=c.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":this.ib=p;this.hb=this.$a=s;return;case "VERTICES":this.$a=p;this.hb=this.ib=s;a=parseInt(c[1],10);3<=a?this.ea=nd:1==a?this.ea="POINTS":i(Error("This VTK file is not supported!"));this.sb=[];return;case "TRIANGLE_STRIPS":this.$a=p;this.hb=this.ib=s;this.ea="TRIANGLE_STRIPS";this.sb=[];return;case "LINES":this.$a=p;this.hb=this.ib=s;this.ea="LINES";this.sb=[];return;case "POLYGONS":this.$a=
p;this.hb=this.ib=s;this.ea="POLYGONS";this.sb=[];return;case "POINT_DATA":this.hb=p;this.$a=this.ib=s;return}if(this.ib)if(1==d||isNaN(parseFloat(e)))this.ib=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.add(d,e,c))}else this.$a?1==d||isNaN(parseFloat(e))?this.$a=s:this.sb.push(c.slice(1)):this.hb&&("NORMALS"==
e?this.Wd=p:1==d||isNaN(parseFloat(e))?this.Wd=this.hb=s:this.Wd&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),b.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),b.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),b.add(d,e,c))))};A("X.parserVTK",Ce);A("X.parserVTK.prototype.parse",Ce.prototype.parse);function De(){le.call(this);this.e="parserFSM"}F(De,le);
De.prototype.parse=function(a,b,c){var d=b.j,e=b.l,f=b.Xc,g=new P,h;h=3;var j=0,k;do k=this.n(c,h++),j++;while(200>j&&10!=k);h++;var n=pe(this,c,h);h+=4;j=pe(this,c,h);h+=4;k=[];for(var l=0,l=0;l<n;l++){var o=me(this,c,h);h+=4;var r=me(this,c,h);h+=4;var t=me(this,c,h);h+=4;k[l]=0;g.add(o,r,t)}n=[];l=[];for(o=0;o<j;o++){var w=pe(this,c,h);h+=4;t=pe(this,c,h);h+=4;r=pe(this,c,h);h+=4;k[w]+=1;k[t]+=1;k[r]+=1;n.push([w,t,r]);l.push(new K(0,0,0))}for(o=0;o<j;o++){w=n[o][0];t=n[o][1];r=n[o][2];h=g.get(w);
var c=g.get(t),B=g.get(r);h=new K(h[0],h[1],h[2]);B=new K(B[0],B[1],B[2]);c=(new K(c[0],c[1],c[2])).f().Xa(h);h=B.f().Xa(h);c=Vc(c,h).normalize();l[w]=l[w].add(c);l[t]=l[t].add(c);l[r]=l[r].add(c)}for(o=0;o<j;o++)w=n[o][0],t=n[o][1],r=n[o][2],h=g.get(w),c=g.get(t),B=g.get(r),f.push(w),f.push(t),f.push(r),d.add(h[0],h[1],h[2]),d.add(c[0],c[1],c[2]),d.add(B[0],B[1],B[2]),w=l[w].scale(1/k[w]).normalize(),t=l[t].scale(1/k[t]).normalize(),r=l[r].scale(1/k[r]).normalize(),e.add(w.x,w.y,w.b),e.add(t.x,t.y,
t.b),e.add(r.x,r.y,r.b);b.ga=nd;d=new qd;d.da=b;d.q=a;this.dispatchEvent(d)};A("X.parserFSM",De);A("X.parserFSM.prototype.parse",De.prototype.parse);function Ee(a){function b(){Xb+=8;return ga<na.length?na.charCodeAt(ga++)&255:-1}function c(){var a;Xb++;a=N&1;N>>=1;0==N&&(N=b(),a=N&1,N=N>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=H[b]>>8-a);return b}function e(a){E++;D[C++]=a;r.push(String.fromCharCode(a));32768==C&&(C=0)}function f(){this.hd=this.gd=0;this.te=q}function g(){for(;;){if(L[za]>=ra)return-1;if(R[L[za]]==za)return L[za]++;L[za]++}}function h(){var a=xc[Bb],b;if(17==za)return-1;Bb++;za++;b=g();if(0<=b)a.gd=
b;else if(a.gd=32768,h())return-1;b=g();if(0<=b)a.hd=b,a.te=q;else if(a.hd=32768,a.te=xc[Bb],a.ki=Bb,h())return-1;za--;return 0}function j(a,b,c){xc=a;Bb=0;R=c;ra=b;for(a=0;17>a;a++)L[a]=0;za=0;return h()?-1:0}function k(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.hd&32768))return f.hd;f=f.te;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.gd&32768))return f.gd;e++;f=a[e]}}function n(){var a,g,h,l,n;do if(a=c(),h=d(2),0==h){N=1;h=b();h|=b()<<8;g=b();g|=b()<<8;for((h^~g)&65535&&document.write("BlockLen checksum mismatch\n");h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=H[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var o;h-=257;n=d(ea[h])+Aa[h];h=H[d(5)]>>3;8<Z[h]?(o=d(8),o|=d(Z[h]-8)<<8):o=d(Z[h]);o+=ha[h];for(h=0;h<n;h++)g=D[C-o&32767],e(g)}else if(2==h){var r=Array(320);g=257+d(5);o=1+d(5);l=4+d(4);for(h=0;19>h;h++)r[h]=0;for(h=0;h<l;h++)r[oa[h]]=d(3);n=fb.length;for(l=0;l<n;l++)fb[l]=new f;if(j(fb,19,r)){C=0;return}n=g+o;l=0;for(var t=-1;l<n;)if(t++,
h=k(fb),16>h)r[l++]=h;else if(16==h){var w;h=3+d(2);if(l+h>n){C=0;return}for(w=l?r[l-1]:0;h--;)r[l++]=w}else{h=17==h?3+d(3):11+d(7);if(l+h>n){C=0;return}for(;h--;)r[l++]=0}n=Db.length;for(l=0;l<n;l++)Db[l]=new f;if(j(Db,g,r)){C=0;return}n=Db.length;for(l=0;l<n;l++)fb[l]=new f;h=[];n=r.length;for(l=g;l<n;l++)h[l-g]=r[l];if(j(fb,o,h)){C=0;return}for(;;)if(h=k(Db),256<=h){h-=256;if(0==h)break;h--;n=d(ea[h])+Aa[h];h=k(fb);8<Z[h]?(o=d(8),o|=d(Z[h]-8)<<8):o=d(Z[h]);for(o+=ha[h];n--;)g=D[C-o&32767],e(g)}else e(h)}while(!a);
C=0;N=1}function l(){r=[];var a=[];y=s;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(n(),B[w]=Array(2),B[w][0]=r.join(""),B[w][1]="geonext.gxt",w++);31==a[0]&&139==a[1]&&(o(),B[w]=Array(2),B[w][0]=r.join(""),B[w][1]="file",w++);if(80==a[0]&&75==a[1]&&(y=p,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();t=b();t|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(kb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<ad-1&&(kb[e++]=
String.fromCharCode(f))}bd||(bd=kb);for(e=0;e<d;)b(),e++;E=0;8==a&&(n(),B[w]=Array(2),B[w][0]=r.join(""),B[w][1]=kb.join(""),w++);o()}}function o(){var a=[],c;t&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());y&&l();a[0]=b();if(8==a[0]){t=b();b();b();b();b();b();b();if(t&4){a[0]=b();a[2]=b();za=a[0]+256*a[1];for(a=0;a<za;a++)b()}if(t&8){a=0;for(kb=[];c=b();){if("7"==c||":"==c)a=0;a<ad-1&&(kb[a++]=c)}}if(t&16)for(;b(););
t&2&&(b(),b());n();b();b();b();b();b();b();b();b();y&&l()}}var r=[],t,w=0,B=[],D=Array(32768),C=0,y=s,E,H=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,
246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,
63,191,127,255],Aa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ea=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ha=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],oa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],na=a,ga=0,N=1,Xb=0,ad=256,kb=[],bd,Db=Array(288),fb=Array(32),Bb=0,xc=q,za=0,L=Array(17);
L[0]=0;var R,ra;Ee.prototype.cg=function(){l();return B}};function Fe(){le.call(this);this.e="parserNRRD"}F(Fe,le);
Fe.prototype.parse=function(a,b,c){var d=0,e=c.match(/^([\s\S]*?)\r?\n\r?\n/),d=e[0].length,f,g,h,j,k,n,e=e[1].split(/\r?\n/);for(k=0,n=e.length;k<n;k++)if(f=e[k],f.match(/NRRD\d+/))this.Jg=p;else if(!f.match(/^#/)&&(j=f.match(/(.*):(.*)/)))g=j[1].trim(),f=j[2].trim(),(h=this.wg[g])?h.call(this,f):this[g]=f;this.Jg||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.ta&&(this.ta=[new K(1,0,
0),new K(0,1,0),new K(0,0,1)],this.Je)){e=[];for(j=0;2>=j;j++)e.push(!isNaN(this.Je[j])?this.ta[j].scale(this.Je[j]):m)}j=0;j="gzip"==this.encoding||"gz"==this.encoding?(new Ee(c.substr(d))).cg()[0][0]:c.substr(d);c=this.Ob[0]*this.Ob[1]*this.Ob[2];d=Array(c);e=-Infinity;k=Infinity;for(n=0;n<c;n++)f=this.zd(j,0+n*this.yd),d[n]=f,e=Math.max(e,f),k=Math.min(k,f);b.$=[this.Ob[0],this.Ob[1],this.Ob[2]];b.M=[(new K(this.ta[0][0],this.ta[0][1],this.ta[0][2])).Mb(),(new K(this.ta[1][0],this.ta[1][1],this.ta[1][2])).Mb(),
(new K(this.ta[2][0],this.ta[2][1],this.ta[2][2])).Mb()];b.Oa=k;b.Ga=e;-Infinity==b.oa&&(b.oa=k);Infinity==b.qa&&(b.qa=e);b.ld();qe(b,d,this.Ob,e);c=new qd;c.da=b;c.q=a;this.dispatchEvent(c)};
Fe.prototype.wg={type:function(a){switch(a){case "unsigned char":case "uint8":this.zd=this.n;this.yd=1;break;case "signed char":case "int8":this.zd=this.gh;this.yd=1;break;case "short":case "signed short":case "unsigned short":case "short int":case "int16":this.zd=this.Ad;this.yd=2;break;case "int":case "int32":break;case "float":this.zd=this.Fc;this.yd=4;break;default:i(Error("Only short/int/int8/float data is allowed. Found "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=
a},dimension:function(a){return parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.Ob=e},"space directions":function(a){var b,c,d;c=a.match(/\(.*?\)/g);return this.ta=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);
var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.Je=e}};A("X.parserNRRD",Fe);A("X.parserNRRD.prototype.parse",Fe.prototype.parse);function Ge(a){x(a)||i(Error("Invalid data."));J.call(this);this.e="parserHelper";this.Re=a;this.Pc=0;this.mg=this.rb=1;this.og=2;this.cf=this.ng=4;this.Cb=q}F(Ge,J);function Y(a,b){x(b)||(b=1);var c=a.Cb(a.Re,a.Pc,b)[0];a.Pc+=a.rb*b;return 1==b?c[0]:c};function He(){le.call(this);this.e="parserMGZ"}F(He,le);
He.prototype.parse=function(a,b,c,d){var e=0,f=e=d?(new Ee(c.substr(0))).cg()[0][0]:c.substr(0),g=e=d=0,h=0,j=0,k=[[0,0,0,0],[0,0,0,0],[0,0,0,0]],c=[],n=[],j=q,l,j={value:0,name:"uchar",size:1,od:this.Qf.bind(this)},o={value:1,name:"int",size:4,od:this.Sf.bind(this)},r={value:3,name:"float",size:4,od:this.Fe.bind(this)},t={value:4,name:"short",size:2,od:this.Rf.bind(this)},n=256,f=new Ge(f),d=this.Sf.bind(this),e=f.ng;f.Cb=d;f.rb=e;Y(f);d=Y(f);e=Y(f);g=Y(f);Y(f);h=Y(f);switch(h){case 0:l=j;break;
case 1:l=o;break;case 3:l=r;break;case 4:l=t}Y(f);j=this.Rf.bind(this);o=f.og;f.Cb=j;f.rb=o;j=Y(f);n-=2;0<j&&(j=this.Fe.bind(this),o=f.cf,f.Cb=j,f.rb=o,n-=60,c[0]=Y(f),c[1]=Y(f),c[2]=Y(f),k[0][0]=Y(f),k[1][0]=Y(f),k[2][0]=Y(f),k[0][1]=Y(f),k[1][1]=Y(f),k[2][1]=Y(f),k[0][2]=Y(f),k[1][2]=Y(f),k[2][2]=Y(f),k[0][3]=Y(f),k[1][3]=Y(f),k[2][3]=Y(f));k=this.Qf.bind(this);j=f.mg;f.Cb=k;f.rb=j;Y(f,n);k=l.size;f.Cb=l.od;f.rb=k;n=Y(f,d*e*g);f.Pc+16<f.Re.length&&(l=this.Fe.bind(this),k=f.cf,f.Cb=l,f.rb=k,Y(f),
Y(f),Y(f),Y(f));l=n;f={Mg:0,Ah:0,tg:0,ih:1,sh:0,min:0,Ng:0,max:0,Kg:0};k=l.length;f.size=k;r=0;r=1;j=0;for(o=k;0<=o;o--)j+=l[o],r*=l[o],f.min>=l[o]&&(f.min=l[o],f.Ng=o),f.max<=l[o]&&(f.max=l[o],f.Kg=o);f.ih=r;f.sh=j;for(r=f.Mg=j/k,o=k,j=0;o--;j+=Math.pow(l[o]-r,2));j=(f.tg=Math.sqrt(f.Ah=j/k),f);d=[d,e,g];b.$=d;b.M=c;c=j.min;e=j.max;b.Oa=c;b.Ga=e;-Infinity==b.oa&&(b.oa=c);Infinity==b.qa&&(b.qa=e);b.ld();qe(b,n,d,e);c=new qd;c.da=b;c.q=a;this.dispatchEvent(c)};A("X.parserMGZ",He);
A("X.parserMGZ.prototype.parse",He.prototype.parse);function Ie(){le.call(this);this.e="parserCRV"}F(Ie,le);
Ie.prototype.parse=function(a,b,c){var d=b.Xc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));var e=0,f=(this.n(c,e)<<16)+(this.n(c,e+1)<<8)+this.n(c,e+2)&16777215,e=e+3;if(16777215!=f)alert("Can't load curvature file, invalid magic number.");else{var f=pe(this,c,e),e=e+4+4+4,g=0,h=0,j=0,k=0,n=0,l=0,o=0,r=0,t=0,w=0,B=0,D=Array(f),C=Array(2),y=Array(2),E;for(E=0;E<f;E++){var H=me(this,c,e),e=e+4;0==E&&(C[0]=y[0]=H);0<=H?(g++,k+=H):(h++,j+=H);t+=H;B++;y[0]=Math.max(H,y[0]);C[0]=Math.min(H,
C[0]);D[E]=H}0!=g&&(n=k/g);0!=h&&(l=j/h);0!=B&&(w=t/B);for(c=t=j=k=0;c<f;c++)H=D[c],e=0,0<=H?(e=Math.pow(H-n,2),k+=e):(e=Math.pow(H-l,2),j+=e),e=Math.pow(H-w,2),t+=e;1<g&&(o=Math.sqrt(k/(g-1)));1<h&&(r=Math.sqrt(j/(h-1)));C[1]=l-2.5*r;y[1]=n+2.5*o;g=d.length;h=[];for(c=0;c<g;c++)j=d[c],j>f&&i(Error("Could not find scalar for vertex.")),j=D[j],h.push(j),h.push(j),h.push(j);b.z.Oa=C[1];b.z.Ga=y[1];-Infinity==b.z.oa&&(b.z.oa=C[1]);Infinity==b.z.qa&&(b.z.qa=y[1]);b.z.u=D;b.z.Tc=h;b.z.c=p;d=new qd;d.da=
b;d.q=a;this.dispatchEvent(d)}};A("X.parserCRV",Ie);A("X.parserCRV.prototype.parse",Ie.prototype.parse);function Je(){le.call(this);this.e="parserLUT"}F(Je,le);Je.prototype.parse=function(a,b,c){var c=c.split("\n"),d=c.length,e;for(e=0;e<d;++e){var f=c[e],f=f.replace(/^\s+|\s+$/g,"");"#"!=f[0]&&(f=f.split(" "),f=f.filter(function(a){return""!=a}),6==f.length&&(f[2]=parseInt(f[2],10)/255,f[3]=parseInt(f[3],10)/255,f[4]=parseInt(f[4],10)/255,f[5]=parseInt(f[5],10)/255,a.add(parseInt(f[0],10),f[1],f[2],f[3],f[4],f[5],10)))}c=new qd;c.da=b;c.q=a;this.dispatchEvent(c)};A("X.parserLUT",Je);
A("X.parserLUT.prototype.parse",Je.prototype.parse);function Ke(){le.call(this);this.e="parserTRK"}F(Ke,le);
Ke.prototype.parse=function(a,b,c){var d=b.j,e=b.l,f=b.va,g=0,h=g+6,j=0,k=Infinity,n;for(n=0;3>n;n++)var l=this.Ad(c,h+2*n),j=Math.max(j,l),k=Math.min(k,l);var o=ne(this,c,g+12,3)[0];ne(this,c,g+24,3);var r=this.Ad(c,g+36),t=this.Ad(c,g+238);ne(this,c,g+440,16);ne(this,c,g+956,6);h=oe(this,c,g+988);g=oe(this,c,g+996);j=[];k=[];n=Infinity;var l=-Infinity,w=q,B=q,D=q,C=q,y=q,E=q,H;for(H=0;H<h;H++){for(var Aa=oe(this,c,g),ea=new P,ha=0,g=g+4,Z=0;Z<Aa;Z++){var oa=this.Fc(c,g),g=g+4,na=this.Fc(c,g),g=
g+4,ga=this.Fc(c,g),g=g+4,N=q;0<r&&(ne(this,c,g,r),g+=4*r);oa/=o[0];na/=o[1];ga/=o[2];ea.add(oa,na,ga);0<Z&&(N=ea.get(Z-1),ha+=Math.sqrt(Math.pow(oa-N[0],2)+Math.pow(na-N[1],2)+Math.pow(ga-N[2],2)))}0<t&&(g+=4*t);Z=ea.zb;Aa=ea.wb;oa=ea.Ab;na=ea.xb;ga=ea.Bb;N=ea.yb;if(!w||Z<w)w=Z;if(!B||Aa>B)B=Aa;if(!D||oa<D)D=oa;if(!C||na>C)C=na;if(!y||ga<y)y=ga;if(!E||N>E)E=N;j.push(ea);k.push(ha)}c=(w+B)/2;g=(D+C)/2;E=(y+E)/2;y=[];for(H=0;H<h;H++){D=j[H];C=D.count;ha=k[H];n=Math.min(n,ha);l=Math.max(l,ha);for(Z=
0;Z<C-1;Z++)r=D.get(Z),o=D.get(Z+1),d.add(r[0],r[1],r[2]),d.add(o[0],o[1],o[2]),t=r[0]-c,w=r[1]-g,B=r[2]-E,ea=Math.sqrt(t*t+w*w+B*B),Aa=o[0]-c,oa=o[1]-g,na=o[2]-E,ga=Math.sqrt(Aa*Aa+oa*oa+na*na),e.add(t/ea,w/ea,B/ea),e.add(Aa/ga,oa/ga,na/ga),o=[Math.abs(o[0]-r[0]),Math.abs(o[1]-r[1]),Math.abs(o[2]-r[2])],r=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]),o[0]/=r,o[1]/=r,o[2]/=r,f.add(o[0],o[1],o[2]),f.add(o[0],o[1],o[2]),y.push(ha),y.push(ha),y.push(ha),y.push(ha),y.push(ha),y.push(ha)}b.ga="LINES";N=new pd;
N.Oa=n;N.Ga=l;N.oa=n;N.qa=l;N.Tc=y;N.bf=s;N.c=p;b.z=N;d=new qd;d.da=b;d.q=a;this.dispatchEvent(d)};A("X.parserTRK",Ke);A("X.parserTRK.prototype.parse",Ke.prototype.parse);function Le(){J.call(this);this.e="loader";this.Uc=new Qb;this.rc=0}F(Le,J);function Me(a,b){a.rc+=b/a.Uc.ha()/3;a.rc=Math.min(1,a.rc);var c=new Md;c.df=a.rc;a.dispatchEvent(c)}function Ne(a){var a=a.r.Xd,b=a.split(".").pop().toUpperCase();b in Oe||i(Error("The "+b+" file format is not supported."));return[a,b,Oe[b][0],Oe[b][1],Oe[b][2]]}
Le.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));var c=Ne(a),d=c[0],c=c[4];if(a.Rc!=q)this.parse(q,a,b);else{var e=new XMLHttpRequest;I(e,"abort",this.qf.bind(this,e,a,b));I(e,"error",this.qf.bind(this,e,a,b));I(e,"load",this.parse.bind(this,e,a,b));e.open("GET",d,p);c&&(e.responseType=c);e.overrideMimeType("text/plain; charset=x-user-defined");e.setRequestHeader("Content-Type","text/plain");e.send(q);this.Uc.set(a.wa,s)}};
Le.prototype.parse=function(a,b,c){Me(this,1);setTimeout(function(){var d=Ne(b),e=d[3],d=new d[2];vc(d,Cc,this.complete.bind(this));var f=b.Rc;f||(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Le.prototype.complete=function(a){Me(this,1);setTimeout(function(){var b=a.q,c=a.da;b.r.c=s;c.P();this.Uc.set(b.wa,p)}.bind(this),100)};Le.prototype.qf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Oe={STL:[Be,q,q],VTK:[Ce,q,q],TRK:[Ke,q,q],FSM:[De,q,q],INFLATED:[De,q,q],SMOOTHWM:[De,q,q],SPHERE:[De,q,q],PIAL:[De,q,q],ORIG:[De,q,q],NRRD:[Fe,q,q],CRV:[Ie,q,q],MGH:[He,s,q],MGZ:[He,p,q],TXT:[Je,q,q],LUT:[Je,q,q],PNG:[re,"png","arraybuffer"],JPG:[re,"jpeg","arraybuffer"],JPEG:[re,"jpeg","arraybuffer"],GIF:[re,"gif","arraybuffer"]};function Pe(a){function b(a,b,d){b=2*b*Math.PI;b=j.ob(Math.cos(b)).ac(k.ob(Math.sin(b)));a=c.ac(e.ob(a)).ac(b.ob(f));d=b.ob(1-Math.abs(d)).ac(g.ob(d));return new Ic(a,d)}this.t=[];for(var a=a||{},c=new Ca(a.start||[0,-1,0]),d=new Ca(a.end||[0,1,0]),e=d.Dc(c),f=a.Ka||1,a=a.Ie||16,g=e.Kc(),h=0.5<Math.abs(g.y()),j=(new Ca(h,!h,0)).je(g).Kc(),k=j.je(g).Kc(),h=new Ic(c,g.xe()),d=new Ic(d,g.Kc()),n=[],l=0;l<a;l++){var o=l/a,r=(l+1)/a;n.push(new Kc([h,b(0,o,-1),b(0,r,-1)]));n.push(new Kc([b(0,r,0),b(0,o,
0),b(1,o,0),b(1,r,0)]));n.push(new Kc([d,b(1,r,1),b(1,o,1)]))}return Nc(n)}F(Pe,Mc);function Qe(){S.call(this);this.e="cylinder";this.be=[-10,-10,-10];this.Jd=[10,10,10];this.Db=10;this.Eb=32;Ea(this,new sd)}F(Qe,S);Qe.prototype.__defineGetter__("start",u("be"));Qe.prototype.__defineSetter__("start",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid start"));this.be=a});Qe.prototype.__defineGetter__("end",u("Jd"));Qe.prototype.__defineSetter__("end",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid end"));this.Jd=a});
Qe.prototype.__defineGetter__("radius",u("Db"));Qe.prototype.__defineSetter__("radius",function(a){z(a)||i(Error("Invalid radius."));this.Db=a});Qe.prototype.P=function(){ud(this,new Pe({start:this.be,end:this.Jd,Ka:this.Db,Ie:this.Eb}));Qe.h.P.call(this)};A("X.cylinder",Qe);A("X.cylinder.prototype.modified",Qe.prototype.P);function Re(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new Ca(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ic(c.ac(e.ob(d)),e))}this.t=[];for(var a=a||{},c=new Ca(a.fe||[0,0,0]),d=a.Ka||1,e=a.Ie||16,a=a.rh||8,f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Kc(g));return Nc(f)}F(Re,Mc);function Se(){S.call(this);this.e="sphere";this.i=[0,0,0];this.Db=5;this.Eb=32;this.pg=16;Ea(this,new sd)}F(Se,S);Se.prototype.__defineGetter__("center",u("i"));Se.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.i=a});Se.prototype.__defineGetter__("radius",u("Db"));Se.prototype.__defineSetter__("radius",function(a){z(a)||i(Error("Invalid radius."));this.Db=a});
Se.prototype.P=function(){ud(this,new Re({fe:this.i,Ka:this.Db,Ie:this.Eb,rh:this.pg}));Se.h.P.call(this)};A("X.sphere",Se);A("X.sphere.prototype.modified",Se.prototype.P);function Ae(a){W.call(this);this.e="labelmap";this.Va=a}F(Ae,W);Ae.prototype.P=function(){var a=new qd;a.da=this;this.dispatchEvent(a);this.Va.P()};A("X.labelmap",Ae);function Te(a){this.t=[];var a=a||{},b=new Ca(a.fe||[0,0,0]),c=!a.Ka?[1,1,1]:a.Ka.length?a.Ka:[a.Ka,a.Ka,a.Ka];return Nc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Kc(a[0].map(function(e){e=new Ca(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Ic(e,new Ca(a[1]))}))}))}F(Te,Mc);function Ue(){S.call(this);this.e="cube";this.i=[0,0,0];this.Pd=this.Od=this.Nd=20;this.Fb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ea(this,new sd)}F(Ue,S);Ue.prototype.__defineGetter__("center",u("i"));Ue.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.i=a});Ue.prototype.__defineGetter__("lengthX",u("Nd"));
Ue.prototype.__defineSetter__("lengthX",function(a){z(a)||i(Error("Invalid lengthX."));this.Nd=a});Ue.prototype.__defineGetter__("lengthY",u("Od"));Ue.prototype.__defineSetter__("lengthY",function(a){z(a)||i(Error("Invalid lengthY."));this.Od=a});Ue.prototype.__defineGetter__("lengthZ",u("Pd"));Ue.prototype.__defineSetter__("lengthZ",function(a){z(a)||i(Error("Invalid lengthZ."));this.Pd=a});Ue.prototype.P=function(){ud(this,new Te({fe:this.i,Ka:[this.Nd/2,this.Od/2,this.Pd/2]}));Ue.h.P.call(this)};
A("X.cube",Ue);A("X.cube.prototype.modified",Ue.prototype.P);function Ve(a){U.call(this,a);this.e="interactor3D"}F(Ve,U);Ve.prototype.Ec=function(a){Ve.h.Ec.call(this,a);var b=new Gd;x(a.Xb)||(a.Xb=0);b.ub=0>a.Xb;b.Za=p;this.dispatchEvent(b)};function We(a){J.call(this);this.e="array";this.u=[];this.Qe=a}F(We,J);We.prototype.add=function(a){this.u.push(a);return p};We.prototype.clear=function(){this.u.length=0};function Xe(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Xe(a,b,d);for(Xe(a,d,c);b<d;++b)if(0<a.Qe(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Qe(f.u[g+1],e);){var j=f,k=g+1,n=j.u[g];j.u[g]=j.u[k];j.u[k]=n;++g}f.u[g]=e}}}We.prototype.sort=function(){Xe(this,0,this.u.length)};function Ye(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Ye.prototype.f=function(){return new Ye(this.top,this.right,this.bottom,this.left)};Ye.prototype.contains=function(a){return!this||!a?s:a instanceof Ye?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Ze(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}Ze.prototype.f=function(){return new Ze(this.left,this.top,this.width,this.height)};Ze.prototype.zf=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,p}return s};
Ze.prototype.contains=function(a){return a instanceof Ze?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};Ze.prototype.ia=function(){return new Zc(this.width,this.height)};function $e(a,b){var c=Wd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function af(a,b){return a.currentStyle?a.currentStyle[b]:q}function bf(a,b){return $e(a,b)||af(a,b)||a.style&&a.style[b]}function cf(a){a=a?9==a.nodeType?a:Wd(a):document;return G&&!pb(9)&&!ge(Ud(a))?a.body:a.documentElement}
function df(a){var b=a.getBoundingClientRect();G&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ef(a){if(G&&!pb(8))return a.offsetParent;for(var b=Wd(a),c=bf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=bf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function ff(a){for(var b=new Ye(0,Infinity,Infinity,0),c=Ud(a),d=c.F.body,e=c.F.documentElement,f=!Ya&&"CSS1Compat"==c.F.compatMode?c.F.documentElement:c.F.body;a=ef(a);)if((!G||0!=a.clientWidth)&&(!Ya||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=bf(a,"overflow")){var g=gf(a),h;h=a;if(Xa&&!nb("1.9")){var j=parseFloat($e(h,"borderLeftWidth"));if(hf(h))var k=h.offsetWidth-h.clientWidth-j-parseFloat($e(h,"borderRightWidth")),j=j+k;h=new Wc(j,parseFloat($e(h,"borderTopWidth")))}else h=new Wc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.F.parentWindow||c.F.defaultView||window;e=c.document;Ya&&!nb("500")&&!$a?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Zc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Zc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function gf(a){var b,c=Wd(a),d=bf(a,"position"),e=Xa&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Wc(0,0),g=cf(c);if(a==g)return f;if(a.getBoundingClientRect)b=df(a),a=he(Ud(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Ya&&"fixed"==bf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Wa||Ya&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ef(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Wa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function jf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function kf(a){if("none"!=bf(a,"display"))return lf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=lf(a);b.display=c;b.position=e;b.visibility=d;return a}function lf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ya&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=df(a),new Zc(a.right-a.left,a.bottom-a.top)):new Zc(b,c)}function mf(a,b){a.style.display=b?"":"none"}function hf(a){return"rtl"==bf(a,"direction")}
function nf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var of={thin:2,medium:4,thick:6};function pf(a,b){if("none"==af(a,b+"Style"))return 0;var c=af(a,b+"Width");return c in of?of[c]:nf(a,c)};function qf(a){this.Ba=a;this.p=[]}F(qf,Yb);var rf=[];function sf(a,b,c,d,e){ja(c)||(rf[0]=c,c=rf);for(var f=0;f<c.length;f++)a.p.push(I(b,c[f],d||a,e||s,a.Ba||a))}qf.prototype.Cd=function(){xb(this.p,yc);this.p.length=0};qf.prototype.D=function(){qf.h.D.call(this);this.Cd()};qf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function tf(){}(function(a){a.rf=function(){return a.Gg||(a.Gg=new a)}})(tf);tf.prototype.ye=0;tf.rf();function uf(a){this.Ia=a||Ud()}F(uf,Hc);v=uf.prototype;v.Eg=tf.rf();v.yf=q;v.Lb=s;v.m=q;v.$b=q;v.jd=q;v.uc=q;v.Bh=s;v.g=u("m");v.He=function(a){this.$b&&this.$b!=a&&i(Error("Method not supported"));uf.h.He.call(this,a)};v.pd=u("Ia");v.Wb=function(){this.m=this.Ia.createElement("div")};v.dc=function(a){this.sa(a)};v.sa=function(a,b){this.Lb&&i(Error("Component already rendered"));this.m||this.Wb();a?a.insertBefore(this.m,b||q):this.Ia.F.body.appendChild(this.m);(!this.$b||this.$b.Lb)&&this.nd()};
v.nd=function(){this.Lb=p;vf(this,function(a){!a.Lb&&a.g()&&a.nd()})};v.xc=function(){vf(this,function(a){a.Lb&&a.xc()});this.td&&this.td.Cd();this.Lb=s};v.D=function(){uf.h.D.call(this);this.Lb&&this.xc();this.td&&(this.td.Aa(),delete this.td);vf(this,function(a){a.Aa()});!this.Bh&&this.m&&de(this.m);this.$b=this.m=this.uc=this.jd=q};function vf(a,b){a.jd&&xb(a.jd,b,m)}
v.removeChild=function(a,b){if(a){var c=la(a)?a:a.yf||(a.yf=":"+(a.Eg.ye++).toString(36)),a=this.uc&&c?(c in this.uc?this.uc[c]:m)||q:q;if(c&&a){var d=this.uc;c in d&&delete d[c];Fb(this.jd,a);b&&(a.xc(),a.m&&de(a.m));c=a;c==q&&i(Error("Unable to set parent component"));c.$b=q;uf.h.He.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function wf(){}F(wf,Hc);v=wf.prototype;v.Ne=0;v.Cc=0;v.we=100;v.pf=0;v.Ke=1;v.Ig=s;v.Og=s;v.Fd=function(a){a=xf(this,a);this.Ne!=a&&(this.Ne=a+this.pf>this.we?this.we-this.pf:a<this.Cc?this.Cc:a,!this.Ig&&!this.Og&&this.dispatchEvent("change"))};v.sd=function(){return xf(this,this.Ne)};v.rd=function(){return xf(this,this.Cc)};v.qd=function(){return xf(this,this.we)};function xf(a,b){return a.Ke==q?b:a.Cc+Math.round((b-a.Cc)/a.Ke)*a.Ke};function yf(a){this.Ia=a||Ud();this.bc=new wf;I(this.bc,"change",this.Bg,s,this)}F(yf,uf);var zf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};v=yf.prototype;v.Wb=function(){this.Ea=this.pd().Wb("div","progress-bar-thumb");var a=zf[this.Nf];this.m=this.pd().Wb("div",a,this.Ea);Af(this);this.g().setAttribute("aria-valuemin",this.rd());this.g().setAttribute("aria-valuemax",this.qd())};
v.nd=function(){yf.h.nd.call(this);G&&7>db&&I(this.g(),"resize",this.Hd,s,this);this.Hd();var a=this.g();a.setAttribute("role","progressbar");a.ni="progressbar";this.g().setAttribute("aria-live","polite")};v.xc=function(){yf.h.xc.call(this);Bf(this)};function Bf(a){G&&7>db&&wc(a.g(),"resize",a.Hd,s,a)}v.sd=function(){return this.bc.sd()};v.Fd=function(a){this.bc.Fd(a);this.g()&&Af(this)};function Af(a){var b=a.sd();a.g().setAttribute("aria-valuenow",b)}v.rd=function(){return this.bc.rd()};v.qd=function(){return this.bc.qd()};
v.Nf="horizontal";v.Bg=function(){this.Hd();this.dispatchEvent("change")};v.Hd=function(){if(this.Ea){var a=this.rd(),b=this.qd(),a=(this.sd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Nf?G&&7>db?(this.Ea.style.top=0,this.Ea.style.height="100%",b=this.Ea.offsetHeight,a=Math.round(a*b),this.Ea.style.top=b-a+"px",this.Ea.style.height=a+"px"):(this.Ea.style.top=100-b+"%",this.Ea.style.height=b+"%"):this.Ea.style.width=b+"%"}};v.D=function(){Bf(this);yf.h.D.call(this);this.Ea=q;this.bc.Aa()};function Cf(a,b){x(a)||i(Error("No valid parent element."));x(b)||i(Error("Invalid initial value."));yf.call(this);this.e="progressbar";this.pa=a;this.Qc=this.Ua=q;this.qb=[];this.qb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.Fd(b);this.re()}F(Cf,yf);
Cf.prototype.re=function(){if("static"==this.pa.style.position||""==this.pa.style.position)this.pa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=$d("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.qb[0]),d=document.createTextNode(this.qb[1]),e=document.createTextNode(this.qb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Ua=b;this.dc(this.pa);a=this.g();a.style.position="absolute";a.style.top=(this.pa.clientHeight-
5)/2;a.style.left=(this.pa.clientWidth-100)/2};function Df(a){var b=a.g().style.top,c=a.g().style.left;de(a.g());var d=new Cf(a.pa,100),e=d.g();e.style.position="absolute";e.style.top=b;e.style.left=c;(e.firstElementChild!=m?e.firstElementChild:ee(e.firstChild)).classList.add("progress-bar-thumb-done");a.Qc=d}Cf.prototype.ue=function(){this.Ua&&de(this.Ua);this.g()&&de(this.g());this.Qc&&de(this.Qc.g());this.Qc=this.Ua=q};var Ef=ca.window;function Ff(a,b,c){ma(a)?c&&(a=wa(a,c)):a&&"function"==typeof a.handleEvent?a=wa(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Ef.setTimeout(a,b||0)};function Gf(){J.call(this);this.e="renderer";this.q=window.document.body;this.S=this.q.clientWidth;this.K=this.q.clientHeight;this.vb=this.o=this.ua=q;this.Pa=new We(rd);this.lb=[];this.R=q;this.Qd=this.Vc=s;this.a=this.Ha=q;this.config={PROGRESSBAR_ENABLED:p};window.console.log("XTK Release 4 -- 04/12/12 -- http://www.goXTK.com")}F(Gf,J);Gf.prototype.ah=function(a){this.Ha&&this.Ha.Fd(100*a.df)};Gf.prototype.Rg=function(a){x(a)&&a instanceof qd&&this.La(a.da)};
Gf.prototype.Ce=function(a){(!x(a)||!(a instanceof Jd))&&i(Error("Invalid hover event."))};Gf.prototype.De=function(a){(!x(a)||!(a instanceof Hd))&&i(Error("Invalid scroll event."))};Gf.prototype.__defineGetter__("interactor",u("vb"));Gf.prototype.__defineGetter__("camera",u("o"));Gf.prototype.__defineGetter__("loadingCompleted",u("Qd"));Gf.prototype.__defineGetter__("container",u("q"));
Gf.prototype.__defineSetter__("container",function(a){x(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;la(b)&&(b=Xd(a));pa(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.q=b});v=Gf.prototype;v.Gc=function(){this.o.reset();this.sa(s,s)};function Hf(a){a.config.PROGRESSBAR_ENABLED&&a.Ha&&!a.Pe&&(Df(a.Ha),a.Pe=Ff(function(){this.Pe=q;this.Ha&&(this.Ha.ue(),this.Ha=q);this.dc()}.bind(a),700))}
v.Z=function(a){var b=$d("canvas");this.q.appendChild(b);this.S=this.q.clientWidth;this.K=this.q.clientHeight;b.width=this.S;b.height=this.K;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.q.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.R=new Le;I(this.R,Bd,this.ah.bind(this));this.ua=b;this.a=c;b=new Ve(this.ua);"2d"==a&&(b=new je(this.ua));b.Z();I(b,Ad,this.Gc.bind(this));I(b,Cd,this.Ce.bind(this));I(b,yd,this.De.bind(this));this.vb=b;b=new ke(this.S,this.K);"2d"==a&&(b=new se(this.S,this.K));b.ze(this.vb);I(b,zd,this.sa.bind(this,s,s));this.o=b};v.add=function(a){(a instanceof Ue||a instanceof Se||a instanceof Qe)&&a.P();this.lb.push(a);this.La(a)};
v.La=function(a){(!this.ua||!this.a)&&i(Error("The renderer was not initialized properly."));x(a)||(window.console.log(a),i(Error("Illegal object.")));Bc(a)||I(a,Cc,this.Rg.bind(this))};v.get=function(a){x(a)||i(Error("Invalid object id."));for(var b=this.Pa.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].wa==a)return b[d];return q};
v.dc=function(){(!this.ua||!this.a)&&i(Error("The renderer was not initialized properly."));x(this.af)||(this.R.Uc.he(s)?(this.config.PROGRESSBAR_ENABLED&&!this.Ha&&(this.Ha=new Cf(this.q,3)),this.af=Ff(function(){this.af=q;this.dc()}.bind(this),100)):(this.Qd||(eval("this.onShowtime()"),this.Qd=p),this.Ha?Hf(this):this.sa(s,p)))};v.Mf=aa();v.sa=aa();
v.md=function(){this.Pa.clear();delete this.Pa;this.lb.length=0;delete this.lb;delete this.R;this.R=q;delete this.o;this.o=q;delete this.vb;this.vb=q;delete this.a;this.a=q;de(this.ua);delete this.ua;this.ua=q};function If(a,b,c,d,e,f,g,h){var j,k=c.offsetParent;if(k){var n="HTML"==k.tagName||"BODY"==k.tagName;if(!n||"static"!=bf(k,"position"))j=gf(k),n||(j=Xc(j,new Wc(k.scrollLeft,k.scrollTop)))}k=gf(a);n=kf(a);k=new Ze(k.x,k.y,n.width,n.height);(n=ff(a))&&k.zf(new Ze(n.left,n.top,n.right-n.left,n.bottom-n.top));var n=Ud(a),l=Ud(c);if(n.F!=l.F){var o=n.F.body,l=l.F.parentWindow||l.F.defaultView,r=new Wc(0,0),t=Wd(o)?Wd(o).parentWindow||Wd(o).defaultView:window,w=o;do{var B;if(t==l)B=gf(w);else{var D=w;
B=new Wc;if(1==D.nodeType)if(D.getBoundingClientRect)D=df(D),B.x=D.left,B.y=D.top;else{var C=he(Ud(D)),D=gf(D);B.x=D.x-C.x;B.y=D.y-C.y}else{var C=ma(D.Ag),y=D;D.targetTouches?y=D.targetTouches[0]:C&&D.Ja.targetTouches&&(y=D.Ja.targetTouches[0]);B.x=y.clientX;B.y=y.clientY}}r.x+=B.x;r.y+=B.y}while(t&&t!=l&&(w=t.frameElement)&&(t=t.parent));o=Xc(r,gf(o));G&&!ge(n)&&(o=Xc(o,he(n)));k.left+=o.x;k.top+=o.y}a=(b&4&&hf(a)?b^2:b)&-5;b=new Wc(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);j&&(b=Xc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var E;if(g&&(E=ff(c))&&j)E.top-=j.y,E.right-=j.x,E.bottom-=j.y,E.left-=j.x;return Jf(b,c,d,f,E,g,h)}
function Jf(a,b,c,d,e,f,g){var a=a.f(),h=0,j=(c&4&&hf(b)?c^2:c)&-5,c=kf(b),g=g?g.f():c.f();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Xa&&(Qa||cb)&&nb("1.9");f instanceof Wc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=jf(a,e);b.style.top=jf(f,e);$c(c,g)||(a=ge(Ud(Wd(b))),
G&&(!a||!nb("8"))?(c=b.style,a?(G?(a=nf(b,af(b,"paddingLeft")),e=nf(b,af(b,"paddingRight")),f=nf(b,af(b,"paddingTop")),d=nf(b,af(b,"paddingBottom")),a=new Ye(f,e,d,a)):(a=$e(b,"paddingLeft"),e=$e(b,"paddingRight"),f=$e(b,"paddingTop"),d=$e(b,"paddingBottom"),a=new Ye(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),G?(e=pf(b,"borderLeft"),f=pf(b,"borderRight"),d=pf(b,"borderTop"),b=pf(b,"borderBottom"),b=new Ye(d,f,b,e)):(e=$e(b,"borderLeftWidth"),f=$e(b,"borderRightWidth"),d=$e(b,"borderTopWidth"),
b=$e(b,"borderBottomWidth"),b=new Ye(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Xa?b.MozBoxSizing="border-box":Ya?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Kf(){}Kf.prototype.Da=aa();function Lf(a,b){this.element=a;this.jf=b}F(Lf,Kf);Lf.prototype.Da=function(a,b,c){If(this.element,this.jf,a,b,m,c)};function Mf(a,b){this.Ba=new qf(this);this.Ge(a||q);b&&(this.ec=b)}F(Mf,Hc);v=Mf.prototype;v.m=q;v.qg=p;v.ef=q;v.ca=s;v.qh=s;v.ve=-1;v.Dg=s;v.vg=p;v.ec="toggle_display";v.g=u("m");v.Ge=function(a){this.ca&&i(Error("Can not change this state of the popup while showing."));this.m=a};
function Nf(a,b){a.Ic&&a.Ic.stop();a.Ac&&a.Ac.stop();if(b){if(!a.ca&&a.Ae()){a.m||i(Error("Caller must call setElement before trying to show the popup"));a.Da();var c=Wd(a.m);a.Dg&&sf(a.Ba,c,"keydown",a.Pg,p);if(a.qg)if(sf(a.Ba,c,"mousedown",a.Jf,p),G){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}sf(a.Ba,c,"mousedown",a.Jf,p);sf(a.Ba,c,"deactivate",a.If)}else sf(a.Ba,c,"blur",a.If);"toggle_display"==
a.ec?(a.m.style.visibility="visible",mf(a.m,p)):"move_offscreen"==a.ec&&a.Da();a.ca=p;a.Ic?(vc(a.Ic,"end",a.Lf,s,a),a.Ic.play()):a.Lf()}}else Of(a)}v.Da=da;function Of(a,b){if(!a.ca||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.Ba&&a.Ba.Cd();a.Ac?(vc(a.Ac,"end",xa(a.hf,b),s,a),a.Ac.play()):a.hf(b);return p}v.hf=function(a){"toggle_display"==this.ec?this.qh?Ff(this.xf,0,this):this.xf():"move_offscreen"==this.ec&&(this.m.style.left="-200px",this.m.style.top="-200px");this.ca=s;this.Be(a)};
v.xf=function(){this.m.style.visibility="hidden";mf(this.m,s)};v.Ae=function(){return this.dispatchEvent("beforeshow")};v.Lf=function(){this.ve=Ba();this.dispatchEvent("show")};v.Be=function(a){Ba();this.dispatchEvent({type:"hide",target:a})};v.Jf=function(a){a=a.target;!fe(this.m,a)&&(!this.ef||fe(this.ef,a))&&!(150>Ba()-this.ve)&&Of(this,a)};v.Pg=function(a){27==a.keyCode&&Of(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
v.If=function(a){if(this.vg){var b=Wd(this.m);if(G||Wa){if(a=b.activeElement,!a||fe(this.m,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>Ba()-this.ve||Of(this)}};v.D=function(){Mf.h.D.call(this);this.Ba.Aa();$b(this.Ic);$b(this.Ac);delete this.m;delete this.Ba};function Pf(a,b){this.ie=a instanceof Wc?a:new Wc(a,b)}F(Pf,Kf);Pf.prototype.Da=function(a,b,c,d){If(cf(a),0,a,b,this.ie,c,q,d)};function Qf(a,b){this.hh=4;this.Bd=b||m;Mf.call(this,a)}F(Qf,Mf);Qf.prototype.Da=function(){if(this.Bd){var a=!this.ca&&"move_offscreen"!=this.ec,b=this.g();a&&(b.style.visibility="hidden",mf(b,p));this.Bd.Da(b,this.hh,this.li);a&&mf(b,s)}};function Rf(a,b,c){this.Ia=c||(a?Ud(Xd(a)):Ud());Qf.call(this,this.Ia.Wb("div",{style:"position:absolute;display:none;"}));this.ke=new Wc(1,1);this.Ib=new Ub;a&&Sf(this,a);if(b!=q)if(a=this.g(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Wd(a).createTextNode(b))}}F(Rf,Qf);var Tf=[];v=Rf.prototype;v.ba=q;v.className="goog-tooltip";
v.Vf=500;v.Cg=0;v.pd=u("Ia");function Sf(a,b){b=Xd(b);a.Ib.add(b);I(b,"mouseover",a.uf,s,a);I(b,"mouseout",a.ud,s,a);I(b,"mousemove",a.tf,s,a);I(b,"focus",a.sf,s,a);I(b,"blur",a.ud,s,a)}v.detach=function(a){if(a)a=Xd(a),Uf(this,a),this.Ib.remove(a);else{for(var b=this.Ib.Kb(),c=0;a=b[c];c++)Uf(this,a);this.Ib.clear()}};function Uf(a,b){wc(b,"mouseover",a.uf,s,a);wc(b,"mouseout",a.ud,s,a);wc(b,"mousemove",a.tf,s,a);wc(b,"focus",a.sf,s,a);wc(b,"blur",a.ud,s,a)}
v.Ge=function(a){var b=this.g();b&&de(b);Rf.h.Ge.call(this,a);a&&(b=this.Ia.F.body,b.insertBefore(a,b.lastChild))};v.Ae=function(){if(!Mf.prototype.Ae.call(this))return s;if(this.anchor)for(var a,b=0;a=Tf[b];b++)fe(a.g(),this.anchor)||Nf(a,s);0<=wb(Tf,this)||Tf.push(this);a=this.g();a.className=this.className;Vf(this);I(a,"mouseover",this.wf,s,this);I(a,"mouseout",this.vf,s,this);Wf(this);return p};
v.Be=function(){Fb(Tf,this);for(var a=this.g(),b,c=0;b=Tf[c];c++)b.anchor&&fe(a,b.anchor)&&Nf(b,s);this.Pf&&Xf(this.Pf);wc(a,"mouseover",this.wf,s,this);wc(a,"mouseout",this.vf,s,this);this.anchor=m;if(0==(this.Wa?this.ca?4:1:this.Zb?3:this.ca?2:0))this.Dd=s;Mf.prototype.Be.call(this)};v.Gf=function(a,b){this.anchor==a&&this.Ib.contains(this.anchor)&&(this.Dd||!this.mi?(Nf(this,s),this.ca||(this.anchor=a,this.Bd=b||Yf(this,0)||m,this.ca&&this.Da(),Nf(this,p))):this.anchor=m);this.Wa=m};
v.Lg=function(a){this.Zb=m;a==this.anchor&&(this.ba==q||this.ba!=this.g()&&!this.Ib.contains(this.ba))&&(!this.ff||!this.ff.ba)&&Nf(this,s)};function Zf(a,b){var c=he(a.Ia);a.ke.x=b.clientX+c.x;a.ke.y=b.clientY+c.y}v.uf=function(a){var b=$f(this,a.target);this.ba=b;Vf(this);b!=this.anchor&&(this.anchor=b,this.Wa||(this.Wa=Ff(wa(this.Gf,this,b,m),this.Vf)),ag(this),Zf(this,a))};function $f(a,b){try{for(;b&&!a.Ib.contains(b);)b=b.parentNode;return b}catch(c){return q}}
v.tf=function(a){Zf(this,a);this.Dd=p};v.sf=function(a){this.ba=a=$f(this,a.target);this.Dd=p;if(this.anchor!=a){this.anchor=a;var b=Yf(this,1);Vf(this);this.Wa||(this.Wa=Ff(wa(this.Gf,this,a,b),this.Vf));ag(this)}};function Yf(a,b){if(0==b){var c=a.ke.f();return new bg(c)}return new cg(a.ba)}function ag(a){if(a.anchor)for(var b,c=0;b=Tf[c];c++)fe(b.g(),a.anchor)&&(b.ff=a,a.Pf=b)}
v.ud=function(a){var b=$f(this,a.target),c=$f(this,a.relatedTarget);b!=c&&(b==this.ba&&(this.ba=q),Wf(this),this.Dd=s,this.ca&&(!a.relatedTarget||!fe(this.g(),a.relatedTarget))?Xf(this):this.anchor=m)};v.wf=function(){var a=this.g();this.ba!=a&&(Vf(this),this.ba=a)};v.vf=function(a){var b=this.g();if(this.ba==b&&(!a.relatedTarget||!fe(b,a.relatedTarget)))this.ba=q,Xf(this)};function Wf(a){a.Wa&&(Ef.clearTimeout(a.Wa),a.Wa=m)}
function Xf(a){if(2==(a.Wa?a.ca?4:1:a.Zb?3:a.ca?2:0))a.Zb=Ff(wa(a.Lg,a,a.anchor),a.Cg)}function Vf(a){a.Zb&&(Ef.clearTimeout(a.Zb),a.Zb=m)}v.D=function(){Nf(this,s);Wf(this);this.detach();this.g()&&de(this.g());this.ba=q;delete this.Ia;Rf.h.D.call(this)};function bg(a,b){Pf.call(this,a,b)}F(bg,Pf);bg.prototype.Da=function(a,b,c){b=cf(a);b=ff(b);c=c?new Ye(c.top+10,c.right,c.bottom,c.left+10):new Ye(10,0,0,10);Jf(this.ie,a,4,c,b,9)&496&&Jf(this.ie,a,4,c,b,5)};function cg(a){Lf.call(this,a,3)}
F(cg,Lf);cg.prototype.Da=function(a,b,c){var d=new Wc(10,0);If(this.element,this.jf,a,b,d,c,9)&496&&If(this.element,2,a,1,d,c,5)};function dg(a,b,c,d){x(a)||i(Error("No valid parent element."));(!z(b)||!z(c))&&i(Error("Invalid coordinates."));(!x(d)||!(d instanceof U))&&i(Error("Invalid interactor."));Rf.call(this);this.e="caption";this.pa=a;this.ed=b;this.fd=c;this.vb=d;this.Ua=q;this.qb=[];this.qb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];vc(d,Dd,this.ue.bind(this));this.re()}F(dg,Rf);
dg.prototype.re=function(){if("static"==this.pa.style.position||""==this.pa.style.position)this.pa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=$d("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.qb[0]);a.appendChild(b);b.appendChild(c);this.Ua=b;this.Bd=new Pf(this.ed,this.fd)||m;this.ca&&this.Da();Nf(this,p);Sf(this,this.pa);this.g().classList.add("x-tooltip")};
dg.prototype.ue=function(){Nf(this,s);this.Ua&&de(this.Ua);this.g()&&de(this.g());this.Ua=q};function eg(){Gf.call(this);this.e="renderer3D";this.mc=this.pc=this.lc=this.oc=this.kc=this.nc=this.Yd=this.Zd=q;this.i=[0,0,0];this.$e=q;this.Id=new Qb;this.sc=new Qb;this.tc=new Qb;this.Vd=new Qb;this.Oc=new Qb;this.$c=new Qb;this.ad=new Qb;this.bd=new Qb;this.config={PROGRESSBAR_ENABLED:p,PICKING_ENABLED:p,ORDERING_ENABLED:p,STATISTICS_ENABLED:s}}F(eg,Gf);v=eg.prototype;v.jh=function(){this.mc=this.pc=this.lc=this.oc=this.kc=this.nc=q;this.i=[0,0,0]};
v.Ce=function(a){eg.h.Ce.call(this,a);var b=a.ed,a=a.fd,c=this.get(this.Tf(b,a));if(c&&(c=c.Qb))(new dg(this.q,this.q.offsetLeft+b+10,this.q.offsetTop+a+10,this.vb)).g().innerHTML=c};
v.Z=function(){eg.h.Z.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.S,this.K),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.config.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.S,this.K,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.S,this.K);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.$e=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}fg(this)};
function fg(a){var b=new te;(!x(a.ua)||!x(a.a)||!x(a.o))&&i(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof te))&&i(Error("Could not add shaders."));we(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.Sc);a.a.shaderSource(d,b.cd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.Yd=e;Object.keys(ue).forEach(function(a){a=ue[a];this.Id.set(a,this.a.getAttribLocation(this.Yd,a));this.a.enableVertexAttribArray(this.Id.get(a))}.bind(a));
Object.keys(ve).forEach(function(a){a=ve[a];this.sc.set(a,this.a.getUniformLocation(this.Yd,a))}.bind(a));a.Zd=b}
v.La=function(a){eg.h.La.call(this,a);var b=s;this.get(a.wa)&&(b=p);var c=a.wa,d=a.j,e=a.l,f=a.va,g=a.Y,h=a.r,j=a.Gb,k=a.Q,n=a.v,l=a.z;if(x(n)&&x(n.r)&&n.r.c)this.La(n);else if(x(n)&&n.c&&this.La(n),x(k)&&x(k.r)&&k.r.c)this.R.load(k,a);else if(x(g)&&x(g.r)&&g.r.c)this.R.load(g,a);else if(x(h)&&h.c)this.R.load(a,a);else if(x(l)&&x(l.r)&&l.r.c)this.R.load(l,a);else{if(0<a.d.length){h=a.d;k=h.length;for(n=n=0;n<k;n++)this.La(h[n])}if(0==d.count)a.c=s;else{for(h=0;this.Vc;)h++,window.console.log("Possible thread lock avoided: "+
h);this.Vc=p;k=a instanceof ye&&a.Va instanceof Ae;b&&x(g)&&g.c&&(h=this.ad.get(c),x(h)&&this.a.isBuffer(h.X)&&this.a.deleteBuffer(h.X));h=q;x(g)&&(!b||g.c?(h=a.Fb,x(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),n=s,g.jb&&(n=p),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,n),n=this.a.createTexture(),n.Fg=g.Te,this.bd.set(g.wa,n),this.a.bindTexture(this.a.TEXTURE_2D,n),g.jb?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Zc,g.Yc,
0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.jb):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,n.Fg),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,
this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),n=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,n),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new xe(n,h.length,2),g.c=s):h=this.ad.get(c));Me(this.R,0.1);if(k)this.Vc=s,Me(this.R,0.9);else{if(!b||d.c||j.c){k=j.k;g=k.Ca(new K(d.zb,d.Ab,d.Bb));k=k.Ca(new K(d.wb,d.xb,d.yb));if(this.nc===q||
g.x<this.nc)this.nc=g.x;if(this.kc===q||k.x>this.kc)this.kc=k.x;if(this.oc===q||g.y<this.oc)this.oc=g.y;if(this.lc===q||k.y>this.lc)this.lc=k.y;if(this.pc===q||g.b<this.pc)this.pc=g.b;if(this.mc===q||k.b>this.mc)this.mc=k.b;this.i=[(this.nc+this.kc)/2,(this.oc+this.lc)/2,(this.pc+this.mc)/2];j.c=s}b&&d.c&&(j=this.tc.get(c),x(j)&&this.a.isBuffer(j.X)&&this.a.deleteBuffer(j.X));j=q;!b||d.c?(j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.U),
this.a.STATIC_DRAW),j=new xe(j,d.count,3),d.c=s):j=this.tc.get(c);Me(this.R,0.3);b&&e.c&&(g=this.tc.get(c),x(g)&&this.a.isBuffer(g.X)&&this.a.deleteBuffer(g.X));g=q;!b||e.c?(g=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(e.U),this.a.STATIC_DRAW),g=new xe(g,e.count,3),e.c=s):g=this.Vd.get(c);Me(this.R,0.3);b&&f.c&&(e=this.Oc.get(c),x(e)&&this.a.isBuffer(e.X)&&this.a.deleteBuffer(e.X));e=q;0<f.length&&(!b||f.c?(f.length!=d.length&&
i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f.U),this.a.STATIC_DRAW),e=new xe(e,f.count,3),f.c=s):e=this.Oc.get(c));Me(this.R,0.2);b&&l&&l.c&&(f=this.$c.get(c),x(f)&&this.a.isBuffer(f.X)&&this.a.deleteBuffer(f.X));f=q;l&&(f=l.Tc,!b||l.c?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),
this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f),this.a.STATIC_DRAW),f=new xe(d,f.length,3),l.c=s):f=this.$c.get(c));Me(this.R,0.1);b||this.Pa.add(a);this.tc.set(c,j);this.Vd.set(c,g);this.Oc.set(c,e);this.ad.set(c,h);this.$c.set(c,f);this.Vc=a.c=s}}}};function gg(a,b){var c=b.j.Nc,c=a.o.view.Ca(b.Gb.k.Ca(new K(c[0],c[1],c[2]))),c=Tc(a.o.fa,c);return Math.round(1E3*c)/1E3}
v.Tf=function(a,b){if(this.config.PICKING_ENABLED){this.sa(p,s);var c=new Uint8Array(4);this.a.readPixels(a,this.K-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
v.sa=function(a,b){eg.h.sa.call(this,a,b);var c=this.Pa.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.$e):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.S,this.K);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.o.lg,f=this.o.tb;this.a.uniformMatrix4fv(this.sc.get("up"),s,e);this.a.uniformMatrix4fv(this.sc.get("uv"),s,f);e=this.i;this.a.uniform3f(this.sc.get("uc"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));f=this.lb.length;
for(e=0;e<f;++e){var g=this.lb[e];if(g instanceof W){var h=new K(1,0,0),h=this.o.s.Ca(h),j=Tc(this.o.fa,h),h=new K(-1,0,0),h=this.o.s.Ca(h),k=Tc(this.o.fa,h),h=new K(0,1,0),h=this.o.s.Ca(h),n=Tc(this.o.fa,h),h=new K(0,-1,0),h=this.o.s.Ca(h),l=Tc(this.o.fa,h),h=new K(0,0,1),h=this.o.s.Ca(h),o=Tc(this.o.fa,h),h=new K(0,0,-1),h=this.o.s.Ca(h),h=Tc(this.o.fa,h),r=Math.max(j,n,o,k,l,h);r==j||r==k?ze(g,0):r==n||r==l?ze(g,1):(r==o||r==h)&&ze(g,2)}}if(this.config.ORDERING_ENABLED){j=s;f=this.lb;g=f.length-
1;do if(e=f[g],e instanceof W&&e.ya){k=e.mb;j=e.Ra.d;1==k?j=e.Sa.d:2==k&&(j=e.Ta.d);k=j.length;n=j[0];n.J=gg(this,n);n.L=e.L;l=j[k-1];l.J=gg(this,l);l.L=e.L;l=Math.round(1E3*((l.J-n.J)/k))/1E3;for(o=o=1;o<k-1;o++)h=Math.round(1E3*(n.J+o*l))/1E3,j[o].J=h,j[o].L=e.L;j=p}while(g--);f=this.Pa.u;g=f.length-1;do if(e=f[g],e.xa&&!(1==e.L||e instanceof ye))e.J=gg(this,e),j=p;while(g--);j&&this.Pa.sort()}if(f=!a&&x(b)&&b&&this.config.STATISTICS_ENABLED)var t=0,w=0,B=0,D=0;var e=this.Id,g=e.get("vp"),j=e.get("vn"),
k=e.get("vc"),n=e.get("vtp"),l=e.get("vs"),e=this.sc,o=e.get("uup"),h=e.get("uuoc"),r=e.get("uoc"),C=e.get("uus"),y=e.get("usrm"),E=e.get("usmin"),H=e.get("usmax"),Aa=e.get("usminc"),ea=e.get("usmaxc"),ha=e.get("usmint"),Z=e.get("usmaxt"),oa=e.get("uoo"),na=e.get("ulmo"),ga=e.get("uut"),N=e.get("uutt"),Xb=e.get("uulmt"),ad=e.get("uts"),kb=e.get("uts2"),bd=e.get("uvlt"),Db=e.get("uvut"),fb=e.get("uvsmin"),Bb=e.get("uvsmax"),xc=e.get("uot"),za=e.get("ups"),e=d;do{var L=c[d-e];if(L){var R=q;L instanceof
ye&&L.Va&&(R=L.Va);if(L.xa&&(!R||R.xa)){var ra=L.wa,Ab=L.jc,ya=this.tc.get(ra),Za=this.Vd.get(ra),Pd=this.Oc.get(ra),Cb=this.$c.get(ra),Qd=this.ad.get(ra);this.a.bindBuffer(this.a.ARRAY_BUFFER,ya.X);this.a.vertexAttribPointer(g,ya.fb,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,Za.X);this.a.vertexAttribPointer(j,Za.fb,this.a.FLOAT,s,0,0);a?this.a.uniform1i(o,p):this.a.uniform1i(o,s);Pd&&!a&&!Ab?(this.a.uniform1i(h,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,Pd.X),this.a.vertexAttribPointer(k,
Pd.fb,this.a.FLOAT,s,0,0)):(Za=1,Ab&&!a&&(Za=0),this.a.uniform1i(h,Za),Za=L.pb,a&&(Za=[Math.floor(ra%65025%255)/255,Math.floor(ra%65025/255)/255,Math.floor(ra/65025)/255]),this.a.uniform3f(r,parseFloat(Za[0]),parseFloat(Za[1]),parseFloat(Za[2])),this.a.vertexAttribPointer(k,ya.fb,this.a.FLOAT,s,0,0));Cb&&!a&&!Ab?(this.a.uniform1i(C,p),this.a.uniform1i(y,L.z.bf),ra=L.z.Sd,Ab=L.z.Rd,this.a.uniform3f(Aa,parseFloat(ra[0]),parseFloat(ra[1]),parseFloat(ra[2])),this.a.uniform3f(ea,parseFloat(Ab[0]),parseFloat(Ab[1]),
parseFloat(Ab[2])),this.a.uniform1f(ha,parseFloat(L.z.oa)),this.a.uniform1f(Z,parseFloat(L.z.qa)),this.a.uniform1f(E,parseFloat(L.z.Oa)),this.a.uniform1f(H,parseFloat(L.z.Ga)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Cb.X),this.a.vertexAttribPointer(l,Cb.fb,this.a.FLOAT,s,0,0)):(this.a.uniform1i(C,s),this.a.vertexAttribPointer(l,ya.fb,this.a.FLOAT,s,0,0));this.a.uniform1f(oa,parseFloat(L.L));L.Y&&Qd&&!a?(this.a.uniform1i(ga,p),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.bd.get(L.Y.wa)),this.a.uniform1i(ad,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Qd.X),this.a.vertexAttribPointer(n,Qd.fb,this.a.FLOAT,s,0,0),this.a.uniform1i(N,s)):(this.a.uniform1i(ga,s),this.a.vertexAttribPointer(n,ya.fb,this.a.FLOAT,s,0,0));R&&(this.a.uniform1i(N,p),this.a.uniform1f(bd,R.oa),this.a.uniform1f(Db,R.qa),this.a.uniform1f(fb,R.Oa),this.a.uniform1f(Bb,R.Ga),Cb=R.v,this.a.uniform1i(Xb,s),R.ya?this.a.uniform1f(oa,parseFloat(R.L)):Cb&&Cb.xa&&(R=L.v.wa,this.a.uniform1i(Xb,p),this.a.activeTexture(this.a.TEXTURE1),
this.a.bindTexture(this.a.TEXTURE_2D,this.bd.get(R)),this.a.uniform1i(kb,1),this.a.uniform1f(na,Cb.L)));this.a.uniformMatrix4fv(xc,s,L.Gb.Ma);R=1;"POINTS"==L.ga&&(R=L.qc);this.a.uniform1f(za,R);R=-1;L.ga==nd?(R=this.a.TRIANGLES,f&&(w+=ya.eb/3)):"LINES"==L.ga?(this.a.lineWidth(L.Ub),R=this.a.LINES,f&&(B+=ya.eb/2)):"POINTS"==L.ga?(R=this.a.POINTS,f&&(D+=ya.eb)):"TRIANGLE_STRIPS"==L.ga?(R=this.a.TRIANGLE_STRIP,f&&(w+=ya.eb/3)):"POLYGONS"==L.ga&&(R=0==ya.eb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(w+=
ya.eb/3));f&&(t+=ya.eb);this.a.drawArrays(R,0,ya.eb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+t+" | ")+("Triangles: "+Math.round(w)+" | "),c=c+("Lines: "+B+" | ")+("Points: "+D+" | ")+("Textures: "+this.bd.ha()),window.console.log(c))}};v.md=function(){this.Zd=q;delete this.Zd;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);eg.h.md.call(this)};A("X.renderer3D",eg);A("X.renderer3D.prototype.init",eg.prototype.Z);A("X.renderer3D.prototype.add",eg.prototype.add);
A("X.renderer3D.prototype.onShowtime",eg.prototype.Mf);A("X.renderer3D.prototype.get",eg.prototype.get);A("X.renderer3D.prototype.render",eg.prototype.dc);A("X.renderer3D.prototype.destroy",eg.prototype.md);A("X.renderer3D.prototype.resetBoundingBox",eg.prototype.jh);A("X.renderer3D.prototype.resetViewAndRender",eg.prototype.Gc);A("X.renderer3D.prototype.pick",eg.prototype.Tf);function hg(){S.call(this);this.e="mesh";Ea(this,new Qc)}F(hg,S);A("X.mesh",hg);function ig(){S.call(this);this.e="fibers";Ea(this,new Qc)}F(ig,S);A("X.fibers",ig);function $(){Gf.call(this);this.e="renderer2D";this.Ue=this.Ld=this.Se=this.Kd=this.Qa=q;this.$d=this.ae=0}F($,Gf);$.prototype.dh=aa();$.prototype.De=function(a){$.h.De.call(this,a);var b=this.lb[0];if(b){var c=this.Qa;b["index"+c]=a.B?b["index"+c]+1:b["index"+c]-1;b.P();eval("this.onScroll();");this.sa(s,s)}};$.prototype.__defineGetter__("orientation",u("Qa"));
$.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.Qa=a});$.prototype.Z=function(){this.Qa||i(Error("No 2D orientation set."));$.h.Z.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ua.width,this.ua.height);this.Kd=$d("canvas");this.Ld=$d("canvas")};$.prototype.Gc=function(){$.h.Gc.call(this);jg(this);this.sa(s,s)};
$.prototype.La=function(a){$.h.La.call(this,a);var b=s;this.get(a.wa)&&(b=p);var c=a.r,d=a.v,e=a.Q;if(x(d)&&x(d.r)&&d.r.c)this.La(d);else if(x(e)&&x(e.r)&&e.r.c)this.R.load(e,a);else if(x(c)&&c.c)this.R.load(a,a);else{d=c=0;e=a.$;"X"==this.Qa?(this.Eb=a.Ra.d,c=e[2],d=e[1]):"Y"==this.Qa?(this.Eb=a.Sa.d,c=e[0],d=e[2]):"Z"==this.Qa&&(this.Eb=a.Ta.d,c=e[0],d=e[1]);"X"==this.Qa&&(e=d,d=c,c=e);this.ae=c;this.$d=d;e=this.Kd;e.width=c;e.height=d;var f=this.Ld;f.width=c;f.height=d;this.Se=e.getContext("2d");
this.Ue=f.getContext("2d");b||(this.Pa.add(a),jg(this))}};function jg(a){var b=Math.min(a.S/a.ae,a.K/a.$d);M(a.o.s,2,3,10*b-10)}
$.prototype.sa=function(a,b){$.h.sa.call(this,a,b);if(0!=this.Pa.u.length){var c=this.S,d=this.K,e=this.o.s;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.H(0,3),g=-1*e.H(1,3),h=Math.max(1+e.H(2,3)/10,0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.lb[0],j=this.Eb[parseInt(e["index"+this.Qa],10)],k=j.Y.jb,j=j.v,n=q;j&&(n=j.jb);var l=this.ae,o=this.$d,c=1/(2*h)*(c-l*h)+f,d=1/(2*h)*(d-o*h)+g,g=this.Se,f=this.Ue,h=g.getImageData(0,0,l,o),l=f.getImageData(0,0,l,o),o=h.data,
r=l.data,t=o.length,w=e.Ga,B=e.oa,D=e.qa,C=0;do{var y=[0,0,0,0],E=[0,0,0,0],H=k[C]/255*w;H>=B&&H<=D&&(y=[k[C],k[C+1],k[C+2],k[C+3]],j&&(E=[n[C],n[C+1],n[C+2],n[C+3]]));H=t-1-C;o[H-3]=y[0];o[H-2]=y[1];o[H-1]=y[2];o[H]=y[3];r[H-3]=E[0];r[H-2]=E[1];r[H-1]=E[2];r[H]=E[3];C+=4}while(C<t);g.putImageData(h,0,0);f.putImageData(l,0,0);this.a.globalAlpha=1;this.a.drawImage(this.Kd,c,d);j&&e.v.xa&&(this.a.globalAlpha=e.v.L,this.a.drawImage(this.Ld,c,d))}};A("X.renderer2D",$);
A("X.renderer2D.prototype.init",$.prototype.Z);A("X.renderer2D.prototype.add",$.prototype.add);A("X.renderer2D.prototype.onShowtime",$.prototype.Mf);A("X.renderer2D.prototype.onScroll",$.prototype.dh);A("X.renderer2D.prototype.get",$.prototype.get);A("X.renderer2D.prototype.resetViewAndRender",$.prototype.Gc);A("X.renderer2D.prototype.render",$.prototype.dc);A("X.renderer2D.prototype.destroy",$.prototype.md);
