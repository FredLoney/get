/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var l=void 0,n=!0,q=null,r=!1;function ca(){return function(){}}function da(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var t,ea=this;function fa(){}
function ga(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ha(a){return a!==l}function w(a){return a!=q}function ia(a){return"array"==ga(a)}function ja(a){var b=ga(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ka(a){return"string"==typeof a}function y(a){return"number"==typeof a}function la(a){return"function"==ga(a)}function ma(a){a=ga(a);return"object"==a||"array"==a||"function"==a}function na(a){return a[oa]||(a[oa]=++qa)}
var oa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),qa=0;function ra(a,b,c){return a.call.apply(a.bind,arguments)}function ta(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ua(a,b,c){ua=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ra:ta;return ua.apply(q,arguments)}function va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};
function B(a,b){var c=a.split("."),d=ea;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ha(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function D(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c;a.prototype.constructor=a};function za(a,b,c){this.ya=this.xa=this.wa=0;3==arguments.length?(this.wa=Number(a),this.xa=Number(b),this.ya=Number(c)):a instanceof za?(this.wa=Number(a.x()),this.xa=Number(a.y()),this.ya=Number(a.b())):(this.wa=Number(a[0]),this.xa=Number(a[1]),this.ya=Number(a[2]))}
za.prototype={f:function(){return new za(this.wa,this.xa,this.ya)},Se:function(){return new za(-this.wa,-this.xa,-this.ya)},pc:function(a){return new za(this.wa+a.x(),this.xa+a.y(),this.ya+a.b())},Yc:function(a){return new za(this.wa-a.x(),this.xa-a.y(),this.ya-a.b())},Ab:function(a){return new za(this.wa*a,this.xa*a,this.ya*a)},ah:function(a){return new za(this.wa/a,this.xa/a,this.ya/a)},mc:function(a){return this.wa*a.x()+this.xa*a.y()+this.ya*a.b()},$f:function(a,b){return this.pc(a.Yc(this).Ab(b))},
length:function(){return Math.sqrt(this.mc(this))},ed:function(){return this.ah(this.length())},Ae:function(a){return new za(this.xa*a.b()-this.ya*a.y(),this.ya*a.x()-this.wa*a.b(),this.wa*a.y()-this.xa*a.x())},x:s("wa"),y:s("xa"),b:s("ya")};var G=G||{};G.Pi=n;G.Ea=function(a){eval("X.DEV === undefined")||window.console.time(a)};G.za=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Lg=0;this.Li=function(){return this.Lg++}};function Aa(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.ad;++c)window.ad=window[b[c]+"RequestAnimationFrame"],window.ve=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.ad||(window.ad=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.ve||(window.ve=function(a){clearTimeout(a)})})();B("Function.prototype.bind",Function.prototype.bind);B("window.requestAnimationFrame",window.ad);
B("window.cancelAnimationFrame",window.ve);function Ba(a){if(!Ca.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Da,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ea,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ga,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ha,"&quot;"));return a}var Da=/&/g,Ea=/</g,Ga=/>/g,Ha=/\"/g,Ca=/[&<>\"]/;var Ia,Ja,Ka,La,Ma,Na,Oa;function Qa(){return ea.navigator?ea.navigator.userAgent:q}function Ra(){return ea.navigator}Ma=La=Ka=Ja=Ia=r;var Sa;if(Sa=Qa()){var Ta=Ra();Ia=0==Sa.indexOf("Opera");Ja=!Ia&&-1!=Sa.indexOf("MSIE");La=(Ka=!Ia&&-1!=Sa.indexOf("WebKit"))&&-1!=Sa.indexOf("Mobile");Ma=!Ia&&!Ka&&"Gecko"==Ta.product}var Ua=Ia,H=Ja,Va=Ma,Wa=Ka,Xa=La,Za,$a=Ra();Za=$a&&$a.platform||"";Na=-1!=Za.indexOf("Mac");Oa=-1!=Za.indexOf("Win");var ab=!!Ra()&&-1!=(Ra().appVersion||"").indexOf("X11"),bb;
a:{var cb="",db;if(Ua&&ea.opera)var hb=ea.opera.version,cb="function"==typeof hb?hb():hb;else if(Va?db=/rv\:([^\);]+)(\)|;)/:H?db=/MSIE\s+([^\);]+)(\)|;)/:Wa&&(db=/WebKit\/(\S+)/),db)var ib=db.exec(Qa()),cb=ib?ib[1]:"";if(H){var jb,kb=ea.document;jb=kb?kb.documentMode:l;if(jb>parseFloat(cb)){bb=""+jb;break a}}bb=cb}var lb={};
function mb(a){var b;if(!(b=lb[a])){b=0;for(var c=(""+bb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var m=j.exec(g)||["","",""],o=k.exec(h)||["","",""];if(0==m[0].length&&0==o[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==o[1].length?0:parseInt(o[1],10))?-1:(0==m[1].length?0:parseInt(m[1],
10))>(0==o[1].length?0:parseInt(o[1],10))?1:0)||((0==m[2].length)<(0==o[2].length)?-1:(0==m[2].length)>(0==o[2].length)?1:0)||(m[2]<o[2]?-1:m[2]>o[2]?1:0)}while(0==b)}b=lb[a]=0<=b}return b}var ob={};function pb(a){return ob[a]||(ob[a]=H&&document.documentMode&&document.documentMode>=a)};function qb(a,b){for(var c in a)b.call(l,a[c],c,a)}function rb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function sb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var tb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function ub(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tb.length;f++)c=tb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var vb=Array.prototype,wb=vb.indexOf?function(a,b,c){return vb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(ka(a))return!ka(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=vb.forEach?function(a,b,c){vb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=vb.map?function(a,b,c){return vb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ka(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},zb=vb.some?function(a,b,c){return vb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return n;return r},Ab=vb.every?function(a,b,c){return vb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return n};function Bb(a,b){var c=wb(a,b);0<=c&&vb.splice.call(a,c,1)}
function Cb(a){return vb.concat.apply(vb,arguments)}function Gb(a){if(ia(a))return Cb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Hb(a,b,c){return 2>=arguments.length?vb.slice.call(a,b):vb.slice.call(a,b,c)};function Ib(a){if("function"==typeof a.sa)a=a.sa();else if(ja(a)||ka(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Jb(a){if("function"==typeof a.Wb)return a.Wb();if(ka(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return rb(a)}
function Kb(a,b){if("function"==typeof a.every)return a.every(b,l);if(ja(a)||ka(a))return Ab(a,b,l);var c;if("function"==typeof a.Uc)c=a.Uc();else if("function"!=typeof a.Wb)if(ja(a)||ka(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=sb(a);else c=l;for(var d=Jb(a),e=d.length,f=0;f<e;f++)if(!b.call(l,d[f],c&&c[f],a))return r;return n};var Lb="StopIteration"in ea?ea.StopIteration:Error("StopIteration");function Mb(){}Mb.prototype.next=function(){i(Lb)};Mb.prototype.vc=function(){return this};function Nb(a){if(a instanceof Mb)return a;if("function"==typeof a.vc)return a.vc(r);if(ja(a)){var b=0,c=new Mb;c.next=function(){for(;;){b>=a.length&&i(Lb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Ob(a,b){if(ja(a))try{xb(a,b,l)}catch(c){c!==Lb&&i(c)}else{a=Nb(a);try{for(;;)b.call(l,a.next(),l,a)}catch(d){d!==Lb&&i(d)}}};function Pb(a,b){this.B={};this.u=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.se(a)}t=Pb.prototype;t.J=0;t.fd=0;t.sa=s("J");t.Wb=function(){Qb(this);for(var a=[],b=0;b<this.u.length;b++)a.push(this.B[this.u[b]]);return a};t.Uc=function(){Qb(this);return this.u.concat()};t.ye=function(a){for(var b=0;b<this.u.length;b++){var c=this.u[b];if(Rb(this.B,c)&&this.B[c]==a)return n}return r};
t.Qc=function(a,b){if(this===a)return n;if(this.J!=a.sa())return r;var c=b||Sb;Qb(this);for(var d,e=0;d=this.u[e];e++)if(!c(this.get(d),a.get(d)))return r;return n};function Sb(a,b){return a===b}t.clear=function(){this.B={};this.fd=this.J=this.u.length=0};t.remove=function(a){return Rb(this.B,a)?(delete this.B[a],this.J--,this.fd++,this.u.length>2*this.J&&Qb(this),n):r};
function Qb(a){if(a.J!=a.u.length){for(var b=0,c=0;b<a.u.length;){var d=a.u[b];Rb(a.B,d)&&(a.u[c++]=d);b++}a.u.length=c}if(a.J!=a.u.length){for(var e={},c=b=0;b<a.u.length;)d=a.u[b],Rb(e,d)||(a.u[c++]=d,e[d]=1),b++;a.u.length=c}}t.get=function(a,b){return Rb(this.B,a)?this.B[a]:b};t.set=function(a,b){Rb(this.B,a)||(this.J++,this.u.push(a),this.fd++);this.B[a]=b};t.se=function(a){var b;a instanceof Pb?(b=a.Uc(),a=a.Wb()):(b=sb(a),a=rb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};t.f=function(){return new Pb(this)};
t.vc=function(a){Qb(this);var b=0,c=this.u,d=this.B,e=this.fd,f=this,g=new Mb;g.next=function(){for(;;){e!=f.fd&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Lb);var g=c[b++];return a?g:d[g]}};return g};function Rb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Tb(a){this.B=new Pb;a&&this.se(a)}function Ub(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+na(a):b.substr(0,1)+a}t=Tb.prototype;t.sa=function(){return this.B.sa()};t.add=function(a){this.B.set(Ub(a),a)};t.se=function(a){for(var a=Jb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};t.Rd=function(a){for(var a=Jb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};t.remove=function(a){return this.B.remove(Ub(a))};t.clear=function(){this.B.clear()};
t.contains=function(a){a=Ub(a);return Rb(this.B.B,a)};t.Yf=function(a){for(var b=new Tb,a=Jb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};t.Wb=function(){return this.B.Wb()};t.f=function(){return new Tb(this)};t.Qc=function(a){return this.sa()==Ib(a)&&Vb(this,a)};
function Vb(a,b){var c=Ib(b);if(a.sa()>c)return r;!(b instanceof Tb)&&5<c&&(b=new Tb(b));return Kb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.ye)a=b.ye(a);else if(ja(b)||ka(b))a=0<=wb(b,a);else a:{for(var c in b)if(b[c]==a){a=n;break a}a=r}return a})}t.vc=function(){return this.B.vc(r)};function Wb(){}Wb.prototype.Kf=r;Wb.prototype.Ia=function(){this.Kf||(this.Kf=n,this.K())};Wb.prototype.K=function(){this.Yg&&Xb.apply(q,this.Yg)};function Yb(a){a&&"function"==typeof a.Ia&&a.Ia()}function Xb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ja(d)?Xb.apply(q,d):Yb(d)}};function Zb(a,b){this.bg=b;this.Tc=[];a>this.bg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Tc.push(this.Dd())}D(Zb,Wb);t=Zb.prototype;t.Hf=q;t.Jf=q;function $b(a,b){a.Tc.length<a.bg?a.Tc.push(b):a.De(b)}t.Dd=function(){return this.Hf?this.Hf():{}};t.De=function(a){if(this.Jf)this.Jf(a);else if(ma(a))if(la(a.Ia))a.Ia();else for(var b in a)delete a[b]};t.K=function(){Zb.i.K.call(this);for(var a=this.Tc;a.length;)this.De(a.pop());delete this.Tc};function ac(){this.Rc=[];this.Ye=new Pb;this.xg=this.yg=this.zg=this.ug=0;this.dd=new Pb;this.Ef=this.wg=0;this.Te=1;this.Ee=new Zb(0,4E3);this.Ee.Dd=function(){return new bc};this.vg=new Zb(0,50);this.vg.Dd=function(){return new cc};var a=this;this.Ie=new Zb(0,2E3);this.Ie.Dd=function(){return""+a.Te++};this.Ie.De=ca()}function cc(){this.lf=this.time=this.count=0}
cc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.lf&&a.push(" [VarAlloc = ",this.lf,"]");return a.join("")};function bc(){}function dc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(ec(a.Lf-c));e.push(" ",fc(a.Lf-b));0==a.Fe?e.push(" Start        "):1==a.Fe?(e.push(" Done "),e.push(ec(a.Ej-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Hi&&e.push("[VarAlloc ",a.Hi,"] ");return e.join("")}
bc.prototype.toString=function(){return this.type==q?this.Vg:"["+this.type+"] "+this.Vg};ac.prototype.reset=function(){for(var a=0;a<this.Rc.length;a++){var b=this.Ee.id;b&&$b(this.Ie,b);$b(this.Ee,this.Rc[a])}this.Rc.length=0;this.Ye.clear();this.ug=wa();this.Ef=this.wg=this.xg=this.yg=this.zg=0;b=this.dd.Uc();for(a=0;a<b.length;a++){var c=this.dd.get(b[a]);c.count=0;c.time=0;c.lf=0;$b(this.vg,c)}this.dd.clear()};
ac.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Rc.length;d++){var e=this.Rc[d];1==e.Fe&&c.pop();a.push(" ",dc(e,this.ug,b,c.join("")));b=e.Lf;a.push("\n");0==e.Fe&&c.push("|  ")}if(0!=this.Ye.sa()){var f=wa();a.push(" Unstopped timers:\n");Ob(this.Ye,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",fc(b.startTime),")\n")})}b=this.dd.Uc();for(d=0;d<b.length;d++)c=this.dd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.wg,"\n","Total comments created ",
this.Ef,"\n","Overhead start: ",this.zg," ms\n","Overhead end: ",this.yg," ms\n","Overhead comment: ",this.xg," ms\n");return a.join("")};function ec(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function fc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new ac;function gc(){}var hc=0;t=gc.prototype;t.key=0;t.rc=r;t.ue=r;t.ha=function(a,b,c,d,e,f){la(a)?this.Zf=n:a&&a.handleEvent&&la(a.handleEvent)?this.Zf=r:i(Error("Invalid listener argument"));this.Wc=a;this.qg=b;this.src=c;this.type=d;this.capture=!!e;this.Ge=f;this.ue=r;this.key=++hc;this.rc=r};t.handleEvent=function(a){return this.Zf?this.Wc.call(this.Ge||this.src,a):this.Wc.handleEvent.call(this.Wc,a)};!H||pb(9);var ic=!H||pb(9),jc=H&&!mb("8");!Wa||mb("528");Va&&mb("1.9b")||H&&mb("8")||Ua&&mb("9.5")||Wa&&mb("528");!Va||mb("8");function kc(a,b){this.type=a;this.currentTarget=this.target=b}D(kc,Wb);t=kc.prototype;t.K=function(){delete this.type;delete this.target;delete this.currentTarget};t.Zb=r;t.bd=n;t.stopPropagation=function(){this.Zb=n};t.preventDefault=function(){this.bd=r};function lc(a){lc[" "](a);return a}lc[" "]=fa;function mc(a,b){a&&this.ha(a,b)}D(mc,kc);t=mc.prototype;t.target=q;t.relatedTarget=q;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Ra=q;
t.ha=function(a,b){var c=this.type=a.type;kc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Va){var e;a:{try{lc(d.nodeName);e=n;break a}catch(f){}e=r}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Wa||a.offsetX!==l?a.offsetX:a.layerX;this.offsetY=Wa||a.offsetY!==l?a.offsetY:a.layerY;this.clientX=a.clientX!==l?a.clientX:a.pageX;this.clientY=a.clientY!==l?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ra=a;delete this.bd;delete this.Zb};t.stopPropagation=function(){mc.i.stopPropagation.call(this);this.Ra.stopPropagation?this.Ra.stopPropagation():this.Ra.cancelBubble=n};
t.preventDefault=function(){mc.i.preventDefault.call(this);var a=this.Ra;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,jc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.kh=s("Ra");t.K=function(){mc.i.K.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ra=q};var nc={},oc={},pc={},qc={};
function J(a,b,c,d,e){if(b){if(ia(b)){for(var f=0;f<b.length;f++)J(a,b[f],c,d,e);return q}var d=!!d,g=oc;b in g||(g[b]={J:0,Ca:0});g=g[b];d in g||(g[d]={J:0,Ca:0},g.J++);var g=g[d],h=na(a),j;g.Ca++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.Wc==c&&g.Ge==e){if(g.rc)break;return j[f].key}}else j=g[h]=[],g.J++;f=rc();f.src=a;g=new gc;g.ha(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);nc[c]=g;pc[h]||(pc[h]=[]);pc[h].push(g);a.addEventListener?(a==ea||!a.If)&&a.addEventListener(b,f,d):a.attachEvent(b in
qc?qc[b]:qc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function rc(){var a=sc,b=ic?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function tc(a,b,c,d,e){if(ia(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else a=J(a,b,c,d,e),nc[a].ue=n}
function uc(a,b,c,d,e){if(ia(b))for(var f=0;f<b.length;f++)uc(a,b[f],c,d,e);else{d=!!d;a:{f=oc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=na(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].Wc==c&&a[f].capture==d&&a[f].Ge==e){vc(a[f].key);break}}}
function vc(a){if(!nc[a])return r;var b=nc[a];if(b.rc)return r;var c=b.src,d=b.type,e=b.qg,f=b.capture;c.removeEventListener?(c==ea||!c.If)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in qc?qc[d]:qc[d]="on"+d,e);c=na(c);e=oc[d][f][c];if(pc[c]){var g=pc[c];Bb(g,b);0==g.length&&delete pc[c]}b.rc=n;e.fg=n;wc(d,f,c,e);delete nc[a];return n}
function wc(a,b,c,d){if(!d.Nd&&d.fg){for(var e=0,f=0;e<d.length;e++)d[e].rc?d[e].qg.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.fg=r;0==f&&(delete oc[a][b][c],oc[a][b].J--,0==oc[a][b].J&&(delete oc[a][b],oc[a].J--),0==oc[a].J&&delete oc[a])}}function xc(a){var b,c=0,d=b==q;b=!!b;if(a==q)qb(pc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}});else if(a=na(a),pc[a])for(var a=pc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}}
function yc(a){var b=Bc,a=na(a),c=pc[a];if(c){var d=ha(b),e=ha(l);return d&&e?(c=oc[b],!!c&&!!c[l]&&a in c[l]):!d&&!e?n:zb(c,function(a){return d&&a.type==b||e&&a.capture==l})}return r}function Cc(a,b,c,d,e){var f=1,b=na(b);if(a[b]){a.Ca--;a=a[b];a.Nd?a.Nd++:a.Nd=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.rc&&(f&=Dc(j,e)!==r)}}finally{a.Nd--,wc(c,d,b,a)}}return Boolean(f)}function Dc(a,b){var c=a.handleEvent(b);a.ue&&vc(a.key);return c}
function sc(a,b){if(!nc[a])return n;var c=nc[a],d=c.type,e=oc;if(!(d in e))return n;var e=e[d],f,g;if(!ic){var h;if(!(h=b))a:{h=["window","event"];for(var j=ea;f=h.shift();)if(w(j[f]))j=j[f];else{h=q;break a}h=j}f=h;h=n in e;j=r in e;if(h){if(0>f.keyCode||f.returnValue!=l)return n;a:{var k=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(m){k=n}if(k||f.returnValue==l)f.returnValue=n}}k=new mc;k.ha(f,this);f=n;try{if(h){for(var o=[],v=k.currentTarget;v;v=v.parentNode)o.push(v);g=e[n];g.Ca=g.J;for(var p=
o.length-1;!k.Zb&&0<=p&&g.Ca;p--)k.currentTarget=o[p],f&=Cc(g,o[p],d,n,k);if(j){g=e[r];g.Ca=g.J;for(p=0;!k.Zb&&p<o.length&&g.Ca;p++)k.currentTarget=o[p],f&=Cc(g,o[p],d,r,k)}}else f=Dc(c,k)}finally{o&&(o.length=0),k.Ia()}return f}d=new mc(b,this);try{f=Dc(c,d)}finally{d.Ia()}return f}var Ec=0;function Fc(a){return a+"_"+Ec++};function Gc(){}D(Gc,Wb);t=Gc.prototype;t.If=n;t.Pd=q;t.af=da("Pd");t.addEventListener=function(a,b,c,d){J(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){uc(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=oc;if(b in c){if(ka(a))a=new kc(a,this);else if(a instanceof kc)a.target=a.target||this;else{var d=a,a=new kc(b,this);ub(a,d)}var d=1,e,c=c[b],b=n in c,f;if(b){e=[];for(f=this;f;f=f.Pd)e.push(f);f=c[n];f.Ca=f.J;for(var g=e.length-1;!a.Zb&&0<=g&&f.Ca;g--)a.currentTarget=e[g],d&=Cc(f,e[g],a.type,n,a)&&a.bd!=r}if(r in c)if(f=c[r],f.Ca=f.J,b)for(g=0;!a.Zb&&g<e.length&&f.Ca;g++)a.currentTarget=e[g],d&=Cc(f,e[g],a.type,r,a)&&a.bd!=r;else for(e=this;!a.Zb&&e&&
f.Ca;e=e.Pd)a.currentTarget=e,d&=Cc(f,e,a.type,r,a)&&a.bd!=r;a=Boolean(d)}else a=n;return a};t.K=function(){Gc.i.K.call(this);xc(this);this.Pd=q};function K(){this.c="base";this.ma=window["X.counter"].Li();this.d=r}D(K,Gc);K.prototype.__defineGetter__("classname",s("c"));K.prototype.__defineGetter__("id",s("ma"));B("X.base",K);function Hc(a,b){this.va=new za(a);this.X=new za(b)}Hc.prototype={f:function(){return new Hc(this.va.f(),this.X.f())},Vb:function(){this.X=this.X.Se()},yh:function(a,b){return new Hc(this.va.$f(a.va,b),this.X.$f(a.X,b))}};function Ic(a,b){this.X=a;this.gd=b}Ic.prototype={f:function(){return new Ic(this.X.f(),this.gd)},Vb:function(){this.X=this.X.Se();this.gd=-this.gd}};function Jc(a,b){this.hb=a;this.Vd=b;var c=a[0].va,d=a[2].va,d=a[1].va.Yc(c).Ae(d.Yc(c)).ed();this.ua=new Ic(d,d.mc(c))}
Jc.prototype={f:function(){var a=this.hb.map(function(a){return a.f()});return new Jc(a,this.Vd)},Vb:function(){this.hb.reverse().map(function(a){a.Vb()});this.ua.Vb()},tg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.hb.length;h++){var j=a.X.mc(this.hb[h].va)-a.gd,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.X.mc(this.ua.X)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.hb.length;h++){var k=(h+1)%this.hb.length,j=g[h],
m=g[k],f=this.hb[h],k=this.hb[k];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.f():f);3==(j|m)&&(j=(a.gd-a.X.mc(f.va))/a.X.mc(k.va.Yc(f.va)),j=f.yh(k,j),b.push(j),c.push(j.f()))}3<=b.length&&d.push(new Jc(b,this.Vd));3<=c.length&&e.push(new Jc(c,this.Vd))}}};function Kc(a){this.ca=this.da=this.ua=q;this.w=[];a&&this.ic(a)}
Kc.prototype={f:function(){var a=new Kc;a.si(this.ua&&this.ua.f());a.ri(this.da&&this.da.f());a.qi(this.ca&&this.ca.f());a.Td(this.w.map(function(a){return a.f()}));return a},S:function(){for(var a=0;a<this.w.length;a++)this.w[a].Vb();this.ua.Vb();this.da&&this.da.S();this.ca&&this.ca.S();a=this.da;this.da=this.ca;this.ca=a},xe:function(a){if(!this.ua)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].tg(this.ua,b,c,b,c);this.da&&(b=this.da.xe(b));c=this.ca?this.ca.xe(c):[];return b.concat(c)},
Ha:function(a){this.w=a.xe(this.w);this.da&&this.da.Ha(a);this.ca&&this.ca.Ha(a)},yb:function(){var a=this.w.slice();this.da&&(a=a.concat(this.da.yb()));this.ca&&(a=a.concat(this.ca.yb()));return a},ic:function(a){if(a.length){this.ua||(this.ua=a[0].ua.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].tg(this.ua,this.w,this.w,b,c);b.length&&(this.da||(this.da=new Kc),this.da.ic(b));c.length&&(this.ca||(this.ca=new Kc),this.ca.ic(c))}},si:da("ua"),ri:da("da"),qi:da("ca"),Td:da("w")};function Lc(){this.w=[]}function Mc(a){var b=new Lc;b.Td(a);return b}
Lc.prototype={f:function(){var a=new Lc;a.Td(this.w.map(function(a){return a.f()}));return a},hf:function(a){var b=new Kc(this.f().w),a=new Kc(a.f().w);b.Ha(a);a.Ha(b);a.S();a.Ha(b);a.S();b.ic(a.yb());return Mc(b.yb())},gb:function(a){var b=new Kc(this.f().w),a=new Kc(a.f().w);b.S();b.Ha(a);a.Ha(b);a.S();a.Ha(b);a.S();b.ic(a.yb());b.S();return Mc(b.yb())},Ke:function(a){var b=new Kc(this.f().w),a=new Kc(a.f().w);b.S();a.Ha(b);a.S();b.Ha(a);a.Ha(b);b.ic(a.yb());b.S();return Mc(b.yb())},inverse:function(){var a=
this.f();a.w.map(function(a){a.Vb()});return a},Td:da("w")};function Nc(){K.call(this);this.c="indexer";this.qe=[];this.ia={}}D(Nc,K);Nc.prototype.add=function(a){w(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.ia||(this.ia[b]=this.qe.length,this.qe.push(a));return this.ia[b]};Nc.prototype.unique=s("qe");function Oc(a){K.call(this);this.c="file";this.ke=a;this.d=n}D(Oc,K);function Pc(){this.Eb=this.r=q}Pc.prototype.__defineSetter__("file",function(a){this.r=!w(a)||a instanceof Array&&0==a.length?q:a instanceof Array?1==a.length?new Oc(a[0]):yb(a,function(a){var c=new L;c.r=new Oc(a);return c}):new Oc(a)});Pc.prototype.__defineGetter__("file",function(){return!this.r?"":this.r.ke});Pc.prototype.__defineGetter__("filedata",s("Eb"));
Pc.prototype.__defineSetter__("filedata",function(a){if(!w(a)||a instanceof Array&&0==a.length)this.Eb=q;if(a instanceof Array)if(1==a.length)this.Eb=a[0];else{var b=this.r.length,c;for(c=0;c<b;c++)this.r[c].Eb=a[c]}else this.Eb=a});function Qc(){K.call(this);this.c="colortable";this.ia=new Pb;Aa(this,new Pc)}D(Qc,K);Qc.prototype.add=function(a,b,c,d,e,f){(!y(a)||!y(c)||!y(d)||!y(e)||!y(f))&&i(Error("Invalid color table entry."));this.ia.set(a,[b,c,d,e,f]);this.d=n};function Rc(a,b,c){this.x=ha(a)?a:0;this.y=ha(b)?b:0;this.b=ha(c)?c:0}Rc.prototype.f=function(){return new Rc(this.x,this.y,this.b)};Rc.prototype.gf=function(){return[this.x,this.y,this.b]};function M(a,b,c){this.x=a;this.y=b;this.b=c}D(M,Rc);t=M.prototype;t.f=function(){return new M(this.x,this.y,this.b)};t.Yb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};t.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};t.S=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};t.normalize=function(){return this.scale(1/this.Yb())};t.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
t.gb=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};t.Qc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Sc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Tc(a,b){return new M(a.x+b.x,a.y+b.y,a.b+b.b)}function Uc(a,b){return new M(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Vc(a,b){this.x=ha(a)?a:0;this.y=ha(b)?b:0}Vc.prototype.f=function(){return new Vc(this.x,this.y)};function Wc(a,b){return new Vc(a.x-b.x,a.y-b.y)};function Xc(a,b){this.x=a;this.y=b}D(Xc,Vc);t=Xc.prototype;t.f=function(){return new Xc(this.x,this.y)};t.Yb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};t.scale=function(a){this.x*=a;this.y*=a;return this};t.S=function(){this.x=-this.x;this.y=-this.y;return this};t.normalize=function(){return this.scale(1/this.Yb())};t.add=function(a){this.x+=a.x;this.y+=a.y;return this};t.gb=function(a){this.x-=a.x;this.y-=a.y;return this};
t.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};t.Qc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Yc(a,b){this.width=a;this.height=b}function Zc(a,b){return a==b?n:!a||!b?r:a.width==b.width&&a.height==b.height}Yc.prototype.f=function(){return new Yc(this.width,this.height)};Yc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Yc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Yc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function $c(a,b){if(a instanceof $c)this.N=a.gf();else{var c;if(c=ja(a))a:{for(var d=c=0;d<a.length;d++){if(!ja(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!y(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.N=Gb(a):a instanceof Yc?this.N=bd(a.height,a.width):y(a)&&y(b)&&0<a&&0<b?this.N=bd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.C=new Yc(this.N[0].length,this.N.length)}
function cd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new $c(b)}function dd(a,b,c){for(var d=0;d<a.ta().height;d++)for(var e=0;e<a.ta().width;e++)b.call(c,a.N[d][e],d,e,a)}function ed(a,b){var c=new $c(a.ta());dd(a,function(d,e,f){c.N[e][f]=b.call(l,d,e,f,a)});return c}function bd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}t=$c.prototype;
t.add=function(a){Zc(this.C,a.ta())||i(Error("Matrix summation is only supported on arrays of equal size"));return ed(this,function(b,c,d){return b+a.N[c][d]})};t.Qc=function(a,b){if(this.C.width!=a.C.width||this.C.height!=a.C.height)return r;for(var c=b||0,d=0;d<this.C.height;d++)for(var e=0;e<this.C.width;e++)if(!(Math.abs(this.N[d][e]-a.N[d][e])<=(c||1.0E-6)))return r;return n};t.ta=s("C");t.O=function(a,b){return!(0<=a&&a<this.C.height&&0<=b&&b<this.C.width)?q:this.N[a][b]};
t.k=function(a,b,c){0<=a&&a<this.C.height&&0<=b&&b<this.C.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.C.height+","+this.C.width+")"));this.N[a][b]=c};t.multiply=function(a){if(a instanceof $c)return this.C.width!=a.ta().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),jd(this,a);if(y(a))return kd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
t.gb=function(a){Zc(this.C,a.ta())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return ed(this,function(b,c,d){return b-a.N[c][d]})};t.gf=s("N");function jd(a,b){var c=new $c(a.C.height,b.ta().width);dd(c,function(a,e,f){for(var g=a=0;g<this.C.width;g++)a+=this.O(e,g)*b.O(g,f);c.k(e,f,a)},a);return c}function kd(a,b){return ed(a,function(a){return a*b})};function N(a,b){$c.call(this,a,b);this.c="matrix"}D(N,$c);function ld(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new N(b)}t=N.prototype;t.Ba=function(){var a=[],b=this.ta();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.O(c,d));return a};
t.translate=function(a){this.C.width!=this.C.height&&i(Error("Can not translate non-square matrix."));var b=this.ta(),c=cd(b.height);a instanceof Xc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof M&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new N(this.multiply(c))};
t.rotate=function(a,b){(4!=this.ta().height||this.C.width!=this.C.height)&&i(Error("Only 4x4 matrices can be rotated."));(!w(b)||!(b instanceof M))&&i(Error("Invalid axis vector."));y(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=cd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new N(this.multiply(f))};t.Ka=function(a){var b=this.ta(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof M&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new $c(c));return new M(parseFloat(a.O(0,0)),parseFloat(a.O(1,0)),parseFloat(a.O(2,0)))};t.Fi=function(a,b){var c=this.N[a];this.N[a]=this.N[b];this.N[b]=c};
t.Ei=function(a,b){for(var c=this.ta(),d=0,d=0;d<c.height;d++){var e=this.O(d,a);e||(e=0);var f=this.O(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};B("X.matrix",N);B("X.matrix.createIdentityMatrix",ld);B("X.matrix.prototype.flatten",N.prototype.Ba);B("X.matrix.prototype.translate",N.prototype.translate);B("X.matrix.prototype.rotate",N.prototype.rotate);B("X.matrix.prototype.toArray",N.prototype.gf);B("X.matrix.prototype.getValueAt",N.prototype.O);B("X.matrix.prototype.setValueAt",N.prototype.k);
B("X.matrix.prototype.multiplyByVector",N.prototype.Ka);B("X.matrix.prototype.swapRows",N.prototype.Fi);B("X.matrix.prototype.swapCols",N.prototype.Ei);function md(){K.call(this);this.c="transform";this.A=ld(4);this.qf=new Float32Array(this.A.Ba())}D(md,K);md.prototype.__defineGetter__("matrix",s("A"));md.prototype.__defineSetter__("matrix",function(a){(!w(a)||!(a instanceof N))&&i(Error("Invalid matrix."));this.A=a;this.n()});t=md.prototype;t.ki=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.A=this.A.rotate(a*Math.PI/180,new M(0,1,0));this.n()};
t.li=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.A=this.A.rotate(a*Math.PI/180,new M(1,0,0));this.n()};t.mi=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.A=this.A.rotate(a*Math.PI/180,new M(0,0,1));this.n()};t.Ii=function(a){y(a)||i(Error("Invalid distance."));this.A=this.A.translate(new M(a,0,0));this.n()};t.Ji=function(a){y(a)||i(Error("Invalid distance."));this.A=this.A.translate(new M(0,a,0));this.n()};
t.Ki=function(a){y(a)||i(Error("Invalid distance."));this.A=this.A.translate(new M(0,0,a));this.n()};function nd(a,b,c){var d=a.A.O(b,c);d||(d=0);a.A.k(b,c,-1*d);a.n()}t.gh=function(){nd(this,0,0)};t.hh=function(){nd(this,1,1)};t.ih=function(){nd(this,2,2)};t.n=function(){this.qf=new Float32Array(this.A.Ba());this.d=n};B("X.transform",md);B("X.transform.prototype.rotateX",md.prototype.ki);B("X.transform.prototype.rotateY",md.prototype.li);B("X.transform.prototype.rotateZ",md.prototype.mi);
B("X.transform.prototype.translateX",md.prototype.Ii);B("X.transform.prototype.translateY",md.prototype.Ji);B("X.transform.prototype.translateZ",md.prototype.Ki);B("X.transform.prototype.flipX",md.prototype.gh);B("X.transform.prototype.flipY",md.prototype.hh);B("X.transform.prototype.flipZ",md.prototype.ih);B("X.transform.prototype.modified",md.prototype.n);function od(){K.call(this);this.c="texture";this.Ya=this.lb=this.r=q;this.qd=this.rd=0;Aa(this,new Pc)}D(od,K);B("X.texture",od);function O(a,b){K.call(this);this.c="fasttriplets";this.Mb=Infinity;this.Jb=-Infinity;this.Nb=Infinity;this.Kb=-Infinity;this.Ob=Infinity;this.Lb=-Infinity;this.hd=[0,0,0];this.v=0;this.G=new Float32Array(a);w(b)&&(this.G=b.G.subarray(0,b.G.length),this.v=this.G.length,this.Mb=b.Mb,this.Jb=b.Jb,this.Nb=b.Nb,this.Kb=b.Kb,this.Ob=b.Ob,this.Lb=b.Lb,this.hd=b.hd.slice())}D(O,K);t=O.prototype;
t.add=function(a,b,c){this.Mb=Math.min(this.Mb,a);this.Jb=Math.max(this.Jb,a);this.Nb=Math.min(this.Nb,b);this.Kb=Math.max(this.Kb,b);this.Ob=Math.min(this.Ob,c);this.Lb=Math.max(this.Lb,c);this.hd=[(this.Mb+this.Jb)/2,(this.Nb+this.Kb)/2,(this.Ob+this.Lb)/2];this.d=n;this.G[this.v++]=a;this.G[this.v++]=b;this.G[this.v++]=c;return this.v/3};t.tc=function(){if(this.v!=this.G.length){var a=new Float32Array(this.v);a.set(this.G.subarray(0,this.v));this.G=a}};
t.get=function(a){a*=3;return[this.G[a],this.G[a+1],this.G[a+2]]};t.remove=function(){i(Error("Not implemented."))};t.clear=function(){this.G=new Float32Array(this.G.length);this.d=n};O.prototype.__defineGetter__("count",function(){this.tc();return this.G.length/3});O.prototype.__defineGetter__("length",function(){this.tc();return this.G.length});B("X.triplets",O);B("X.triplets.prototype.add",O.prototype.add);B("X.triplets.prototype.resize",O.prototype.tc);B("X.triplets.prototype.get",O.prototype.get);
B("X.triplets.prototype.remove",O.prototype.remove);B("X.triplets.prototype.clear",O.prototype.clear);function pd(){this.qa=qd;this.Sb=new md;this.Cb=[1,1,1];this.Rb=this.ga=this.T=this.h=this.g=q;this.Hc=[];this.Fa=n;this.hc=this.Ic=1;this.cc=q;this.Ac=r;this.R=1;this.Q=0}var qd="TRIANGLES";pd.prototype.__defineGetter__("texture",function(){this.ga||(this.ga=new od);return this.ga});pd.prototype.__defineGetter__("transform",s("Sb"));pd.prototype.__defineGetter__("points",s("g"));pd.prototype.__defineGetter__("normals",s("h"));pd.prototype.__defineGetter__("colors",s("T"));
pd.prototype.__defineGetter__("color",s("Cb"));pd.prototype.__defineSetter__("color",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Cb=a;this.d=n});pd.prototype.__defineGetter__("opacity",s("R"));pd.prototype.__defineSetter__("opacity",function(a){(!y(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.R=a;this.d=n});
pd.prototype.__defineGetter__("caption",s("cc"));pd.prototype.__defineSetter__("caption",function(a){this.cc=a;this.d=n});pd.prototype.__defineGetter__("visible",s("Fa"));pd.prototype.__defineSetter__("visible",function(a){for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Fa=a;this.d=n});pd.prototype.__defineGetter__("pointsize",s("Ic"));pd.prototype.__defineSetter__("pointsize",function(a){y(a)||i(Error("Invalid point size."));this.Ic=a;this.d=n});
pd.prototype.__defineGetter__("magicmode",s("Ac"));pd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Ac=a;this.d=n});pd.prototype.__defineGetter__("linewidth",s("hc"));pd.prototype.__defineSetter__("linewidth",function(a){y(a)||i(Error("Invalid line width."));this.hc=a;this.d=n});function rd(){this.na=Infinity;this.Z=this.ja=-Infinity;this.$=Infinity;this.tb=[0,0,0];this.rb=[1,1,1]}rd.prototype.__defineGetter__("lowerThreshold",s("Z"));rd.prototype.__defineSetter__("lowerThreshold",function(a){a>=this.na&&a<=this.ja&&(this.Z=a)});rd.prototype.__defineGetter__("upperThreshold",s("$"));rd.prototype.__defineSetter__("upperThreshold",function(a){a>=this.na&&a<=this.ja&&(this.$=a)});rd.prototype.__defineGetter__("min",s("na"));rd.prototype.__defineGetter__("max",s("ja"));
rd.prototype.__defineGetter__("minColor",s("tb"));rd.prototype.__defineSetter__("minColor",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid min. color."));this.tb=a});rd.prototype.__defineGetter__("maxColor",s("rb"));rd.prototype.__defineSetter__("maxColor",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid max. color."));this.rb=a});function sd(){K.call(this);this.c="scalars";this.wc=this.t=q;this.Af=n;Aa(this,new Pc);Aa(this,new rd);this.tb=[0,1,0];this.rb=[1,0,0]}D(sd,K);sd.prototype.__defineGetter__("array",s("t"));sd.prototype.__defineSetter__("array",function(a){this.wc=this.t=a;this.d=n});B("X.scalars",sd);function U(a){K.call(this);this.c="object";this.e=[];this.s=this.U=q;Aa(this,new pd);w(a)&&this.Tb(a)}D(U,K);
U.prototype.Tb=function(a){this.qa=a.qa;this.Sb=new md;this.Sb.A=new N(a.Sb.A.N);this.Cb=a.Cb.slice();a.g&&(this.g=new O(a.g.length,a.g));a.h&&(this.h=new O(a.h.length,a.h));a.T&&(this.T=new O(a.T.length,a.T));this.ga=a.ga;this.Rb=a.Rb;a.r&&(this.r=new Oc((new String(a.r.ke)).toString()));this.R=a.R;this.e.length=0;var b=a.e;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.e.push(new G[b[d].c](b[d]));this.Fa=a.Fa;this.Ic=a.Ic;this.hc=a.hc;a.cc&&(this.cc=(new String(a.cc)).toString());this.Ac=a.Ac;this.Hc=
a.Hc.slice();this.d=n};U.prototype.__defineGetter__("colortable",function(){this.U||(this.U=new Qc);return this.U});U.prototype.__defineGetter__("scalars",function(){this.s||(this.s=new sd);return this.s});U.prototype.__defineGetter__("children",s("e"));U.prototype.n=function(){var a=new td;a.W=this;this.dispatchEvent(a)};
function ud(a,b){(!w(a)||!w(b)||!(a instanceof U)||!(b instanceof U))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.R?-1:1==b.R?1:w(a.Q)&&w(b.Q)&&a.Q>b.Q?-1:1}B("X.object",U);B("X.object.prototype.modified",U.prototype.n);function vd(){}function wd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),j=a.h.get(d+1),k=a.h.get(d+2),m=a.Cb;a.T&&0<a.T.length&&(m=a.T.get(d));var o=[];o.push(new Hc(e,h));o.push(new Hc(f,j));o.push(new Hc(g,k));c.push(new Jc(o,m))}return Mc(c)}
function xd(a,b){(!w(b)||!(b instanceof Lc))&&i(Error("Invalid CSG object."));var c=new Nc,d=[];yb(b.w,function(a){for(var b=[],g=a.Vd,b=yb(a.hb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Kg=yb(c.unique(),function(a){return[a.va.x(),a.va.y(),a.va.b()]});a.Jg=yb(c.unique(),function(a){return[a.X.x(),a.X.y(),a.X.b()]});a.Ig=yb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});a.g=new O(9*d.length);a.h=new O(9*d.length);
a.T=new O(9*d.length);yb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Kg,j=this.Jg,k=this.Ig;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(j[b][0],j[b][1],j[b][2]);this.h.add(j[c][0],j[c][1],j[c][2]);this.h.add(j[a][0],j[a][1],j[a][2]);k[b]&&this.T.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.T.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.T.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.T.v&&(a.T=q);a.qa=qd}
vd.prototype.hf=function(a){(!w(a)||!(a instanceof Lc)&&!(a instanceof U))&&i(Error("Invalid object."));var b=a;a instanceof U&&(b=wd(b));a=new U;Aa(a,new vd);xd(a,wd(this).hf(b));return a};vd.prototype.gb=function(a){(!w(a)||!(a instanceof Lc)&&!(a instanceof U))&&i(Error("Invalid object."));var b=a;a instanceof U&&(b=wd(b));a=new U;Aa(a,new vd);xd(a,wd(this).gb(b));return a};
vd.prototype.Ke=function(a){(!w(a)||!(a instanceof Lc)&&!(a instanceof U))&&i(Error("Invalid object."));var b=a;a instanceof U&&(b=wd(b));a=new U;Aa(a,new vd);xd(a,wd(this).Ke(b));return a};vd.prototype.inverse=function(){var a=new U;Aa(a,new vd);xd(a,wd(this).inverse());return a};B("X.constructable",vd);B("X.constructable.prototype.intersect",vd.prototype.Ke);B("X.constructable.prototype.inverse",vd.prototype.inverse);B("X.constructable.prototype.subtract",vd.prototype.gb);
B("X.constructable.prototype.union",vd.prototype.hf);function yd(a){kc.call(this,a);this.c="event"}D(yd,kc);var zd=Fc("pan"),Ad=Fc("rotate"),Bd=Fc("zoom"),Cd=Fc("scroll");Fc("render");var Dd=Fc("resetview"),Ed=Fc("windowlevel"),Bc=Fc("modified"),Fd=Fc("progress"),Gd=Fc("hover"),Hd=Fc("hover_end");function Id(){yd.call(this,Ed);this.ee=this.re=0}D(Id,yd);function Jd(){yd.call(this,zd);this.Q=new Xc(0,0)}D(Jd,yd);function Kd(){yd.call(this,Ad);this.Q=new Xc(0,0)}D(Kd,yd);function Ld(){yd.call(this,Bd);this.jb=this.Hb=r}D(Ld,yd);
function Md(){yd.call(this,Cd);this.H=r}D(Md,yd);function Nd(){yd.call(this,Gd);this.zd=this.yd=0}D(Nd,yd);function Od(){yd.call(this,Hd)}D(Od,yd);function Pd(){yd.call(this,Dd)}D(Pd,yd);function td(){yd.call(this,Bc);this.q=this.W=q}D(td,yd);function Qd(){yd.call(this,Fd);this.Bf=0}D(Qd,yd);function V(){K.call(this);this.c="parser";this.Y=q;this.v=0;this.Ng=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.md=n}D(V,K);V.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Rd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function W(a,b,c){w(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.Y.slice(a.v,a.v+=c*d));if(a.Ng!=a.md){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Sd(a,b,c){G.Ea(a.c+".reslice");for(var d=b.V,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],j=b.z!=q,k=h*d,m=Array(g),o=0;o<g;o++){m[o]=Array(h);for(var v=0;v<h;v++)m[o][v]=new c.data.constructor(d)}for(var p=0,c=c=0;c<g;c++){for(var o=f.subarray(c*k,(c+1)*k),v=new Uint8Array(4*k),x=0,u=0,C=0,x=0;x<h;x++)for(u=0;u<d;u++){var p=o[C],E=0,z=0,F=0,A=0;b.U?((A=b.U.ia.get(Math.floor(p)))||(A=b.U.ia.get(b.U.ia.sa()-1)),E=255*A[1],z=255*A[2],F=255*A[3],A=255*A[4]):(E=z=F=255*(p/e),A=255);var I=4*C;v[I]=E;
v[++I]=z;v[++I]=F;v[++I]=A;m[c][x][u]=p;C++}p=new od;p.Ya=v;p.rd=d;p.qd=h;o=b.ab.e[c];o.ga=p;j&&(o.z=b.z.ab.e[c].ga)}for(x=0;x<h;x++){v=new Uint8Array(4*g*d);for(c=C=0;c<g;c++)for(u=0;u<d;u++)p=m[c][x][u],b.U?((A=b.U.ia.get(Math.floor(p)))||(A=b.U.ia.get(b.U.ia.sa()-1)),E=255*A[1],z=255*A[2],F=255*A[3],A=255*A[4]):(E=z=F=255*(p/e),A=255),I=4*C,v[I]=E,v[++I]=z,v[++I]=F,v[++I]=A,C++;p=new od;p.Ya=v;p.rd=d;p.qd=g;o=b.$a.e[x];o.ga=p;j&&(o.z=b.z.$a.e[x].ga)}for(u=0;u<d;u++){v=new Uint8Array(4*g*h);for(c=
C=0;c<g;c++)for(x=0;x<h;x++)p=m[c][x][u],b.U?((A=b.U.ia.get(Math.floor(p)))||(A=b.U.ia.get(b.U.ia.sa()-1)),E=255*A[1],z=255*A[2],F=255*A[3],A=255*A[4]):(E=z=F=255*(p/e),A=255),I=4*C,v[I]=E,v[++I]=z,v[++I]=F,v[++I]=A,C++;p=new od;p.Ya=v;p.rd=h;p.qd=g;o=b.Za.e[u];o.ga=p;j&&(o.z=b.z.Za.e[u].ga)}G.za(a.c+".reslice");return m};function Td(){V.call(this);this.c="parserLBL"}D(Td,V);
Td.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");var d=b.Hc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.Y=c;for(var f=[],g=W(this,"uchar",c.byteLength),h=g.length,j=r,k=0,c=1;c<h;c++)10==g[c-1]?(k=c,j=n):j&&32==g[c]&&(j=parseInt(String.fromCharCode.apply(q,g.subarray(k,c)),10),f.push(j),j=r);g=b.s.t?b.s.t:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)k=d[c],k>e&&i(Error("Could not find scalar for vertex.")),
k=g[k],f[h++]=k,f[h++]=k,f[h++]=k;b.s.t=g;b.s.wc=f;b.s.d=n;G.za(this.c+".parse");d=new td;d.W=b;d.q=a;this.dispatchEvent(d)};B("X.parserLBL",Td);B("X.parserLBL.prototype.parse",Td.prototype.parse);function Wd(a){this.o=a;this.ag=J(this.o,Va?"DOMMouseScroll":"mousewheel",this)}D(Wd,Gc);
Wd.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ra;if("mousewheel"==a.type){c=1;if(H||Wa&&(Oa||mb("532.0")))c=40;d=Wa&&Na&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ha(a.wheelDeltaX)?(b=Wa&&Na&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Wa&&Na&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ha(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;y(this.cg)&&Math.min(Math.max(b,-this.cg),this.cg);y(this.dg)&&(c=Math.min(Math.max(c,
-this.dg),this.dg));b=new Xd(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Ia()}};Wd.prototype.K=function(){Wd.i.K.call(this);vc(this.ag);delete this.ag};function Xd(a,b,c,d){b&&this.ha(b,l);this.type="mousewheel";this.detail=a;this.lc=d}D(Xd,mc);H||Wa&&mb("525");var Yd;function Zd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Hb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=wb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var $d=!H||pb(9);!Va&&!H||H&&pb(9)||Va&&mb("1.9.1");H&&mb("9");function ae(a){return a?new be(ce(a)):Yd||(Yd=new be)}function de(a){return ka(a)?document.getElementById(a):a}function ee(a,b){qb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in fe?a.setAttribute(fe[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var fe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function ge(a,b,c){return he(document,arguments)}
function he(a,b){var c=b[0],d=b[1];if(!$d&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ba(d.name),'"');if(d.type){c.push(' type="',Ba(d.type),'"');var e={};ub(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ka(d)?c.className=d:ia(d)?Zd.apply(q,[c].concat(d)):ee(c,d));2<b.length&&ie(a,c,b);return c}
function ie(a,b,c){function d(c){c&&b.appendChild(ka(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ja(f)&&!(ma(f)&&0<f.nodeType)?xb(je(f)?Gb(f):f,d):d(f)}}function ke(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function le(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function me(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ce(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function je(a){if(a&&"number"==typeof a.length){if(ma(a))return"function"==typeof a.item||"string"==typeof a.item;if(la(a))return"function"==typeof a.item}return r}function be(a){this.L=a||ea.document||document}t=be.prototype;
t.Gd=ae;t.j=function(a){return ka(a)?this.L.getElementById(a):a};t.jc=function(a,b,c){return he(this.L,arguments)};t.createElement=function(a){return this.L.createElement(a)};t.createTextNode=function(a){return this.L.createTextNode(a)};function ne(a){return"CSS1Compat"==a.L.compatMode}function oe(a){var b=a.L,a=!Wa&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Vc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}t.appendChild=function(a,b){a.appendChild(b)};
t.contains=me;function Y(a){(!w(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));K.call(this);this.c="interactor";this.dc=a;this.ge=this.uf=this.tf=this.vf=this.sf=this.wf=q;this.fe=n;this.wb=this.sb=this.Va=r;this.pd=[0,0];this.ae=new Xc(0,0);this.P={MOUSEWHEEL_ENABLED:n,MOUSECLICKS_ENABLED:n,KEYBOARD_ENABLED:n,HOVERING_ENABLED:n,CONTEXTMENU_ENABLED:r}}D(Y,K);Y.prototype.__defineGetter__("config",s("P"));Y.prototype.__defineGetter__("leftButtonDown",s("Va"));
Y.prototype.__defineGetter__("middleButtonDown",s("sb"));Y.prototype.__defineGetter__("rightButtonDown",s("wb"));
Y.prototype.ha=function(){this.P.MOUSEWHEEL_ENABLED?(this.ge=new Wd(this.dc),this.wf=J(this.ge,"mousewheel",this.Zc.bind(this))):(vc(this.wf),this.ge=q);this.P.MOUSECLICKS_ENABLED?(this.sf=J(this.dc,"mousedown",this.Kh.bind(this)),this.vf=J(this.dc,"mouseup",this.Ph.bind(this))):(vc(this.sf),vc(this.vf));this.dc.oncontextmenu=this.P.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.P.KEYBOARD_ENABLED?this.ig.bind(this):q;vc(this.tf);vc(this.uf);this.tf=J(this.dc,"mousemove",this.Mh.bind(this));
this.uf=J(this.dc,"mouseout",this.Nh.bind(this))};Y.prototype.Kh=function(a){0==a.button?this.Va=n:1==a.button?this.sb=n:2==a.button&&(this.wb=n);eval("this.onMouseDown("+this.Va+","+this.sb+","+this.wb+")");pe(this);a.preventDefault()};Y.prototype.Jh=ca();Y.prototype.Ph=function(a){0==a.button?this.Va=r:1==a.button?this.sb=r:2==a.button&&(this.wb=r);eval("this.onMouseUp("+this.Va+","+this.sb+","+this.wb+")");pe(this);a.preventDefault()};Y.prototype.__defineGetter__("mousePosition",s("pd"));t=Y.prototype;
t.Oh=ca();t.Nh=function(a){this.fe=r;this.P.KEYBOARD_ENABLED&&(window.onkeydown=q);this.wb=this.sb=this.Va=r;pe(this);this.ae=new Xc(0,0);a.preventDefault()};t.Lh=ca();
t.Mh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.fe=n;this.P.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.ig.bind(this));a.preventDefault();var b=a.shiftKey;this.pd=[a.offsetX,a.offsetY];var c=new Xc(this.pd[0],this.pd[1]),a=this.ae.gb(c);this.ae=c.f();this.P.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.sb||this.Va||this.wb)&&pe(this),this.He=setTimeout(function(){pe(this);var a=new Nd;a.yd=c.x;a.zd=c.y;this.dispatchEvent(a);
this.He=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.Yb()&&(this.Va&&!b?(b=new Kd,b.Q=a,this.dispatchEvent(b)):this.sb||this.Va&&b?(b=new Jd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.Q=a,this.dispatchEvent(b)):this.wb&&(b=new Ld,b.Hb=0<a.y,b.jb=r,this.dispatchEvent(b)))};function pe(a){a.He&&clearTimeout(a.He);a.dispatchEvent(new Od)}t.Qh=ca();t.Zc=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");pe(this);a.preventDefault()};
t.Hh=ca();
t.ig=function(a){if(this.fe){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");pe(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Pd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Jd:b?a=new Ld:(a=new Kd,this instanceof qe&&(a=new Md)),a&&(c=new Xc(0,0),37==f?(c.x=5,a.H=r,b&&(a.H=n,a.Hb=n,a.jb=r)):39==f?(c.x=-5,a.H=n,b&&(a.Hb=r,a.jb=r)):38==f?(c.y=5,a.H=n,b&&(a.Hb=n,a.jb=n)):40==f&&(c.y=-5,a.H=r,b&&(a.Hb=r,
a.jb=n)),a.Q=c,this.dispatchEvent(a)))}};B("X.interactor",Y);B("X.interactor.prototype.init",Y.prototype.ha);B("X.interactor.prototype.onMouseDown",Y.prototype.Jh);B("X.interactor.prototype.onMouseUp",Y.prototype.Oh);B("X.interactor.prototype.onMouseMove",Y.prototype.Lh);B("X.interactor.prototype.onMouseWheel",Y.prototype.Qh);B("X.interactor.prototype.onKey",Y.prototype.Hh);function qe(a){Y.call(this,a);this.c="interactor2D"}D(qe,Y);qe.prototype.Zc=function(a){qe.i.Zc.call(this,a);var b=new Md;w(a.lc)||(a.lc=0);b.H=0>a.lc;this.dispatchEvent(b)};function re(a){U.call(this);this.c="slice";this.l=[0,0,0];this.fc=[0,0,1];this.H=[0,1,0];this.D=this.I=10;this.Rb=[0,1,0,0,1,1,1,1,1,0,0,0];this.z=this.cb=q;this.Na=n;this.bc=[1,1,1];w(a)&&this.Tb(a)}D(re,U);re.prototype.Tb=function(a){this.l=a.l.slice();this.fc=a.fc.slice();this.H=a.H.slice();this.I=a.I;this.D=a.D;this.cb=a.cb;this.z=a.z;this.Na=a.Na;this.bc=a.bc;this.Mg=a.Mg;re.i.Tb.call(this,a)};
re.prototype.kc=function(){var a=new M(this.fc[0],this.fc[1],this.fc[2]),b=new M(this.H[0],this.H[1],this.H[2]),c=Uc(b,a),d=new M(this.l[0],this.l[1],this.l[2]),e=new M(1,1,1);1==a.x?(e=new M(this.l[0],this.D/2,this.I/2),this.Rb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new M(this.I/2,this.l[1],this.D/2),this.Rb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new M(this.I/2,this.D/2,this.l[2]));var f=Tc(c.f().S(),b.f().S()),f=new M(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Tc(c.f().S(),b),g=new M(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Tc(c,b.f().S()),h=new M(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Tc(c,b),b=new M(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new O(18);this.h=new O(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(j.x,j.y,j.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Na&&(a=new U,a.g=new O(24),a.h=
new O(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Cb=[this.bc[0],this.bc[1],this.bc[2]],a.qa="LINES",a.hc=2,this.e.push(a))};B("X.slice",re);function L(a){U.call(this);this.c="volume";this.l=[0,0,0];this.V=[10,10,10];this.F=[1,1,1];this.lb=[];this.zc=this.ob=this.yc=this.nb=this.xc=this.mb=0;this.Za=new U;this.$a=new U;this.ab=new U;this.xd=this.Ga=r;this.xb=0;this.z=q;this.Na=n;this.ba=Infinity;this.aa=-Infinity;Aa(this,new Pc);Aa(this,new rd);w(a)&&this.Tb(a)}D(L,U);
L.prototype.Tb=function(a){window.console.log(a);this.l=a.l.slice();this.V=a.V.slice();this.F=a.F.slice();this.mb=a.mb;this.xc=a.xc;this.nb=a.nb;this.yc=a.yc;this.ob=a.ob;this.zc=a.zc;this.Za=new U(a.Za);this.$a=new U(a.$a);this.ab=new U(a.ab);this.Ga=a.Ga;this.xd=a.xd;this.xb=a.xb;this.z=a.z;this.Na=a.Na;L.i.Tb.call(this,a)};
L.prototype.kc=function(){this.e.length=0;this.Za.e.length=0;this.$a.e.length=0;this.ab.e.length=0;this.e.push(this.Za);this.e.push(this.$a);this.e.push(this.ab);for(var a=0,a=0;3>a;a++){for(var b=(this.V[a]-1)/2,c=b,d=0,d=0;d<this.V[a];d++){var e=-b*this.F[a]+d*this.F[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.e[a].e,g=0,h=0,j=[1,1,1],k=this.Na;0==a?(g=this.V[2]*this.F[2]-this.F[2],h=this.V[1]*this.F[1]-this.F[1],j=[1,1,0]):
1==a?(g=this.V[0]*this.F[0]-this.F[0],h=this.V[2]*this.F[2]-this.F[2],j=[1,0,0]):2==a&&(g=this.V[0]*this.F[0]-this.F[0],h=this.V[1]*this.F[1]-this.F[1],j=[0,1,0]);w(this.cb)&&(k=r);var m=new re,o=m,f=f[a],v=[[1,0,0],[0,1,0],[0,0,1]][a],p=[[0,1,0],[0,0,-1],[0,1,0]][a];(!w(f)||!(f instanceof Array)||3!=f.length)&&i(Error("Invalid center."));(!w(v)||!(v instanceof Array)||3!=v.length)&&i(Error("Invalid front direction."));(!w(p)||!(p instanceof Array)||3!=p.length)&&i(Error("Invalid up direction."));
y(g)||i(Error("Invalid width."));y(h)||i(Error("Invalid height."));var x=r;w(k)&&(x=k);k=[1,1,1];w(j)&&(k=j);o.l=f;o.fc=v;o.H=p;o.I=g;o.D=h;o.Na=x;o.bc=k;o.kc();m.cb=this;m.visible=d==Math.floor(c);e.push(m)}0==a?this.xc=this.mb=c:1==a?this.yc=this.nb=c:2==a&&(this.zc=this.ob=c)}this.d=n};
L.prototype.n=function(a){a="undefined"!==typeof a?a:n;if(0<this.e.length)if(this.Ga!=this.xd&&(this.Ga?(this.e[0].e[parseInt(this.mb,10)].visible=r,this.e[1].e[parseInt(this.nb,10)].visible=r,this.e[2].e[parseInt(this.ob,10)].visible=r):this.e[this.xb].visible=r,this.d=n,this.xd=this.Ga),this.Ga)se(this,this.xb);else for(var b=0,b=0;3>b;b++){var c=this.e[b],d=0,e=0;0==b?(d=this.mb,e=this.xc,this.xc=this.mb):1==b?(d=this.nb,e=this.yc,this.yc=this.nb):2==b&&(d=this.ob,e=this.zc,this.zc=this.ob);c.e[parseInt(e,
10)].visible=r;c=c.e[parseInt(d,10)];c.visible=n;c.R=1}a&&L.i.n.call(this)};L.prototype.__defineGetter__("dimensions",s("V"));L.prototype.__defineGetter__("volumeRendering",s("Ga"));L.prototype.__defineSetter__("volumeRendering",function(a){this.Ga=a;this.n(r)});L.prototype.__defineSetter__("visible",da("Fa"));L.prototype.__defineGetter__("center",s("l"));L.prototype.__defineSetter__("center",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
L.prototype.__defineGetter__("image",s("lb"));L.prototype.__defineGetter__("labelmap",function(){this.z||(this.z=new te(this));return this.z});L.prototype.__defineGetter__("indexX",s("mb"));L.prototype.__defineSetter__("indexX",function(a){y(a)&&0<=a&&a<this.Za.e.length&&(this.mb=a,this.n(r))});L.prototype.__defineGetter__("indexY",s("nb"));L.prototype.__defineSetter__("indexY",function(a){y(a)&&0<=a&&a<this.$a.e.length&&(this.nb=a,this.n(r))});L.prototype.__defineGetter__("indexZ",s("ob"));
L.prototype.__defineSetter__("indexZ",function(a){y(a)&&0<=a&&a<this.ab.e.length&&(this.ob=a,this.n(r))});L.prototype.__defineGetter__("windowLow",s("ba"));L.prototype.__defineSetter__("windowLow",da("ba"));L.prototype.__defineGetter__("windowHigh",s("aa"));L.prototype.__defineSetter__("windowHigh",da("aa"));L.prototype.__defineGetter__("borders",s("Na"));L.prototype.__defineSetter__("borders",da("Na"));
function se(a,b){if(a.Ga&&(a.d||b!=a.xb)){var c=a.e[a.xb];c.visible=r;var c=a.e[b],d=c.e.length,e;for(e=0;e<d;e++)c.e[e].Fa=n;a.xb=b;a.d=r}}B("X.volume",L);B("X.volume.prototype.modified",L.prototype.n);function ue(){V.call(this);this.c="parserSTL"}D(ue,V);
ue.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");this.Y=c;var d=b.g,e=b.h;if("solid"==String.fromCharCode.apply(q,W(this,"uchar",5))){b.g=d=new O(c.byteLength);b.h=e=new O(c.byteLength);var f=d,d=e,e=W(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,j=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var m=String.fromCharCode.apply(q,e.subarray(j,k)).split(" "),h=parseFloat(m[0]),o=parseFloat(m[1]),m=parseFloat(m[2]);g?(d.add(h,o,m),d.add(h,o,m),d.add(h,o,m)):f.add(h,o,m);h=g=r}}else 32==e[k-1]&&
(102==e[k]?(j=k+=13,g=n):118==e[k]&&(j=k+=7,h=n))}else{this.v=80;f=W(this,"uint");b.g=d=new O(9*f);b.h=e=new O(9*f);for(c=c=0;c<f;c++)g=W(this,"float",12),j=g[0],k=g[1],h=g[2],e.add(j,k,h),e.add(j,k,h),e.add(j,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.v+=2}G.za(this.c+".parse");f=new td;f.W=b;f.q=a;this.dispatchEvent(f)};B("X.parserSTL",ue);B("X.parserSTL.prototype.parse",ue.prototype.parse);function we(a){function b(){zc+=8;return eb<sa.length?sa[eb++]:-1}function c(){var a;zc++;a=Fa&1;Fa>>=1;0==Fa&&(Fa=b(),a=Fa&1,Fa=Fa>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=S[b]>>8-a);return b}function e(a){z[F++]=a;if(I==x-1){var b=new Uint8Array(2*x);b.set(p);p=b;x*=2}p[I++]=a;32768==F&&(F=0)}function f(){this.Bd=this.Ad=0;this.Le=q}function g(){for(;;){if(fb[xa]>=fd)return-1;if(gd[fb[xa]]==xa)return fb[xa]++;fb[xa]++}}function h(){var a=Ac[Db],b;if(17==xa)return-1;Db++;
xa++;b=g();if(0<=b)a.Ad=b;else if(a.Ad=32768,h())return-1;b=g();if(0<=b)a.Bd=b,a.Le=q;else if(a.Bd=32768,a.Le=Ac[Db],a.Aj=Db,h())return-1;xa--;return 0}function j(a,b,c){Ac=a;Db=0;gd=c;fd=b;for(a=0;17>a;a++)fb[a]=0;xa=0;return h()?-1:0}function k(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Bd&32768))return f.Bd;f=f.Le;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Ad&32768))return f.Ad;e++;f=a[e]}}function m(){var a,g,h,m,o;do if(a=c(),h=d(2),0==h){Fa=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=S[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;o=d(Q[h])+T[h];h=S[d(5)]>>3;8<$[h]?(p=d(8),p|=d($[h]-8)<<8):p=d($[h]);p+=ba[h];for(h=0;h<o;h++)g=z[F-p&32767],e(g)}else if(2==h){var u=Array(320);g=257+d(5);p=1+d(5);m=4+d(4);for(h=0;19>h;h++)u[h]=0;for(h=0;h<m;h++)u[aa[h]]=d(3);o=gb.length;for(m=0;m<o;m++)gb[m]=new f;if(j(gb,19,u)){F=0;return}o=g+p;m=0;for(var v=-1;m<o;)if(v++,h=
k(gb),16>h)u[m++]=h;else if(16==h){var x;h=3+d(2);if(m+h>o){F=0;return}for(x=m?u[m-1]:0;h--;)u[m++]=x}else{h=17==h?3+d(3):11+d(7);if(m+h>o){F=0;return}for(;h--;)u[m++]=0}o=Fb.length;for(m=0;m<o;m++)Fb[m]=new f;if(j(Fb,g,u)){F=0;return}o=Fb.length;for(m=0;m<o;m++)gb[m]=new f;h=[];for(m=g;m<u.length;m++)h[m-g]=u[m];if(j(gb,p,h)){F=0;return}for(;;)if(h=k(Fb),256<=h){h-=256;if(0==h)break;h--;o=d(Q[h])+T[h];h=k(gb);8<$[h]?(p=d(8),p|=d($[h]-8)<<8):p=d($[h]);for(p+=ba[h];o--;)g=z[F-p&32767],e(g)}else e(h)}while(!a);
F=0;Fa=1}function o(){var a=[],c;u&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());A&&v(sa.byteLength);a[0]=b();if(8==a[0]){u=b();b();b();b();b();b();b();if(u&4){a[0]=b();a[2]=b();xa=a[0]+256*a[1];for(a=0;a<xa;a++)b()}if(u&8){a=0;for(nb=[];c=b();){if("7"==c||":"==c)a=0;a<hd-1&&(nb[a++]=c)}}if(u&16)for(;b(););u&2&&(b(),b());m();b();b();b();b();b();b();b();b();A&&v(sa.byteLength)}}function v(a){x=a;p=new Uint8Array(a);
a=[];A=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(m(),E[C]=Array(2),E[C][0]=p,E[C][1]="geonext.gxt",C++);31==a[0]&&139==a[1]&&(o(),E[C]=Array(2),E[C][0]=p,E[C][1]="file",C++);if(80==a[0]&&75==a[1]&&(A=n,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u=b();u|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(nb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<hd-1&&(nb[e++]=String.fromCharCode(f))}id||(id=nb);for(e=0;e<
d;)b(),e++;I=0;8==a&&(m(),E[C]=Array(2),E[C][0]=p,E[C][1]=nb.join(""),C++);o()}}var p=q,x=0,u,C=0,E=[],z=Array(32768),F=0,A=r,I=0,S=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ba=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],sa=a,eb=0,Fa=1,zc=0,hd=256,nb=[],id,Fb=Array(288),gb=Array(32),
Db=0,Ac=q,xa=0,fb=Array(17);fb[0]=0;var gd,fd;we.prototype.jf=function(){v(sa.byteLength);return p}};function xe(){V.call(this);this.c="parserDCM"}D(xe,V);xe.prototype.parse=function(a,b,c){c=this.$c(c,b);if(c.Md==c.Sa){var d=c.df.length,e,f=0;for(e=0;e<d;e++){var g=c.df[e];g!==l&&(g*=c.ib,g=c.Pc.subarray(g,g+c.ib),c.data.set(g,f*c.ib),f++)}b.V=[c.ra[0],c.ra[1],c.ra[2]];b.F=[c.eb[0],c.eb[1],c.eb[2]];e=Rd(c.data);d=e[0];e=e[1];c.min=b.na=b.ba=d;c.max=b.ja=b.aa=e;-Infinity==b.Z&&(b.Z=d);Infinity==b.$&&(b.$=e);b.kc();b.lb=Sd(this,b,c)}c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};
xe.prototype.$c=function(a,b){this.Y=a;if(w(b.ac)){d=b.ac;f=d.Xf;h=d.Wf;this.v=2*f;var c=W(this,"uchar",h),c=parseInt(String.fromCharCode.apply(q,c),10);d.ra[2]++}else{var d={rows:0,cols:0,eb:q,te:0,Sg:0,Sa:1,Fh:1,Xf:0,Wf:0,Md:0,ib:0,Pc:q,Ze:0,df:[],data:q,min:Infinity,max:-Infinity};d.Sa=b.r.length;w(d.Sa)||(d.Sa=1);for(var e=W(this,"ushort",this.Y.byteLength),f=66,g=h=q,h=q,c="",j=7;0<j;)if(h=e[f++],40==h)switch(g=e[f++],f++,h=e[f++],g){case 16:d.rows=e[f++];j--;break;case 17:d.cols=e[f++];j--;
break;case 256:d.te=e[f++];j--;break;case 257:d.Sg=e[f++];j--;break;case 2:d.Fh=e[f++];j--;break;case 48:for(var g="",k=0,k=0;k<h/2;k++)var m=e[f++],o=m&255,m=(m&65280)>>8,g=g+String.fromCharCode(o),g=g+String.fromCharCode(m);g=g.split("\\");d.eb=[parseInt(g[0],10),parseInt(g[1],10),1];j--}else if(32==h&&(g=e[f++],19==g)){f++;h=e[f++];d.Xf=f;d.Wf=h;for(k=0;k<h/2;k++)m=e[f++],o=m&255,m=(m&65280)>>8,c+=String.fromCharCode(o),c+=String.fromCharCode(m),c=parseInt(c,10);j--}b.ac=d;d.ra=[d.cols,d.rows,
1];d.ib=d.rows*d.cols;switch(d.te){case 8:d.Pc=new Uint8Array(d.cols*d.rows*d.Sa);d.data=new Uint8Array(d.cols*d.rows*d.Sa);break;case 16:d.Pc=new Uint16Array(d.cols*d.rows*d.Sa);d.data=new Uint16Array(d.cols*d.rows*d.Sa);break;case 32:d.Pc=new Uint32Array(d.cols*d.rows*d.Sa),d.data=new Uint32Array(d.cols*d.rows*d.Sa)}}this.v=this.Y.byteLength-2*d.ib;e=q;switch(d.te){case 8:e=W(this,"uchar",d.ib);break;case 16:e=W(this,"ushort",d.ib);break;case 32:e=W(this,"uint",d.ib)}d.df[c]=d.Ze;d.Pc.set(e,d.Ze*
d.ib);d.Ze++;++d.Md;return d};B("X.parserDCM",xe);B("X.parserDCM.prototype.parse",xe.prototype.parse);function ye(){V.call(this);this.c="parserVTK"}D(ye,V);
ye.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new O(c.byteLength);b.h=e=new O(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=String.fromCharCode.apply(q,f.subarray(c,Math.min(c+32768,h)));f=g.split("\n");g=f.length;this.Lc=this.Mc=q;this.Fb=[];this.oa=qd;this.ie=this.ub=this.kb=this.vb=r;c=0;for(h=g%8;h--;)ze(this,f[c]),c++;for(h=0.125*g^0;h--;)ze(this,f[c]),c++,ze(this,f[c]),c++,ze(this,f[c]),c++,ze(this,f[c]),c++,ze(this,f[c]),c++,
ze(this,f[c]),c++,ze(this,f[c]),c++,ze(this,f[c]),c++;var c=this.Mc,f=this.Lc,g=f.length,j=h=this.Fb.length;do{var k=this.Fb[h-j],m=k.length,o;for(o=0;o<m&&!("LINES"==this.oa&&o+1>=m);o++){var v=parseInt(k[o],10),p=c.get(v);d.add(p[0],p[1],p[2]);var x=v,u=p;"LINES"==this.oa?(x=parseInt(k[o+1],10),u=c.get(x),d.add(u[0],u[1],u[2])):"TRIANGLE_STRIPS"==this.oa&&(0==o||o==m-1)&&d.add(p[0],p[1],p[2]);v<g?(u=f.get(v),e.add(u[0],u[1],u[2]),"LINES"==this.oa?(x=f.get(x),e.add(x[0],x[1],x[2])):"TRIANGLE_STRIPS"==
this.oa&&(0==o||o==m-1)&&e.add(u[0],u[1],u[2])):(x=new M(p[0],p[1],p[2]),x.normalize(),e.add(x.x,x.y,x.b),"LINES"==this.oa?(x=new M(u[0],u[1],u[2]),x.normalize(),e.add(x.x,x.y,x.b)):"TRIANGLE_STRIPS"==this.oa&&(0==o||o==m-1)&&e.add(x.x,x.y,x.b))}j--}while(0<j);b.qa=this.oa;G.za(this.c+".parse");d=new td;d.W=b;d.q=a;this.dispatchEvent(d)};
function ze(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.vb=n;a.kb=r;a.ub=r;c=parseInt(c[1],10);a.Mc=new O(3*c);a.Lc=new O(3*c);return;case "VERTICES":a.kb=n;a.vb=r;a.ub=r;c=parseInt(c[1],10);3<=c?a.oa=qd:1==c?a.oa="POINTS":i(Error("This VTK file is not supported!"));a.Fb=[];return;case "TRIANGLE_STRIPS":a.kb=n;a.vb=r;a.ub=r;a.oa="TRIANGLE_STRIPS";a.Fb=[];return;case "LINES":a.kb=n;a.vb=r;a.ub=r;a.oa="LINES";a.Fb=[];return;case "POLYGONS":a.kb=n;
a.vb=r;a.ub=r;a.oa="POLYGONS";a.Fb=[];return;case "POINT_DATA":a.ub=n;a.vb=r;a.kb=r;return}if(a.vb)if(1==d||isNaN(parseFloat(e)))a.vb=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Mc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Mc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Mc.add(d,e,c))}else a.kb?1==d||isNaN(parseFloat(e))?a.kb=r:a.Fb.push(c.slice(1)):a.ub&&("NORMALS"==e?a.ie=n:1==d||isNaN(parseFloat(e))?
(a.ub=r,a.ie=r):a.ie&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Lc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Lc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Lc.add(d,e,c))))}B("X.parserVTK",ye);B("X.parserVTK.prototype.parse",ye.prototype.parse);function Ae(){V.call(this);this.c="parserFSM";this.md=r}D(Ae,V);
Ae.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");this.Y=c;var d=b.g,e=b.h,f=b.Hc,c=0,g;do g=W(this,"uchar"),c++;while(200>c&&10!=g);W(this,"uchar");var e=W(this,"uint"),c=W(this,"uint"),h=W(this,"float",3*e);g=W(this,"uint",3*c);var j=new Uint32Array(e),k=new Float32Array(9*c);b.g=d=new O(9*c);b.h=e=new O(9*c);var m;for(m=0;m<c;m++){var o=3*m,v=g[o],p=g[o+1],x=g[o+2];f.push(v);f.push(p);f.push(x);j[v]+=1;j[p]+=1;j[x]+=1;var o=3*v,u=3*p,C=3*x,E=h[o],z=h[o+1],F=h[o+2],p=h[u],x=h[u+1],v=h[u+
2],A=h[C],I=h[C+1],S=h[C+2];d.add(E,z,F);d.add(p,x,v);d.add(A,I,S);E=new M(E,z,F);A=new M(A,I,S);p=(new M(p,x,v)).f().gb(E);x=A.f().gb(E);p=Uc(p,x).normalize();k[o]+=p.x;k[o+1]+=p.y;k[o+2]+=p.b;k[u]+=p.x;k[u+1]+=p.y;k[u+2]+=p.b;k[C]+=p.x;k[C+1]+=p.y;k[C+2]+=p.b}for(m=0;m<c;m++)o=3*m,v=g[o],p=g[o+1],x=g[o+2],o=3*v,u=3*p,C=3*x,f=new M(k[u],k[u+1],k[u+2]),h=new M(k[C],k[C+1],k[C+2]),o=(new M(k[o],k[o+1],k[o+2])).scale(1/j[v]).normalize(),f=f.scale(1/j[p]).normalize(),h=h.scale(1/j[x]).normalize(),e.add(o.x,
o.y,o.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.qa=qd;G.za(this.c+".parse");c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};B("X.parserFSM",Ae);B("X.parserFSM.prototype.parse",Ae.prototype.parse);function Be(){V.call(this);this.c="parserMGZ";this.md=r}D(Be,V);Be.prototype.parse=function(a,b,c,d){G.Ea(this.c+".parse");var e=c;d&&(e=(new we(new Uint8Array(c))).jf(),e=e.buffer);c=this.$c(e);b.V=[c.Pe,c.Qe,c.Re];b.F=c.Ag;d=c.min;e=c.max;b.na=b.ba=d;b.ja=b.aa=e;-Infinity==b.Z&&(b.Z=d);Infinity==b.$&&(b.$=e);b.kc();G.za(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};
Be.prototype.$c=function(a){this.Y=a;a={version:0,Hg:0,Fg:0,jh:0,Gg:0,Pe:0,Qe:0,Re:0,Eh:0,type:0,bh:0,rg:0,Ri:q,Eg:q,Ag:q,data:q,min:Infinity,max:-Infinity};a.version=W(this,"uint");a.Pe=W(this,"uint");a.Qe=W(this,"uint");a.Re=W(this,"uint");a.Eh=W(this,"uint");a.type=W(this,"uint");a.bh=W(this,"uint");a.rg=W(this,"ushort");if(0<a.rg){a.Ag=W(this,"float",3);var b=[];b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));a.Eg=b}this.v=284;b=a.Pe*a.Qe*
a.Re;switch(a.type){case 0:a.data=W(this,"uchar",b);break;case 1:a.data=W(this,"uint",b);break;case 3:a.data=W(this,"float",b);break;case 4:a.data=W(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Rd(a.data);a.min=b[0];a.max=b[1];this.v+16<this.Y.byteLength&&(a.Hg=W(this,"float"),a.jh=W(this,"float"),a.Fg=W(this,"float"),a.Gg=W(this,"float"));return a};B("X.parserMGZ",Be);B("X.parserMGZ.prototype.parse",Be.prototype.parse);function Ce(){V.call(this);this.c="parserCRV";this.md=r}D(Ce,V);
Ce.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");var d=b.Hc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.Y=c;this.v=3;var e=W(this,"uint");W(this,"uint");W(this,"uint");var f=0,g=0,h=0,j=0,k=0,m=0,o=0,v=0,p=0,x=0,u=0,c=Array(2),C=Array(2),E=W(this,"float",e),z;for(z=0;z<e;z++){var F=E[z];0==z&&(c[0]=C[0]=F);0<=F?(f++,j+=F):(g++,h+=F);p+=F;u++;C[0]=Math.max(F,C[0]);c[0]=Math.min(F,c[0]);E[z]=F}0!=f&&(k=j/f);0!=g&&(m=h/g);0!=u&&(x=p/u);for(u=p=h=j=0;u<e;u++)F=E[u],
z=0,0<=F?(z=Math.pow(F-k,2),j+=z):(z=Math.pow(F-m,2),h+=z),z=Math.pow(F-x,2),p+=z;1<f&&(o=Math.sqrt(j/(f-1)));1<g&&(v=Math.sqrt(h/(g-1)));c[1]=m-2.5*v;C[1]=k+2.5*o;e=d.length;f=new Float32Array(3*e);for(u=0;u<e;u++)g=E[d[u]],h=3*u,f[h]=g,f[h+1]=g,f[h+2]=g;b.s.na=c[1];b.s.ja=C[1];-Infinity==b.s.Z&&(b.s.Z=c[1]);Infinity==b.s.$&&(b.s.$=C[1]);b.s.t=E;b.s.wc=f;b.s.d=n;G.za(this.c+".parse");d=new td;d.W=b;d.q=a;this.dispatchEvent(d)};B("X.parserCRV",Ce);B("X.parserCRV.prototype.parse",Ce.prototype.parse);function De(){V.call(this);this.c="parserTRK"}D(De,V);
De.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");var d=b.g,e=b.h,f=b.T;this.Y=c;W(this,"uchar",6);W(this,"ushort",3);var g=W(this,"float",3);W(this,"float",3);W(this,"ushort");W(this,"uchar",200);W(this,"ushort");W(this,"uchar",200);W(this,"float",16);W(this,"uchar",444);W(this,"uchar",4);W(this,"uchar",4);W(this,"float",6);W(this,"uchar",2);W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");var h=W(this,"uint");W(this,"uint");var j=W(this,"uint"),
k=[],m=[],c=Infinity,o=-Infinity,v=q,p=q,x=q,u=q,e=d=q,C=W(this,"uint",(this.Y.byteLength-1E3)/4);this.v=j;for(var E=W(this,"float",(this.Y.byteLength-1E3)/4),z=0,j=f=0;j<h;j++){for(var F=C[z],A=new O(3*F),I=0,S=0;S<F;S++){var T=E[z+3*S+1],Q=E[z+3*S+2],ba=E[z+3*S+3],T=T/g[0],Q=Q/g[1],ba=ba/g[2];A.add(T,Q,ba);if(0<S)var $=A.get(S-1),I=I+Math.sqrt(Math.pow(T-$[0],2)+Math.pow(Q-$[1],2)+Math.pow(ba-$[2],2));S<F-1&&(f+=6)}z+=3*F+1;S=A.Mb;F=A.Jb;T=A.Nb;Q=A.Kb;ba=A.Ob;$=A.Lb;if(!v||S<v)v=S;if(!p||F>p)p=
F;if(!x||T<x)x=T;if(!u||Q>u)u=Q;if(!d||ba<d)d=ba;if(!e||$>e)e=$;k.push(A);m.push(I)}g=(v+p)/2;x=(x+u)/2;v=(d+e)/2;u=new Float32Array(f);b.g=d=new O(f);b.h=e=new O(f);b.T=f=new O(f);for(j=p=0;j<h;j++){C=k[j];E=C.count;I=m[j];c=Math.min(c,I);o=Math.max(o,I);for(S=0;S<E-1;S++){A=C.get(S);z=C.get(S+1);d.add(A[0],A[1],A[2]);d.add(z[0],z[1],z[2]);var F=A[0]-g,T=A[1]-x,Q=A[2]-v,ba=Math.sqrt(F*F+T*T+Q*Q),$=z[0]-g,aa=z[1]-x,sa=z[2]-v,eb=Math.sqrt($*$+aa*aa+sa*sa);e.add(F/ba,T/ba,Q/ba);e.add($/eb,aa/eb,sa/
eb);z=[Math.abs(z[0]-A[0]),Math.abs(z[1]-A[1]),Math.abs(z[2]-A[2])];A=Math.sqrt(z[0]*z[0]+z[1]*z[1]+z[2]*z[2]);z[0]/=A;z[1]/=A;z[2]/=A;f.add(z[0],z[1],z[2]);f.add(z[0],z[1],z[2]);u[p++]=I;u[p++]=I;u[p++]=I;u[p++]=I;u[p++]=I;u[p++]=I}}b.qa="LINES";h=new sd;h.na=c;h.ja=o;h.Z=c;h.$=o;h.wc=u;h.Af=r;h.d=n;b.s=h;G.za(this.c+".parse");c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};B("X.parserTRK",De);B("X.parserTRK.prototype.parse",De.prototype.parse);function Ee(){V.call(this);this.c="parserIMAGE"}D(Ee,V);Ee.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;tc(f,"load",this.Zh.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Ee.prototype.Zh=function(a,b,c){b.lb=a;b.Ya=q;a=new td;a.W=c;a.q=b;this.dispatchEvent(a)};B("X.parserIMAGE",Ee);B("X.parserIMAGE.prototype.parse",Ee.prototype.parse);function Fe(){V.call(this);this.c="parserLUT"}D(Fe,V);
Fe.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");this.Y=c;var c=W(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(q,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}G.za(this.c+".parse");c=new td;
c.W=b;c.q=a;this.dispatchEvent(c)};B("X.parserLUT",Fe);B("X.parserLUT.prototype.parse",Fe.prototype.parse);function Ge(){V.call(this);this.c="parserNRRD"}D(Ge,V);
Ge.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");this.Y=c;var c=W(this,"uchar",c.byteLength),d=c.length,e=q,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(q,c.subarray(0,g-2));f=g+1;break}var h,j,k,m,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Ah=n;else if(!h.match(/^#/)&&(m=h.match(/(.*):(.*)/)))j=m[1].trim(),h=m[2].trim(),(k=this.fh[j])?k.call(this,h):this[j]=h;this.Ah||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Da&&(this.Da=[new M(1,0,0),new M(0,1,0),new M(0,0,1)],this.ef)){d=[];for(m=0;2>=m;m++)d.push(!isNaN(this.ef[m])?this.Da[m].scale(this.ef[m]):l)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new we(f)).jf();f=f.buffer;c={data:q,min:Infinity,max:-Infinity};c.data=new this.Bb(f);m=Rd(c.data);f=c.min=m[0];m=c.max=m[1];b.V=[this.bf[0],this.bf[1],this.bf[2]];b.F=[(new M(this.Da[0][0],this.Da[0][1],
this.Da[0][2])).Yb(),(new M(this.Da[1][0],this.Da[1][1],this.Da[1][2])).Yb(),(new M(this.Da[2][0],this.Da[2][1],this.Da[2][2])).Yb()];b.na=b.ba=f;b.ja=b.aa=m;-Infinity==b.Z&&(b.Z=f);Infinity==b.$&&(b.$=m);b.kc();G.za(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};
Ge.prototype.fh={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Bb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Bb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Bb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Bb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Bb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Bb=Uint32Array;break;case "float":this.Bb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.ra=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.bf=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Da=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.ef=e}};B("X.parserNRRD",Ge);B("X.parserNRRD.prototype.parse",Ge.prototype.parse);function He(){V.call(this);this.c="parserNII"}D(He,V);He.prototype.parse=function(a,b,c){G.Ea(this.c+".parse");var d=c;348!=(new Uint32Array(c,0,1))[0]&&(d=(new we(new Uint8Array(c))).jf(),d=d.buffer);c=this.$c(d);b.V=[c.ra[1],c.ra[2],c.ra[3]];b.F=[c.eb[1],c.eb[2],c.eb[3]];var d=c.min,e=c.max;b.na=b.ba=d;b.ja=b.aa=e;-Infinity==b.Z&&(b.Z=d);Infinity==b.$&&(b.$=e);b.kc();G.za(this.c+".parse");b.lb=Sd(this,b,c);c=new td;c.W=b;c.q=a;this.dispatchEvent(c)};
He.prototype.$c=function(a){this.Y=a;a={vi:0,Wg:q,Xg:q,eh:0,pi:0,hi:0,$g:q,ra:q,vh:0,wh:0,xh:0,th:0,Ce:0,Rg:0,zi:0,eb:q,Bg:0,oi:0,ni:0,yi:0,wi:q,Ni:q,Tg:0,Ug:0,xi:0,Gi:0,lh:0,mh:0,Zg:q,Qg:q,ai:0,ti:0,ei:0,fi:0,gi:0,bi:0,ci:0,di:0,Ai:q,Bi:q,Ci:q,uh:q,Bh:q,data:q,min:Infinity,max:-Infinity};a.vi=W(this,"uint");a.Wg=W(this,"uchar",10);a.Xg=W(this,"uchar",18);a.eh=W(this,"uint");a.pi=W(this,"ushort");a.hi=W(this,"uchar");a.$g=W(this,"uchar");a.ra=W(this,"ushort",8);a.vh=W(this,"float");a.wh=W(this,"float");
a.xh=W(this,"float");a.th=W(this,"ushort");a.Ce=W(this,"ushort");a.Rg=W(this,"ushort");a.zi=W(this,"ushort");a.eb=W(this,"float",8);a.Bg=W(this,"float");a.oi=W(this,"float");a.ni=W(this,"float");a.yi=W(this,"ushort");a.wi=W(this,"uchar");a.Ni=W(this,"uchar");a.Tg=W(this,"float");a.Ug=W(this,"float");a.xi=W(this,"float");a.Gi=W(this,"float");a.lh=W(this,"uint",1);a.mh=W(this,"uint",1);a.Zg=W(this,"uchar",80);a.Qg=W(this,"uchar",24);a.ai=W(this,"ushort");a.ti=W(this,"ushort");a.ei=W(this,"float");a.fi=
W(this,"float");a.gi=W(this,"float");a.bi=W(this,"float");a.ci=W(this,"float");a.di=W(this,"float");a.Ai=W(this,"float",4);a.Bi=W(this,"float",4);a.Ci=W(this,"float",4);a.uh=W(this,"uchar",16);a.Bh=W(this,"uchar",4);this.v=parseInt(a.Bg,10);var b=a.ra[1]*a.ra[2]*a.ra[3];switch(a.Ce){case 2:a.data=W(this,"uchar",b);break;case 4:a.data=W(this,"sshort",b);break;case 8:a.data=W(this,"sint",b);break;case 16:a.data=W(this,"float",b);break;case 256:a.data=W(this,"schar",b);break;case 512:a.data=W(this,"ushort",
b);break;case 768:a.data=W(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Ce))}b=Rd(a.data);a.min=b[0];a.max=b[1];return a};B("X.parserNII",He);B("X.parserNII.prototype.parse",He.prototype.parse);function Ie(){K.call(this);this.c="loader";this.gc=new Pb;this.Jc=0}D(Ie,K);function Je(a,b){a.Jc+=b/a.gc.sa()/3;a.Jc=Math.min(1,a.Jc);var c=new Qd;c.Bf=a.Jc;a.dispatchEvent(c)}function Ke(a){var a=a.r.ke,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Le||i(Error("The "+b+" file format is not supported."));return[a,b,Le[b][0],Le[b][1],Le[b][2]]}
Ie.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Rb(this.gc.B,a.ma)||this.gc.get(a.ma)){this.gc.set(a.ma,r);var c=Ke(a)[0];if(a.Eb!=q)this.parse(q,a,b);else{var d=new XMLHttpRequest;J(d,"abort",this.Nf.bind(this,d,a,b));J(d,"error",this.Nf.bind(this,d,a,b));J(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,n);d.responseType="arraybuffer";d.send(q)}}};
Ie.prototype.parse=function(a,b,c){Je(this,1);setTimeout(function(){var d=Ke(b),e=d[3],d=new d[2];tc(d,Bc,this.complete.bind(this));var f=b.Eb;f==q&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Ie.prototype.complete=function(a){Je(this,1);setTimeout(function(){var b=a.q,c=a.W;b.r.d=r;b.d=n;c.n();this.gc.set(b.ma,n)}.bind(this),100)};Ie.prototype.Nf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Le={STL:[ue,q],VTK:[ye,q],TRK:[De,q],FSM:[Ae,q],INFLATED:[Ae,q],SMOOTHWM:[Ae,q],SPHERE:[Ae,q],PIAL:[Ae,q],ORIG:[Ae,q],NRRD:[Ge,q],NII:[He,q],GZ:[He,q],DCM:[xe,q],DICOM:[xe,q],"":[xe,q],CRV:[Ce,q],LABEL:[Td,q],MGH:[Be,r],MGZ:[Be,n],TXT:[Fe,q],LUT:[Fe,q],PNG:[Ee,"png"],JPG:[Ee,"jpeg"],JPEG:[Ee,"jpeg"],GIF:[Ee,"gif"]};function Me(a,b){(!y(a)||!y(b))&&i(Error("A camera needs valid width and height values."));K.call(this);this.c="camera";this.pa=new M(0,0,100);this.ec=new M(0,0,0);this.H=new M(0,1,0);this.m=this.Od(this.pa,this.ec);this.Gb=new Float32Array(this.m.Ba())}D(Me,K);Me.prototype.Uh=function(a){a instanceof Kd||i(Error("Received no valid rotate event."));this.rotate(a.Q)};Me.prototype.Yh=function(a){a instanceof Ld||i(Error("Received no valid zoom event."));a.Hb?this.Cg(a.jb):this.Dg(a.jb)};
Me.prototype.Rh=function(a){a instanceof Jd||i(Error("Received no valid pan event."));this.ng(a.Q)};Me.prototype.__defineGetter__("view",s("m"));Me.prototype.__defineSetter__("view",function(a){(!w(a)||!(a instanceof N))&&i(Error("Invalid view matrix."));this.m=a;this.Gb=new Float32Array(this.m.Ba())});Me.prototype.__defineGetter__("position",function(){return[this.pa.x,this.pa.y,this.pa.b]});
Me.prototype.__defineSetter__("position",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid position."));this.pa=new M(a[0],a[1],a[2]);this.reset()});Me.prototype.__defineGetter__("focus",function(){return[this.ec.x,this.ec.y,this.ec.b]});Me.prototype.__defineSetter__("focus",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid focus"));this.ec=new M(a[0],a[1],a[2]);this.reset()});Me.prototype.__defineGetter__("up",function(){return[this.H.x,this.H.y,this.H.b]});
Me.prototype.__defineSetter__("up",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid up vector."));this.H=new M(a[0],a[1],a[2]);this.reset()});t=Me.prototype;t.reset=function(){this.m=this.Od(this.pa,this.ec);this.Gb=new Float32Array(this.m.Ba())};t.rotate=function(a){a instanceof Array&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for rotate operation."));return a};
t.ng=function(a){a instanceof Array&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for pan operation."));a=new M(-a.x,a.y,0);a=ld(4).translate(a);this.m=new N(a.multiply(this.m));this.Gb=new Float32Array(this.m.Ba())};t.Cg=function(a){var b=20;w(a)&&!a&&(b=1);a=new M(0,0,b);a=ld(4).translate(a);this.m=new N(a.multiply(this.m));this.Gb=new Float32Array(this.m.Ba())};
t.Dg=function(a){var b=30;w(a)&&!a&&(b=1);a=new M(0,0,-b);a=ld(4).translate(a);this.m=new N(a.multiply(this.m));this.Gb=new Float32Array(this.m.Ba())};t.Od=function(a,b){(!(a instanceof M)||!(b instanceof M))&&i(Error("3D vectors required for calculating the view."));return ld(4)};B("X.camera",Me);B("X.camera.prototype.pan",Me.prototype.ng);B("X.camera.prototype.rotate",Me.prototype.rotate);B("X.camera.prototype.zoomIn",Me.prototype.Cg);B("X.camera.prototype.zoomOut",Me.prototype.Dg);function Ne(a){function b(a,b,d){b=2*b*Math.PI;b=j.Ab(Math.cos(b)).pc(k.Ab(Math.sin(b)));a=c.pc(e.Ab(a)).pc(b.Ab(f));d=b.Ab(1-Math.abs(d)).pc(g.Ab(d));return new Hc(a,d)}this.w=[];for(var a=a||{},c=new za(a.start||[0,-1,0]),d=new za(a.end||[0,1,0]),e=d.Yc(c),f=a.Ta||1,a=a.cf||16,g=e.ed(),h=0.5<Math.abs(g.y()),j=(new za(h,!h,0)).Ae(g).ed(),k=j.Ae(g).ed(),h=new Hc(c,g.Se()),d=new Hc(d,g.ed()),m=[],o=0;o<a;o++){var v=o/a,p=(o+1)/a;m.push(new Jc([h,b(0,v,-1),b(0,p,-1)]));m.push(new Jc([b(0,p,0),b(0,v,
0),b(1,v,0),b(1,p,0)]));m.push(new Jc([d,b(1,p,1),b(1,v,1)]))}return Mc(m)}D(Ne,Lc);function Oe(){U.call(this);this.c="cylinder";this.pe=[-10,-10,-10];this.Yd=[10,10,10];this.Pb=10;this.Qb=32;Aa(this,new vd)}D(Oe,U);Oe.prototype.__defineGetter__("start",s("pe"));Oe.prototype.__defineSetter__("start",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid start"));this.pe=a});Oe.prototype.__defineGetter__("end",s("Yd"));Oe.prototype.__defineSetter__("end",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid end"));this.Yd=a});
Oe.prototype.__defineGetter__("radius",s("Pb"));Oe.prototype.__defineSetter__("radius",function(a){y(a)||i(Error("Invalid radius."));this.Pb=a});Oe.prototype.n=function(){xd(this,new Ne({start:this.pe,end:this.Yd,Ta:this.Pb,cf:this.Qb}));Oe.i.n.call(this)};B("X.cylinder",Oe);B("X.cylinder.prototype.modified",Oe.prototype.n);function Pe(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new za(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Hc(c.pc(e.Ab(d)),e))}this.w=[];for(var a=a||{},c=new za(a.we||[0,0,0]),d=a.Ta||1,e=a.cf||16,a=a.Di||8,f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Jc(g));return Mc(f)}D(Pe,Lc);function Qe(){U.call(this);this.c="sphere";this.l=[0,0,0];this.Pb=5;this.Qb=32;this.Og=16;Aa(this,new vd)}D(Qe,U);Qe.prototype.__defineGetter__("center",s("l"));Qe.prototype.__defineSetter__("center",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Qe.prototype.__defineGetter__("radius",s("Pb"));Qe.prototype.__defineSetter__("radius",function(a){y(a)||i(Error("Invalid radius."));this.Pb=a});
Qe.prototype.n=function(){xd(this,new Pe({we:this.l,Ta:this.Pb,cf:this.Qb,Di:this.Og}));Qe.i.n.call(this)};B("X.sphere",Qe);B("X.sphere.prototype.modified",Qe.prototype.n);function te(a){L.call(this);this.c="labelmap";this.cb=a}D(te,L);te.prototype.n=function(){var a=new td;a.W=this;this.dispatchEvent(a);this.cb.n()};B("X.labelmap",te);function Re(a){this.w=[];var a=a||{},b=new za(a.we||[0,0,0]),c=!a.Ta?[1,1,1]:a.Ta.length?a.Ta:[a.Ta,a.Ta,a.Ta];return Mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Jc(a[0].map(function(e){e=new za(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Hc(e,new za(a[1]))}))}))}D(Re,Lc);function Se(){U.call(this);this.c="cube";this.l=[0,0,0];this.de=this.ce=this.be=20;this.Rb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Aa(this,new vd)}D(Se,U);Se.prototype.__defineGetter__("center",s("l"));Se.prototype.__defineSetter__("center",function(a){(!w(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Se.prototype.__defineGetter__("lengthX",s("be"));
Se.prototype.__defineSetter__("lengthX",function(a){y(a)||i(Error("Invalid lengthX."));this.be=a});Se.prototype.__defineGetter__("lengthY",s("ce"));Se.prototype.__defineSetter__("lengthY",function(a){y(a)||i(Error("Invalid lengthY."));this.ce=a});Se.prototype.__defineGetter__("lengthZ",s("de"));Se.prototype.__defineSetter__("lengthZ",function(a){y(a)||i(Error("Invalid lengthZ."));this.de=a});Se.prototype.n=function(){xd(this,new Re({we:this.l,Ta:[this.be/2,this.ce/2,this.de/2]}));Se.i.n.call(this)};
B("X.cube",Se);B("X.cube.prototype.modified",Se.prototype.n);function Te(a){Y.call(this,a);this.c="interactor3D"}D(Te,Y);Te.prototype.Zc=function(a){Te.i.Zc.call(this,a);var b=new Ld;w(a.lc)||(a.lc=0);b.Hb=0>a.lc;b.jb=n;this.dispatchEvent(b)};function Ue(a){K.call(this);this.c="array";this.t=[];this.nf=a}D(Ue,K);Ue.prototype.add=function(a){this.t.push(a);return n};Ue.prototype.clear=function(){this.t.length=0};function Ve(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Ve(a,b,d);for(Ve(a,d,c);b<d;++b)if(0<a.nf(a.t[b],a.t[d])){var e=a.t[b];a.t[b]=a.t[d];for(var f=a,g=d,h=c;g+1<h&&0>f.nf(f.t[g+1],e);){var j=f,k=g+1,m=j.t[g];j.t[g]=j.t[k];j.t[k]=m;++g}f.t[g]=e}}}Ue.prototype.sort=function(){Ve(this,0,this.t.length)};function We(a,b){Me.call(this,a,b);this.c="camera2D"}D(We,Me);We.prototype.rotate=function(a){var a=We.i.rotate.call(this,a),b=new Id;0<a.x?b.re--:0>a.x&&b.re++;0<a.y?b.ee++:0>a.y&&b.ee--;this.dispatchEvent(b)};function Xe(a,b){Me.call(this,a,b);this.c="camera3D";this.of=45;this.xf=new Float32Array(Ye(this.of,a/b).Ba())}D(Xe,Me);function Ye(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new N([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
Xe.prototype.rotate=function(a){var a=Xe.i.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=ld(4),d=new M(parseFloat(this.m.O(0,0)),parseFloat(this.m.O(0,1)),parseFloat(this.m.O(0,2))),b=c.rotate(b,new M(parseFloat(this.m.O(1,0)),parseFloat(this.m.O(1,1)),parseFloat(this.m.O(1,2)))),a=c.rotate(a,d);this.m=new N(this.m.multiply(a.multiply(b)));this.Gb=new Float32Array(this.m.Ba())};
Xe.prototype.Od=function(a,b){Xe.i.Od.call(this,a,b);var c=ld(4),d=new M(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.H.f();e.Qc(d)&&(e.b+=1.0E-6);var f=Uc(e,d),e=Uc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.S())};B("X.camera3D",Xe);function Ze(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Ze.prototype.f=function(){return new Ze(this.top,this.right,this.bottom,this.left)};Ze.prototype.contains=function(a){return!this||!a?r:a instanceof Ze?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function $e(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}$e.prototype.f=function(){return new $e(this.left,this.top,this.width,this.height)};$e.prototype.Yf=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,n}return r};
$e.prototype.contains=function(a){return a instanceof $e?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};$e.prototype.ta=function(){return new Yc(this.width,this.height)};function af(a,b){var c=ce(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function bf(a,b){return a.currentStyle?a.currentStyle[b]:q}function cf(a,b){return af(a,b)||bf(a,b)||a.style&&a.style[b]}function df(a){a=a?9==a.nodeType?a:ce(a):document;return H&&!pb(9)&&!ne(ae(a))?a.body:a.documentElement}
function ef(a){var b=a.getBoundingClientRect();H&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ff(a){if(H&&!pb(8))return a.offsetParent;for(var b=ce(a),c=cf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=cf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function gf(a){for(var b=new Ze(0,Infinity,Infinity,0),c=ae(a),d=c.L.body,e=c.L.documentElement,f=!Wa&&"CSS1Compat"==c.L.compatMode?c.L.documentElement:c.L.body;a=ff(a);)if((!H||0!=a.clientWidth)&&(!Wa||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=cf(a,"overflow")){var g=hf(a),h;h=a;if(Va&&!mb("1.9")){var j=parseFloat(af(h,"borderLeftWidth"));if(jf(h))var k=h.offsetWidth-h.clientWidth-j-parseFloat(af(h,"borderRightWidth")),j=j+k;h=new Vc(j,parseFloat(af(h,"borderTopWidth")))}else h=new Vc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.L.parentWindow||c.L.defaultView||window;e=c.document;Wa&&!mb("500")&&!Xa?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Yc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Yc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function hf(a){var b,c=ce(a),d=cf(a,"position"),e=Va&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vc(0,0),g=df(c);if(a==g)return f;if(a.getBoundingClientRect)b=ef(a),a=oe(ae(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Wa&&"fixed"==cf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ua||Wa&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ff(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Ua||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function kf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function lf(a){if("none"!=cf(a,"display"))return mf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=mf(a);b.display=c;b.position=e;b.visibility=d;return a}function mf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Wa&&!b&&!c;return(!ha(b)||d)&&a.getBoundingClientRect?(a=ef(a),new Yc(a.right-a.left,a.bottom-a.top)):new Yc(b,c)}function nf(a,b){a.style.display=b?"":"none"}function jf(a){return"rtl"==cf(a,"direction")}
function of(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var pf={thin:2,medium:4,thick:6};function qf(a,b){if("none"==bf(a,b+"Style"))return 0;var c=bf(a,b+"Width");return c in pf?pf[c]:of(a,c)};function rf(a){this.Ja=a;this.u=[]}D(rf,Wb);var sf=[];function tf(a,b,c,d,e){ia(c)||(sf[0]=c,c=sf);for(var f=0;f<c.length;f++)a.u.push(J(b,c[f],d||a,e||r,a.Ja||a))}rf.prototype.Rd=function(){xb(this.u,vc);this.u.length=0};rf.prototype.K=function(){rf.i.K.call(this);this.Rd()};rf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function uf(){}(function(a){a.Of=function(){return a.sh||(a.sh=new a)}})(uf);uf.prototype.Te=0;uf.Of();function vf(a){this.Qa=a||ae()}D(vf,Gc);t=vf.prototype;t.qh=uf.Of();t.Vf=q;t.Xb=r;t.o=q;t.oc=q;t.Cd=q;t.Oc=q;t.Mi=r;t.j=s("o");t.af=function(a){this.oc&&this.oc!=a&&i(Error("Method not supported"));vf.i.af.call(this,a)};t.Gd=s("Qa");t.jc=function(){this.o=this.Qa.createElement("div")};t.$b=function(a){this.zb(a)};t.zb=function(a,b){this.Xb&&i(Error("Component already rendered"));this.o||this.jc();a?a.insertBefore(this.o,b||q):this.Qa.L.body.appendChild(this.o);(!this.oc||this.oc.Xb)&&this.Fd()};
t.Fd=function(){this.Xb=n;wf(this,function(a){!a.Xb&&a.j()&&a.Fd()})};t.Sc=function(){wf(this,function(a){a.Xb&&a.Sc()});this.Kd&&this.Kd.Rd();this.Xb=r};t.K=function(){vf.i.K.call(this);this.Xb&&this.Sc();this.Kd&&(this.Kd.Ia(),delete this.Kd);wf(this,function(a){a.Ia()});!this.Mi&&this.o&&ke(this.o);this.oc=this.o=this.Oc=this.Cd=q};function wf(a,b){a.Cd&&xb(a.Cd,b,l)}
t.removeChild=function(a,b){if(a){var c=ka(a)?a:a.Vf||(a.Vf=":"+(a.qh.Te++).toString(36)),a=this.Oc&&c?(c in this.Oc?this.Oc[c]:l)||q:q;if(c&&a){var d=this.Oc;c in d&&delete d[c];Bb(this.Cd,a);b&&(a.Sc(),a.o&&ke(a.o));c=a;c==q&&i(Error("Unable to set parent component"));c.oc=q;vf.i.af.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function xf(){}D(xf,Gc);t=xf.prototype;t.kf=0;t.Xc=0;t.Oe=100;t.Mf=0;t.ff=1;t.zh=r;t.Dh=r;t.Ud=function(a){a=yf(this,a);this.kf!=a&&(this.kf=a+this.Mf>this.Oe?this.Oe-this.Mf:a<this.Xc?this.Xc:a,!this.zh&&!this.Dh&&this.dispatchEvent("change"))};t.Jd=function(){return yf(this,this.kf)};t.Id=function(){return yf(this,this.Xc)};t.Hd=function(){return yf(this,this.Oe)};function yf(a,b){return a.ff==q?b:a.Xc+Math.round((b-a.Xc)/a.ff)*a.ff};function zf(a){this.Qa=a||ae();this.qc=new xf;J(this.qc,"change",this.nh,r,this)}D(zf,vf);var Af={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};t=zf.prototype;t.jc=function(){this.Ma=this.Gd().jc("div","progress-bar-thumb");var a=Af[this.mg];this.o=this.Gd().jc("div",a,this.Ma);Bf(this);this.j().setAttribute("aria-valuemin",this.Id());this.j().setAttribute("aria-valuemax",this.Hd())};
t.Fd=function(){zf.i.Fd.call(this);H&&7>bb&&J(this.j(),"resize",this.Wd,r,this);this.Wd();var a=this.j();a.setAttribute("role","progressbar");a.Dj="progressbar";this.j().setAttribute("aria-live","polite")};t.Sc=function(){zf.i.Sc.call(this);Cf(this)};function Cf(a){H&&7>bb&&uc(a.j(),"resize",a.Wd,r,a)}t.Jd=function(){return this.qc.Jd()};t.Ud=function(a){this.qc.Ud(a);this.j()&&Bf(this)};function Bf(a){var b=a.Jd();a.j().setAttribute("aria-valuenow",b)}t.Id=function(){return this.qc.Id()};t.Hd=function(){return this.qc.Hd()};
t.mg="horizontal";t.nh=function(){this.Wd();this.dispatchEvent("change")};t.Wd=function(){if(this.Ma){var a=this.Id(),b=this.Hd(),a=(this.Jd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.mg?H&&7>bb?(this.Ma.style.top=0,this.Ma.style.height="100%",b=this.Ma.offsetHeight,a=Math.round(a*b),this.Ma.style.top=b-a+"px",this.Ma.style.height=a+"px"):(this.Ma.style.top=100-b+"%",this.Ma.style.height=b+"%"):this.Ma.style.width=b+"%"}};t.K=function(){Cf(this);zf.i.K.call(this);this.Ma=q;this.qc.Ia()};function Df(a,b){w(a)||i(Error("No valid parent element."));w(b)||i(Error("Invalid initial value."));zf.call(this);this.c="progressbar";this.Aa=a;this.kd=this.bb=q;this.Db=[];this.Db=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.Ud(b);this.Je()}D(Df,zf);
Df.prototype.Je=function(){if("static"==this.Aa.style.position||""==this.Aa.style.position)this.Aa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ge("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Db[0]),d=document.createTextNode(this.Db[1]),e=document.createTextNode(this.Db[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.bb=b;this.$b(this.Aa);a=this.j();a.style.position="absolute";a.style.top=(this.Aa.clientHeight-
5)/2;a.style.left=(this.Aa.clientWidth-100)/2;a.classList.add("xtk-progress-bar")};function Ef(a){var b=a.j().style.top,c=a.j().style.left;ke(a.j());var d=new Df(a.Aa,100),e=d.j();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=l?e.firstElementChild:le(e.firstChild)).classList.add("progress-bar-thumb-done");a.kd=d}Df.prototype.Me=function(){this.bb&&ke(this.bb);this.j()&&ke(this.j());this.kd&&ke(this.kd.j());this.kd=this.bb=q};var Ff=ea.window;function Gf(a,b,c){la(a)?c&&(a=ua(a,c)):a&&"function"==typeof a.handleEvent?a=ua(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Ff.setTimeout(a,b||0)};function Hf(){K.call(this);this.c="renderer";this.q=window.document.body;this.I=this.q.clientWidth;this.D=this.q.clientHeight;this.Ib=this.p=this.ea=q;this.Wa=new Ue(ud);this.Pa=[];this.M=q;this.je=this.nd=this.od=r;this.a=this.Oa=q;this.P={PROGRESSBAR_ENABLED:n};window.console.log("XTK Release pre8 -- 08/17/12 -- http://www.goXTK.com -- @goXTK")}D(Hf,K);t=Hf.prototype;t.Sh=function(a){this.Oa&&this.Oa.Ud(100*a.Bf)};t.Ih=function(a){w(a)&&a instanceof td&&a.W&&this.Ua(a.W)};
t.We=function(a){(!w(a)||!(a instanceof Nd))&&i(Error("Invalid hover event."))};t.Th=function(){var a=de(this.q);this.I=a.clientWidth;this.D=a.clientHeight;a=de(this.ea);a.width=this.I;a.height=this.D;this instanceof If&&(this.a.viewport(0,0,this.I,this.D),this.p.xf=new Float32Array(Ye(this.p.of,this.ea.width/this.ea.height).Ba()));this.sc()};t.Xe=function(a){(!w(a)||!(a instanceof Md))&&i(Error("Invalid scroll event."))};Hf.prototype.__defineGetter__("config",s("P"));
Hf.prototype.__defineGetter__("interactor",s("Ib"));Hf.prototype.__defineGetter__("camera",s("p"));Hf.prototype.__defineGetter__("loadingCompleted",s("nd"));Hf.prototype.__defineGetter__("container",s("q"));Hf.prototype.__defineSetter__("container",function(a){w(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ka(b)&&(b=de(a));ma(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.q=b});t=Hf.prototype;t.sc=function(){this.p.reset()};
function Jf(a){a.P.PROGRESSBAR_ENABLED&&a.Oa&&!a.mf&&(Ef(a.Oa),a.mf=Gf(function(){this.mf=q;this.Oa&&(this.Oa.Me(),this.Oa=q);this.$b()}.bind(a),700))}
t.ha=function(a){var b=ge("canvas");this.q.appendChild(b);this.I=this.q.clientWidth;this.D=this.q.clientHeight;b.width=this.I;b.height=this.D;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.q.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.M=new Ie;J(this.M,Fd,this.Sh.bind(this));this.ea=b;this.a=c;b=new Te(this.ea);"2d"==a&&(b=new qe(this.ea));b.ha();J(b,Dd,this.sc.bind(this));J(b,Gd,this.We.bind(this));J(b,Cd,this.Xe.bind(this));this.Ib=b;b=new Xe(this.I,this.D);"2d"==a&&(b=new We(this.I,this.D));a=b;c=this.Ib;(!w(c)||!(c instanceof Y))&&i(Error("Could not observe the interactor."));J(c,Ad,a.Uh.bind(a));J(c,zd,a.Rh.bind(a));J(c,Bd,a.Yh.bind(a));this.p=b;J(window,"resize",this.Th,r,this)};
t.add=function(a){(a instanceof Se||a instanceof Qe||a instanceof Oe)&&a.n();this.Pa.push(a);this.Ua(a)};t.Ua=function(a){(!this.ea||!this.a)&&i(Error("The renderer was not initialized properly."));w(a)||(window.console.log(a),i(Error("Illegal object.")));yc(a)||J(a,Bc,this.Ih.bind(this))};t.get=function(a){w(a)||i(Error("Invalid object id."));for(var b=this.Wa.t,c=b.length,d=0,d=0;d<c;d++)if(b[d].ma==a)return b[d];return q};
t.$b=function(){(!this.ea||!this.a)&&i(Error("The renderer was not initialized properly."));w(this.zf)||(this.M.gc.ye(r)?(this.P.PROGRESSBAR_ENABLED&&!this.Oa&&(this.Oa=new Df(this.q,3)),this.je=this.nd=r,this.zf=Gf(function(){this.zf=q;this.$b()}.bind(this),100)):(!this.nd&&!this.je&&(this.je=n,eval("this.onShowtime()"),this.nd=n),this.Oa?Jf(this):(window.ad(this.$b.bind(this),this.ea),eval("this.onRender()"),this.zb(r,n))))};t.lg=ca();t.jg=ca();t.zb=ca();
t.Ed=function(){this.Wa.clear();delete this.Wa;this.Pa.length=0;delete this.Pa;delete this.M;this.M=q;delete this.p;this.p=q;delete this.Ib;this.Ib=q;delete this.a;this.a=q;ke(this.ea);delete this.ea;this.ea=q};function Kf(){K.call(this);this.c="shaders";this.wd="";this.wd="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.ld="";this.ld="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
D(Kf,K);
var Lf={nj:"vertexPosition",mj:"vertexNormal",lj:"vertexColor",pj:"vertexTexturePos",oj:"vertexScalar"},Mf={qj:"view",Wi:"perspective",Oi:"center",Vi:"objectTransform",hj:"useObjectColor",Ti:"objectColor",jj:"useScalars",dj:"scalarsReplaceMode",aj:"scalarsMin",Yi:"scalarsMax",bj:"scalarsMinColor",Zi:"scalarsMaxColor",cj:"scalarsMinThreshold",$i:"scalarsMaxThreshold",Xi:"pointSize",Ui:"objectOpacity",Si:"normal",ij:"usePicking",kj:"useTexture",gj:"useLabelMapTexture",Qi:"labelmapOpacity",ej:"textureSampler",fj:"textureSampler2",
rj:"volumeLowerThreshold",xj:"volumeUpperThreshold",uj:"volumeScalarMin",sj:"volumeScalarMax",vj:"volumeScalarMinColor",tj:"volumeScalarMaxColor",zj:"volumeWindowLow",yj:"volumeWindowHigh",wj:"volumeTexture"};
function Nf(a){var b=Object.keys(Mf);Object.keys(Lf).every(function(a){a=Lf[a];return-1!=this.wd.search(a)||-1!=this.ld.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Mf[a];return-1!=this.wd.search(a)||-1!=this.ld.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Of(a,b,c){w(a)||i(Error("Invalid GL Buffer."));w(b)||i(Error("Invalid number of items."));w(c)||i(Error("Invalid item size."));K.call(this);this.c="buffer";this.fa=a;this.pb=b;this.qb=c}D(Of,K);function Pf(a,b,c,d,e,f,g,h){var j,k=c.offsetParent;if(k){var m="HTML"==k.tagName||"BODY"==k.tagName;if(!m||"static"!=cf(k,"position"))j=hf(k),m||(j=Wc(j,new Vc(k.scrollLeft,k.scrollTop)))}k=hf(a);m=lf(a);k=new $e(k.x,k.y,m.width,m.height);(m=gf(a))&&k.Yf(new $e(m.left,m.top,m.right-m.left,m.bottom-m.top));var m=ae(a),o=ae(c);if(m.L!=o.L){var v=m.L.body,o=o.L.parentWindow||o.L.defaultView,p=new Vc(0,0),x=ce(v)?ce(v).parentWindow||ce(v).defaultView:window,u=v;do{var C;if(x==o)C=hf(u);else{var E=u;
C=new Vc;if(1==E.nodeType)if(E.getBoundingClientRect)E=ef(E),C.x=E.left,C.y=E.top;else{var z=oe(ae(E)),E=hf(E);C.x=E.x-z.x;C.y=E.y-z.y}else{var z=la(E.kh),F=E;E.targetTouches?F=E.targetTouches[0]:z&&E.Ra.targetTouches&&(F=E.Ra.targetTouches[0]);C.x=F.clientX;C.y=F.clientY}}p.x+=C.x;p.y+=C.y}while(x&&x!=o&&(u=x.frameElement)&&(x=x.parent));v=Wc(p,hf(v));H&&!ne(m)&&(v=Wc(v,oe(m)));k.left+=v.x;k.top+=v.y}a=(b&4&&jf(a)?b^2:b)&-5;b=new Vc(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);j&&(b=Wc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var A;if(g&&(A=gf(c))&&j)A.top-=j.y,A.right-=j.x,A.bottom-=j.y,A.left-=j.x;return Qf(b,c,d,f,A,g,h)}
function Qf(a,b,c,d,e,f,g){var a=a.f(),h=0,j=(c&4&&jf(b)?c^2:c)&-5,c=lf(b),g=g?g.f():c.f();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Va&&(Na||ab)&&mb("1.9");f instanceof Vc?(a=f.x,f=f.y):(a=f,f=l);b.style.left=kf(a,e);b.style.top=kf(f,e);Zc(c,g)||(a=ne(ae(ce(b))),
H&&(!a||!mb("8"))?(c=b.style,a?(H?(a=of(b,bf(b,"paddingLeft")),e=of(b,bf(b,"paddingRight")),f=of(b,bf(b,"paddingTop")),d=of(b,bf(b,"paddingBottom")),a=new Ze(f,e,d,a)):(a=af(b,"paddingLeft"),e=af(b,"paddingRight"),f=af(b,"paddingTop"),d=af(b,"paddingBottom"),a=new Ze(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),H?(e=qf(b,"borderLeft"),f=qf(b,"borderRight"),d=qf(b,"borderTop"),b=qf(b,"borderBottom"),b=new Ze(d,f,b,e)):(e=af(b,"borderLeftWidth"),f=af(b,"borderRightWidth"),d=af(b,"borderTopWidth"),
b=af(b,"borderBottomWidth"),b=new Ze(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Va?b.MozBoxSizing="border-box":Wa?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Rf(){}Rf.prototype.La=ca();function Sf(a,b){this.element=a;this.Gf=b}D(Sf,Rf);Sf.prototype.La=function(a,b,c){Pf(this.element,this.Gf,a,b,l,c)};function Tf(a,b){this.Ja=new rf(this);this.$e(a||q);b&&(this.uc=b)}D(Tf,Gc);t=Tf.prototype;t.o=q;t.Pg=n;t.Cf=q;t.la=r;t.ui=r;t.Ne=-1;t.ph=r;t.dh=n;t.uc="toggle_display";t.j=s("o");t.$e=function(a){this.la&&i(Error("Can not change this state of the popup while showing."));this.o=a};
function Uf(a,b){a.cd&&a.cd.stop();a.Vc&&a.Vc.stop();if(b){if(!a.la&&a.Ue()){a.o||i(Error("Caller must call setElement before trying to show the popup"));a.La();var c=ce(a.o);a.ph&&tf(a.Ja,c,"keydown",a.Gh,n);if(a.Pg)if(tf(a.Ja,c,"mousedown",a.hg,n),H){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}tf(a.Ja,c,"mousedown",a.hg,n);tf(a.Ja,c,"deactivate",a.gg)}else tf(a.Ja,c,"blur",a.gg);"toggle_display"==
a.uc?(a.o.style.visibility="visible",nf(a.o,n)):"move_offscreen"==a.uc&&a.La();a.la=n;a.cd?(tc(a.cd,"end",a.kg,r,a),a.cd.play()):a.kg()}}else Vf(a)}t.La=fa;function Vf(a,b){if(!a.la||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Ja&&a.Ja.Rd();a.Vc?(tc(a.Vc,"end",va(a.Ff,b),r,a),a.Vc.play()):a.Ff(b);return n}t.Ff=function(a){"toggle_display"==this.uc?this.ui?Gf(this.Uf,0,this):this.Uf():"move_offscreen"==this.uc&&(this.o.style.left="-200px",this.o.style.top="-200px");this.la=r;this.Ve(a)};
t.Uf=function(){this.o.style.visibility="hidden";nf(this.o,r)};t.Ue=function(){return this.dispatchEvent("beforeshow")};t.kg=function(){this.Ne=wa();this.dispatchEvent("show")};t.Ve=function(a){wa();this.dispatchEvent({type:"hide",target:a})};t.hg=function(a){a=a.target;!me(this.o,a)&&(!this.Cf||me(this.Cf,a))&&!(150>wa()-this.Ne)&&Vf(this,a)};t.Gh=function(a){27==a.keyCode&&Vf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
t.gg=function(a){if(this.dh){var b=ce(this.o);if(H||Ua){if(a=b.activeElement,!a||me(this.o,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.Ne||Vf(this)}};t.K=function(){Tf.i.K.call(this);this.Ja.Ia();Yb(this.cd);Yb(this.Vc);delete this.o;delete this.Ja};function Wf(a,b){this.ze=a instanceof Vc?a:new Vc(a,b)}D(Wf,Rf);Wf.prototype.La=function(a,b,c,d){Pf(df(a),0,a,b,this.ze,c,q,d)};function Xf(a,b){this.$h=4;this.Qd=b||l;Tf.call(this,a)}D(Xf,Tf);Xf.prototype.La=function(){if(this.Qd){var a=!this.la&&"move_offscreen"!=this.uc,b=this.j();a&&(b.style.visibility="hidden",nf(b,n));this.Qd.La(b,this.$h,this.Bj);a&&nf(b,r)}};function Yf(a,b,c){this.Qa=c||(a?ae(de(a)):ae());Xf.call(this,this.Qa.jc("div",{style:"position:absolute;display:none;"}));this.Be=new Vc(1,1);this.Ub=new Tb;a&&Zf(this,a);if(b!=q)if(a=this.j(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ce(a).createTextNode(b))}}D(Yf,Xf);var $f=[];t=Yf.prototype;t.ka=q;t.className="goog-tooltip";
t.sg=500;t.oh=0;t.Gd=s("Qa");function Zf(a,b){b=de(b);a.Ub.add(b);J(b,"mouseover",a.Rf,r,a);J(b,"mouseout",a.Ld,r,a);J(b,"mousemove",a.Qf,r,a);J(b,"focus",a.Pf,r,a);J(b,"blur",a.Ld,r,a)}t.detach=function(a){if(a)a=de(a),ag(this,a),this.Ub.remove(a);else{for(var b=this.Ub.Wb(),c=0;a=b[c];c++)ag(this,a);this.Ub.clear()}};function ag(a,b){uc(b,"mouseover",a.Rf,r,a);uc(b,"mouseout",a.Ld,r,a);uc(b,"mousemove",a.Qf,r,a);uc(b,"focus",a.Pf,r,a);uc(b,"blur",a.Ld,r,a)}
t.$e=function(a){var b=this.j();b&&ke(b);Yf.i.$e.call(this,a);a&&(b=this.Qa.L.body,b.insertBefore(a,b.lastChild))};t.Ue=function(){if(!Tf.prototype.Ue.call(this))return r;if(this.anchor)for(var a,b=0;a=$f[b];b++)me(a.j(),this.anchor)||Uf(a,r);0<=wb($f,this)||$f.push(this);a=this.j();a.className=this.className;bg(this);J(a,"mouseover",this.Tf,r,this);J(a,"mouseout",this.Sf,r,this);cg(this);return n};
t.Ve=function(){Bb($f,this);for(var a=this.j(),b,c=0;b=$f[c];c++)b.anchor&&me(a,b.anchor)&&Uf(b,r);this.og&&dg(this.og);uc(a,"mouseover",this.Tf,r,this);uc(a,"mouseout",this.Sf,r,this);this.anchor=l;if(0==(this.fb?this.la?4:1:this.nc?3:this.la?2:0))this.Sd=r;Tf.prototype.Ve.call(this)};t.eg=function(a,b){this.anchor==a&&this.Ub.contains(this.anchor)&&(this.Sd||!this.Cj?(Uf(this,r),this.la||(this.anchor=a,this.Qd=b||eg(this,0)||l,this.la&&this.La(),Uf(this,n))):this.anchor=l);this.fb=l};
t.Ch=function(a){this.nc=l;a==this.anchor&&(this.ka==q||this.ka!=this.j()&&!this.Ub.contains(this.ka))&&(!this.Df||!this.Df.ka)&&Uf(this,r)};function fg(a,b){var c=oe(a.Qa);a.Be.x=b.clientX+c.x;a.Be.y=b.clientY+c.y}t.Rf=function(a){var b=gg(this,a.target);this.ka=b;bg(this);b!=this.anchor&&(this.anchor=b,this.fb||(this.fb=Gf(ua(this.eg,this,b,l),this.sg)),hg(this),fg(this,a))};function gg(a,b){try{for(;b&&!a.Ub.contains(b);)b=b.parentNode;return b}catch(c){return q}}
t.Qf=function(a){fg(this,a);this.Sd=n};t.Pf=function(a){this.ka=a=gg(this,a.target);this.Sd=n;if(this.anchor!=a){this.anchor=a;var b=eg(this,1);bg(this);this.fb||(this.fb=Gf(ua(this.eg,this,a,b),this.sg));hg(this)}};function eg(a,b){if(0==b){var c=a.Be.f();return new ig(c)}return new jg(a.ka)}function hg(a){if(a.anchor)for(var b,c=0;b=$f[c];c++)me(b.j(),a.anchor)&&(b.Df=a,a.og=b)}
t.Ld=function(a){var b=gg(this,a.target),c=gg(this,a.relatedTarget);b!=c&&(b==this.ka&&(this.ka=q),cg(this),this.Sd=r,this.la&&(!a.relatedTarget||!me(this.j(),a.relatedTarget))?dg(this):this.anchor=l)};t.Tf=function(){var a=this.j();this.ka!=a&&(bg(this),this.ka=a)};t.Sf=function(a){var b=this.j();if(this.ka==b&&(!a.relatedTarget||!me(b,a.relatedTarget)))this.ka=q,dg(this)};function cg(a){a.fb&&(Ff.clearTimeout(a.fb),a.fb=l)}
function dg(a){if(2==(a.fb?a.la?4:1:a.nc?3:a.la?2:0))a.nc=Gf(ua(a.Ch,a,a.anchor),a.oh)}function bg(a){a.nc&&(Ff.clearTimeout(a.nc),a.nc=l)}t.K=function(){Uf(this,r);cg(this);this.detach();this.j()&&ke(this.j());this.ka=q;delete this.Qa;Yf.i.K.call(this)};function ig(a,b){Wf.call(this,a,b)}D(ig,Wf);ig.prototype.La=function(a,b,c){b=df(a);b=gf(b);c=c?new Ze(c.top+10,c.right,c.bottom,c.left+10):new Ze(10,0,0,10);Qf(this.ze,a,4,c,b,9)&496&&Qf(this.ze,a,4,c,b,5)};function jg(a){Sf.call(this,a,3)}
D(jg,Sf);jg.prototype.La=function(a,b,c){var d=new Vc(10,0);Pf(this.element,this.Gf,a,b,d,c,9)&496&&Pf(this.element,2,a,1,d,c,5)};function kg(a,b,c,d){w(a)||i(Error("No valid parent element."));(!y(b)||!y(c))&&i(Error("Invalid coordinates."));(!w(d)||!(d instanceof Y))&&i(Error("Invalid interactor."));Yf.call(this);this.c="caption";this.Aa=a;this.yd=b;this.zd=c;this.Ib=d;this.bb=q;this.Db=[];this.Db=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];tc(d,Hd,this.Me.bind(this));this.Je()}D(kg,Yf);
kg.prototype.Je=function(){if("static"==this.Aa.style.position||""==this.Aa.style.position)this.Aa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=ge("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Db[0]);a.appendChild(b);b.appendChild(c);this.bb=b;this.Qd=new Wf(this.yd,this.zd)||l;this.la&&this.La();Uf(this,n);Zf(this,this.Aa);this.j().classList.add("x-tooltip")};
kg.prototype.Me=function(){Uf(this,r);this.bb&&ke(this.bb);this.j()&&ke(this.j());this.bb=q};function If(){Hf.call(this);this.c="renderer3D";this.Dc=this.Gc=this.Cc=this.Fc=this.Bc=this.Ec=this.le=this.me=q;this.l=[0,0,0];this.yf=q;this.Xd=new Pb;this.Kc=new Pb;this.Nc=new Pb;this.he=new Pb;this.jd=new Pb;this.td=new Pb;this.ud=new Pb;this.vd=new Pb;this.P={PROGRESSBAR_ENABLED:n,PICKING_ENABLED:n,ORDERING_ENABLED:n,STATISTICS_ENABLED:r}}D(If,Hf);If.prototype.__defineGetter__("config",s("P"));t=If.prototype;t.ii=function(){this.Dc=this.Gc=this.Cc=this.Fc=this.Bc=this.Ec=q;this.l=[0,0,0]};
t.We=function(a){If.i.We.call(this,a);var b=a.yd,a=a.zd,c=this.get(this.pg(b,a));if(c&&(c=c.cc))(new kg(this.q,this.q.offsetLeft+b+10,this.q.offsetTop+a+10,this.Ib)).j().innerHTML=c};
t.ha=function(){If.i.ha.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.I,this.D),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.P.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.I,this.D,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.I,this.D);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.yf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}lg(this)};
function lg(a){var b=new Kf;(!w(a.ea)||!w(a.a)||!w(a.p))&&i(Error("Renderer was not initialized properly."));(!w(b)||!(b instanceof Kf))&&i(Error("Could not add shaders."));Nf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.ld);a.a.shaderSource(d,b.wd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.le=e;Object.keys(Lf).forEach(function(a){a=Lf[a];this.Xd.set(a,this.a.getAttribLocation(this.le,a));this.a.enableVertexAttribArray(this.Xd.get(a))}.bind(a));
Object.keys(Mf).forEach(function(a){a=Mf[a];this.Kc.set(a,this.a.getUniformLocation(this.le,a))}.bind(a));a.me=b}
t.Ua=function(a){If.i.Ua.call(this,a);var b=r;this.get(a.ma)&&(b=n);var c=a.ma,d=a.g,e=a.h,f=a.T,g=a.ga,h=a.r,j=a.Sb,k=a.U,m=a.z,o=a.s;if(w(m)&&w(m.r)&&m.r.d)this.Ua(m);else if(w(m)&&m.d&&this.Ua(m),w(k)&&w(k.r)&&k.r.d)this.M.load(k,a);else if(w(g)&&w(g.r)&&g.r.d)this.M.load(g,a);else{if(w(h)&&h instanceof Array)if(w(a.ac)){if(a.ac.Md!=h.length||!a.d)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.M.load(h[b],a);return}else{if(w(h)&&h.d){this.M.load(a,a);return}if(w(o)&&w(o.r)&&o.r.d){this.M.load(o,
a);return}}if(0<a.e.length){h=a.e;k=h.length;for(m=m=0;m<k;m++)this.Ua(h[m])}if(d){for(h=0;this.od;)h++,window.console.log("Possible thread lock avoided: "+h);this.od=n;k=a instanceof re&&a.cb instanceof te;b&&w(g)&&g.d&&(h=this.ud.get(c),w(h)&&this.a.isBuffer(h.fa)&&this.a.deleteBuffer(h.fa));h=q;w(g)&&(!b||g.d?(h=a.Rb,w(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),m=r,g.Ya&&(m=n),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,m),
m=this.a.createTexture(),m.rh=g.lb,this.vd.set(g.ma,m),this.a.bindTexture(this.a.TEXTURE_2D,m),g.Ya?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.rd,g.qd,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.Ya):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,m.rh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,
this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),m=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Of(m,h.length,2),g.d=r):h=this.ud.get(c));Je(this.M,
0.1);if(k)this.od=r,G.za(this.c+".update"),Je(this.M,0.9);else{if(!b||d.d||j.d){k=j.A;g=k.Ka(new M(d.Mb,d.Nb,d.Ob));k=k.Ka(new M(d.Jb,d.Kb,d.Lb));if(this.Ec===q||g.x<this.Ec)this.Ec=g.x;if(this.Bc===q||k.x>this.Bc)this.Bc=k.x;if(this.Fc===q||g.y<this.Fc)this.Fc=g.y;if(this.Cc===q||k.y>this.Cc)this.Cc=k.y;if(this.Gc===q||g.b<this.Gc)this.Gc=g.b;if(this.Dc===q||k.b>this.Dc)this.Dc=k.b;this.l=[(this.Ec+this.Bc)/2,(this.Fc+this.Cc)/2,(this.Gc+this.Dc)/2];j.d=r}b&&d.d&&(j=this.Nc.get(c),w(j)&&this.a.isBuffer(j.fa)&&
this.a.deleteBuffer(j.fa));j=q;!b||d.d?(j=this.a.createBuffer(),d.tc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,d.G,this.a.STATIC_DRAW),j=new Of(j,d.count,3),d.d=r):j=this.Nc.get(c);Je(this.M,0.3);b&&e.d&&(g=this.Nc.get(c),w(g)&&this.a.isBuffer(g.fa)&&this.a.deleteBuffer(g.fa));g=q;!b||e.d?(g=this.a.createBuffer(),e.tc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.G,this.a.STATIC_DRAW),g=new Of(g,e.count,3),e.d=r):g=this.he.get(c);
Je(this.M,0.3);b&&f&&f.d&&(e=this.jd.get(c),w(e)&&this.a.isBuffer(e.fa)&&this.a.deleteBuffer(e.fa));e=q;f&&(!b||f.d?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.tc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.G,this.a.STATIC_DRAW),e=new Of(e,f.count,3),f.d=r):e=this.jd.get(c));Je(this.M,0.2);b&&o&&o.d&&(f=this.td.get(c),w(f)&&this.a.isBuffer(f.fa)&&this.a.deleteBuffer(f.fa));f=q;o&&(f=o.wc,!b||o.d?(f.length!=
d.length&&i(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Of(d,f.length,3),o.d=r):f=this.td.get(c));Je(this.M,0.1);b||this.Wa.add(a);this.Nc.set(c,j);this.he.set(c,g);this.jd.set(c,e);this.ud.set(c,h);this.td.set(c,f);this.od=a.d=r}}else a.d=r}};function mg(a,b){var c=b.g.hd,c=a.p.m.Ka(b.Sb.A.Ka(new M(c[0],c[1],c[2]))),c=Sc(a.p.pa,c);return Math.round(1E3*c)/1E3}
t.pg=function(a,b){if(this.P.PICKING_ENABLED){this.zb(n,r);var c=new Uint8Array(4);this.a.readPixels(a,this.D-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
t.zb=function(a,b){If.i.zb.call(this,a,b);var c=this.Wa.t,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.yf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.I,this.D);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.p.xf,f=this.p.Gb;this.a.uniformMatrix4fv(this.Kc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Kc.get("view"),r,f);e=this.l;this.a.uniform3f(this.Kc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.Pa.length;for(e=0;e<f;++e){var g=this.Pa[e];if(g instanceof L){var h=new M(1,0,0),h=this.p.m.Ka(h),j=Sc(this.p.pa,h),h=new M(-1,0,0),h=this.p.m.Ka(h),k=Sc(this.p.pa,h),h=new M(0,1,0),h=this.p.m.Ka(h),m=Sc(this.p.pa,h),h=new M(0,-1,0),h=this.p.m.Ka(h),o=Sc(this.p.pa,h),h=new M(0,0,1),h=this.p.m.Ka(h),v=Sc(this.p.pa,h),h=new M(0,0,-1),h=this.p.m.Ka(h),h=Sc(this.p.pa,h),p=Math.max(j,m,v,k,o,h);p==j||p==k?se(g,0):p==m||p==o?se(g,1):(p==v||p==h)&&se(g,2)}}if(this.P.ORDERING_ENABLED){j=r;f=this.Pa;
g=f.length-1;do if(e=f[g],e instanceof L&&e.Ga){k=e.xb;j=e.Za.e;1==k?j=e.$a.e:2==k&&(j=e.ab.e);k=j.length;m=j[0];m.Q=mg(this,m);m.R=e.R;o=j[k-1];o.Q=mg(this,o);o.R=e.R;o=Math.round(1E3*((o.Q-m.Q)/k))/1E3;for(v=v=1;v<k-1;v++)h=Math.round(1E3*(m.Q+v*o))/1E3,j[v].Q=h,j[v].R=e.R;j=n}while(g--);f=this.Wa.t;g=f.length-1;do if(e=f[g],e.Fa&&!(1==e.R||e instanceof re))e.Q=mg(this,e),j=n;while(g--);j&&this.Wa.sort()}if(f=!a&&w(b)&&b&&this.P.STATISTICS_ENABLED)var x=0,u=0,C=0,E=0;var e=this.Xd,g=e.get("vertexPosition"),
j=e.get("vertexNormal"),k=e.get("vertexColor"),m=e.get("vertexTexturePos"),o=e.get("vertexScalar"),e=this.Kc,v=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),z=e.get("useScalars"),F=e.get("scalarsReplaceMode"),A=e.get("scalarsMin"),I=e.get("scalarsMax"),S=e.get("scalarsMinColor"),T=e.get("scalarsMaxColor"),Q=e.get("scalarsMinThreshold"),ba=e.get("scalarsMaxThreshold"),$=e.get("objectOpacity"),aa=e.get("labelmapOpacity"),sa=e.get("useTexture"),eb=e.get("useLabelMapTexture"),Fa=
e.get("textureSampler"),zc=e.get("textureSampler2"),hd=e.get("volumeLowerThreshold"),nb=e.get("volumeUpperThreshold"),id=e.get("volumeScalarMin"),Fb=e.get("volumeScalarMax"),gb=e.get("volumeWindowLow"),Db=e.get("volumeWindowHigh"),Ac=e.get("volumeScalarMinColor"),xa=e.get("volumeScalarMaxColor"),fb=e.get("volumeTexture"),gd=e.get("objectTransform"),fd=e.get("pointSize"),e=d;do{var P=c[d-e];if(P){var R=q;P instanceof re&&P.cb&&(R=P.cb);if(P.Fa&&(!R||R.Fa)){var pa=P.ma,Pa=P.Ac,ya=this.Nc.get(pa),Ya=
this.he.get(pa),Ud=this.jd.get(pa),Eb=this.td.get(pa),Vd=this.ud.get(pa);this.a.bindBuffer(this.a.ARRAY_BUFFER,ya.fa);this.a.vertexAttribPointer(g,ya.qb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ya.fa);this.a.vertexAttribPointer(j,Ya.qb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(v,n):this.a.uniform1i(v,r);Ud&&!a&&!Pa?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ud.fa),this.a.vertexAttribPointer(k,Ud.qb,this.a.FLOAT,r,0,0)):(Ya=1,Pa&&!a&&(Ya=0),this.a.uniform1i(h,Ya),Ya=
P.Cb,a&&(Ya=[Math.floor(pa%65025%255)/255,Math.floor(pa%65025/255)/255,Math.floor(pa/65025)/255]),this.a.uniform3f(p,parseFloat(Ya[0]),parseFloat(Ya[1]),parseFloat(Ya[2])),this.a.vertexAttribPointer(k,ya.qb,this.a.FLOAT,r,0,0));Eb&&!a&&!Pa?(this.a.uniform1i(z,n),this.a.uniform1i(F,P.s.Af),pa=P.s.tb,Pa=P.s.rb,this.a.uniform3f(S,parseFloat(pa[0]),parseFloat(pa[1]),parseFloat(pa[2])),this.a.uniform3f(T,parseFloat(Pa[0]),parseFloat(Pa[1]),parseFloat(Pa[2])),this.a.uniform1f(Q,parseFloat(P.s.Z)),this.a.uniform1f(ba,
parseFloat(P.s.$)),this.a.uniform1f(A,parseFloat(P.s.na)),this.a.uniform1f(I,parseFloat(P.s.ja)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Eb.fa),this.a.vertexAttribPointer(o,Eb.qb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(z,r),this.a.vertexAttribPointer(o,ya.qb,this.a.FLOAT,r,0,0));this.a.uniform1f($,parseFloat(P.R));P.ga&&Vd&&!a?(this.a.uniform1i(sa,n),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.vd.get(P.ga.ma)),this.a.uniform1i(Fa,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,
Vd.fa),this.a.vertexAttribPointer(m,Vd.qb,this.a.FLOAT,r,0,0),this.a.uniform1i(fb,r)):(this.a.uniform1i(sa,r),this.a.vertexAttribPointer(m,ya.qb,this.a.FLOAT,r,0,0));R&&(this.a.uniform1i(fb,n),this.a.uniform1f(hd,R.Z),this.a.uniform1f(nb,R.$),this.a.uniform1f(id,R.na),this.a.uniform1f(Fb,R.ja),pa=R.tb,Pa=R.rb,this.a.uniform3f(Ac,parseFloat(pa[0]),parseFloat(pa[1]),parseFloat(pa[2])),this.a.uniform3f(xa,parseFloat(Pa[0]),parseFloat(Pa[1]),parseFloat(Pa[2])),this.a.uniform1f(gb,R.ba),this.a.uniform1f(Db,
R.aa),Eb=R.z,this.a.uniform1i(eb,r),R.Ga?this.a.uniform1f($,parseFloat(R.R)):Eb&&Eb.Fa&&(R=P.z.ma,this.a.uniform1i(eb,n),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.vd.get(R)),this.a.uniform1i(zc,1),this.a.uniform1f(aa,Eb.R)));this.a.uniformMatrix4fv(gd,r,P.Sb.qf);R=1;"POINTS"==P.qa&&(R=P.Ic);this.a.uniform1f(fd,R);R=-1;P.qa==qd?(R=this.a.TRIANGLES,f&&(u+=ya.pb/3)):"LINES"==P.qa?(this.a.lineWidth(P.hc),R=this.a.LINES,f&&(C+=ya.pb/2)):"POINTS"==P.qa?(R=this.a.POINTS,
f&&(E+=ya.pb)):"TRIANGLE_STRIPS"==P.qa?(R=this.a.TRIANGLE_STRIP,f&&(u+=ya.pb/3)):"POLYGONS"==P.qa&&(R=0==ya.pb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(u+=ya.pb/3));f&&(x+=ya.pb);this.a.drawArrays(R,0,ya.pb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+x+" | ")+("Triangles: "+Math.round(u)+" | "),c=c+("Lines: "+C+" | ")+("Points: "+E+" | ")+("Textures: "+this.vd.sa()),window.console.log(c))}};
t.Ed=function(){this.me=q;delete this.me;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);If.i.Ed.call(this)};B("X.renderer3D",If);B("X.renderer3D.prototype.init",If.prototype.ha);B("X.renderer3D.prototype.add",If.prototype.add);B("X.renderer3D.prototype.onShowtime",If.prototype.lg);B("X.renderer3D.prototype.onRender",If.prototype.jg);B("X.renderer3D.prototype.get",If.prototype.get);B("X.renderer3D.prototype.render",If.prototype.$b);B("X.renderer3D.prototype.destroy",If.prototype.Ed);
B("X.renderer3D.prototype.resetBoundingBox",If.prototype.ii);B("X.renderer3D.prototype.resetViewAndRender",If.prototype.sc);B("X.renderer3D.prototype.pick",If.prototype.pg);function Z(){Hf.call(this);this.c="renderer2D";this.rf=this.$d=this.pf=this.Zd=this.Xa=q;this.sd=this.ne=this.oe=0}D(Z,Hf);Z.prototype.Vh=ca();Z.prototype.Wh=ca();Z.prototype.Xe=function(a){Z.i.Xe.call(this,a);var b=this.Pa[0];if(b){var c=this.Xa;b["index"+c]=a.H?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
Z.prototype.Xh=function(a){var b=this.Pa[0];if(b){var c=b.aa-b.ba,d=c/2,e=parseInt(c+c/15*-a.re,10),a=parseInt(d+d/15*a.ee,10);c==e&&e++;d==a&&a++;b.ba-=parseInt(d-a,10);b.ba-=parseInt(c-e,10);b.ba=Math.max(b.ba,b.na);b.aa-=parseInt(d-a,10);b.aa+=parseInt(c-e,10);b.aa=Math.min(b.aa,b.ja);eval("this.onWindowLevel();")}};Z.prototype.__defineGetter__("orientation",s("Xa"));
Z.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.Xa=a});t=Z.prototype;t.ha=function(){this.Xa||i(Error("No 2D orientation set."));Z.i.ha.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ea.width,this.ea.height);this.Zd=ge("canvas");this.$d=ge("canvas");J(this.p,Ed,this.Xh.bind(this))};t.rotate=function(){this.sd++};t.ji=function(){this.sd--};
t.sc=function(){Z.i.sc.call(this);ng(this);var a=this.Pa[0];a&&(a.aa=a.ja,a.ba=a.na)};
t.Ua=function(a){Z.i.Ua.call(this,a);var b=r;this.get(a.ma)&&(b=n);var c=a.r,d=a.z,e=a.U;if(w(d)&&w(d.r)&&d.r.d)this.Ua(d);else if(w(e)&&w(e.r)&&e.r.d)this.M.load(e,a);else{if(w(c)&&c instanceof Array)if(w(a.ac)){if(a.ac.Md!=c.length||b&&!a.d)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.M.load(c[b],a);return}else if(w(c)&&c.d){this.M.load(a,a);return}d=c=0;e=a.V;"X"==this.Xa?(this.Qb=a.Za.e,c=e[2],d=e[1]):"Y"==this.Xa?(this.Qb=a.$a.e,c=e[0],d=e[2]):"Z"==this.Xa&&(this.Qb=a.ab.e,c=e[0],d=e[1]);
"X"==this.Xa&&(e=d,d=c,c=e);this.oe=c;this.ne=d;e=this.Zd;e.width=c;e.height=d;var f=this.$d;f.width=c;f.height=d;this.pf=e.getContext("2d");this.rf=f.getContext("2d");b||(this.Wa.add(a),ng(this))}};function ng(a){var b=Math.min(a.I/a.oe,a.D/a.ne);a.p.m.k(2,3,10*b-10)}
t.zb=function(a,b){Z.i.zb.call(this,a,b);if(0!=this.Wa.t.length){var c=this.I,d=this.D,e=this.p.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.O(0,3),g=-1*e.O(1,3),h=Math.max(1+e.O(2,3)/10,0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Pa[0],j=this.Qb[parseInt(e["index"+this.Xa],10)],k=j.ga.Ya,j=j.z,m=q;j&&(m=j.Ya);var o=this.oe,v=this.ne,p=this.pf,x=this.rf,u=p.getImageData(0,0,o,v),C=x.getImageData(0,0,o,v),E=u.data,z=C.data,F=E.length,A=e.ja,I=e.Z,S=e.$,T=0;do{var Q=
[0,0,0,0],ba=[0,0,0,0],$=k[T]/255*A,aa=k[T],sa=e.ba/A,aa=(aa/255-sa)/(e.aa/A-sa),aa=255*aa;$>=I&&$<=S&&(Q=new M(e.tb[0],e.tb[1],e.tb[2]),Q=(new M(e.rb[0],e.rb[1],e.rb[2])).scale(aa).add(Q.scale(255-aa)),Q=[Math.floor(Q.x),Math.floor(Q.y),Math.floor(Q.b),255],j&&(ba=[m[T],m[T+1],m[T+2],m[T+3]]));aa=F-1-T;E[aa-3]=Q[0];E[aa-2]=Q[1];E[aa-1]=Q[2];E[aa]=Q[3];z[aa-3]=ba[0];z[aa-2]=ba[1];z[aa-1]=ba[2];z[aa]=ba[3];T+=4}while(T<F);p.putImageData(u,0,0);x.putImageData(C,0,0);this.a.globalAlpha=1;this.a.translate(c/
2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.sd);switch(this.sd%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-o/2+f;g=-v/2+g;this.a.drawImage(this.Zd,f,g);j&&e.z.Fa&&(this.a.globalAlpha=e.z.R,this.a.drawImage(this.$d,f,g))}};B("X.renderer2D",Z);B("X.renderer2D.prototype.init",Z.prototype.ha);B("X.renderer2D.prototype.add",Z.prototype.add);B("X.renderer2D.prototype.onShowtime",Z.prototype.lg);B("X.renderer2D.prototype.onRender",Z.prototype.jg);
B("X.renderer2D.prototype.onScroll",Z.prototype.Vh);B("X.renderer2D.prototype.onWindowLevel",Z.prototype.Wh);B("X.renderer2D.prototype.get",Z.prototype.get);B("X.renderer2D.prototype.rotate",Z.prototype.rotate);B("X.renderer2D.prototype.rotateCounter",Z.prototype.ji);B("X.renderer2D.prototype.resetViewAndRender",Z.prototype.sc);B("X.renderer2D.prototype.render",Z.prototype.$b);B("X.renderer2D.prototype.destroy",Z.prototype.Ed);function og(){U.call(this);this.c="fibers";Aa(this,new Pc)}D(og,U);B("X.fibers",og);function pg(){U.call(this);this.c="mesh";Aa(this,new Pc)}D(pg,U);B("X.mesh",pg);
